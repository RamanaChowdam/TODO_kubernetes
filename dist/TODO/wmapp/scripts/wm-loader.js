(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("rxjs"), require("@angular/compiler"), require("@angular/core"), require("@angular/common/http")) : typeof define === "function" && define.amd ? define("@wm/core", [ "exports", "rxjs", "@angular/compiler", "@angular/core", "@angular/common/http" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.core = {}), global.rxjs, global.ng.compiler, global.ng.core, global.ng.common.http);
})(this, function(exports, rxjs, compiler, i0, i1) {
    "use strict";
    (function(FormWidgetType) {
        FormWidgetType["AUTOCOMPLETE"] = "autocomplete";
        FormWidgetType["CHECKBOX"] = "checkbox";
        FormWidgetType["CHECKBOXSET"] = "checkboxset";
        FormWidgetType["CHIPS"] = "chips";
        FormWidgetType["COLORPICKER"] = "colorpicker";
        FormWidgetType["CURRENCY"] = "currency";
        FormWidgetType["DATE"] = "date";
        FormWidgetType["DATETIME"] = "datetime";
        FormWidgetType["NUMBER"] = "number";
        FormWidgetType["PASSWORD"] = "password";
        FormWidgetType["RADIOSET"] = "radioset";
        FormWidgetType["RATING"] = "rating";
        FormWidgetType["RICHTEXT"] = "richtext";
        FormWidgetType["SELECT"] = "select";
        FormWidgetType["TOGGLE"] = "toggle";
        FormWidgetType["SLIDER"] = "slider";
        FormWidgetType["SWITCH"] = "switch";
        FormWidgetType["TEXT"] = "text";
        FormWidgetType["TEXTAREA"] = "textarea";
        FormWidgetType["TIME"] = "time";
        FormWidgetType["TIMESTAMP"] = "timestamp";
        FormWidgetType["TYPEAHEAD"] = "typeahead";
        FormWidgetType["UPLOAD"] = "upload";
    })(exports.FormWidgetType || (exports.FormWidgetType = {}));
    (function(DataType) {
        DataType["INTEGER"] = "integer";
        DataType["BIG_INTEGER"] = "big_integer";
        DataType["SHORT"] = "short";
        DataType["FLOAT"] = "float";
        DataType["BIG_DECIMAL"] = "big_decimal";
        DataType["DOUBLE"] = "double";
        DataType["LONG"] = "long";
        DataType["BYTE"] = "byte";
        DataType["STRING"] = "string";
        DataType["CHARACTER"] = "character";
        DataType["TEXT"] = "text";
        DataType["DATE"] = "date";
        DataType["TIME"] = "time";
        DataType["TIMESTAMP"] = "timestamp";
        DataType["DATETIME"] = "datetime";
        DataType["LOCALDATETIME"] = "localdatetime";
        DataType["BOOLEAN"] = "boolean";
        DataType["LIST"] = "list";
        DataType["CLOB"] = "clob";
        DataType["BLOB"] = "blob";
    })(exports.DataType || (exports.DataType = {}));
    (function(MatchMode) {
        MatchMode["BETWEEN"] = "between";
        MatchMode["GREATER"] = "greaterthanequal";
        MatchMode["LESSER"] = "lessthanequal";
        MatchMode["NULL"] = "null";
        MatchMode["EMPTY"] = "empty";
        MatchMode["NULLOREMPTY"] = "nullorempty";
        MatchMode["EQUALS"] = "exact";
    })(exports.MatchMode || (exports.MatchMode = {}));
    (function(DEFAULT_FORMATS) {
        DEFAULT_FORMATS["DATE"] = "yyyy-MM-dd";
        DEFAULT_FORMATS["TIME"] = "HH:mm:ss";
        DEFAULT_FORMATS["TIMESTAMP"] = "timestamp";
        DEFAULT_FORMATS["DATETIME"] = "yyyy-MM-ddTHH:mm:ss";
        DEFAULT_FORMATS["LOCALDATETIME"] = "yyyy-MM-ddTHH:mm:ss";
        DEFAULT_FORMATS["DATETIME_ORACLE"] = "yyyy-MM-dd HH:mm:ss";
        DEFAULT_FORMATS["DATE_TIME"] = "yyyy-MM-dd HH:mm:ss";
    })(exports.DEFAULT_FORMATS || (exports.DEFAULT_FORMATS = {}));
    var getUploadEventTmpl = function(attrs, counter, fieldName) {
        var eventTmpl = "";
        attrs.forEach(function(val, key) {
            if (key && key.endsWith(".event")) {
                var eventName = key.split(".")[0];
                var counterTl = counter ? counter + "." : "";
                eventTmpl = " " + eventTmpl + " (" + eventName + ')="' + counterTl + "triggerUploadEvent($event, '" + eventName + "', '" + fieldName + "', row)\" ";
            }
        });
        return eventTmpl;
    };
    var \u02750 = getUploadEventTmpl;
    var getFormWidgetTemplate = function(widgetType, innerTmpl, attrs, options) {
        if (options === void 0) {
            options = {};
        }
        var tmpl;
        var updateOn = attrs.get("updateon");
        var updateOnTmpl = updateOn ? 'updateon="' + updateOn + '"' : "";
        switch (widgetType) {
          case exports.FormWidgetType.AUTOCOMPLETE:
          case exports.FormWidgetType.TYPEAHEAD:
            tmpl = '<div wmSearch type="autocomplete" debouncetime="' + attrs.get("debouncetime") + '" ' + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.CHECKBOX:
            tmpl = "<div wmCheckbox " + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.CHECKBOXSET:
            tmpl = "<ul wmCheckboxset " + innerTmpl + "></ul>";
            break;

          case exports.FormWidgetType.CHIPS:
            tmpl = '<ul wmChips role="input" debouncetime="' + attrs.get("debouncetime") + '" ' + innerTmpl + "></ul>";
            break;

          case exports.FormWidgetType.COLORPICKER:
            tmpl = "<div wmColorPicker " + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.CURRENCY:
            tmpl = "<div wmCurrency " + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.DATE:
            tmpl = '<div wmDate dataentrymode="' + attrs.get("dataentrymode") + '" ' + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.DATETIME:
            tmpl = '<div wmDateTime dataentrymode="' + attrs.get("dataentrymode") + '" ' + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.NUMBER:
            tmpl = "<div wmNumber " + innerTmpl + ' type="number" aria-label="Only numbers" ' + updateOnTmpl + "></div>";
            break;

          case exports.FormWidgetType.PASSWORD:
            tmpl = "<wm-input " + innerTmpl + ' type="password" aria-label="Enter password" ' + updateOnTmpl + "></wm-input>";
            break;

          case exports.FormWidgetType.RADIOSET:
            tmpl = "<ul wmRadioset " + innerTmpl + "></ul>";
            break;

          case exports.FormWidgetType.RATING:
            tmpl = "<div wmRating " + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.RICHTEXT:
            tmpl = '<div wmRichTextEditor role="textbox" ' + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.SELECT:
            tmpl = "<wm-select " + innerTmpl + "></wm-select>";
            break;

          case exports.FormWidgetType.TOGGLE:
            tmpl = "<div wmCheckbox " + innerTmpl + ' type="toggle" role="checkbox" aria-label="Toggle button"></div>';
            break;

          case exports.FormWidgetType.SLIDER:
            tmpl = "<div wmSlider " + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.SWITCH:
            tmpl = "<div wmSwitch " + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.TEXT:
            var inputType = options.inputType || "inputtype";
            tmpl = "<wm-input " + innerTmpl + ' type="' + (attrs.get(inputType) || "text") + '" aria-describedby="Enter text" ' + updateOnTmpl + "></wm-input>";
            break;

          case exports.FormWidgetType.TEXTAREA:
            tmpl = "<wm-textarea " + innerTmpl + ' role="textbox" aria-describedby="Place your text" ' + updateOnTmpl + "></wm-textarea>";
            break;

          case exports.FormWidgetType.TIME:
            tmpl = '<div wmTime dataentrymode="' + attrs.get("dataentrymode") + '" ' + innerTmpl + "></div>";
            break;

          case exports.FormWidgetType.TIMESTAMP:
            tmpl = '<div wmDateTime dataentrymode="' + attrs.get("dataentrymode") + '" ' + innerTmpl + ' role="input"></div>';
            break;

          case exports.FormWidgetType.UPLOAD:
            var counter = options.counter;
            var pCounter = options.pCounter;
            var uploadProps = options.uploadProps;
            var eventTmpl = getUploadEventTmpl(attrs, counter, uploadProps && uploadProps.name);
            if (uploadProps) {
                tmpl = '<form name="' + uploadProps.formName + '" ' + innerTmpl + '>\n                            <input focus-target class="file-upload" type="file" name="' + uploadProps.name + '" ' + eventTmpl + "/>\n                        </form>";
            } else {
                tmpl = '<a class="form-control-static" href="{{' + counter + '.href}}" target="_blank" *ngIf="' + counter + ".filetype === 'image' && " + counter + '.href">\n                        <img style="height:2em" class="wi wi-file" [src]="' + counter + '.href"/></a>\n                        <a class="form-control-static" target="_blank" href="{{' + counter + '.href}}" *ngIf="' + counter + ".filetype !== 'image' && " + counter + '.href">\n                        <i class="wi wi-file"></i></a>\n                        <input ' + innerTmpl + ' class="app-blob-upload" [ngClass]="{\'file-readonly\': ' + counter + '.readonly}" ' + eventTmpl + '\n                        [required]="' + counter + '.required" type="file" name="' + (attrs.get("key") || attrs.get("name")) + '_formWidget" [readonly]="' + counter + '.readonly"\n                        [class.hidden]="!' + pCounter + '.isUpdateMode" [accept]="' + counter + '.permitted">';
            }
            break;

          default:
            tmpl = "<wm-input " + innerTmpl + ' aria-describedby="Enter text" type="text" ' + updateOnTmpl + "></wm-input>";
            break;
        }
        return tmpl;
    };
    var getRequiredFormWidget = function(widgetType) {
        switch (widgetType) {
          case exports.FormWidgetType.AUTOCOMPLETE:
          case exports.FormWidgetType.TYPEAHEAD:
            return "wm-search";

          case exports.FormWidgetType.CHIPS:
            return "wm-chips";

          case exports.FormWidgetType.COLORPICKER:
            return "wm-colorpicker";

          case exports.FormWidgetType.CURRENCY:
            return "wm-currency";

          case exports.FormWidgetType.DATE:
            return "wm-date";

          case exports.FormWidgetType.DATETIME:
            return "wm-datetime";

          case exports.FormWidgetType.TIME:
          case exports.FormWidgetType.TIMESTAMP:
            return "wm-time";

          case exports.FormWidgetType.RATING:
            return "wm-rating";

          case exports.FormWidgetType.RICHTEXT:
            return "wm-richtexteditor";

          case exports.FormWidgetType.SLIDER:
            return "wm-slider";

          default:
            return "wm-text";
        }
    };
    var addDatasetBoundExprAttribute = function(childNode, attr, attrValue) {
        attrValue = attrValue.replace("bind:", "");
        var datasetBoundAttribute = childNode.attrs.find(function(a) {
            return a.name === "datasetboundexpr";
        });
        if (attr.name === "dataset" && !datasetBoundAttribute) {
            childNode.attrs.push(new compiler.Attribute("datasetboundexpr", attrValue, attr.sourceSpan, attr.valueSpan));
        }
    };
    var \u02751 = addDatasetBoundExprAttribute;
    var updateTemplateAttrs = function(rootNode, parentDataSet, widgetName, instance, referenceName) {
        if (instance === void 0) {
            instance = "";
        }
        if (referenceName === void 0) {
            referenceName = "item";
        }
        var regex = new RegExp("(" + parentDataSet + ")(\\[0\\])?(.data\\[\\$i\\])?(.content\\[\\$i\\])?(\\[\\$i\\])?", "g");
        var currentItemRegEx;
        var currentItemWidgetsRegEx;
        var formWidgetsRegex;
        var nodes;
        var widgetList = {
            "wm-list": [ "itemclass", "disableitem", "dataset" ]
        };
        if (widgetName) {
            currentItemRegEx = new RegExp("(Widgets." + widgetName + ".currentItem)\\b", "g");
            currentItemWidgetsRegEx = new RegExp("(Widgets." + widgetName + ".currentItemWidgets)\\b", "g");
            formWidgetsRegex = new RegExp("(Widgets.(.*).(formWidgets|filterWidgets))\\b", "g");
        }
        if (!_.isArray(rootNode)) {
            nodes = widgetList[rootNode.name] ? [ rootNode ] : rootNode.children || [];
        } else {
            nodes = rootNode;
        }
        nodes.forEach(function(childNode) {
            if (childNode.name) {
                var nodeName_1 = childNode.name;
                var parentDataSetLengthRegex_1 = new RegExp("bind:\\s*\\(*" + parentDataSet + "\\)*\\.length\\)*");
                childNode.attrs.forEach(function(attr) {
                    var value = attr.value && attr.value.trim();
                    if (_.startsWith(value, "bind:")) {
                        if (!widgetList[nodeName_1] || widgetList[nodeName_1] && widgetList[nodeName_1].indexOf(attr.name) > -1) {
                            if (_.includes(value, parentDataSet) && value !== "bind:" + parentDataSet && !parentDataSetLengthRegex_1.test(value)) {
                                value = value.replace("bind:", "");
                                addDatasetBoundExprAttribute(childNode, attr, value);
                                value = value.replace(regex, referenceName);
                                value = "bind:" + value;
                            }
                        }
                        if (currentItemRegEx && currentItemRegEx.test(value)) {
                            if (value.includes(".formWidgets") || value.includes(".filterWidgets")) {
                                value = value.replace(formWidgetsRegex, "Widgets");
                            }
                            addDatasetBoundExprAttribute(childNode, attr, value);
                            value = value.replace(currentItemRegEx, referenceName);
                        }
                        if (currentItemWidgetsRegEx && currentItemWidgetsRegEx.test(value)) {
                            value = value.replace(currentItemWidgetsRegEx, instance + "currentItemWidgets");
                        }
                        attr.value = value;
                    }
                });
                updateTemplateAttrs(childNode.children, parentDataSet, widgetName, instance, referenceName);
            }
        });
    };
    var getNgModelAttr = function(attrs) {
        if (attrs.has("formControlName") || attrs.has("formControlName.bind")) {
            return "";
        }
        return "ngModel";
    };
    var rowActionAttrs = new Map([ [ "display-name", "caption" ], [ "display-name.bind", "caption.bind" ], [ "title", "hint" ], [ "title.bind", "hint.bind" ], [ "show", "show" ], [ "show.bind", "show.bind" ], [ "disabled", "disabled" ], [ "disabled.bind", "disabled.bind" ], [ "hyperlink", "hyperlink" ], [ "hyperlink.bind", "hyperlink.bind" ], [ "target", "target" ], [ "conditionalclass.bind", "conditionalclass.bind" ], [ "conditionalstyle.bind", "conditionalstyle.bind" ] ]);
    var getRowActionAttrs = function(attrs) {
        var tmpl = "";
        attrs.forEach(function(val, key) {
            var newAttr = rowActionAttrs.get(key);
            if (newAttr) {
                tmpl += newAttr + '="' + val + '" ';
            }
        });
        return tmpl;
    };
    var CURRENCY_INFO = {
        USD: {
            symbol: "$",
            name: "US Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "USD",
            name_plural: "US dollars"
        },
        CAD: {
            symbol: "CA$",
            name: "Canadian Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "CAD",
            name_plural: "Canadian dollars"
        },
        EUR: {
            symbol: "\u20ac",
            name: "Euro",
            symbol_native: "\u20ac",
            decimal_digits: 2,
            rounding: 0,
            code: "EUR",
            name_plural: "euros"
        },
        AED: {
            symbol: "AED",
            name: "United Arab Emirates Dirham",
            symbol_native: "\u062f.\u0625.\u200f",
            decimal_digits: 2,
            rounding: 0,
            code: "AED",
            name_plural: "UAE dirhams"
        },
        AFN: {
            symbol: "Af",
            name: "Afghan Afghani",
            symbol_native: "\u060b",
            decimal_digits: 0,
            rounding: 0,
            code: "AFN",
            name_plural: "Afghan Afghanis"
        },
        ALL: {
            symbol: "ALL",
            name: "Albanian Lek",
            symbol_native: "Lek",
            decimal_digits: 0,
            rounding: 0,
            code: "ALL",
            name_plural: "Albanian lek\xeb"
        },
        AMD: {
            symbol: "AMD",
            name: "Armenian Dram",
            symbol_native: "\u0564\u0580.",
            decimal_digits: 0,
            rounding: 0,
            code: "AMD",
            name_plural: "Armenian drams"
        },
        ARS: {
            symbol: "AR$",
            name: "Argentine Peso",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "ARS",
            name_plural: "Argentine pesos"
        },
        AUD: {
            symbol: "AU$",
            name: "Australian Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "AUD",
            name_plural: "Australian dollars"
        },
        AZN: {
            symbol: "man.",
            name: "Azerbaijani Manat",
            symbol_native: "\u043c\u0430\u043d.",
            decimal_digits: 2,
            rounding: 0,
            code: "AZN",
            name_plural: "Azerbaijani manats"
        },
        BAM: {
            symbol: "KM",
            name: "Bosnia-Herzegovina Convertible Mark",
            symbol_native: "KM",
            decimal_digits: 2,
            rounding: 0,
            code: "BAM",
            name_plural: "Bosnia-Herzegovina convertible marks"
        },
        BDT: {
            symbol: "Tk",
            name: "Bangladeshi Taka",
            symbol_native: "\u09f3",
            decimal_digits: 2,
            rounding: 0,
            code: "BDT",
            name_plural: "Bangladeshi takas"
        },
        BGN: {
            symbol: "BGN",
            name: "Bulgarian Lev",
            symbol_native: "\u043b\u0432.",
            decimal_digits: 2,
            rounding: 0,
            code: "BGN",
            name_plural: "Bulgarian leva"
        },
        BHD: {
            symbol: "BD",
            name: "Bahraini Dinar",
            symbol_native: "\u062f.\u0628.\u200f",
            decimal_digits: 3,
            rounding: 0,
            code: "BHD",
            name_plural: "Bahraini dinars"
        },
        BIF: {
            symbol: "FBu",
            name: "Burundian Franc",
            symbol_native: "FBu",
            decimal_digits: 0,
            rounding: 0,
            code: "BIF",
            name_plural: "Burundian francs"
        },
        BND: {
            symbol: "BN$",
            name: "Brunei Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "BND",
            name_plural: "Brunei dollars"
        },
        BOB: {
            symbol: "Bs",
            name: "Bolivian Boliviano",
            symbol_native: "Bs",
            decimal_digits: 2,
            rounding: 0,
            code: "BOB",
            name_plural: "Bolivian bolivianos"
        },
        BRL: {
            symbol: "R$",
            name: "Brazilian Real",
            symbol_native: "R$",
            decimal_digits: 2,
            rounding: 0,
            code: "BRL",
            name_plural: "Brazilian reals"
        },
        BWP: {
            symbol: "BWP",
            name: "Botswanan Pula",
            symbol_native: "P",
            decimal_digits: 2,
            rounding: 0,
            code: "BWP",
            name_plural: "Botswanan pulas"
        },
        BYR: {
            symbol: "BYR",
            name: "Belarusian Ruble",
            symbol_native: "BYR",
            decimal_digits: 0,
            rounding: 0,
            code: "BYR",
            name_plural: "Belarusian rubles"
        },
        BZD: {
            symbol: "BZ$",
            name: "Belize Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "BZD",
            name_plural: "Belize dollars"
        },
        CDF: {
            symbol: "CDF",
            name: "Congolese Franc",
            symbol_native: "FrCD",
            decimal_digits: 2,
            rounding: 0,
            code: "CDF",
            name_plural: "Congolese francs"
        },
        CHF: {
            symbol: "CHF",
            name: "Swiss Franc",
            symbol_native: "CHF",
            decimal_digits: 2,
            rounding: .05,
            code: "CHF",
            name_plural: "Swiss francs"
        },
        CLP: {
            symbol: "CL$",
            name: "Chilean Peso",
            symbol_native: "$",
            decimal_digits: 0,
            rounding: 0,
            code: "CLP",
            name_plural: "Chilean pesos"
        },
        CNY: {
            symbol: "CN\xa5",
            name: "Chinese Yuan",
            symbol_native: "CN\xa5",
            decimal_digits: 2,
            rounding: 0,
            code: "CNY",
            name_plural: "Chinese yuan"
        },
        COP: {
            symbol: "CO$",
            name: "Colombian Peso",
            symbol_native: "$",
            decimal_digits: 0,
            rounding: 0,
            code: "COP",
            name_plural: "Colombian pesos"
        },
        CRC: {
            symbol: "\u20a1",
            name: "Costa Rican Col\xf3n",
            symbol_native: "\u20a1",
            decimal_digits: 0,
            rounding: 0,
            code: "CRC",
            name_plural: "Costa Rican col\xf3ns"
        },
        CVE: {
            symbol: "CV$",
            name: "Cape Verdean Escudo",
            symbol_native: "CV$",
            decimal_digits: 2,
            rounding: 0,
            code: "CVE",
            name_plural: "Cape Verdean escudos"
        },
        CZK: {
            symbol: "K\u010d",
            name: "Czech Republic Koruna",
            symbol_native: "K\u010d",
            decimal_digits: 2,
            rounding: 0,
            code: "CZK",
            name_plural: "Czech Republic korunas"
        },
        DJF: {
            symbol: "Fdj",
            name: "Djiboutian Franc",
            symbol_native: "Fdj",
            decimal_digits: 0,
            rounding: 0,
            code: "DJF",
            name_plural: "Djiboutian francs"
        },
        DKK: {
            symbol: "Dkr",
            name: "Danish Krone",
            symbol_native: "kr",
            decimal_digits: 2,
            rounding: 0,
            code: "DKK",
            name_plural: "Danish kroner"
        },
        DOP: {
            symbol: "RD$",
            name: "Dominican Peso",
            symbol_native: "RD$",
            decimal_digits: 2,
            rounding: 0,
            code: "DOP",
            name_plural: "Dominican pesos"
        },
        DZD: {
            symbol: "DA",
            name: "Algerian Dinar",
            symbol_native: "\u062f.\u062c.\u200f",
            decimal_digits: 2,
            rounding: 0,
            code: "DZD",
            name_plural: "Algerian dinars"
        },
        EEK: {
            symbol: "Ekr",
            name: "Estonian Kroon",
            symbol_native: "kr",
            decimal_digits: 2,
            rounding: 0,
            code: "EEK",
            name_plural: "Estonian kroons"
        },
        EGP: {
            symbol: "EGP",
            name: "Egyptian Pound",
            symbol_native: "\u062c.\u0645.\u200f",
            decimal_digits: 2,
            rounding: 0,
            code: "EGP",
            name_plural: "Egyptian pounds"
        },
        ERN: {
            symbol: "Nfk",
            name: "Eritrean Nakfa",
            symbol_native: "Nfk",
            decimal_digits: 2,
            rounding: 0,
            code: "ERN",
            name_plural: "Eritrean nakfas"
        },
        ETB: {
            symbol: "Br",
            name: "Ethiopian Birr",
            symbol_native: "Br",
            decimal_digits: 2,
            rounding: 0,
            code: "ETB",
            name_plural: "Ethiopian birrs"
        },
        GBP: {
            symbol: "\xa3",
            name: "British Pound Sterling",
            symbol_native: "\xa3",
            decimal_digits: 2,
            rounding: 0,
            code: "GBP",
            name_plural: "British pounds sterling"
        },
        GEL: {
            symbol: "GEL",
            name: "Georgian Lari",
            symbol_native: "GEL",
            decimal_digits: 2,
            rounding: 0,
            code: "GEL",
            name_plural: "Georgian laris"
        },
        GHS: {
            symbol: "GH\u20b5",
            name: "Ghanaian Cedi",
            symbol_native: "GH\u20b5",
            decimal_digits: 2,
            rounding: 0,
            code: "GHS",
            name_plural: "Ghanaian cedis"
        },
        GNF: {
            symbol: "FG",
            name: "Guinean Franc",
            symbol_native: "FG",
            decimal_digits: 0,
            rounding: 0,
            code: "GNF",
            name_plural: "Guinean francs"
        },
        GTQ: {
            symbol: "GTQ",
            name: "Guatemalan Quetzal",
            symbol_native: "Q",
            decimal_digits: 2,
            rounding: 0,
            code: "GTQ",
            name_plural: "Guatemalan quetzals"
        },
        HKD: {
            symbol: "HK$",
            name: "Hong Kong Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "HKD",
            name_plural: "Hong Kong dollars"
        },
        HNL: {
            symbol: "HNL",
            name: "Honduran Lempira",
            symbol_native: "L",
            decimal_digits: 2,
            rounding: 0,
            code: "HNL",
            name_plural: "Honduran lempiras"
        },
        HRK: {
            symbol: "kn",
            name: "Croatian Kuna",
            symbol_native: "kn",
            decimal_digits: 2,
            rounding: 0,
            code: "HRK",
            name_plural: "Croatian kunas"
        },
        HUF: {
            symbol: "Ft",
            name: "Hungarian Forint",
            symbol_native: "Ft",
            decimal_digits: 0,
            rounding: 0,
            code: "HUF",
            name_plural: "Hungarian forints"
        },
        IDR: {
            symbol: "Rp",
            name: "Indonesian Rupiah",
            symbol_native: "Rp",
            decimal_digits: 0,
            rounding: 0,
            code: "IDR",
            name_plural: "Indonesian rupiahs"
        },
        ILS: {
            symbol: "\u20aa",
            name: "Israeli New Sheqel",
            symbol_native: "\u20aa",
            decimal_digits: 2,
            rounding: 0,
            code: "ILS",
            name_plural: "Israeli new sheqels"
        },
        INR: {
            symbol: "\u20b9",
            name: "Indian Rupee",
            symbol_native: "\u099f\u0995\u09be",
            decimal_digits: 2,
            rounding: 0,
            code: "INR",
            name_plural: "Indian rupees"
        },
        IQD: {
            symbol: "IQD",
            name: "Iraqi Dinar",
            symbol_native: "\u062f.\u0639.\u200f",
            decimal_digits: 0,
            rounding: 0,
            code: "IQD",
            name_plural: "Iraqi dinars"
        },
        IRR: {
            symbol: "IRR",
            name: "Iranian Rial",
            symbol_native: "\ufdfc",
            decimal_digits: 0,
            rounding: 0,
            code: "IRR",
            name_plural: "Iranian rials"
        },
        ISK: {
            symbol: "Ikr",
            name: "Icelandic Kr\xf3na",
            symbol_native: "kr",
            decimal_digits: 0,
            rounding: 0,
            code: "ISK",
            name_plural: "Icelandic kr\xf3nur"
        },
        JMD: {
            symbol: "J$",
            name: "Jamaican Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "JMD",
            name_plural: "Jamaican dollars"
        },
        JOD: {
            symbol: "JD",
            name: "Jordanian Dinar",
            symbol_native: "\u062f.\u0623.\u200f",
            decimal_digits: 3,
            rounding: 0,
            code: "JOD",
            name_plural: "Jordanian dinars"
        },
        JPY: {
            symbol: "\xa5",
            name: "Japanese Yen",
            symbol_native: "\uffe5",
            decimal_digits: 0,
            rounding: 0,
            code: "JPY",
            name_plural: "Japanese yen"
        },
        KES: {
            symbol: "Ksh",
            name: "Kenyan Shilling",
            symbol_native: "Ksh",
            decimal_digits: 2,
            rounding: 0,
            code: "KES",
            name_plural: "Kenyan shillings"
        },
        KHR: {
            symbol: "KHR",
            name: "Cambodian Riel",
            symbol_native: "\u17db",
            decimal_digits: 2,
            rounding: 0,
            code: "KHR",
            name_plural: "Cambodian riels"
        },
        KMF: {
            symbol: "CF",
            name: "Comorian Franc",
            symbol_native: "FC",
            decimal_digits: 0,
            rounding: 0,
            code: "KMF",
            name_plural: "Comorian francs"
        },
        KRW: {
            symbol: "\u20a9",
            name: "South Korean Won",
            symbol_native: "\u20a9",
            decimal_digits: 0,
            rounding: 0,
            code: "KRW",
            name_plural: "South Korean won"
        },
        KWD: {
            symbol: "KD",
            name: "Kuwaiti Dinar",
            symbol_native: "\u062f.\u0643.\u200f",
            decimal_digits: 3,
            rounding: 0,
            code: "KWD",
            name_plural: "Kuwaiti dinars"
        },
        KZT: {
            symbol: "KZT",
            name: "Kazakhstani Tenge",
            symbol_native: "\u0442\u04a3\u0433.",
            decimal_digits: 2,
            rounding: 0,
            code: "KZT",
            name_plural: "Kazakhstani tenges"
        },
        LBP: {
            symbol: "LB\xa3",
            name: "Lebanese Pound",
            symbol_native: "\u0644.\u0644.\u200f",
            decimal_digits: 0,
            rounding: 0,
            code: "LBP",
            name_plural: "Lebanese pounds"
        },
        LKR: {
            symbol: "SLRs",
            name: "Sri Lankan Rupee",
            symbol_native: "SL Re",
            decimal_digits: 2,
            rounding: 0,
            code: "LKR",
            name_plural: "Sri Lankan rupees"
        },
        LTL: {
            symbol: "Lt",
            name: "Lithuanian Litas",
            symbol_native: "Lt",
            decimal_digits: 2,
            rounding: 0,
            code: "LTL",
            name_plural: "Lithuanian litai"
        },
        LVL: {
            symbol: "Ls",
            name: "Latvian Lats",
            symbol_native: "Ls",
            decimal_digits: 2,
            rounding: 0,
            code: "LVL",
            name_plural: "Latvian lati"
        },
        LYD: {
            symbol: "LD",
            name: "Libyan Dinar",
            symbol_native: "\u062f.\u0644.\u200f",
            decimal_digits: 3,
            rounding: 0,
            code: "LYD",
            name_plural: "Libyan dinars"
        },
        MAD: {
            symbol: "MAD",
            name: "Moroccan Dirham",
            symbol_native: "\u062f.\u0645.\u200f",
            decimal_digits: 2,
            rounding: 0,
            code: "MAD",
            name_plural: "Moroccan dirhams"
        },
        MDL: {
            symbol: "MDL",
            name: "Moldovan Leu",
            symbol_native: "MDL",
            decimal_digits: 2,
            rounding: 0,
            code: "MDL",
            name_plural: "Moldovan lei"
        },
        MGA: {
            symbol: "MGA",
            name: "Malagasy Ariary",
            symbol_native: "MGA",
            decimal_digits: 0,
            rounding: 0,
            code: "MGA",
            name_plural: "Malagasy Ariaries"
        },
        MKD: {
            symbol: "MKD",
            name: "Macedonian Denar",
            symbol_native: "MKD",
            decimal_digits: 2,
            rounding: 0,
            code: "MKD",
            name_plural: "Macedonian denari"
        },
        MMK: {
            symbol: "MMK",
            name: "Myanma Kyat",
            symbol_native: "K",
            decimal_digits: 0,
            rounding: 0,
            code: "MMK",
            name_plural: "Myanma kyats"
        },
        MOP: {
            symbol: "MOP$",
            name: "Macanese Pataca",
            symbol_native: "MOP$",
            decimal_digits: 2,
            rounding: 0,
            code: "MOP",
            name_plural: "Macanese patacas"
        },
        MUR: {
            symbol: "MURs",
            name: "Mauritian Rupee",
            symbol_native: "MURs",
            decimal_digits: 0,
            rounding: 0,
            code: "MUR",
            name_plural: "Mauritian rupees"
        },
        MXN: {
            symbol: "MX$",
            name: "Mexican Peso",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "MXN",
            name_plural: "Mexican pesos"
        },
        MYR: {
            symbol: "RM",
            name: "Malaysian Ringgit",
            symbol_native: "RM",
            decimal_digits: 2,
            rounding: 0,
            code: "MYR",
            name_plural: "Malaysian ringgits"
        },
        MZN: {
            symbol: "MTn",
            name: "Mozambican Metical",
            symbol_native: "MTn",
            decimal_digits: 2,
            rounding: 0,
            code: "MZN",
            name_plural: "Mozambican meticals"
        },
        NAD: {
            symbol: "N$",
            name: "Namibian Dollar",
            symbol_native: "N$",
            decimal_digits: 2,
            rounding: 0,
            code: "NAD",
            name_plural: "Namibian dollars"
        },
        NGN: {
            symbol: "\u20a6",
            name: "Nigerian Naira",
            symbol_native: "\u20a6",
            decimal_digits: 2,
            rounding: 0,
            code: "NGN",
            name_plural: "Nigerian nairas"
        },
        NIO: {
            symbol: "C$",
            name: "Nicaraguan C\xf3rdoba",
            symbol_native: "C$",
            decimal_digits: 2,
            rounding: 0,
            code: "NIO",
            name_plural: "Nicaraguan c\xf3rdobas"
        },
        NOK: {
            symbol: "Nkr",
            name: "Norwegian Krone",
            symbol_native: "kr",
            decimal_digits: 2,
            rounding: 0,
            code: "NOK",
            name_plural: "Norwegian kroner"
        },
        NPR: {
            symbol: "NPRs",
            name: "Nepalese Rupee",
            symbol_native: "\u0928\u0947\u0930\u0942",
            decimal_digits: 2,
            rounding: 0,
            code: "NPR",
            name_plural: "Nepalese rupees"
        },
        NZD: {
            symbol: "NZ$",
            name: "New Zealand Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "NZD",
            name_plural: "New Zealand dollars"
        },
        OMR: {
            symbol: "OMR",
            name: "Omani Rial",
            symbol_native: "\u0631.\u0639.\u200f",
            decimal_digits: 3,
            rounding: 0,
            code: "OMR",
            name_plural: "Omani rials"
        },
        PAB: {
            symbol: "B/.",
            name: "Panamanian Balboa",
            symbol_native: "B/.",
            decimal_digits: 2,
            rounding: 0,
            code: "PAB",
            name_plural: "Panamanian balboas"
        },
        PEN: {
            symbol: "S/.",
            name: "Peruvian Nuevo Sol",
            symbol_native: "S/.",
            decimal_digits: 2,
            rounding: 0,
            code: "PEN",
            name_plural: "Peruvian nuevos soles"
        },
        PHP: {
            symbol: "\u20b1",
            name: "Philippine Peso",
            symbol_native: "\u20b1",
            decimal_digits: 2,
            rounding: 0,
            code: "PHP",
            name_plural: "Philippine pesos"
        },
        PKR: {
            symbol: "PKRs",
            name: "Pakistani Rupee",
            symbol_native: "\u20a8",
            decimal_digits: 0,
            rounding: 0,
            code: "PKR",
            name_plural: "Pakistani rupees"
        },
        PLN: {
            symbol: "z\u0142",
            name: "Polish Zloty",
            symbol_native: "z\u0142",
            decimal_digits: 2,
            rounding: 0,
            code: "PLN",
            name_plural: "Polish zlotys"
        },
        PYG: {
            symbol: "\u20b2",
            name: "Paraguayan Guarani",
            symbol_native: "\u20b2",
            decimal_digits: 0,
            rounding: 0,
            code: "PYG",
            name_plural: "Paraguayan guaranis"
        },
        QAR: {
            symbol: "QR",
            name: "Qatari Rial",
            symbol_native: "\u0631.\u0642.\u200f",
            decimal_digits: 2,
            rounding: 0,
            code: "QAR",
            name_plural: "Qatari rials"
        },
        RON: {
            symbol: "RON",
            name: "Romanian Leu",
            symbol_native: "RON",
            decimal_digits: 2,
            rounding: 0,
            code: "RON",
            name_plural: "Romanian lei"
        },
        RSD: {
            symbol: "din.",
            name: "Serbian Dinar",
            symbol_native: "\u0434\u0438\u043d.",
            decimal_digits: 0,
            rounding: 0,
            code: "RSD",
            name_plural: "Serbian dinars"
        },
        RUB: {
            symbol: "RUB",
            name: "Russian Ruble",
            symbol_native: "\u0440\u0443\u0431.",
            decimal_digits: 2,
            rounding: 0,
            code: "RUB",
            name_plural: "Russian rubles"
        },
        RWF: {
            symbol: "RWF",
            name: "Rwandan Franc",
            symbol_native: "FR",
            decimal_digits: 0,
            rounding: 0,
            code: "RWF",
            name_plural: "Rwandan francs"
        },
        SAR: {
            symbol: "SR",
            name: "Saudi Riyal",
            symbol_native: "\u0631.\u0633.\u200f",
            decimal_digits: 2,
            rounding: 0,
            code: "SAR",
            name_plural: "Saudi riyals"
        },
        SDG: {
            symbol: "SDG",
            name: "Sudanese Pound",
            symbol_native: "SDG",
            decimal_digits: 2,
            rounding: 0,
            code: "SDG",
            name_plural: "Sudanese pounds"
        },
        SEK: {
            symbol: "Skr",
            name: "Swedish Krona",
            symbol_native: "kr",
            decimal_digits: 2,
            rounding: 0,
            code: "SEK",
            name_plural: "Swedish kronor"
        },
        SGD: {
            symbol: "S$",
            name: "Singapore Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "SGD",
            name_plural: "Singapore dollars"
        },
        SOS: {
            symbol: "Ssh",
            name: "Somali Shilling",
            symbol_native: "Ssh",
            decimal_digits: 0,
            rounding: 0,
            code: "SOS",
            name_plural: "Somali shillings"
        },
        SYP: {
            symbol: "SY\xa3",
            name: "Syrian Pound",
            symbol_native: "\u0644.\u0633.\u200f",
            decimal_digits: 0,
            rounding: 0,
            code: "SYP",
            name_plural: "Syrian pounds"
        },
        THB: {
            symbol: "\u0e3f",
            name: "Thai Baht",
            symbol_native: "\u0e3f",
            decimal_digits: 2,
            rounding: 0,
            code: "THB",
            name_plural: "Thai baht"
        },
        TND: {
            symbol: "DT",
            name: "Tunisian Dinar",
            symbol_native: "\u062f.\u062a.\u200f",
            decimal_digits: 3,
            rounding: 0,
            code: "TND",
            name_plural: "Tunisian dinars"
        },
        TOP: {
            symbol: "T$",
            name: "Tongan Pa\u02bbanga",
            symbol_native: "T$",
            decimal_digits: 2,
            rounding: 0,
            code: "TOP",
            name_plural: "Tongan pa\u02bbanga"
        },
        TRY: {
            symbol: "TL",
            name: "Turkish Lira",
            symbol_native: "TL",
            decimal_digits: 2,
            rounding: 0,
            code: "TRY",
            name_plural: "Turkish Lira"
        },
        TTD: {
            symbol: "TT$",
            name: "Trinidad and Tobago Dollar",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "TTD",
            name_plural: "Trinidad and Tobago dollars"
        },
        TWD: {
            symbol: "NT$",
            name: "New Taiwan Dollar",
            symbol_native: "NT$",
            decimal_digits: 2,
            rounding: 0,
            code: "TWD",
            name_plural: "New Taiwan dollars"
        },
        TZS: {
            symbol: "TSh",
            name: "Tanzanian Shilling",
            symbol_native: "TSh",
            decimal_digits: 0,
            rounding: 0,
            code: "TZS",
            name_plural: "Tanzanian shillings"
        },
        UAH: {
            symbol: "\u20b4",
            name: "Ukrainian Hryvnia",
            symbol_native: "\u20b4",
            decimal_digits: 2,
            rounding: 0,
            code: "UAH",
            name_plural: "Ukrainian hryvnias"
        },
        UGX: {
            symbol: "USh",
            name: "Ugandan Shilling",
            symbol_native: "USh",
            decimal_digits: 0,
            rounding: 0,
            code: "UGX",
            name_plural: "Ugandan shillings"
        },
        UYU: {
            symbol: "$U",
            name: "Uruguayan Peso",
            symbol_native: "$",
            decimal_digits: 2,
            rounding: 0,
            code: "UYU",
            name_plural: "Uruguayan pesos"
        },
        UZS: {
            symbol: "UZS",
            name: "Uzbekistan Som",
            symbol_native: "UZS",
            decimal_digits: 0,
            rounding: 0,
            code: "UZS",
            name_plural: "Uzbekistan som"
        },
        VEF: {
            symbol: "Bs.F.",
            name: "Venezuelan Bol\xedvar",
            symbol_native: "Bs.F.",
            decimal_digits: 2,
            rounding: 0,
            code: "VEF",
            name_plural: "Venezuelan bol\xedvars"
        },
        VND: {
            symbol: "\u20ab",
            name: "Vietnamese Dong",
            symbol_native: "\u20ab",
            decimal_digits: 0,
            rounding: 0,
            code: "VND",
            name_plural: "Vietnamese dong"
        },
        XAF: {
            symbol: "FCFA",
            name: "CFA Franc BEAC",
            symbol_native: "FCFA",
            decimal_digits: 0,
            rounding: 0,
            code: "XAF",
            name_plural: "CFA francs BEAC"
        },
        XOF: {
            symbol: "CFA",
            name: "CFA Franc BCEAO",
            symbol_native: "CFA",
            decimal_digits: 0,
            rounding: 0,
            code: "XOF",
            name_plural: "CFA francs BCEAO"
        },
        YER: {
            symbol: "YR",
            name: "Yemeni Rial",
            symbol_native: "\u0631.\u064a.\u200f",
            decimal_digits: 0,
            rounding: 0,
            code: "YER",
            name_plural: "Yemeni rials"
        },
        ZAR: {
            symbol: "R",
            name: "South African Rand",
            symbol_native: "R",
            decimal_digits: 2,
            rounding: 0,
            code: "ZAR",
            name_plural: "South African rand"
        },
        ZMK: {
            symbol: "ZK",
            name: "Zambian Kwacha",
            symbol_native: "ZK",
            decimal_digits: 0,
            rounding: 0,
            code: "ZMK",
            name_plural: "Zambian kwachas"
        }
    };
    var $RAF = window.requestAnimationFrame;
    var $RAFQueue = [];
    var invokeLater = function(fn) {
        if (!$RAFQueue.length) {
            $RAF(function() {
                $RAFQueue.forEach(function(f) {
                    return f();
                });
                $RAFQueue.length = 0;
            });
        }
        $RAFQueue.push(fn);
    };
    var appendNode = function(node, parent, sync) {
        var task = function() {
            return parent.appendChild(node);
        };
        sync ? task() : invokeLater(task);
    };
    var insertBefore = function(node, ref, sync) {
        var task = function() {
            return ref.parentNode.insertBefore(node, ref);
        };
        sync ? task() : invokeLater(task);
    };
    var insertAfter = function(node, ref, sync) {
        var task = function() {
            return ref.parentNode.insertBefore(node, ref.nextSibling);
        };
        sync ? task() : invokeLater(task);
    };
    var removeNode = function(node, sync) {
        var task = function() {
            return node.remove();
        };
        sync ? task() : invokeLater(task);
    };
    var removeClass = function(node, ov, sync) {
        ov = ov || "";
        var task = function(c) {
            return node.classList.remove(c);
        };
        ov.split(" ").forEach(function(c) {
            if (c.length) {
                sync ? task(c) : invokeLater(function() {
                    return task(c);
                });
            }
        });
    };
    var addClass = function(node, nv, sync) {
        nv = nv || "";
        var task = function(c) {
            return node.classList.add(c);
        };
        nv.split(" ").forEach(function(c) {
            if (c.length) {
                sync ? task(c) : invokeLater(function() {
                    return task(c);
                });
            }
        });
    };
    var switchClass = function(node, toAdd, toRemove, sync) {
        if (toAdd === void 0) {
            toAdd = "";
        }
        if (toRemove === void 0) {
            toRemove = "";
        }
        removeClass(node, toRemove, sync);
        addClass(node, toAdd, sync);
    };
    var toggleClass = function(node, cls, condition, sync) {
        if (condition) {
            addClass(node, cls, sync);
        } else {
            removeClass(node, cls, sync);
        }
    };
    var setCSS = function(node, cssName, val, sync) {
        var task = function() {
            return node.style[cssName] = val;
        };
        sync ? task() : invokeLater(task);
    };
    var setCSSFromObj = function(node, cssObj, sync) {
        var keys = Object.keys(cssObj || {});
        keys.forEach(function(key) {
            return setCSS(node, key, cssObj[key], sync);
        });
    };
    var setProperty = function(node, propName, val, sync) {
        var task = function() {
            return node[propName] = val;
        };
        sync ? task() : invokeLater(task);
    };
    var setAttr = function(node, attrName, val, sync) {
        var task = function() {
            return node instanceof Element && node.setAttribute(attrName, val);
        };
        sync ? task() : invokeLater(task);
    };
    var setHtml = function(node, html, sync) {
        var task = function() {
            return node.innerHTML = html;
        };
        sync ? task() : invokeLater(task);
    };
    var removeAttr = function(node, attrName, sync) {
        var task = function() {
            return node.removeAttribute(attrName);
        };
        sync ? task() : invokeLater(task);
    };
    var createElement = function(nodeType, attrs, sync) {
        var node = document.createElement(nodeType);
        if (attrs) {
            Object.keys(attrs).forEach(function(attrName) {
                setAttr(node, attrName, attrs[attrName], sync);
            });
        }
        return node;
    };
    var toDimension = function(v) {
        if (v == +v) {
            return v + "px";
        }
        return v;
    };
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function(resolve, reject) {
            function fulfilled(value) {
                try {
                    step(generator.next(value));
                } catch (e) {
                    reject(e);
                }
            }
            function rejected(value) {
                try {
                    step(generator["throw"](value));
                } catch (e) {
                    reject(e);
                }
            }
            function step(result) {
                result.done ? resolve(result.value) : new P(function(resolve) {
                    resolve(result.value);
                }).then(fulfilled, rejected);
            }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = {
            label: 0,
            sent: function() {
                if (t[0] & 1) throw t[1];
                return t[1];
            },
            trys: [],
            ops: []
        }, f, y, t, g;
        return g = {
            next: verb(0),
            throw: verb(1),
            return: verb(2)
        }, typeof Symbol === "function" && (g[Symbol.iterator] = function() {
            return this;
        }), g;
        function verb(n) {
            return function(v) {
                return step([ n, v ]);
            };
        }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 
                0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [ op[0] & 2, t.value ];
                switch (op[0]) {
                  case 0:
                  case 1:
                    t = op;
                    break;

                  case 4:
                    _.label++;
                    return {
                        value: op[1],
                        done: false
                    };

                  case 5:
                    _.label++;
                    y = op[1];
                    op = [ 0 ];
                    continue;

                  case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;

                  default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue;
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break;
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break;
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break;
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue;
                }
                op = body.call(thisArg, _);
            } catch (e) {
                op = [ 6, e ];
                y = 0;
            } finally {
                f = t = 0;
            }
            if (op[0] & 5) throw op[1];
            return {
                value: op[0] ? op[1] : void 0,
                done: true
            };
        }
    }
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m) return m.call(o);
        return {
            next: function() {
                if (o && i >= o.length) o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var properties = {};
    function getWmProjectProperties() {
        if (window._WM_APP_PROPERTIES) {
            return window._WM_APP_PROPERTIES;
        } else {
            return properties;
        }
    }
    function setWmProjectProperties(props) {
        Object.setPrototypeOf(properties, props);
    }
    function idGenerator(token) {
        var id;
        return __generator(this, function(_a) {
            switch (_a.label) {
              case 0:
                id = 1;
                _a.label = 1;

              case 1:
                return [ 4, "" + token + id++ ];

              case 2:
                _a.sent();
                return [ 3, 1 ];

              case 3:
                return [ 2 ];
            }
        });
    }
    var IDGenerator = function() {
        function IDGenerator(key) {
            this.generator = idGenerator(key);
        }
        IDGenerator.prototype.nextUid = function() {
            return this.generator.next().value;
        };
        return IDGenerator;
    }();
    var isString = function(v) {
        return typeof v === "string";
    };
    var isDef = function(v) {
        return v !== void 0;
    };
    var ifDef = function(v, d) {
        return v === void 0 ? d : v;
    };
    var \u02752 = ifDef;
    var plus = function(a, b) {
        return void 0 === a ? b : void 0 === b ? a : a + b;
    };
    var \u02753 = plus;
    var minus = function(a, b) {
        return ifDef(a, 0) - ifDef(b, 0);
    };
    var \u02754 = minus;
    var noop = function() {};
    var \u02755 = noop;
    var exprFnCache = new Map();
    var eventFnCache = new Map();
    var purePipes = new Map();
    var primitiveEquals = function(a, b) {
        if (typeof a === "object" || typeof b === "object") {
            return false;
        }
        if (a !== a && b !== b) {
            return true;
        }
        return a === b;
    };
    var \u02756 = primitiveEquals;
    var detectChanges = function(ov, nv) {
        var len = nv.length;
        var hasChange = len > 10;
        switch (len) {
          case 10:
            hasChange = !primitiveEquals(ov[9], nv[9]);
            if (hasChange) {
                break;
            }

          case 9:
            hasChange = !primitiveEquals(ov[8], nv[8]);
            if (hasChange) {
                break;
            }

          case 8:
            hasChange = !primitiveEquals(ov[7], nv[7]);
            if (hasChange) {
                break;
            }

          case 7:
            hasChange = !primitiveEquals(ov[6], nv[6]);
            if (hasChange) {
                break;
            }

          case 6:
            hasChange = !primitiveEquals(ov[5], nv[5]);
            if (hasChange) {
                break;
            }

          case 5:
            hasChange = !primitiveEquals(ov[4], nv[4]);
            if (hasChange) {
                break;
            }

          case 4:
            hasChange = !primitiveEquals(ov[3], nv[3]);
            if (hasChange) {
                break;
            }

          case 3:
            hasChange = !primitiveEquals(ov[2], nv[2]);
            if (hasChange) {
                break;
            }

          case 2:
            hasChange = !primitiveEquals(ov[1], nv[1]);
            if (hasChange) {
                break;
            }

          case 1:
            hasChange = !primitiveEquals(ov[0], nv[0]);
            if (hasChange) {
                break;
            }
        }
        return hasChange;
    };
    var \u02757 = detectChanges;
    var getPurePipeVal = function(pipe, cache, identifier) {
        var args = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            args[_i - 3] = arguments[_i];
        }
        var lastResult = cache.get(identifier);
        var result;
        if (lastResult) {
            var isModified = detectChanges(lastResult.args, args);
            if (!isModified) {
                return lastResult.result;
            }
        }
        result = pipe.transform.apply(pipe, __spread(args));
        lastResult = {
            args: args,
            result: result
        };
        cache.set(identifier, lastResult);
        return result;
    };
    var \u02758 = getPurePipeVal;
    var STR_ESCAPE_REGEX = /[^ a-zA-Z0-9]/g;
    var stringEscapeFn = function(str) {
        return "\\u" + ("0000" + str.charCodeAt(0).toString(16)).slice(-4);
    };
    var \u02759 = stringEscapeFn;
    var ASTCompiler = function() {
        function ASTCompiler(ast, exprType, pipeNameVsIsPureMap) {
            this.ast = ast;
            this.declarations = [];
            this.stmts = [];
            this.pipes = [];
            this.vIdx = 0;
            this.exprType = exprType;
            this.pipeNameVsIsPureMap = pipeNameVsIsPureMap;
        }
        ASTCompiler.prototype.createVar = function() {
            var v = "v" + this.vIdx++;
            this.declarations.push(v);
            return v;
        };
        ASTCompiler.prototype.processImplicitReceiver = function() {
            return "ctx";
        };
        ASTCompiler.prototype.processLiteralPrimitive = function() {
            var ast = this.cAst;
            return isString(ast.value) ? '"' + ast.value.replace(/"/g, '"').replace(STR_ESCAPE_REGEX, stringEscapeFn) + '"' : ast.value;
        };
        ASTCompiler.prototype.processLiteralArray = function() {
            var e_1, _a;
            var ast = this.cAst;
            var stmts = this.cStmts;
            var v = this.createVar();
            var s = [];
            try {
                for (var _b = __values(ast.expressions), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var item = _c.value;
                    s.push(this.build(item, stmts));
                }
            } catch (e_1_1) {
                e_1 = {
                    error: e_1_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_1) throw e_1.error;
                }
            }
            stmts.push(v + "=[" + s.join(",") + "]");
            return v;
        };
        ASTCompiler.prototype.processLiteralMap = function() {
            var e_2, _a;
            var ast = this.cAst;
            var stmts = this.cStmts;
            var v = this.createVar();
            var _values = [];
            try {
                for (var _b = __values(ast.values), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var _value = _c.value;
                    _values.push(this.build(_value, stmts));
                }
            } catch (e_2_1) {
                e_2 = {
                    error: e_2_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_2) throw e_2.error;
                }
            }
            stmts.push(v + "={" + ast.keys.map(function(k, i) {
                return "'" + k.key + "':" + _values[i];
            }) + "}");
            return v;
        };
        ASTCompiler.prototype.processPropertyRead = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var r = this.build(ast.receiver, stmts);
            var v = this.createVar();
            stmts.push(v + "=" + r + "&&" + r + "." + ast.name);
            return v;
        };
        ASTCompiler.prototype.processKeyedRead = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var k = this.build(ast.key, stmts);
            var o = this.build(ast.obj, stmts);
            var v = this.createVar();
            stmts.push(v + "=" + o + "&&" + o + "[" + k + "]");
            return v;
        };
        ASTCompiler.prototype.processPrefixNot = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var r = this.build(ast.expression, stmts);
            stmts.push(r + "=!" + r);
            return r;
        };
        ASTCompiler.prototype.handleBinaryPlus_Minus = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var l = this.build(ast.left, stmts);
            var r = this.build(ast.right, stmts);
            var v = this.createVar();
            var m = ast.operation === "+" ? "_plus" : "_minus";
            stmts.push(v + "=" + m + "(" + l + "," + r + ")");
            return v;
        };
        ASTCompiler.prototype.handleBinaryAND_OR = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var _s1 = [];
            var _sl = [];
            var _sr = [];
            var l = this.build(ast.left, _sl);
            var r = this.build(ast.right, _sr);
            var v = this.createVar();
            if (ast.operation === "&&") {
                _s1.push(_sl.join(";"), ";" + v + "=false", ";if(" + l + "){", _sr.join(";"), ";" + v + "=" + r + ";", "}");
            } else {
                _s1.push(_sl.join(";"), ";" + v + "=" + l, ";if(!" + l + "){", _sr.join(";"), ";" + v + "=" + r + ";", "}");
            }
            stmts.push(_s1.join(""));
            return v;
        };
        ASTCompiler.prototype.handleBinaryDefault = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var l = this.build(ast.left, stmts);
            var r = this.build(ast.right, stmts);
            var v = this.createVar();
            stmts.push(v + "=" + l + ast.operation + r);
            return v;
        };
        ASTCompiler.prototype.processBinary = function() {
            var ast = this.cAst;
            var op = ast.operation;
            if (op === "+" || op === "-") {
                return this.handleBinaryPlus_Minus();
            }
            if (op === "&&" || op === "||") {
                return this.handleBinaryAND_OR();
            }
            return this.handleBinaryDefault();
        };
        ASTCompiler.prototype.processConditional = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var condition = this.build(ast.condition, stmts);
            var v = this.createVar();
            var _s1 = [];
            var _s2 = [];
            var _s3 = [];
            var trueExp = this.build(ast.trueExp, _s2);
            var falseExp = this.build(ast.falseExp, _s3);
            _s1.push("if(" + condition + "){", _s2.join(";"), ";" + v + "=" + trueExp + ";", "}else{", _s3.join(";"), ";" + v + "=" + falseExp + ";", "}");
            stmts.push(_s1.join(" "));
            return v;
        };
        ASTCompiler.prototype.processMethodCall = function() {
            var e_3, _a;
            var ast = this.cAst;
            var stmts = this.cStmts;
            var _args = [];
            try {
                for (var _b = __values(ast.args), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var arg = _c.value;
                    _args.push(this.build(arg, stmts));
                }
            } catch (e_3_1) {
                e_3 = {
                    error: e_3_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_3) throw e_3.error;
                }
            }
            var fn = this.build(ast.receiver, stmts);
            var v = this.createVar();
            var isImplicitReceiver = ast.receiver instanceof compiler.ImplicitReceiver;
            stmts.push(v + "= " + fn + "&&" + fn + "." + ast.name + "&&" + fn + "." + ast.name + (isImplicitReceiver ? ".bind(_ctx)" : "") + "(" + _args.join(",") + ")");
            return v;
        };
        ASTCompiler.prototype.processChain = function() {
            var _this = this;
            var ast = this.cAst;
            return ast.expressions.map(function(e) {
                return _this.build(e);
            }).join(";");
        };
        ASTCompiler.prototype.processPropertyWrite = function() {
            var ast = this.cAst;
            var stmts = this.cStmts;
            var receiver, lhs;
            if (ast.receiver instanceof compiler.ImplicitReceiver) {
                lhs = "_ctx." + ast.name;
            } else {
                receiver = this.build(ast.receiver, stmts);
                lhs = "" + receiver + (receiver.length ? "." : "") + ast.name;
            }
            var rhs = this.build(ast.value, stmts);
            stmts.push(lhs + "=" + rhs);
        };
        ASTCompiler.prototype.processPipe = function() {
            var e_4, _a;
            var ast = this.cAst;
            var stmts = this.cStmts;
            var t = this.createVar();
            var _args = [];
            var _s1 = [];
            var _s2 = [];
            var exp = this.build(ast.exp, stmts);
            try {
                for (var _b = __values(ast.args), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var arg = _c.value;
                    _args.push(this.build(arg, _s2));
                }
            } catch (e_4_1) {
                e_4 = {
                    error: e_4_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_4) throw e_4.error;
                }
            }
            var p = "_p" + this.pipes.length;
            this.pipes.push([ ast.name, p ]);
            _args.unshift(exp);
            _s1.push(_s2.length ? _s2.join(";") + ";" : "", this.pipeNameVsIsPureMap.get(ast.name) ? t + "=getPPVal(" + p + ',_ppc,"' + p + '",' + _args + ")" : t + "=" + p + ".transform(" + _args + ")");
            stmts.push(_s1.join(""));
            return t;
        };
        ASTCompiler.prototype.build = function(ast, cStmts) {
            this.cAst = ast;
            this.cStmts = cStmts || this.stmts;
            if (ast instanceof compiler.ImplicitReceiver) {
                return this.processImplicitReceiver();
            } else if (ast instanceof compiler.LiteralPrimitive) {
                return this.processLiteralPrimitive();
            } else if (ast instanceof compiler.LiteralArray) {
                return this.processLiteralArray();
            } else if (ast instanceof compiler.LiteralMap) {
                return this.processLiteralMap();
            } else if (ast instanceof compiler.PropertyRead) {
                return this.processPropertyRead();
            } else if (ast instanceof compiler.PropertyWrite) {
                return this.processPropertyWrite();
            } else if (ast instanceof compiler.KeyedRead) {
                return this.processKeyedRead();
            } else if (ast instanceof compiler.PrefixNot) {
                return this.processPrefixNot();
            } else if (ast instanceof compiler.Binary) {
                return this.processBinary();
            } else if (ast instanceof compiler.Conditional) {
                return this.processConditional();
            } else if (ast instanceof compiler.MethodCall) {
                return this.processMethodCall();
            } else if (ast instanceof compiler.Chain) {
                return this.processChain();
            } else if (ast instanceof compiler.BindingPipe) {
                return this.processPipe();
            }
        };
        ASTCompiler.prototype.extendCtxWithLocals = function() {
            var v1 = this.createVar();
            this.stmts.push(v1 + "=Object.assign({}, locals)", "Object.setPrototypeOf(" + v1 + ", _ctx)", "ctx=" + v1);
        };
        ASTCompiler.prototype.fnBody = function() {
            this.declarations.push("ctx");
            return '"use strict";\nvar ' + this.declarations.join(",") + ";\n" + this.stmts.join(";");
        };
        ASTCompiler.prototype.fnArgs = function() {
            var e_5, _a;
            var args = [ "_plus", "_minus", "_isDef" ];
            if (this.exprType === ExpressionType.Binding) {
                args.push("getPPVal", "_ppc");
                try {
                    for (var _b = __values(this.pipes), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var _d = __read(_c.value, 2), pipeVar = _d[1];
                        args.push(pipeVar);
                    }
                } catch (e_5_1) {
                    e_5 = {
                        error: e_5_1
                    };
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    } finally {
                        if (e_5) throw e_5.error;
                    }
                }
            }
            args.push("_ctx", "locals");
            return args.join(",");
        };
        ASTCompiler.prototype.addReturnStmt = function(result) {
            this.stmts.push("return " + result + ";");
        };
        ASTCompiler.prototype.cleanup = function() {
            this.ast = this.cAst = this.stmts = this.cStmts = this.declarations = this.pipes = this.pipeNameVsIsPureMap = undefined;
        };
        ASTCompiler.prototype.compile = function() {
            this.extendCtxWithLocals();
            this.addReturnStmt(this.build(this.ast));
            var fn = new Function(this.fnArgs(), this.fnBody());
            var boundFn;
            if (this.exprType === ExpressionType.Binding) {
                boundFn = fn.bind(undefined, plus, minus, isDef, getPurePipeVal);
                boundFn.usedPipes = this.pipes.slice(0);
            } else {
                boundFn = fn.bind(undefined, plus, minus, isDef);
            }
            this.cleanup();
            return boundFn;
        };
        return ASTCompiler;
    }();
    var nullPipe = function() {
        return {
            transform: noop
        };
    };
    var \u027510 = nullPipe;
    var pipeProvider;
    function setPipeProvider(_pipeProvider) {
        pipeProvider = _pipeProvider;
    }
    var ExpressionType;
    (function(ExpressionType) {
        ExpressionType[ExpressionType["Binding"] = 0] = "Binding";
        ExpressionType[ExpressionType["Action"] = 1] = "Action";
    })(ExpressionType || (ExpressionType = {}));
    function $parseExpr(expr) {
        var e_6, _a;
        if (!pipeProvider) {
            console.log("set pipe provider");
            return noop;
        }
        if (!isString(expr)) {
            return noop;
        }
        expr = expr.trim();
        if (expr.endsWith(";")) {
            expr = expr.slice(0, -1);
        }
        if (!expr.length) {
            return noop;
        }
        var fn = exprFnCache.get(expr);
        if (fn) {
            return fn;
        }
        var parser = new compiler.Parser(new compiler.Lexer());
        var ast = parser.parseBinding(expr, "");
        var boundFn;
        if (ast.errors.length) {
            fn = noop;
            boundFn = fn;
        } else {
            var pipeNameVsIsPureMap = pipeProvider.getPipeNameVsIsPureMap();
            var astCompiler = new ASTCompiler(ast.ast, ExpressionType.Binding, pipeNameVsIsPureMap);
            fn = astCompiler.compile();
            if (fn.usedPipes.length) {
                var pipeArgs = [];
                var hasPurePipe = false;
                try {
                    for (var _b = __values(fn.usedPipes), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var _d = __read(_c.value, 1), pipeName = _d[0];
                        var pipeInfo = pipeProvider.meta(pipeName);
                        var pipeInstance = void 0;
                        if (!pipeInfo) {
                            pipeInstance = nullPipe;
                        } else {
                            if (pipeInfo.pure) {
                                hasPurePipe = true;
                                pipeInstance = purePipes.get(pipeName);
                            }
                            if (!pipeInstance) {
                                pipeInstance = pipeProvider.getInstance(pipeName);
                            }
                            if (pipeInfo.pure) {
                                purePipes.set(pipeName, pipeInstance);
                            }
                        }
                        pipeArgs.push(pipeInstance);
                    }
                } catch (e_6_1) {
                    e_6 = {
                        error: e_6_1
                    };
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    } finally {
                        if (e_6) throw e_6.error;
                    }
                }
                pipeArgs.unshift(hasPurePipe ? new Map() : undefined);
                boundFn = fn.bind.apply(fn, __spread([ undefined ], pipeArgs));
            } else {
                boundFn = fn.bind(undefined, undefined);
            }
        }
        exprFnCache.set(expr, boundFn);
        return boundFn;
    }
    function $parseEvent(expr) {
        if (!isString(expr)) {
            return noop;
        }
        expr = expr.trim();
        if (!expr.length) {
            return noop;
        }
        var fn = eventFnCache.get(expr);
        if (fn) {
            return fn;
        }
        var parser = new compiler.Parser(new compiler.Lexer());
        var ast = parser.parseAction(expr, "");
        if (ast.errors.length) {
            return noop;
        }
        var astCompiler = new ASTCompiler(ast.ast, ExpressionType.Action);
        fn = astCompiler.compile();
        eventFnCache.set(expr, fn);
        return fn;
    }
    var registry = new Map();
    var watchIdGenerator = new IDGenerator("watch-id-");
    var FIRST_TIME_WATCH = {};
    Object.freeze(FIRST_TIME_WATCH);
    var isFirstTimeChange = function(v) {
        return v === FIRST_TIME_WATCH;
    };
    var muted = false;
    var appRef;
    var debounce = function(fn, wait) {
        if (wait === void 0) {
            wait = 50;
        }
        var timeout;
        return function() {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            window["__zone_symbol__clearTimeout"](timeout);
            timeout = window["__zone_symbol__setTimeout"](function() {
                return fn.apply(void 0, __spread(args));
            }, wait);
        };
    };
    var muteWatchers = function() {
        muted = true;
    };
    var unMuteWatchers = function() {
        muted = false;
        triggerWatchers();
    };
    var $watch = function(expr, $scope, $locals, listener, identifier, doNotClone) {
        if (identifier === void 0) {
            identifier = watchIdGenerator.nextUid();
        }
        if (doNotClone === void 0) {
            doNotClone = false;
        }
        if (expr.indexOf("[$i]") !== -1) {
            expr = expr.replace(/\[\$i]/g, "[0]");
        }
        var fn = $parseExpr(expr);
        registry.set(identifier, {
            fn: fn.bind(expr, $scope, $locals),
            listener: listener,
            expr: expr,
            last: FIRST_TIME_WATCH,
            doNotClone: doNotClone
        });
        return function() {
            return $unwatch(identifier);
        };
    };
    var $unwatch = function(identifier) {
        return registry.delete(identifier);
    };
    var changedByWatch = false;
    var $RAF$1 = window.requestAnimationFrame;
    var ngZone;
    var triggerWatchers = function(ignoreMuted) {
        if (muted && !ignoreMuted) {
            return;
        }
        var limit = 5;
        var pass = 1;
        var changeDetected;
        do {
            changeDetected = false;
            registry.forEach(function(watchInfo) {
                var fn = watchInfo.fn;
                var listener = watchInfo.listener;
                var ov = watchInfo.last;
                var nv;
                try {
                    nv = fn();
                } catch (e) {
                    console.warn("error in executing expression: '" + watchInfo.expr + "'");
                }
                if (!_.isEqual(nv, ov)) {
                    changeDetected = true;
                    changedByWatch = true;
                    watchInfo.last = nv;
                    if (_.isObject(nv) && !watchInfo.doNotClone && nv.__cloneable__ !== false) {
                        watchInfo.last = _.clone(nv);
                    }
                    listener(nv, ov);
                    resetChangeFromWatch();
                }
            });
            pass++;
        } while (changeDetected && pass < limit);
        if (changeDetected && pass === limit) {
            console.warn("Number of watch cycles gone above set limit of: " + limit + " ");
        }
    };
    var setNgZone = function(zone) {
        return ngZone = zone;
    };
    var setAppRef = function(ref) {
        appRef = ref;
    };
    var isChangeFromWatch = function() {
        return changedByWatch;
    };
    var resetChangeFromWatch = function() {
        return changedByWatch = false;
    };
    window.watchRegistry = registry;
    var skipWatchers;
    var \u02751$2 = function() {
        skipWatchers = true;
        ngZone.run(function() {
            return triggerWatchers();
        });
    };
    var debouncedTriggerWatchers = debounce(\u02751$2, 100);
    var $invokeWatchers = function(force, ignoreMuted) {
        if (force) {
            triggerWatchers(ignoreMuted);
        } else {
            if (skipWatchers) {
                skipWatchers = false;
                return;
            }
            debouncedTriggerWatchers();
        }
    };
    var $appDigest = function() {
        var queued = false;
        return function(force) {
            if (!appRef) {
                return;
            }
            if (force) {
                ngZone.run(function() {
                    return appRef.tick();
                });
                queued = false;
            } else {
                if (queued) {
                    return;
                } else {
                    queued = true;
                    $RAF$1(function() {
                        ngZone.run(function() {
                            return appRef.tick();
                        });
                        queued = false;
                    });
                }
            }
        };
    }();
    var IDataSource = function() {
        function IDataSource() {}
        return IDataSource;
    }();
    var Operation;
    (function(Operation) {
        Operation["LIST_RECORDS"] = "listRecords";
        Operation["UPDATE_RECORD"] = "updateRecord";
        Operation["INSERT_RECORD"] = "insertRecord";
        Operation["DELETE_RECORD"] = "deleteRecord";
        Operation["INVOKE"] = "invoke";
        Operation["UPDATE"] = "update";
        Operation["NOTIFY"] = "notify";
        Operation["IS_API_AWARE"] = "isApiAware";
        Operation["SUPPORTS_CRUD"] = "supportsCRUD";
        Operation["SUPPORTS_DISTINCT_API"] = "supportsDistinctAPI";
        Operation["IS_PAGEABLE"] = "isPageable";
        Operation["GET_OPERATION_TYPE"] = "getOperationType";
        Operation["GET_RELATED_PRIMARY_KEYS"] = "getRelatedTablePrimaryKeys";
        Operation["GET_ENTITY_NAME"] = "getEntityName";
        Operation["SET_INPUT"] = "setinput";
        Operation["GET_RELATED_TABLE_DATA"] = "getRelatedTableData";
        Operation["GET_DISTINCT_DATA_BY_FIELDS"] = "getDistinctDataByFields";
        Operation["GET_AGGREGATED_DATA"] = "getAggregatedData";
        Operation["GET_MATCH_MODE"] = "getMatchMode";
        Operation["DOWNLOAD"] = "download";
        Operation["GET_NAME"] = "getName";
        Operation["GET_PROPERTIES_MAP"] = "getPropertiesMap";
        Operation["GET_PRIMARY_KEY"] = "getPrimaryKey";
        Operation["GET_BLOB_URL"] = "getBlobURL";
        Operation["SUPPORTS_SERVER_FILTER"] = "supportsServerFilter";
        Operation["GET_OPTIONS"] = "getOptions";
        Operation["SEARCH_RECORDS"] = "searchRecords";
        Operation["GET_REQUEST_PARAMS"] = "getRequestParams";
        Operation["GET_PAGING_OPTIONS"] = "getPagingOptions";
        Operation["FETCH_DISTINCT_VALUES"] = "fetchDistinctValues";
        Operation["GET_UNIQUE_IDENTIFIER"] = "getUniqueIdentifier";
        Operation["GET_CONTEXT_IDENTIFIER"] = "getContextIdentifier";
        Operation["IS_UPDATE_REQUIRED"] = "isUpdateRequired";
        Operation["ADD_ITEM"] = "addItem";
        Operation["SET_ITEM"] = "setItem";
        Operation["REMOVE_ITEM"] = "removeItem";
        Operation["IS_BOUND_TO_LOCALE"] = "isBoundToLocale";
        Operation["GET_DEFAULT_LOCALE"] = "getDefaultLocale";
        Operation["CANCEL"] = "cancel";
    })(Operation || (Operation = {}));
    var DataSource = {
        Operation: Operation
    };
    var App = function() {
        function App() {}
        return App;
    }();
    var AbstractDialogService = function() {
        function AbstractDialogService() {}
        return AbstractDialogService;
    }();
    var AbstractHttpService = function() {
        function AbstractHttpService() {}
        return AbstractHttpService;
    }();
    var AbstractI18nService = function() {
        function AbstractI18nService() {}
        return AbstractI18nService;
    }();
    var AbstractToasterService = function() {
        function AbstractToasterService() {}
        return AbstractToasterService;
    }();
    var AbstractSpinnerService = function() {
        function AbstractSpinnerService() {}
        return AbstractSpinnerService;
    }();
    var UserDefinedExecutionContext = function() {
        function UserDefinedExecutionContext() {}
        return UserDefinedExecutionContext;
    }();
    var AbstractNavigationService = function() {
        function AbstractNavigationService() {}
        return AbstractNavigationService;
    }();
    var AppDefaults = function() {
        function AppDefaults() {}
        return AppDefaults;
    }();
    var DynamicComponentRefProvider = function() {
        function DynamicComponentRefProvider() {}
        return DynamicComponentRefProvider;
    }();
    var _this = this;
    var userAgent = window.navigator.userAgent;
    var REGEX = {
        SNAKE_CASE: /[A-Z]/g,
        ANDROID: /Android/i,
        IPHONE: /iPhone/i,
        IPOD: /iPod/i,
        IPAD: /iPad/i,
        ANDROID_TABLET: /android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i,
        MOBILE: /Mobile/i,
        WINDOWS: /Windows Phone/i,
        SUPPORTED_IMAGE_FORMAT: /\.(bmp|gif|jpe|jpg|jpeg|tif|tiff|pbm|png|ico)$/i,
        SUPPORTED_FILE_FORMAT: /\.(txt|js|css|html|script|properties|json|java|xml|smd|xmi|sql|log|wsdl|vm|ftl|jrxml|yml|yaml|md|less|jsp)$/i,
        SUPPORTED_AUDIO_FORMAT: /\.(mp3|ogg|webm|wma|3gp|wav|m4a)$/i,
        SUPPORTED_VIDEO_FORMAT: /\.(mp4|ogg|webm|wmv|mpeg|mpg|avi)$/i,
        PAGE_RESOURCE_PATH: /^\/pages\/.*\.(js|css|html|json)$/,
        MIN_PAGE_RESOURCE_PATH: /.*(page.min.html)$/,
        VALID_EMAIL: /^[a-zA-Z][\w.+]+@[a-zA-Z_]+?\.[a-zA-Z.]{1,4}[a-zA-Z]$/,
        VALID_WEB_URL: /^(http[s]?:\/\/)(www\.){0,1}[a-zA-Z0-9=:?\/\.\-]+(\.[a-zA-Z]{2,5}[\.]{0,1})?/,
        VALID_WEBSOCKET_URL: /^(ws[s]?:\/\/)(www\.){0,1}[a-zA-Z0-9=:?\/\.\-]+(\.[a-zA-Z]{2,5}[\.]{0,1})?/,
        VALID_RELATIVE_URL: /^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/).*/,
        REPLACE_PATTERN: /\$\{([^\}]+)\}/g,
        ZIP_FILE: /\.zip$/i,
        EXE_FILE: /\.exe$/i,
        NO_QUOTES_ALLOWED: /^[^'|"]*$/,
        NO_DOUBLE_QUOTES_ALLOWED: /^[^"]*$/,
        VALID_HTML: /<[a-z][\s\S]*>/i,
        VALID_PASSWORD: /^[0-9a-zA-Z-_.@&*!#$%]+$/,
        SPECIAL_CHARACTERS: /[^A-Z0-9a-z_]+/i,
        APP_SERVER_URL_FORMAT: /^(http[s]?:\/\/)(www\.){0,1}[a-zA-Z0-9\.\-]+([:]?[0-9]{2,5}|\.[a-zA-Z]{2,5}[\.]{0,1})\/+[^?#&=]+$/,
        JSON_DATE_FORMAT: /\d{4}-[0-1]\d-[0-3]\d(T[0-2]\d:[0-5]\d:[0-5]\d.\d{1,3}Z$)?/
    }, compareBySeparator = ":";
    var NUMBER_TYPES = [ "int", exports.DataType.INTEGER, exports.DataType.FLOAT, exports.DataType.DOUBLE, exports.DataType.LONG, exports.DataType.SHORT, exports.DataType.BYTE, exports.DataType.BIG_INTEGER, exports.DataType.BIG_DECIMAL ];
    var now = new Date();
    var CURRENT_DATE = "CURRENT_DATE";
    var isDefined = function(v) {
        return "undefined" !== typeof v;
    };
    var isObject = function(v) {
        return null !== v && "object" === typeof v;
    };
    var toBoolean = function(val, identity) {
        return val && val !== "false" ? true : identity ? val === identity : false;
    };
    function isIE11() {
        return window.navigator.appVersion.indexOf("Trident/") > -1;
    }
    var isIE = function() {
        return isIE11() || window.navigator.userAgent.indexOf("MSIE") > -1;
    };
    var isAndroid = function() {
        return REGEX.ANDROID.test(userAgent);
    };
    var isAndroidTablet = function() {
        return REGEX.ANDROID_TABLET.test(userAgent);
    };
    var isIphone = function() {
        return REGEX.IPHONE.test(userAgent);
    };
    var isIpod = function() {
        return REGEX.IPOD.test(userAgent);
    };
    var isIpad = function() {
        return REGEX.IPAD.test(userAgent);
    };
    var isIos = function() {
        return isIphone() || isIpod() || isIpad();
    };
    var isMobile = function() {
        return isAndroid() || isIos() || isAndroidTablet() || $("#wm-mobile-display:visible").length > 0;
    };
    var isMobileApp = function() {
        return getWmProjectProperties().platformType === "MOBILE" && getWmProjectProperties().type === "APPLICATION";
    };
    var getAndroidVersion = function() {
        var match = window.navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);
        return match ? match[1] : "";
    };
    var isKitkatDevice = function() {
        return isAndroid() && parseInt(getAndroidVersion(), 10) === 4;
    };
    var encodeUrl = function(url) {
        var index = url.indexOf("?");
        if (index > -1) {
            url = encodeURI(url.substring(0, index)) + url.substring(index);
            url = encodeUrlParams(url);
        } else {
            url = encodeURI(url);
        }
        return url;
    };
    var encodeUrlParams = function(url) {
        var queryParams, encodedParams = "", queryParamsString, index;
        index = url.indexOf("?");
        if (index > -1) {
            index += 1;
            queryParamsString = url.substring(index);
            if (queryParamsString) {
                queryParams = queryParamsString.split("&");
                queryParams.forEach(function(param) {
                    var decodedParamValue;
                    var i = _.includes(param, "=") ? param.indexOf("=") : param && param.length, paramName = param.substr(0, i), paramValue = param.substr(i + 1);
                    if (paramValue || _.includes(param, "=")) {
                        try {
                            decodedParamValue = decodeURIComponent(paramValue);
                        } catch (e) {
                            decodedParamValue = paramValue;
                        }
                        encodedParams += paramName + "=" + encodeURIComponent(decodedParamValue) + "&";
                    } else {
                        encodedParams += paramName + "&";
                    }
                });
                encodedParams = encodedParams.slice(0, -1);
                url = url.replace(queryParamsString, encodedParams);
            }
        }
        return url;
    };
    var initCaps = function(name) {
        if (!name) {
            return "";
        }
        return name.charAt(0).toUpperCase() + name.substring(1);
    };
    var spaceSeparate = function(name) {
        if (name === name.toUpperCase()) {
            return name;
        }
        return name.replace(REGEX.SNAKE_CASE, function(letter, pos) {
            return (pos ? " " : "") + letter;
        });
    };
    var replaceAt = function(string, index, character) {
        return string.substr(0, index) + character + string.substr(index + character.length);
    };
    var periodSeparate = function(name) {
        var dotIndex;
        dotIndex = name.indexOf(".");
        if (dotIndex !== -1) {
            name = replaceAt(name, dotIndex + 1, name.charAt(dotIndex + 1).toUpperCase());
            name = replaceAt(name, dotIndex, " ");
        }
        return name;
    };
    var prettifyLabel = function(label) {
        label = _.camelCase(label);
        label = initCaps(label);
        label = spaceSeparate(label);
        label = periodSeparate(label);
        return label;
    };
    var deHyphenate = function(name) {
        return name.split("-").join(" ");
    };
    var prettifyLabels = function(names, separator) {
        if (separator === void 0) {
            separator = ",";
        }
        var modifiedNames, namesArray = [];
        if (!_.isArray(names)) {
            namesArray = _.split(names, separator);
        }
        modifiedNames = _.map(namesArray, prettifyLabel);
        if (_.isArray(names)) {
            return modifiedNames;
        }
        return modifiedNames.join(separator);
    };
    var isInsecureContentRequest = function(url) {
        var parser = document.createElement("a");
        parser.href = url;
        if (parser.protocol === "") {
            return false;
        }
        if (stringStartsWith(location.href, "https://")) {
            return parser.protocol !== "https:" && parser.protocol !== "wss:";
        }
        return false;
    };
    var stringStartsWith = function(str, startsWith, ignoreCase) {
        if (!str) {
            return false;
        }
        var regEx = new RegExp("^" + startsWith, ignoreCase ? "i" : "");
        return regEx.test(str);
    };
    var getEvaluatedExprValue = function(object, expression) {
        var val;
        val = _.attempt(function() {
            var argsExpr = Object.keys(object).map(function(fieldName) {
                return "var " + fieldName + " = data['" + fieldName + "'];";
            }).join(" ");
            var f = new Function("data", argsExpr + " return  " + expression);
            return f(object);
        });
        if (_.isError(val)) {
            val = _.get(object, expression);
        }
        return val;
    };
    var isImageFile = function(fileName) {
        return REGEX.SUPPORTED_IMAGE_FORMAT.test(fileName);
    };
    var isAudioFile = function(fileName) {
        return REGEX.SUPPORTED_AUDIO_FORMAT.test(fileName);
    };
    var isVideoFile = function(fileName) {
        return REGEX.SUPPORTED_VIDEO_FORMAT.test(fileName);
    };
    var isValidWebURL = function(url) {
        return REGEX.VALID_WEB_URL.test(url);
    };
    var getResourceURL = function(urlString) {
        if (isValidWebURL(urlString)) ;
        return urlString;
    };
    function triggerFn(fn) {
        var argmnts = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            argmnts[_i - 1] = arguments[_i];
        }
        var start = 1;
        var len = arguments.length, args = new Array(len - start);
        for (start; start < len; start++) {
            args[start - 1] = arguments[start];
        }
        if (_.isFunction(fn)) {
            return fn.apply(null, args);
        }
    }
    var getFormattedDate = function(datePipe, dateObj, format) {
        if (!dateObj) {
            return undefined;
        }
        if (format === "timestamp") {
            return moment(dateObj).valueOf();
        }
        return datePipe.transform(dateObj, format);
    };
    var getDateObj = function(value) {
        if (_.isDate(value)) {
            return value;
        }
        if (!isNaN(value)) {
            value = parseInt(value, 10);
        }
        if (!moment(value).isValid() || value === "" || value === null || value === undefined) {
            return undefined;
        }
        var dateObj = new Date(value);
        if (_.isString(value)) {
            dateObj = new Date(moment(value).format());
        }
        if (value === CURRENT_DATE || isNaN(dateObj.getDay())) {
            return now;
        }
        return dateObj;
    };
    var addEventListenerOnElement = function(_element, excludeElement, nativeElement, eventType, isDropDownDisplayEnabledOnInput, successCB, life, isCapture) {
        if (isCapture === void 0) {
            isCapture = false;
        }
        var element = _element;
        var eventListener = function(event) {
            if (excludeElement && (excludeElement.contains(event.target) || excludeElement === event.target)) {
                return;
            }
            if (nativeElement.contains(event.target)) {
                if ($(event.target).is("input") && !isDropDownDisplayEnabledOnInput) {
                    return;
                }
                element.removeEventListener(eventType, eventListener, isCapture);
                return;
            }
            if (life === 0) {
                element.removeEventListener(eventType, eventListener, isCapture);
            }
            successCB();
        };
        element.addEventListener(eventType, eventListener, isCapture);
        var removeEventListener = function() {
            element.removeEventListener(eventType, eventListener, isCapture);
        };
        return removeEventListener;
    };
    var getClonedObject = function(object) {
        return _.cloneDeep(object);
    };
    var getFiles = function(formName, fieldName, isList) {
        var files = _.get(document.forms, [ formName, fieldName, "files" ]);
        return isList ? _.map(files, _.identity) : files && files[0];
    };
    function random() {
        return Math.floor((1 + Math.random()) * 65536).toString(16).substring(1);
    }
    var generateGUId = function() {
        return random() + "-" + random() + "-" + random();
    };
    var validateAccessRoles = function(roleExp, loggedInUser) {
        var roles;
        if (roleExp && loggedInUser) {
            roles = roleExp && roleExp.split(",").map(Function.prototype.call, String.prototype.trim);
            return _.intersection(roles, loggedInUser.userRoles).length;
        }
        return true;
    };
    var getValidJSON = function(content) {
        if (!content) {
            return undefined;
        }
        try {
            var parsedIntValue = parseInt(content, 10);
            return isObject(content) || !isNaN(parsedIntValue) ? content : JSON.parse(content);
        } catch (e) {
            return undefined;
        }
    };
    var xmlToJson = function(xmlString) {
        var x2jsObj = new X2JS({
            emptyNodeForm: "content",
            attributePrefix: "",
            enableToStringFunc: false
        });
        var json = x2jsObj.xml2js(xmlString);
        if (json) {
            json = _.get(json, Object.keys(json)[0]);
        }
        return json;
    };
    var findValueOf = function(obj, key, create) {
        if (!obj || !key) {
            return;
        }
        if (!create) {
            return _.get(obj, key);
        }
        var parts = key.split("."), keys = [];
        var skipProcessing;
        parts.forEach(function(part) {
            if (!parts.length) {
                skipProcessing = true;
                return false;
            }
            var subParts = part.match(/\w+/g);
            var subPart;
            while (subParts.length) {
                subPart = subParts.shift();
                keys.push({
                    key: subPart,
                    value: subParts.length ? [] : {}
                });
            }
        });
        if (skipProcessing) {
            return undefined;
        }
        keys.forEach(function(_key) {
            var tempObj = obj[_key.key];
            if (!isObject(tempObj)) {
                tempObj = getValidJSON(tempObj);
                if (!tempObj) {
                    tempObj = _key.value;
                }
            }
            obj[_key.key] = tempObj;
            obj = tempObj;
        });
        return obj;
    };
    var extractType = function(typeRef) {
        var type;
        if (!typeRef) {
            return exports.DataType.STRING;
        }
        type = typeRef && typeRef.substring(typeRef.lastIndexOf(".") + 1);
        type = type && type.toLowerCase();
        type = type === exports.DataType.LOCALDATETIME ? exports.DataType.DATETIME : type;
        return type;
    };
    var isNumberType = function(type) {
        return NUMBER_TYPES.indexOf(extractType(type).toLowerCase()) !== -1;
    };
    var isEmptyObject = function(obj) {
        if (isObject(obj) && !_.isArray(obj)) {
            return Object.keys(obj).length === 0;
        }
        return false;
    };
    var isPageable = function(obj) {
        var pageable = {
            content: [],
            first: true,
            last: true,
            number: 0,
            numberOfElements: 10,
            size: 20,
            sort: null,
            totalElements: 10,
            totalPages: 1
        };
        return _.isEqual(_.keys(pageable), _.keys(obj).sort());
    };
    var replace = function(template, map, parseError) {
        var regEx = REGEX.REPLACE_PATTERN;
        if (!template) {
            return;
        }
        if (parseError) {
            regEx = /\{([^\}]+)\}/g;
        }
        return template.replace(regEx, function(match, key) {
            return _.get(map, key);
        });
    };
    var isDateTimeType = function(type) {
        if (_.includes(type, ".")) {
            type = _.toLower(extractType(type));
        }
        return _.includes([ exports.DataType.DATE, exports.DataType.TIME, exports.DataType.TIMESTAMP, exports.DataType.DATETIME, exports.DataType.LOCALDATETIME ], type);
    };
    var getValidDateObject = function(val) {
        if (moment(val).isValid()) {
            if (isIos()) {
                val = moment(moment(val).valueOf()).format("YYYY/MM/DD HH:mm:ss");
            }
            return val;
        }
        if (!isNaN(val)) {
            val = parseInt(val, 10);
        } else {
            if (!new Date(val).getTime()) {
                val = moment(moment().format("YYYY-MM-DD") + " " + val, "YYYY-MM-DD HH:mm:ss A");
            }
        }
        return new Date(moment(val).valueOf());
    };
    var getNativeDateObject = function(val) {
        val = getValidDateObject(val);
        return new Date(val);
    };
    var getBlob = function(val, valContentType) {
        if (val instanceof Blob) {
            return val;
        }
        var jsonVal = getValidJSON(val);
        if (jsonVal && jsonVal instanceof Object) {
            val = new Blob([ JSON.stringify(jsonVal) ], {
                type: valContentType || "application/json"
            });
        } else {
            val = new Blob([ val ], {
                type: valContentType || "text/plain"
            });
        }
        return val;
    };
    var isEqualWithFields = function(obj1, obj2, compareBy) {
        var _compareBy = _.isArray(compareBy) ? compareBy : _.split(compareBy, ",");
        _compareBy = _.map(_compareBy, _.trim);
        return _.isEqualWith(obj1, obj2, function(o1, o2) {
            return _.every(_compareBy, function(cb) {
                var cb1, cb2, _cb;
                if (_.indexOf(cb, compareBySeparator) === -1) {
                    cb1 = cb2 = _.trim(cb);
                } else {
                    _cb = _.split(cb, compareBySeparator);
                    cb1 = _.trim(_cb[0]);
                    cb2 = _.trim(_cb[1]);
                }
                return _.get(o1, cb1) === _.get(o2, cb2);
            });
        });
    };
    var getNode = function(selector) {
        return document.querySelector(selector);
    };
    var \u02750$4 = getNode;
    var isStyleSheetLoaded = function(href) {
        return !!getNode('link[href="' + href + '"]');
    };
    var \u02751$3 = isStyleSheetLoaded;
    var removeStyleSheet = function(href) {
        var node = getNode('link[href="' + href + '"]');
        if (node) {
            node.remove();
        }
    };
    var \u02752$1 = removeStyleSheet;
    var loadStyleSheet = function(url, attr) {
        if (isStyleSheetLoaded(url)) {
            return;
        }
        var link = document.createElement("link");
        link.href = url;
        if (attr && attr.name) {
            link.setAttribute(attr.name, attr.value);
        }
        link.setAttribute("rel", "stylesheet");
        link.setAttribute("type", "text/css");
        document.head.appendChild(link);
        return link;
    };
    var loadStyleSheets = function(urls) {
        if (urls === void 0) {
            urls = [];
        }
        if (!Array.isArray(urls)) {
            urls = [ urls ];
        }
        urls.forEach(loadStyleSheet);
    };
    var isScriptLoaded = function(src) {
        return !!getNode('script[src="' + src + '"], script[data-src="' + src + '"]');
    };
    var \u02753$1 = isScriptLoaded;
    var loadScript = function(url) {
        return __awaiter(_this, void 0, void 0, function() {
            var _url;
            return __generator(this, function(_a) {
                _url = url.trim();
                if (!_url.length || isScriptLoaded(_url)) {
                    return [ 2, Promise.resolve() ];
                }
                return [ 2, fetchContent("text", _url, false, function(text) {
                    var script = document.createElement("script");
                    script.textContent = text;
                    document.head.appendChild(script);
                }) ];
            });
        });
    };
    var loadScripts = function(urls) {
        if (urls === void 0) {
            urls = [];
        }
        return __awaiter(_this, void 0, void 0, function() {
            var e_1, _a, urls_1, urls_1_1, url, e_1_1;
            return __generator(this, function(_b) {
                switch (_b.label) {
                  case 0:
                    _b.trys.push([ 0, 5, 6, 7 ]);
                    urls_1 = __values(urls), urls_1_1 = urls_1.next();
                    _b.label = 1;

                  case 1:
                    if (!!urls_1_1.done) return [ 3, 4 ];
                    url = urls_1_1.value;
                    return [ 4, loadScript(url) ];

                  case 2:
                    _b.sent();
                    _b.label = 3;

                  case 3:
                    urls_1_1 = urls_1.next();
                    return [ 3, 1 ];

                  case 4:
                    return [ 3, 7 ];

                  case 5:
                    e_1_1 = _b.sent();
                    e_1 = {
                        error: e_1_1
                    };
                    return [ 3, 7 ];

                  case 6:
                    try {
                        if (urls_1_1 && !urls_1_1.done && (_a = urls_1.return)) _a.call(urls_1);
                    } finally {
                        if (e_1) throw e_1.error;
                    }
                    return [ 7 ];

                  case 7:
                    return [ 2, Promise.resolve() ];
                }
            });
        });
    };
    var _WM_APP_PROJECT = {};
    var setSessionStorageItem = function(key, value) {
        var item = window.sessionStorage.getItem(_WM_APP_PROJECT.id);
        if (item) {
            item = JSON.parse(item);
        } else {
            item = {};
        }
        item[key] = value;
        window.sessionStorage.setItem(_WM_APP_PROJECT.id, JSON.stringify(item));
    };
    var getSessionStorageItem = function(key) {
        var item = window.sessionStorage.getItem(_WM_APP_PROJECT.id);
        if (item) {
            item = JSON.parse(item);
            return item[key];
        }
    };
    var noop$1 = function() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
    };
    var isArray = function(v) {
        return _.isArray(v);
    };
    var isString$1 = function(v) {
        return typeof v === "string";
    };
    var isNumber = function(v) {
        return typeof v === "number";
    };
    var convertToBlob = function(filepath) {
        return new Promise(function(resolve, reject) {
            resolveLocalFileSystemURL(filepath, function(fileEntry) {
                fileEntry.file(function(file) {
                    var reader = new FileReader();
                    reader.onloadend = function() {
                        var imgBlob = new Blob([ reader.result ], {
                            type: file.type
                        });
                        resolve({
                            blob: imgBlob,
                            filepath: filepath
                        });
                    };
                    reader.onerror = reject;
                    reader.readAsArrayBuffer(file);
                });
            }, reject);
        });
    };
    var hasCordova = function() {
        return !!window["cordova"];
    };
    var isSpotcues = /Spotcues/i.test(window["navigator"].userAgent);
    var AppConstants = {
        INT_MAX_VALUE: 2147483647
    };
    var openLink = function(link, target) {
        if (target === void 0) {
            target = "_self";
        }
        if (hasCordova() && _.startsWith(link, "#")) {
            location.hash = link;
        } else {
            window.open(link, target);
        }
    };
    var fetchContent = function(dataType, url, inSync, success, error) {
        if (inSync === void 0) {
            inSync = false;
        }
        return $.ajax({
            type: "get",
            dataType: dataType,
            url: url,
            async: !inSync
        }).done(function(response) {
            return success && success(response);
        }).fail(function(reason) {
            return error && error(reason);
        });
    };
    var toPromise = function(a) {
        if (a instanceof Promise) {
            return a;
        } else {
            return Promise.resolve(a);
        }
    };
    var retryIfFails = function(fn, interval, maxRetries, onBeforeRetry) {
        if (onBeforeRetry === void 0) {
            onBeforeRetry = function() {
                return Promise.resolve(false);
            };
        }
        var retryCount = 0;
        var tryFn = function() {
            retryCount++;
            if (_.isFunction(fn)) {
                return fn();
            }
        };
        maxRetries = _.isNumber(maxRetries) && maxRetries > 0 ? maxRetries : 0;
        interval = _.isNumber(interval) && interval > 0 ? interval : 0;
        return new Promise(function(resolve, reject) {
            var errorFn = function() {
                var errArgs = arguments;
                setTimeout(function() {
                    toPromise(onBeforeRetry()).then(function(retry) {
                        if (retry !== false && (!maxRetries || retryCount <= maxRetries)) {
                            toPromise(tryFn()).then(resolve, errorFn);
                        } else {
                            reject(errArgs);
                        }
                    }, function() {
                        return reject(errArgs);
                    });
                }, interval);
            };
            toPromise(tryFn()).then(resolve, errorFn);
        });
    };
    var getAbortableDefer = function() {
        var _defer = {
            promise: null,
            reject: null,
            resolve: null,
            onAbort: function() {},
            isAborted: false
        };
        _defer.promise = new Promise(function(resolve, reject) {
            _defer.resolve = resolve;
            _defer.reject = reject;
        });
        _defer.promise.abort = function() {
            triggerFn(_defer.onAbort);
            _defer.reject("aborted");
            _defer.isAborted = true;
        };
        return _defer;
    };
    var createCSSRule = function(ruleSelector, rules) {
        var stylesheet = document.styleSheets[0];
        stylesheet.insertRule(ruleSelector + " { " + rules + " }");
    };
    var getUrlParams = function(link) {
        var params = {};
        var index = link.indexOf("?");
        if (index !== -1) {
            var queryParams = _.split(link.substring(index + 1, link.length), "&");
            queryParams.forEach(function(param) {
                param = _.split(param, "=");
                params[param[0]] = param[1];
            });
        }
        return params;
    };
    var getRouteNameFromLink = function(link) {
        link = link.replace("#/", "/");
        var index = link.indexOf("?");
        if (index !== -1) {
            link = link.substring(0, index);
        }
        return link;
    };
    var isAppleProduct = /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);
    var defer = function() {
        var d = {
            promise: null,
            resolve: noop$1,
            reject: noop$1
        };
        d.promise = new Promise(function(resolve, reject) {
            d.resolve = resolve;
            d.reject = reject;
        });
        return d;
    };
    var executePromiseChain = function(fns, args, d, i) {
        d = d || defer();
        i = i || 0;
        if (i === 0) {
            fns = _.filter(fns, function(fn) {
                return !(_.isUndefined(fn) || _.isNull(fn));
            });
        }
        if (fns && i < fns.length) {
            try {
                toPromise(fns[i].apply(undefined, args)).then(function() {
                    return executePromiseChain(fns, args, d, i + 1);
                }, d.reject);
            } catch (e) {
                d.reject(e);
            }
        } else {
            d.resolve();
        }
        return d.promise;
    };
    var isDataSourceEqual = function(d1, d2) {
        return d1.execute(DataSource.Operation.GET_UNIQUE_IDENTIFIER) === d2.execute(DataSource.Operation.GET_UNIQUE_IDENTIFIER) && _.isEqual(d1.execute(DataSource.Operation.GET_CONTEXT_IDENTIFIER), d2.execute(DataSource.Operation.GET_CONTEXT_IDENTIFIER));
    };
    var validateDataSourceCtx = function(ds, ctx) {
        return ds.execute(DataSource.Operation.GET_CONTEXT_IDENTIFIER) === ctx;
    };
    var processFilterExpBindNode = function(context, filterExpressions) {
        var destroyFn = context.registerDestroyListener ? context.registerDestroyListener.bind(context) : _.noop;
        var filter$ = new rxjs.Subject();
        var bindFilExpObj = function(obj, targetNodeKey) {
            if (stringStartsWith(obj[targetNodeKey], "bind:")) {
                destroyFn($watch(obj[targetNodeKey].replace("bind:", ""), context, {}, function(newVal, oldVal) {
                    if (newVal === oldVal && _.isUndefined(newVal) || _.isUndefined(newVal) && !_.isUndefined(oldVal)) {
                        return;
                    }
                    if (!_.includes([ "blob", "file" ], obj.type)) {
                        newVal = getClonedObject(newVal);
                    }
                    if (obj.target === "dataBinding") {
                        filterExpressions.rules = [];
                        _.forEach(newVal, function(value, target) {
                            filterExpressions.rules.push({
                                target: target,
                                value: value,
                                matchMode: obj.matchMode || "startignorecase",
                                required: false,
                                type: ""
                            });
                        });
                    } else {
                        obj[targetNodeKey] = newVal;
                    }
                    filter$.next({
                        filterExpressions: filterExpressions,
                        newVal: newVal
                    });
                }));
            }
        };
        var traverseFilterExpressions = function(expressions) {
            if (expressions.rules) {
                _.forEach(expressions.rules, function(filExpObj, i) {
                    if (filExpObj.rules) {
                        traverseFilterExpressions(filExpObj);
                    } else {
                        if (filExpObj.matchMode === "between") {
                            bindFilExpObj(filExpObj, "secondvalue");
                        }
                        bindFilExpObj(filExpObj, "value");
                    }
                });
            }
        };
        traverseFilterExpressions(filterExpressions);
        return filter$;
    };
    var extendProto = function(target, proto) {
        var _proto = Object.getPrototypeOf(target);
        while (Object.getPrototypeOf(_proto).constructor !== Object) {
            _proto = Object.getPrototypeOf(_proto);
            if (proto === _proto) {
                return;
            }
        }
        Object.setPrototypeOf(_proto, proto);
    };
    var removeExtraSlashes = function(url) {
        var base64regex = /^data:image\/([a-z]{2,});base64,/;
        if (_.isString(url)) {
            if (_.startsWith(url, "file:///") || base64regex.test(url)) {
                return url;
            }
            return url.replace(new RegExp("([^:]/)(/)+", "g"), "$1");
        }
    };
    $.cachedScript = function() {
        var inProgress = new Map();
        var resolved = new Set();
        var isInProgress = function(url) {
            return inProgress.has(url);
        };
        var isResolved = function(url) {
            return resolved.has(url);
        };
        var onLoad = function(url) {
            resolved.add(url);
            inProgress.get(url).resolve();
            inProgress.delete(url);
        };
        var setInProgress = function(url) {
            var resFn;
            var rejFn;
            var promise = new Promise(function(res, rej) {
                resFn = res;
                rejFn = rej;
            });
            promise.resolve = resFn;
            promise.reject = rejFn;
            inProgress.set(url, promise);
        };
        return function(url) {
            if (isResolved(url)) {
                return Promise.resolve();
            }
            if (isInProgress(url)) {
                return inProgress.get(url);
            }
            setInProgress(url);
            var options = {
                dataType: "script",
                cache: true,
                url: url
            };
            $.ajax(options).done(function() {
                return onLoad(url);
            });
            return inProgress.get(url);
        };
    }();
    var DEFAULT_DISPLAY_FORMATS = {
        DATE: "yyyy-MM-dd",
        TIME: "hh:mm a",
        TIMESTAMP: "yyyy-MM-dd hh:mm:ss a",
        DATETIME: "yyyy-MM-dd hh:mm:ss a"
    };
    var getDisplayDateTimeFormat = function(type) {
        return DEFAULT_DISPLAY_FORMATS[_.toUpper(type)];
    };
    var addForIdAttributes = function(element) {
        var labelEl = element.querySelectorAll("label.control-label");
        var inputEl = element.querySelectorAll("[focus-target]");
        if (!inputEl.length) {
            inputEl = element.querySelectorAll("input, select, textarea");
        }
        if (labelEl.length && inputEl.length) {
            var widgetId = $(inputEl[0]).closest("[widget-id]").attr("widget-id");
            if (widgetId) {
                setAttr(inputEl[0], "id", widgetId);
                setAttr(labelEl[0], "for", widgetId);
            }
        }
    };
    var adjustContainerPosition = function(containerElem, parentElem, ref, ele) {
        var containerHeight = ele ? _.parseInt(ele.css("height")) : _.parseInt(containerElem.css("height"));
        var viewPortHeight = $(window).height() + window.scrollY;
        var parentDimesion = parentElem.getBoundingClientRect();
        var parentTop = parentDimesion.top + window.scrollY;
        if (viewPortHeight - (parentTop + parentDimesion.height) < containerHeight) {
            var newTop_1 = parentTop - containerHeight;
            ref._ngZone.onStable.subscribe(function() {
                containerElem.css("top", newTop_1 + "px");
            });
        }
    };
    var closePopover = function(element) {
        if (!element.closest(".app-popover").length) {
            var popoverElements = document.querySelectorAll(".app-popover-wrapper");
            _.forEach(popoverElements, function(ele) {
                if (ele.widget.isOpen) {
                    ele.widget.isOpen = false;
                }
            });
        }
    };
    var detectChanges$1 = $appDigest;
    var triggerItemAction = function(scope, item) {
        var itemLink = item.link;
        var itemAction = item.action;
        var linkTarget = item.target;
        if (itemAction) {
            if (!scope.itemActionFn) {
                scope.itemActionFn = $parseEvent(itemAction);
            }
            scope.itemActionFn(scope.userDefinedExecutionContext, Object.create(item));
        }
        if (itemLink) {
            if (itemLink.startsWith("#/") && (!linkTarget || linkTarget === "_self")) {
                var queryParams = getUrlParams(itemLink);
                itemLink = getRouteNameFromLink(itemLink);
                var router = _.get(scope, "route") || _.get(scope, "menuRef.route");
                router.navigate([ itemLink ], {
                    queryParams: queryParams
                });
            } else {
                openLink(itemLink, linkTarget);
            }
        }
    };
    var getDatasourceFromExpr = function(expr, scope) {
        var isBoundToVariable = _.startsWith(expr, "Variables.");
        var isBoundToWidget = _.startsWith(expr, "Widgets.");
        var parts = expr.split(".");
        if (isBoundToVariable) {
            return _.get(scope.viewParent.Variables, parts[1]);
        }
        if (isBoundToWidget) {
            var widgetScope = _.get(scope.viewParent.Widgets, parts[1]);
            var widgetDatasetBoundExpr = widgetScope.$attrs.get("datasetboundexpr");
            var widgetBoundExpression = void 0;
            widgetBoundExpression = !widgetScope.datasource && widgetDatasetBoundExpr ? widgetDatasetBoundExpr : widgetScope.binddataset;
            return getDatasourceFromExpr(widgetBoundExpression, widgetScope);
        }
    };
    var extractCurrentItemExpr = function(expr, scope) {
        var currentItemRegEx = /^Widgets\..*\.currentItem/g;
        if (currentItemRegEx.test(expr)) {
            var parts = expr.split(".");
            var widgetScope = _.get(scope.viewParent.Widgets, parts[1]);
            var widgetDatasetBoundExpr = widgetScope.$attrs.get("datasetboundexpr");
            if (!widgetScope.datasource && widgetDatasetBoundExpr) {
                expr = expr.replace(/^Widgets\..*\.currentItem/g, widgetDatasetBoundExpr + "[$i]");
                return extractCurrentItemExpr(expr, scope);
            } else {
                expr = expr.replace(/^Widgets\..*\.currentItem/g, widgetScope.binddataset + "[$i]");
            }
        }
        return expr;
    };
    var findRootContainer = function($el) {
        var root = $el.closest(".app-prefab");
        if (!root.length) {
            root = $el.closest(".app-partial");
        }
        if (!root.length) {
            root = $el.closest(".app-page");
        }
        return root.length && root.parent()[0].tagName;
    };
    var VALIDATOR = {
        REQUIRED: "required",
        MAXCHARS: "maxchars",
        MINVALUE: "minvalue",
        MAXVALUE: "maxvalue",
        REGEXP: "regexp",
        MINDATE: "mindate",
        MAXDATE: "maxdate",
        MINTIME: "mintime",
        MAXTIME: "maxtime",
        EXCLUDEDATES: "excludedates",
        EXCLUDEDAYS: "excludedays"
    };
    var Utils = Object.freeze({
        isDefined: isDefined,
        isObject: isObject,
        toBoolean: toBoolean,
        isIE: isIE,
        isAndroid: isAndroid,
        isAndroidTablet: isAndroidTablet,
        isIphone: isIphone,
        isIpod: isIpod,
        isIpad: isIpad,
        isIos: isIos,
        isMobile: isMobile,
        isMobileApp: isMobileApp,
        getAndroidVersion: getAndroidVersion,
        isKitkatDevice: isKitkatDevice,
        encodeUrl: encodeUrl,
        encodeUrlParams: encodeUrlParams,
        initCaps: initCaps,
        spaceSeparate: spaceSeparate,
        replaceAt: replaceAt,
        periodSeparate: periodSeparate,
        prettifyLabel: prettifyLabel,
        deHyphenate: deHyphenate,
        prettifyLabels: prettifyLabels,
        isInsecureContentRequest: isInsecureContentRequest,
        stringStartsWith: stringStartsWith,
        getEvaluatedExprValue: getEvaluatedExprValue,
        isImageFile: isImageFile,
        isAudioFile: isAudioFile,
        isVideoFile: isVideoFile,
        isValidWebURL: isValidWebURL,
        getResourceURL: getResourceURL,
        triggerFn: triggerFn,
        getFormattedDate: getFormattedDate,
        getDateObj: getDateObj,
        addEventListenerOnElement: addEventListenerOnElement,
        getClonedObject: getClonedObject,
        getFiles: getFiles,
        generateGUId: generateGUId,
        validateAccessRoles: validateAccessRoles,
        getValidJSON: getValidJSON,
        xmlToJson: xmlToJson,
        findValueOf: findValueOf,
        extractType: extractType,
        isNumberType: isNumberType,
        isEmptyObject: isEmptyObject,
        isPageable: isPageable,
        replace: replace,
        isDateTimeType: isDateTimeType,
        getValidDateObject: getValidDateObject,
        getNativeDateObject: getNativeDateObject,
        getBlob: getBlob,
        isEqualWithFields: isEqualWithFields,
        loadStyleSheet: loadStyleSheet,
        loadStyleSheets: loadStyleSheets,
        loadScript: loadScript,
        loadScripts: loadScripts,
        _WM_APP_PROJECT: _WM_APP_PROJECT,
        setSessionStorageItem: setSessionStorageItem,
        getSessionStorageItem: getSessionStorageItem,
        noop: noop$1,
        isArray: isArray,
        isString: isString$1,
        isNumber: isNumber,
        convertToBlob: convertToBlob,
        hasCordova: hasCordova,
        isSpotcues: isSpotcues,
        AppConstants: AppConstants,
        openLink: openLink,
        fetchContent: fetchContent,
        toPromise: toPromise,
        retryIfFails: retryIfFails,
        getAbortableDefer: getAbortableDefer,
        createCSSRule: createCSSRule,
        getUrlParams: getUrlParams,
        getRouteNameFromLink: getRouteNameFromLink,
        isAppleProduct: isAppleProduct,
        defer: defer,
        executePromiseChain: executePromiseChain,
        isDataSourceEqual: isDataSourceEqual,
        validateDataSourceCtx: validateDataSourceCtx,
        processFilterExpBindNode: processFilterExpBindNode,
        extendProto: extendProto,
        removeExtraSlashes: removeExtraSlashes,
        getDisplayDateTimeFormat: getDisplayDateTimeFormat,
        addForIdAttributes: addForIdAttributes,
        adjustContainerPosition: adjustContainerPosition,
        closePopover: closePopover,
        detectChanges: detectChanges$1,
        triggerItemAction: triggerItemAction,
        getDatasourceFromExpr: getDatasourceFromExpr,
        extractCurrentItemExpr: extractCurrentItemExpr,
        findRootContainer: findRootContainer,
        VALIDATOR: VALIDATOR,
        "\u02750": \u02750$4,
        "\u02751": \u02751$3,
        "\u02752": \u02752$1,
        "\u02753": \u02753$1
    });
    var EventNotifier = function() {
        function EventNotifier(start) {
            if (start === void 0) {
                start = true;
            }
            this._subject = new rxjs.Subject();
            this._isInitialized = false;
            this._eventsBeforeInit = [];
            if (start) {
                this.start();
            }
        }
        EventNotifier.prototype.notify = function(eventName) {
            var data = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                data[_i - 1] = arguments[_i];
            }
            if (this._isInitialized) {
                this._subject.next({
                    name: eventName,
                    data: data
                });
            } else {
                this._eventsBeforeInit.push({
                    name: eventName,
                    data: data
                });
            }
        };
        EventNotifier.prototype.start = function() {
            var _this = this;
            if (!this._isInitialized) {
                this._isInitialized = true;
                this._eventsBeforeInit.forEach(function(event) {
                    return _this._subject.next(event);
                });
            }
        };
        EventNotifier.prototype.subscribe = function(eventName, callback) {
            var eventListener;
            if (eventName && callback) {
                eventListener = this._subject.subscribe(function(event) {
                    if (event && isObject(event) && event.name === eventName) {
                        callback.apply(undefined, event.data);
                    }
                });
                return function() {
                    eventListener.unsubscribe();
                };
            }
            return noop$1;
        };
        EventNotifier.prototype.destroy = function() {
            this._subject.complete();
        };
        return EventNotifier;
    }();
    var ConstantService = function() {
        function ConstantService() {
            this.MATCH_MODES = {
                STARTS_WITH_IGNORE_CASE: "startignorecase",
                STARTS_WITH: "start",
                ENDS_WITH_IGNORE_CASE: "endignorecase",
                ENDS_WITH: "end",
                CONTAINS: "anywhere",
                CONTAINS_IGNORE_CASE: "anywhereignorecase",
                IS_EQUAL_WITH_IGNORE_CASE: "exactignorecase",
                IS_EQUAL: "exact"
            };
            this.VALIDATOR = VALIDATOR;
        }
        ConstantService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        ConstantService.ngInjectableDef = i0.defineInjectable({
            factory: function ConstantService_Factory() {
                return new ConstantService();
            },
            token: ConstantService,
            providedIn: "root"
        });
        return ConstantService;
    }();
    var UtilsService = function() {
        function UtilsService() {
            _.assign(this, Utils);
        }
        UtilsService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        UtilsService.ctorParameters = function() {
            return [];
        };
        UtilsService.ngInjectableDef = i0.defineInjectable({
            factory: function UtilsService_Factory() {
                return new UtilsService();
            },
            token: UtilsService,
            providedIn: "root"
        });
        return UtilsService;
    }();
    var FieldTypeService = function() {
        function FieldTypeService() {
            _.assign(this, {
                INTEGER: "integer",
                BIG_INTEGER: "big_integer",
                SHORT: "short",
                FLOAT: "float",
                BIG_DECIMAL: "big_decimal",
                DOUBLE: "double",
                LONG: "long",
                BYTE: "byte",
                STRING: "string",
                CHARACTER: "character",
                TEXT: "text",
                DATE: "date",
                TIME: "time",
                TIMESTAMP: "timestamp",
                DATETIME: "datetime",
                BOOLEAN: "boolean",
                LIST: "list",
                CLOB: "clob",
                BLOB: "blob"
            });
        }
        FieldTypeService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        FieldTypeService.ctorParameters = function() {
            return [];
        };
        FieldTypeService.ngInjectableDef = i0.defineInjectable({
            factory: function FieldTypeService_Factory() {
                return new FieldTypeService();
            },
            token: FieldTypeService,
            providedIn: "root"
        });
        return FieldTypeService;
    }();
    var FieldWidgetService = function() {
        function FieldWidgetService() {
            _.assign(this, {
                TEXT: "text",
                NUMBER: "number",
                TEXTAREA: "textarea",
                PASSWORD: "password",
                CHECKBOX: "checkbox",
                SLIDER: "slider",
                RICHTEXT: "richtext",
                CURRENCY: "currency",
                SWITCH: "switch",
                SELECT: "select",
                CHECKBOXSET: "checkboxset",
                RADIOSET: "radioset",
                DATE: "date",
                TIME: "time",
                TIMESTAMP: "timestamp",
                UPLOAD: "upload",
                RATING: "rating",
                DATETIME: "datetime",
                AUTOCOMPLETE: "autocomplete",
                CHIPS: "chips",
                COLORPICKER: "colorpicker"
            });
        }
        FieldWidgetService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        FieldWidgetService.ctorParameters = function() {
            return [];
        };
        FieldWidgetService.ngInjectableDef = i0.defineInjectable({
            factory: function FieldWidgetService_Factory() {
                return new FieldWidgetService();
            },
            token: FieldWidgetService,
            providedIn: "root"
        });
        return FieldWidgetService;
    }();
    var ScriptStore = [];
    var ScriptLoaderService = function() {
        function ScriptLoaderService(http) {
            var _this = this;
            this.http = http;
            this.scripts = {};
            ScriptStore.forEach(function(script) {
                _this.scripts[script.name] = {
                    loaded: false,
                    src: script.src
                };
            });
        }
        ScriptLoaderService.prototype.load = function() {
            var _this = this;
            var scripts = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                scripts[_i] = arguments[_i];
            }
            if (scripts && scripts.length) {
                return Promise.resolve().then(function() {
                    return _this.pathMappings || _this.loadPathMappings();
                }).then(function() {
                    return Promise.all(scripts.map(function(s) {
                        return _this.loadScript(s);
                    }));
                });
            }
            return Promise.resolve();
        };
        ScriptLoaderService.prototype.loadPathMappings = function() {
            var _this = this;
            var path = (_WM_APP_PROJECT.cdnUrl || _WM_APP_PROJECT.ngDest) + "path_mapping.json";
            return this.http.get(path).toPromise().then(function(data) {
                _this.pathMappings = data;
            }, function() {
                _this.pathMappings = {};
            });
        };
        ScriptLoaderService.prototype.loadScript = function(name) {
            var _this = this;
            return new Promise(function(resolve, reject) {
                if (_this.scripts[name] && _this.scripts[name].loaded) {
                    resolve({
                        script: name,
                        loaded: true
                    });
                    return;
                } else if (!_this.scripts[name]) {
                    _this.scripts[name] = {
                        loaded: false,
                        src: name
                    };
                }
                var script = document.createElement("script");
                script.type = "text/javascript";
                script.async = false;
                var src = _this.scripts[name].src;
                src = _this.pathMappings[src] || src;
                if (src.startsWith("http")) {
                    script.src = src;
                } else {
                    script.src = (_WM_APP_PROJECT.cdnUrl || _WM_APP_PROJECT.ngDest) + src;
                }
                if (script.readyState) {
                    script.onreadystatechange = function() {
                        if (script.readyState === "loaded" || script.readyState === "complete") {
                            script.onreadystatechange = null;
                            _this.scripts[name].loaded = true;
                            resolve({
                                script: name,
                                loaded: true
                            });
                        }
                    };
                } else {
                    script.onload = function() {
                        _this.scripts[name].loaded = true;
                        resolve({
                            script: name,
                            loaded: true
                        });
                    };
                }
                script.onerror = function(error) {
                    return resolve({
                        script: name,
                        loaded: false,
                        status: "Loaded"
                    });
                };
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        };
        ScriptLoaderService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        ScriptLoaderService.ctorParameters = function() {
            return [ {
                type: i1.HttpClient
            } ];
        };
        ScriptLoaderService.ngInjectableDef = i0.defineInjectable({
            factory: function ScriptLoaderService_Factory() {
                return new ScriptLoaderService(i0.inject(i1.HttpClient));
            },
            token: ScriptLoaderService,
            providedIn: "root"
        });
        return ScriptLoaderService;
    }();
    var CoreModule = function() {
        function CoreModule() {}
        CoreModule.forRoot = function() {
            return {
                ngModule: CoreModule,
                providers: []
            };
        };
        CoreModule.decorators = [ {
            type: i0.NgModule,
            args: [ {
                declarations: [],
                imports: [ i1.HttpClientModule ],
                providers: [],
                bootstrap: []
            } ]
        } ];
        return CoreModule;
    }();
    exports.getFormWidgetTemplate = getFormWidgetTemplate;
    exports.getRequiredFormWidget = getRequiredFormWidget;
    exports.updateTemplateAttrs = updateTemplateAttrs;
    exports.getNgModelAttr = getNgModelAttr;
    exports.getRowActionAttrs = getRowActionAttrs;
    exports.\u02750 = \u02750;
    exports.\u02751 = \u02751;
    exports.CURRENCY_INFO = CURRENCY_INFO;
    exports.appendNode = appendNode;
    exports.insertBefore = insertBefore;
    exports.insertAfter = insertAfter;
    exports.removeNode = removeNode;
    exports.removeClass = removeClass;
    exports.addClass = addClass;
    exports.switchClass = switchClass;
    exports.toggleClass = toggleClass;
    exports.setCSS = setCSS;
    exports.setCSSFromObj = setCSSFromObj;
    exports.setProperty = setProperty;
    exports.setAttr = setAttr;
    exports.setHtml = setHtml;
    exports.removeAttr = removeAttr;
    exports.createElement = createElement;
    exports.toDimension = toDimension;
    exports.EventNotifier = EventNotifier;
    exports.setPipeProvider = setPipeProvider;
    exports.$parseExpr = $parseExpr;
    exports.$parseEvent = $parseEvent;
    exports.\u02752 = \u02752;
    exports.\u02753 = \u02753;
    exports.\u02754 = \u02754;
    exports.\u02755 = \u02755;
    exports.\u02756 = \u02756;
    exports.\u02757 = \u02757;
    exports.\u02758 = \u02758;
    exports.\u02759 = \u02759;
    exports.\u027510 = \u027510;
    exports.isDefined = isDefined;
    exports.isObject = isObject;
    exports.toBoolean = toBoolean;
    exports.isIE = isIE;
    exports.isAndroid = isAndroid;
    exports.isAndroidTablet = isAndroidTablet;
    exports.isIphone = isIphone;
    exports.isIpod = isIpod;
    exports.isIpad = isIpad;
    exports.isIos = isIos;
    exports.isMobile = isMobile;
    exports.isMobileApp = isMobileApp;
    exports.getAndroidVersion = getAndroidVersion;
    exports.isKitkatDevice = isKitkatDevice;
    exports.encodeUrl = encodeUrl;
    exports.encodeUrlParams = encodeUrlParams;
    exports.initCaps = initCaps;
    exports.spaceSeparate = spaceSeparate;
    exports.replaceAt = replaceAt;
    exports.periodSeparate = periodSeparate;
    exports.prettifyLabel = prettifyLabel;
    exports.deHyphenate = deHyphenate;
    exports.prettifyLabels = prettifyLabels;
    exports.isInsecureContentRequest = isInsecureContentRequest;
    exports.stringStartsWith = stringStartsWith;
    exports.getEvaluatedExprValue = getEvaluatedExprValue;
    exports.isImageFile = isImageFile;
    exports.isAudioFile = isAudioFile;
    exports.isVideoFile = isVideoFile;
    exports.isValidWebURL = isValidWebURL;
    exports.getResourceURL = getResourceURL;
    exports.triggerFn = triggerFn;
    exports.getFormattedDate = getFormattedDate;
    exports.getDateObj = getDateObj;
    exports.addEventListenerOnElement = addEventListenerOnElement;
    exports.getClonedObject = getClonedObject;
    exports.getFiles = getFiles;
    exports.generateGUId = generateGUId;
    exports.validateAccessRoles = validateAccessRoles;
    exports.getValidJSON = getValidJSON;
    exports.xmlToJson = xmlToJson;
    exports.findValueOf = findValueOf;
    exports.extractType = extractType;
    exports.isNumberType = isNumberType;
    exports.isEmptyObject = isEmptyObject;
    exports.isPageable = isPageable;
    exports.replace = replace;
    exports.isDateTimeType = isDateTimeType;
    exports.getValidDateObject = getValidDateObject;
    exports.getNativeDateObject = getNativeDateObject;
    exports.getBlob = getBlob;
    exports.isEqualWithFields = isEqualWithFields;
    exports.loadStyleSheet = loadStyleSheet;
    exports.loadStyleSheets = loadStyleSheets;
    exports.loadScript = loadScript;
    exports.loadScripts = loadScripts;
    exports._WM_APP_PROJECT = _WM_APP_PROJECT;
    exports.setSessionStorageItem = setSessionStorageItem;
    exports.getSessionStorageItem = getSessionStorageItem;
    exports.noop = noop$1;
    exports.isArray = isArray;
    exports.isString = isString$1;
    exports.isNumber = isNumber;
    exports.convertToBlob = convertToBlob;
    exports.hasCordova = hasCordova;
    exports.isSpotcues = isSpotcues;
    exports.AppConstants = AppConstants;
    exports.openLink = openLink;
    exports.fetchContent = fetchContent;
    exports.toPromise = toPromise;
    exports.retryIfFails = retryIfFails;
    exports.getAbortableDefer = getAbortableDefer;
    exports.createCSSRule = createCSSRule;
    exports.getUrlParams = getUrlParams;
    exports.getRouteNameFromLink = getRouteNameFromLink;
    exports.isAppleProduct = isAppleProduct;
    exports.defer = defer;
    exports.executePromiseChain = executePromiseChain;
    exports.isDataSourceEqual = isDataSourceEqual;
    exports.validateDataSourceCtx = validateDataSourceCtx;
    exports.processFilterExpBindNode = processFilterExpBindNode;
    exports.extendProto = extendProto;
    exports.removeExtraSlashes = removeExtraSlashes;
    exports.getDisplayDateTimeFormat = getDisplayDateTimeFormat;
    exports.addForIdAttributes = addForIdAttributes;
    exports.adjustContainerPosition = adjustContainerPosition;
    exports.closePopover = closePopover;
    exports.detectChanges = detectChanges$1;
    exports.triggerItemAction = triggerItemAction;
    exports.getDatasourceFromExpr = getDatasourceFromExpr;
    exports.extractCurrentItemExpr = extractCurrentItemExpr;
    exports.findRootContainer = findRootContainer;
    exports.VALIDATOR = VALIDATOR;
    exports.FIRST_TIME_WATCH = FIRST_TIME_WATCH;
    exports.isFirstTimeChange = isFirstTimeChange;
    exports.debounce = debounce;
    exports.muteWatchers = muteWatchers;
    exports.unMuteWatchers = unMuteWatchers;
    exports.$watch = $watch;
    exports.$unwatch = $unwatch;
    exports.setNgZone = setNgZone;
    exports.setAppRef = setAppRef;
    exports.isChangeFromWatch = isChangeFromWatch;
    exports.resetChangeFromWatch = resetChangeFromWatch;
    exports.$invokeWatchers = $invokeWatchers;
    exports.$appDigest = $appDigest;
    exports.IDGenerator = IDGenerator;
    exports.IDataSource = IDataSource;
    exports.DataSource = DataSource;
    exports.App = App;
    exports.AbstractDialogService = AbstractDialogService;
    exports.AbstractHttpService = AbstractHttpService;
    exports.AbstractI18nService = AbstractI18nService;
    exports.AbstractToasterService = AbstractToasterService;
    exports.AbstractSpinnerService = AbstractSpinnerService;
    exports.UserDefinedExecutionContext = UserDefinedExecutionContext;
    exports.AbstractNavigationService = AbstractNavigationService;
    exports.AppDefaults = AppDefaults;
    exports.DynamicComponentRefProvider = DynamicComponentRefProvider;
    exports.ConstantService = ConstantService;
    exports.UtilsService = UtilsService;
    exports.FieldTypeService = FieldTypeService;
    exports.FieldWidgetService = FieldWidgetService;
    exports.ScriptStore = ScriptStore;
    exports.ScriptLoaderService = ScriptLoaderService;
    exports.CoreModule = CoreModule;
    exports.getWmProjectProperties = getWmProjectProperties;
    exports.setWmProjectProperties = setWmProjectProperties;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports) : typeof define === "function" && define.amd ? define("@wm/swipey", [ "exports" ], factory) : factory(global.swipey = {});
})(this, function(exports) {
    "use strict";
    var SwipeAnimation = function() {
        function SwipeAnimation() {
            this._isGesturesEnabled = true;
        }
        SwipeAnimation.prototype.bindEvents = function() {
            if (window["PointerEvent"]) {
                return [ "pointer" ];
            }
            return [ "touch" ];
        };
        SwipeAnimation.prototype.bounds = function(e, $d) {
            return {};
        };
        SwipeAnimation.prototype.context = function() {
            return {};
        };
        SwipeAnimation.prototype.direction = function() {
            return $.fn.swipey.DIRECTIONS.HORIZONTAL;
        };
        SwipeAnimation.prototype.setGesturesEnabled = function(enabled) {
            this._isGesturesEnabled = enabled;
        };
        SwipeAnimation.prototype.isGesturesEnabled = function() {
            return this._isGesturesEnabled;
        };
        SwipeAnimation.prototype.goToLower = function(time) {
            this._$ele.swipeAnimation("gotoLower", time);
        };
        SwipeAnimation.prototype.goToUpper = function(time) {
            this._$ele.swipeAnimation("gotoUpper", time);
        };
        SwipeAnimation.prototype.onAnimation = function(e, distanceMoved) {};
        SwipeAnimation.prototype.onUpper = function() {};
        SwipeAnimation.prototype.onLower = function() {};
        SwipeAnimation.prototype.threshold = function() {
            return 30;
        };
        SwipeAnimation.prototype.init = function($ele, $swipeTargetEle) {
            this._$ele = $ele;
            $ele.swipeAnimation({
                animation: this.animation(),
                target: $swipeTargetEle,
                bounds: this.bounds.bind(this),
                bindEvents: this.bindEvents(),
                context: this.context.bind(this),
                direction: this.direction(),
                enableGestures: this.isGesturesEnabled.bind(this),
                onAnimation: this.onAnimation.bind(this),
                onLower: this.onLower.bind(this),
                onUpper: this.onUpper.bind(this),
                threshold: this.threshold(),
                disableMouse: true
            });
        };
        return SwipeAnimation;
    }();
    exports.SwipeAnimation = SwipeAnimation;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/compiler")) : typeof define === "function" && define.amd ? define("@wm/transpiler", [ "exports", "@angular/compiler" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.transpiler = {}), global.ng.compiler);
})(this, function(exports, compiler) {
    "use strict";
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m) return m.call(o);
        return {
            next: function() {
                if (o && i >= o.length) o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var NG_FORM_MODULE = [ {
        from: "@angular/forms",
        name: "FormsModule",
        as: "ngFormsModule"
    } ];
    var NG_REACTIVE_FORM_MODULE = [ {
        from: "@angular/forms",
        name: "ReactiveFormsModule",
        as: "ngReactiveFormsModule"
    } ];
    var NGX_BS_DATE_PICKER = [ {
        from: "ngx-bootstrap/datepicker",
        name: "BsDatepickerModule",
        as: "ngx_BsDatepickerModule"
    } ];
    var NGX_CAROUSEL_MODULE = [ {
        from: "ngx-bootstrap/carousel",
        name: "CarouselModule",
        as: "ngxCarouselModule",
        forRoot: true
    } ];
    var NGX_COLOR_PICKER_MODULE = [ {
        from: "ngx-color-picker",
        name: "ColorPickerModule",
        as: "ngx_ColorPickerModule"
    } ];
    var NGX_DROP_DOWN_MODULE = [ {
        from: "ngx-bootstrap/dropdown",
        name: "BsDropdownModule",
        as: "ngxBsDropdownModule",
        forRoot: true
    } ];
    var NGX_DATE_PICKER = [ {
        from: "ngx-bootstrap/datepicker",
        name: "DatepickerModule",
        as: "ngx_DatepickerModule",
        forRoot: true
    } ];
    var NGX_MODAL_MODULE = [ {
        from: "ngx-bootstrap/modal",
        name: "ModalModule",
        as: "ngx_ModalModule"
    } ];
    var NGX_PAGINATION_MODULE = [ {
        from: "ngx-bootstrap/pagination",
        name: "PaginationModule",
        as: "ngxPaginationModule",
        forRoot: true
    } ];
    var NGX_POPOVER_MODULE = [ {
        from: "ngx-bootstrap/popover",
        name: "PopoverModule",
        as: "ngxPopoverModule",
        forRoot: true
    } ];
    var NGX_TIME_PICKER = [ {
        from: "ngx-bootstrap/timepicker",
        name: "TimepickerModule",
        as: "ngx_TimepickerModule",
        forRoot: true
    } ];
    var NGX_TOOL_TIP_MODULE = [ {
        from: "ngx-bootstrap/tooltip",
        name: "TooltipModule",
        as: "ngxTooltipModule",
        forRoot: true
    } ];
    var NGX_TYPE_HEAD_MODULE = [ {
        from: "ngx-bootstrap/typeahead",
        name: "TypeaheadModule",
        as: "ngxTypeaheadModule",
        forRoot: true
    } ];
    var PROGRESS_MODULE = [ {
        from: "@wm/components/basic/progress",
        name: "ProgressModule"
    } ];
    var MOBILE_BASIC_MODULE = __spread(PROGRESS_MODULE, [ {
        from: "@wm/mobile/components/basic",
        name: "BasicModule",
        as: "WM_MobileBasicModule",
        platformType: "MOBILE"
    } ]);
    var MOBILE_EPOCH_MODULE = [ {
        from: "@wm/mobile/components/input/epoch",
        name: "EpochModule",
        as: "WM_MobileEpochModule",
        platformType: "MOBILE"
    } ];
    var MOBILE_FILE_UPLOAD_MODULE = [ {
        from: "@wm/mobile/components/input/file-upload",
        name: "FileUploadModule",
        as: "WM_MobileFileUploadModule",
        platformType: "MOBILE"
    } ];
    var PAGE_MODULE = [ {
        from: "@wm/components/page",
        name: "PageModule"
    }, {
        from: "@wm/mobile/components/page",
        name: "PageModule",
        as: "WM_MobilePageModule",
        platformType: "MOBILE"
    } ];
    var BASIC_MODULE = __spread([ {
        from: "@wm/components/basic",
        name: "BasicModule"
    } ], MOBILE_BASIC_MODULE);
    var INPUT_MODULE = __spread(NG_FORM_MODULE, [ {
        from: "@wm/components/input",
        name: "InputModule"
    } ]);
    var DIALOG_MODULE = __spread(NGX_MODAL_MODULE, INPUT_MODULE, [ {
        from: "@wm/components/dialogs",
        name: "DialogModule"
    } ]);
    var PAGINATION_MODULE = __spread(NG_FORM_MODULE, NGX_PAGINATION_MODULE, [ {
        from: "@wm/components/data/pagination",
        name: "PaginationModule"
    } ]);
    var SEARCH_MODULE = __spread(NG_FORM_MODULE, NGX_TYPE_HEAD_MODULE, [ {
        from: "@wm/components/basic/search",
        name: "SearchModule"
    } ]);
    var ACCORDION_MODULE = [ {
        from: "@wm/components/containers/accordion",
        name: "AccordionModule"
    } ];
    var ALERT_DIALOG_MODULE = __spread(DIALOG_MODULE, [ {
        from: "@wm/components/dialogs/alert-dialog",
        name: "AlertDialogModule"
    } ]);
    var BARCODE_SCANNER_MODULE = [ {
        from: "@wm/mobile/components/device/barcode-scanner",
        name: "BarcodeScannerModule"
    } ];
    var MENU_MODULE = __spread(BASIC_MODULE, NGX_DROP_DOWN_MODULE, INPUT_MODULE, [ {
        from: "@wm/components/navigation/menu",
        name: "MenuModule"
    } ]);
    var BREAD_CRUMB_MODULE = __spread(MENU_MODULE, [ {
        from: "@wm/components/navigation/breadcrumb",
        name: "BreadcrumbModule"
    } ]);
    var CAMERA_MODULE = [ {
        from: "@wm/mobile/components/device/camera",
        name: "CameraModule"
    } ];
    var CALENDAR_MODULE = __spread(NG_FORM_MODULE, NGX_DATE_PICKER, [ {
        from: "@wm/components/input/calendar",
        name: "CalendarModule"
    } ]);
    var CAROUSEL_MODULE = __spread(NGX_CAROUSEL_MODULE, [ {
        from: "@wm/components/advanced/carousel",
        name: "CarouselModule"
    } ]);
    var CHART_MODULE = __spread(BASIC_MODULE, [ {
        from: "@wm/components/chart",
        name: "ChartModule"
    } ]);
    var CHIPS_MODULE = __spread(SEARCH_MODULE, [ {
        from: "@wm/components/input/chips",
        name: "ChipsModule"
    } ]);
    var COLOR_PICKER_MODULE = __spread(NG_FORM_MODULE, NGX_COLOR_PICKER_MODULE, [ {
        from: "@wm/components/input/color-picker",
        name: "ColorPickerModule"
    } ]);
    var CONFIRM_DIALOG_MODULE = __spread(DIALOG_MODULE, [ {
        from: "@wm/components/dialogs/confirm-dialog",
        name: "ConfirmDialogModule"
    } ]);
    var CONTENT_MODULE = [ {
        from: "@wm/components/page",
        name: "PageModule"
    } ];
    var CURRENCY_MODULE = __spread(INPUT_MODULE, [ {
        from: "@wm/components/input/currency",
        name: "CurrencyModule"
    } ]);
    var DESIGN_DIALOG_MODULE = __spread(DIALOG_MODULE, [ {
        from: "@wm/components/dialogs/design-dialog",
        name: "DesignDialogModule"
    } ]);
    var EPOCH_MODULE = __spread(NG_FORM_MODULE, NGX_BS_DATE_PICKER, NGX_TIME_PICKER, NGX_DROP_DOWN_MODULE, NGX_DATE_PICKER, MOBILE_EPOCH_MODULE, [ {
        from: "@wm/components/input/epoch",
        name: "EpochModule"
    } ]);
    var FILE_UPLOAD_MODULE = __spread(MOBILE_FILE_UPLOAD_MODULE, [ {
        from: "@wm/components/input/file-upload",
        name: "FileUploadModule"
    } ]);
    var FOOTER_MODULE = [ {
        from: "@wm/components/page/footer",
        name: "FooterModule"
    } ];
    var HEADER_MODULE = [ {
        from: "@wm/components/page/header",
        name: "HeaderModule"
    } ];
    var IFRAME_DIALOG_MODULE = __spread(BASIC_MODULE, DIALOG_MODULE, [ {
        from: "@wm/components/dialogs/iframe-dialog",
        name: "IframeDialogModule"
    } ]);
    var LAYOUT_GRID_MODULE = [ {
        from: "@wm/components/containers/layout-grid",
        name: "LayoutGridModule"
    } ];
    var LOGIN_DIALOG_MODULE = __spread(DIALOG_MODULE, [ {
        from: "@wm/components/dialogs/login-dialog",
        name: "LoginDialogModule"
    } ]);
    var CARD_MODULE = __spread(NGX_DROP_DOWN_MODULE, MENU_MODULE, BASIC_MODULE, [ {
        from: "@wm/components/data/card",
        name: "CardModule"
    } ]);
    var MARQUEE_MODULE = [ {
        from: "@wm/components/advanced/marquee",
        name: "MarqueeModule"
    } ];
    var LEFT_PANEL_MODULE = [ {
        from: "@wm/components/page/left-panel",
        name: "LeftPanelModule"
    }, {
        from: "@wm/mobile/components/page/left-panel",
        name: "LeftPanelModule",
        as: "WM_MobileLeftPanelModule",
        platformType: "MOBILE"
    } ];
    var LIST_MODULE = __spread(PAGINATION_MODULE, INPUT_MODULE, [ {
        from: "@wm/components/data/list",
        name: "ListModule"
    } ]);
    var LOGIN_MODULE = [ {
        from: "@wm/components/advanced/login",
        name: "LoginModule"
    } ];
    var MOBILE_NAV_BAR_MODULE = __spread(LEFT_PANEL_MODULE, SEARCH_MODULE, PAGE_MODULE, [ {
        from: "@wm/mobile/components/page/mobile-navbar",
        name: "MobileNavbarModule"
    } ]);
    var MEDIA_LIST_MODULE = __spread(BASIC_MODULE, PAGE_MODULE, MOBILE_NAV_BAR_MODULE, [ {
        from: "@wm/mobile/components/data/media-list",
        name: "MediaListModule"
    } ]);
    var MOBILE_TAB_BAR_MODULE = [ {
        from: "@wm/mobile/components/page/tab-bar",
        name: "TabBarModule"
    } ];
    var NAVBAR_MODULE = [ {
        from: "@wm/components/navigation/navbar",
        name: "NavbarModule"
    } ];
    var POPOVER_MODULE = __spread(NGX_POPOVER_MODULE, BASIC_MODULE, [ {
        from: "@wm/components/navigation/popover",
        name: "PopoverModule"
    } ]);
    var PANEL_MODULE = __spread(MENU_MODULE, [ {
        from: "@wm/components/containers/panel",
        name: "PanelModule"
    } ]);
    var PARTIAL_DIALOG_MODULE = __spread(DIALOG_MODULE, [ {
        from: "@wm/components/dialogs/partial-dialog",
        name: "PartialDialogModule"
    } ]);
    var PREFAB_MODULE = [ {
        from: "@wm/components/prefab",
        name: "PrefabModule"
    } ];
    var RATING_MODULE = [ {
        from: "@wm/components/input/rating",
        name: "RatingModule"
    } ];
    var RICH_TEXT_EDITOR_MODULE = [ {
        from: "@wm/components/basic/rich-text-editor",
        name: "RichTextEditorModule"
    } ];
    var RIGHT_PANEL_MODULE = [ {
        from: "@wm/components/page/right-panel",
        name: "RightPanelModule"
    } ];
    var SEGMENTED_CONTROL_MODULE = [ {
        from: "@wm/mobile/components/containers/segmented-control",
        name: "SegmentedControlModule"
    } ];
    var SLIDER_MODULE = __spread(NG_FORM_MODULE, [ {
        from: "@wm/components/input/slider",
        name: "SliderModule"
    } ]);
    var TABS_MODULE = [ {
        from: "@wm/components/containers/tabs",
        name: "TabsModule"
    } ];
    var TABLE_MODULE = __spread(NG_FORM_MODULE, NG_REACTIVE_FORM_MODULE, PAGINATION_MODULE, MENU_MODULE, BASIC_MODULE, INPUT_MODULE, NGX_TOOL_TIP_MODULE, LIST_MODULE, [ {
        from: "@wm/components/data/table",
        name: "TableModule"
    } ]);
    var TILE_MODULE = [ {
        from: "@wm/components/containers/tile",
        name: "TileModule"
    } ];
    var TOP_NAV_MODULE = [ {
        from: "@wm/components/page/top-nav",
        name: "TopNavModule"
    } ];
    var TREE_MODULE = [ {
        from: "@wm/components/basic/tree",
        name: "TreeModule"
    } ];
    var WIZARD_MODULE = __spread(NG_FORM_MODULE, [ {
        from: "@wm/components/containers/wizard",
        name: "WizardModule"
    } ]);
    var LIVE_TABLE_MODULE = __spread(TABLE_MODULE, [ {
        from: "@wm/components/data/live-table",
        name: "LiveTableModule"
    } ]);
    var FORM_MODULE = __spread(NG_FORM_MODULE, NG_REACTIVE_FORM_MODULE, BASIC_MODULE, INPUT_MODULE, PAGE_MODULE, DESIGN_DIALOG_MODULE, [ {
        from: "@wm/components/data/form",
        name: "FormModule"
    } ]);
    var WIDGET_IMPORTS = new Map([ [ "wm-accordion", ACCORDION_MODULE ], [ "wm-accordionpane", ACCORDION_MODULE ], [ "wm-anchor", BASIC_MODULE ], [ "wm-alertdialog", ALERT_DIALOG_MODULE ], [ "wm-audio", BASIC_MODULE ], [ "wm-barcodescanner", BARCODE_SCANNER_MODULE ], [ "wm-button", INPUT_MODULE ], [ "wm-buttongroup", INPUT_MODULE ], [ "wm-breadcrumb", BREAD_CRUMB_MODULE ], [ "wm-camera", CAMERA_MODULE ], [ "wm-calendar", CALENDAR_MODULE ], [ "wm-card", CARD_MODULE ], [ "wm-card-actions", CARD_MODULE ], [ "wm-card-content", CARD_MODULE ], [ "wm-card-footer", CARD_MODULE ], [ "wm-carousel", CAROUSEL_MODULE ], [ "wm-carousel-content", CAROUSEL_MODULE ], [ "wm-carousel-template", CAROUSEL_MODULE ], [ "wm-chart", CHART_MODULE ], [ "wm-checkbox", INPUT_MODULE ], [ "wm-checkboxset", INPUT_MODULE ], [ "wm-chips", CHIPS_MODULE ], [ "wm-colorpicker", COLOR_PICKER_MODULE ], [ "wm-confirmdialog", CONFIRM_DIALOG_MODULE ], [ "wm-content", CONTENT_MODULE ], [ "wm-currency", CURRENCY_MODULE ], [ "wm-date", EPOCH_MODULE ], [ "wm-datetime", EPOCH_MODULE ], [ "wm-dialog", DESIGN_DIALOG_MODULE ], [ "wm-footer", FOOTER_MODULE ], [ "wm-form", FORM_MODULE ], [ "wm-form-action", FORM_MODULE ], [ "wm-form-field", FORM_MODULE ], [ "wm-filter-field", FORM_MODULE ], [ "wm-fileupload", FILE_UPLOAD_MODULE ], [ "wm-gridrow", LAYOUT_GRID_MODULE ], [ "wm-gridcolumn", LAYOUT_GRID_MODULE ], [ "wm-header", HEADER_MODULE ], [ "wm-html", BASIC_MODULE ], [ "wm-icon", BASIC_MODULE ], [ "wm-iframe", BASIC_MODULE ], [ "wm-iframedialog", IFRAME_DIALOG_MODULE ], [ "wm-label", BASIC_MODULE ], [ "wm-layoutgrid", LAYOUT_GRID_MODULE ], [ "wm-left-panel", LEFT_PANEL_MODULE ], [ "wm-list", LIST_MODULE ], [ "wm-livetable", LIVE_TABLE_MODULE ], [ "wm-login", LOGIN_MODULE ], [ "wm-logindialog", LOGIN_DIALOG_MODULE ], [ "wm-marquee", MARQUEE_MODULE ], [ "wm-menu", MENU_MODULE ], [ "wm-media-list", MEDIA_LIST_MODULE ], [ "wm-mobile-navbar", MOBILE_NAV_BAR_MODULE ], [ "wm-mobile-tabbar", MOBILE_TAB_BAR_MODULE ], [ "wm-nav", MENU_MODULE ], [ "wm-navbar", NAVBAR_MODULE ], [ "wm-nav-item", MENU_MODULE ], [ "wm-network-info-toaster", BASIC_MODULE ], [ "wm-number", INPUT_MODULE ], [ "wm-page", PAGE_MODULE ], [ "wm-page-content", PAGE_MODULE ], [ "wm-pagedialog", PARTIAL_DIALOG_MODULE ], [ "wm-pagination", PAGINATION_MODULE ], [ "wm-panel", PANEL_MODULE ], [ "wm-panel-footer", PANEL_MODULE ], [ "wm-picture", BASIC_MODULE ], [ "wm-popover", POPOVER_MODULE ], [ "wm-progress-bar", PROGRESS_MODULE ], [ "wm-prefab", PREFAB_MODULE ], [ "wm-prefab-container", PREFAB_MODULE ], [ "wm-progress-circle", PROGRESS_MODULE ], [ "wm-radioset", INPUT_MODULE ], [ "wm-rating", RATING_MODULE ], [ "wm-richtexteditor", RICH_TEXT_EDITOR_MODULE ], [ "wm-right-panel", RIGHT_PANEL_MODULE ], [ "wm-select", INPUT_MODULE ], [ "wm-search", SEARCH_MODULE ], [ "wm-segmented-content", SEGMENTED_CONTROL_MODULE ], [ "wm-segmented-control", SEGMENTED_CONTROL_MODULE ], [ "wm-slider", SLIDER_MODULE ], [ "wm-spinner", BASIC_MODULE ], [ "wm-switch", INPUT_MODULE ], [ "wm-table", TABLE_MODULE ], [ "wm-tabs", TABS_MODULE ], [ "wm-tabpane", TABS_MODULE ], [ "wm-text", INPUT_MODULE ], [ "wm-textarea", INPUT_MODULE ], [ "wm-time", EPOCH_MODULE ], [ "wm-tile", TILE_MODULE ], [ "wm-top-nav", TOP_NAV_MODULE ], [ "wm-tree", TREE_MODULE ], [ "wm-video", BASIC_MODULE ], [ "wm-wizard", WIZARD_MODULE ], [ "wm-wizardstep", WIZARD_MODULE ] ]);
    var CSS_REGEX = {
        COMMENTS_FORMAT: /\/\*((?!\*\/).|\n)+\*\//g,
        SELECTOR_FORMAT: /[^\{\}]*\{/gi,
        SELECTOR_EXCLUDE_FORMAT: /(@keyframes|@media|@font-face|@comment[0-9]+|from|to|[0-9]+%)\b/i
    };
    var isString = function(v) {
        return typeof v === "string";
    };
    var OVERRIDES = {
        accessroles: "*accessroles",
        "ng-if": "*ngIf",
        showindevice: "showInDevice",
        "ng-class": "[ngClass]",
        "data-ng-class": "[ngClass]",
        "data-ng-src": "src",
        "ng-src": "src",
        "data-ng-href": "href",
        "ng-href": "href",
        "ng-disabled": "disabled",
        "data-ng-disabled": "disabled",
        "ng-model": '[ngModelOptions]="{standalone: true}" [(ngModel)]'
    };
    var getBoundToExpr = function(value) {
        if (!value) {
            return null;
        }
        value = value.trim();
        if (value.startsWith("bind:")) {
            return value.substr(5);
        }
    };
    var quoteAttr = function(v) {
        return ("" + v).replace(/&/g, "&amp;").replace(/'/g, "&apos;").replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
    };
    var registry = new Map();
    var htmlParser = new compiler.HtmlParser();
    var empty = function() {
        return "";
    };
    var isEvent = function(name) {
        return name[0] === "o" && name[1] === "n" && name[2] === "-";
    };
    var getEventName = function(key) {
        return key.substr(3);
    };
    var processBinding = function(attr, expr) {
        return [ attr.name + ".bind", quoteAttr(expr) ];
    };
    var processEvent = function(attr) {
        var evtName = getEventName(attr.name);
        return [ evtName + ".event", attr.value ];
    };
    var wrapWithApos = function(val) {
        return "&apos;" + val.replace(/&apos/g, "&quot").replace(/&quot/g, "\\&quot") + "&apos;";
    };
    var processAttr = function(attr) {
        var overridden = OVERRIDES[attr.name];
        var value = attr.valueSpan ? attr.value : undefined;
        if (overridden) {
            if (attr.name === "accessroles") {
                return [ overridden, "'" + value + "'" ];
            }
            return [ overridden, quoteAttr(value) ];
        }
        if (isEvent(attr.name)) {
            return processEvent(attr);
        }
        var boundExpr = getBoundToExpr(attr.value);
        if (boundExpr) {
            return processBinding(attr, boundExpr);
        }
        return [ attr.name, quoteAttr(value) ];
    };
    var getDataSource = function(dataSetExpr) {
        var parts = dataSetExpr.split(".");
        if (parts[0] === "Variables" || parts[0] === "Widgets") {
            return parts[0] + "." + parts[1];
        }
    };
    var getFormMarkupAttr = function(attrs) {
        if (attrs.get("datavalue.bind")) {
            var onDataValueBinding = getDataSource(attrs.get("datavalue.bind"));
            attrs.set("datavaluesource.bind", onDataValueBinding);
        }
        return getAttrMarkup(attrs);
    };
    var getAttrMap = function(attrs) {
        var attrMap = new Map();
        attrs.forEach(function(attr) {
            var _a = __read(processAttr(attr), 2), attrName = _a[0], attrValue = _a[1];
            attrMap.set(attrName, attrValue);
        });
        if (attrMap.get("dataset.bind")) {
            var dataSource = getDataSource(attrMap.get("dataset.bind"));
            if (dataSource) {
                attrMap.set("datasource.bind", dataSource);
            }
        }
        return attrMap;
    };
    var getAttrMarkup = function(attrs) {
        var attrMarkup = "";
        attrs.forEach(function(v, k) {
            attrMarkup += " " + k;
            if (v) {
                v = v.trim();
                if (k === "[ngClass]" && v.startsWith("{")) {
                    v = v.replace(/"/g, "'");
                }
                if (k === "show.bind" && attrs.get("deferload") === "true") {
                    v = v + ('" *lazyLoad="' + wrapWithApos(v));
                }
                attrMarkup += '="' + v + '"';
            }
        });
        return attrMarkup;
    };
    var getRequiredProviders = function(nodeDef, providers, nodeAttrs) {
        if (!nodeDef.requires) {
            return [];
        }
        var requires = nodeDef.requires;
        if (isString(requires)) {
            requires = [ requires ];
        }
        if (!Array.isArray(requires)) {
            return [];
        }
        return requires.map(function(require) {
            for (var i = nodeAttrs.length - 1; i >= 0; i--) {
                if (nodeAttrs[i].name === "tableName") {
                    return nodeDef[nodeAttrs[i].value];
                }
            }
            for (var i = providers.length - 1; i >= 0; i--) {
                if (providers[i].nodeName === require) {
                    return providers[i].provide;
                }
            }
        });
    };
    var DIMENSION_PROPS = [ "padding", "borderwidth", "margin" ];
    var SEPARATOR = " ";
    var UNSET = "unset";
    var setDimensionProp = function(cssObj, key, nv) {
        var cssKey = key;
        var val;
        var top;
        var right;
        var bottom;
        var left;
        var suffix = "";
        function setVal(prop, value) {
            if (value === UNSET) {
                value = "";
            }
            cssObj[cssKey + prop + suffix] = value;
        }
        if (key === "borderwidth") {
            suffix = "width";
            cssKey = "border";
        }
        val = nv;
        if (val.indexOf(UNSET) !== -1) {
            val = val.split(SEPARATOR);
            top = val[0];
            right = val[1] || val[0];
            bottom = val[2] || val[0];
            left = val[3] || val[1] || val[0];
            setVal("top", top);
            setVal("right", right);
            setVal("bottom", bottom);
            setVal("left", left);
        } else {
            if (key === "borderwidth") {
                cssKey = "borderwidth";
            }
            cssObj[cssKey] = nv;
        }
    };
    var processDimensionAttributes = function(attrMap) {
        var attrKeys = Array.from(attrMap.keys());
        attrKeys.forEach(function(attrKey) {
            if (DIMENSION_PROPS.includes(attrKey)) {
                var cssObj_1 = {};
                var attrValue = attrMap.get(attrKey);
                attrMap.delete(attrKey);
                setDimensionProp(cssObj_1, attrKey, attrValue);
                Object.keys(cssObj_1).forEach(function(key) {
                    if (cssObj_1[key]) {
                        attrMap.set(key, cssObj_1[key]);
                    }
                });
            }
        });
    };
    var getNodeName = function(name) {
        return name.replace(":svg:svg", "svg").replace(":svg:", "svg:");
    };
    var processNode = function(node, importCollector, providers) {
        var nodeDef = registry.get(node.name);
        var pre;
        var post;
        var template;
        if (nodeDef) {
            pre = nodeDef.pre || empty;
            post = nodeDef.post || empty;
            template = nodeDef.template || empty;
        }
        var markup = "";
        var attrMap;
        var requiredProviders;
        var shared;
        if (!providers) {
            providers = [];
        }
        var isElementType = node instanceof compiler.Element;
        if (isElementType) {
            var provideInfo = void 0;
            if (nodeDef) {
                requiredProviders = getRequiredProviders(nodeDef, providers, node.attrs);
                shared = new Map();
                template.apply(void 0, __spread([ node, shared ], requiredProviders));
            }
            attrMap = getAttrMap(node.attrs);
            processDimensionAttributes(attrMap);
            var nodeName = getNodeName(node.name);
            if (nodeDef) {
                markup = pre.apply(void 0, __spread([ attrMap, shared ], requiredProviders));
                if (nodeDef.provide) {
                    provideInfo = {
                        nodeName: node.name,
                        provide: _.isFunction(nodeDef.provide) ? nodeDef.provide.apply(nodeDef, __spread([ attrMap, shared ], requiredProviders)) : nodeDef.provide
                    };
                    if (node.name === "wm-table") {
                        var tableColNodeDefn = registry.get("wm-table-column");
                        tableColNodeDefn[_.find(node.attrs, function(el) {
                            return el.name === "name";
                        }).value] = provideInfo.provide;
                        registry.set("wm-table-column", tableColNodeDefn);
                    }
                    providers.push(provideInfo);
                }
            } else {
                markup = "<" + nodeName + " " + getAttrMarkup(attrMap) + ">";
            }
            node.children.forEach(function(child) {
                return markup += processNode(child, importCollector, providers);
            });
            if (nodeDef) {
                if (provideInfo) {
                    providers.splice(providers.indexOf(provideInfo), 1);
                }
                markup += post.apply(void 0, __spread([ attrMap, shared ], requiredProviders));
            } else {
                if (node.endSourceSpan && !compiler.getHtmlTagDefinition(node.name).isVoid) {
                    markup += "</" + nodeName + ">";
                }
            }
        } else if (node instanceof compiler.Text) {
            markup += node.value;
        }
        importCollector(WIDGET_IMPORTS.get(node.name));
        if (nodeDef && nodeDef.imports) {
            var imports = [];
            if (typeof nodeDef.imports === "function") {
                imports = nodeDef.imports(attrMap);
            } else {
                imports = nodeDef.imports;
            }
            imports.forEach(function(i) {
                importCollector(WIDGET_IMPORTS.get(i));
            });
        }
        return markup;
    };
    var transpile = function(markup) {
        if (markup === void 0) {
            markup = "";
        }
        var e_1, _a;
        if (!markup.length) {
            return;
        }
        var requiredWMComponents = [];
        var nodes = htmlParser.parse(markup, "");
        if (nodes.errors.length) {
            return;
        }
        var output = "";
        try {
            for (var _b = __values(nodes.rootNodes), _c = _b.next(); !_c.done; _c = _b.next()) {
                var node = _c.value;
                output += processNode(node, function(imports) {
                    if (imports) {
                        requiredWMComponents = requiredWMComponents.concat(imports);
                    }
                });
            }
        } catch (e_1_1) {
            e_1 = {
                error: e_1_1
            };
        } finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            } finally {
                if (e_1) throw e_1.error;
            }
        }
        requiredWMComponents = _.uniqWith(requiredWMComponents, _.isEqual);
        requiredWMComponents = _.sortBy(requiredWMComponents, [ "from", "name" ]);
        return {
            markup: output,
            requiredWMComponents: requiredWMComponents
        };
    };
    var register = function(nodeName, nodeDefFn) {
        return registry.set(nodeName, nodeDefFn());
    };
    var scopeComponentStyles = function(componentName, componentType, styles) {
        if (styles === void 0) {
            styles = "";
        }
        componentName = componentName.toLowerCase();
        var comments = {};
        var commentCount = 0;
        if (styles.startsWith("/*DISABLE_SCOPING*/")) {
            return styles;
        }
        styles = styles.replace(CSS_REGEX.COMMENTS_FORMAT, function(comment) {
            var key = "@comment" + commentCount++ + "{";
            comments[key] = comment;
            return key;
        });
        styles = styles.replace(CSS_REGEX.SELECTOR_FORMAT, function(selector) {
            if (!CSS_REGEX.SELECTOR_EXCLUDE_FORMAT.test(selector)) {
                var firstNonSpaceCharIndex = selector.match(/\S/).index;
                var prefixSpaceCharSeq = "";
                if (firstNonSpaceCharIndex > 0) {
                    prefixSpaceCharSeq = selector.substring(0, firstNonSpaceCharIndex);
                    selector = selector.substring(firstNonSpaceCharIndex);
                }
                if (!selector.startsWith("/*") && selector.trim().length > 0) {
                    selector = selector.split(",").map(function(s) {
                        var spaceIndex = selector.indexOf(" ");
                        s = s.trim();
                        if (s.startsWith(".wm-app")) {
                            if (spaceIndex > 0) {
                                s = s.substring(spaceIndex + 1);
                            } else {
                                return selector;
                            }
                        }
                        if (componentType === 0 || componentType === "PAGE") {
                            s = ".wm-app app-page-" + componentName + " " + s;
                        } else if (componentType === 1 || componentType === "PREFAB") {
                            s = ".wm-app app-prefab-" + componentName + " " + s;
                        } else if (componentType === 2 || componentType === "PARTIAL") {
                            s = ".wm-app app-partial-" + componentName + " " + s;
                        }
                        return s;
                    }).join(",");
                }
                selector = prefixSpaceCharSeq + selector;
            }
            return selector;
        });
        for (var key in comments) {
            styles = styles.replace(key, comments[key]);
        }
        return styles;
    };
    exports.getBoundToExpr = getBoundToExpr;
    exports.getDataSource = getDataSource;
    exports.getFormMarkupAttr = getFormMarkupAttr;
    exports.getAttrMarkup = getAttrMarkup;
    exports.processNode = processNode;
    exports.transpile = transpile;
    exports.register = register;
    exports.scopeComponentStyles = scopeComponentStyles;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("rxjs"), require("@wm/core"), require("@angular/common/http")) : typeof define === "function" && define.amd ? define("@wm/http", [ "exports", "@angular/common", "@angular/core", "rxjs", "@wm/core", "@angular/common/http" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.http = {}), global.ng.common, global.ng.core, global.rxjs, global.wm.core, global.ng.common.http);
})(this, function(exports, common, core, rxjs, core$1, http) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    var HttpServiceImpl = function(_super) {
        __extends(HttpServiceImpl, _super);
        function HttpServiceImpl(httpClient) {
            var _this = _super.call(this) || this;
            _this.httpClient = httpClient;
            _this.nonBodyTypeMethods = [ "GET", "DELETE", "HEAD", "OPTIONS", "JSONP" ];
            _this.sessionTimeoutObservable = new rxjs.Subject();
            _this.sessionTimeoutQueue = [];
            return _this;
        }
        HttpServiceImpl.prototype.handleSessionTimeout = function(options, subscriber401) {
            this.sessionTimeoutQueue.push({
                requestInfo: options,
                sub401: subscriber401
            });
            this.on401();
        };
        HttpServiceImpl.prototype.generateRequest = function(options) {
            var reqHeaders = new http.HttpHeaders();
            var reqParams = new http.HttpParams();
            var headers = options.headers;
            var params = options.params;
            var responseType = options.responseType;
            var withCredentials = options.withCredentials;
            if (!options.isDirectCall) {
                reqHeaders = reqHeaders.append("X-Requested-With", "XMLHttpRequest");
            }
            if (headers) {
                Object.entries(headers).forEach(function(_a) {
                    var _b = __read(_a, 2), k = _b[0], v = _b[1];
                    return reqHeaders = reqHeaders.append(k, v);
                });
            }
            if (params) {
                Object.entries(params).forEach(function(_a) {
                    var _b = __read(_a, 2), k = _b[0], v = _b[1];
                    return reqParams = reqParams.append(k, v);
                });
            }
            var third;
            var fourth;
            var reqOptions = {
                headers: reqHeaders,
                params: reqParams,
                responseType: responseType,
                withCredentials: withCredentials
            };
            if (_.includes(this.nonBodyTypeMethods, options.method && options.method.toUpperCase()) && options.data === undefined) {
                third = reqOptions;
                fourth = null;
            } else {
                third = options.data;
                fourth = reqOptions;
            }
            return new http.HttpRequest(options.method, options.url, third, fourth);
        };
        HttpServiceImpl.prototype.getErrMessage = function(err) {
            var HTTP_STATUS_MSG = {
                404: this.getLocale()["MESSAGE_404_ERROR"] || "Requested resource not found",
                401: this.getLocale()["MESSAGE_401_ERROR"] || "Requested resource requires authentication",
                403: this.getLocale()["LABEL_FORBIDDEN_MESSAGE"] || "The requested resource access/action is forbidden."
            };
            var errMsg = HTTP_STATUS_MSG[err.status];
            var errorDetails = err.error;
            errorDetails = core$1.getValidJSON(errorDetails) || errorDetails;
            if (errorDetails && errorDetails.errors) {
                errMsg = this.parseErrors(errorDetails.errors) || errMsg || "Service Call Failed";
            } else {
                errMsg = errMsg || "Service Call Failed";
            }
            return errMsg;
        };
        HttpServiceImpl.prototype.sendCallAsObservable = function(options) {
            var req = this.generateRequest(options);
            return this.httpClient.request(req);
        };
        HttpServiceImpl.prototype.send = function(options) {
            var _this = this;
            var req = this.generateRequest(options);
            return new Promise(function(resolve, reject) {
                _this.httpClient.request(req).toPromise().then(function(response) {
                    resolve(response);
                }, function(err) {
                    if (_this.isPlatformSessionTimeout(err)) {
                        err._401Subscriber.asObservable().subscribe(function(response) {
                            resolve(response);
                        }, function(e) {
                            reject(e);
                        });
                    } else {
                        var errMsg = _this.getErrMessage(err);
                        reject({
                            error: errMsg,
                            details: err
                        });
                    }
                });
            });
        };
        HttpServiceImpl.prototype.setLocale = function(locale) {
            this.localeObject = locale;
        };
        HttpServiceImpl.prototype.getLocale = function() {
            return this.localeObject;
        };
        HttpServiceImpl.prototype.parseErrors = function(errors) {
            var _this = this;
            var errMsg = "";
            if (errors && errors.error && errors.error.length) {
                errors.error.forEach(function(errorDetails, i) {
                    errMsg += _this.parseError(errorDetails) + (i > 0 ? "\n" : "");
                });
            }
            return errMsg;
        };
        HttpServiceImpl.prototype.parseError = function(errorObj) {
            var errMsg;
            errMsg = errorObj.message ? core$1.replace(errorObj.message, errorObj.parameters, true) : errorObj.parameters && errorObj.parameters[0] || "";
            return errMsg;
        };
        HttpServiceImpl.prototype.getHeader = function(error, headerKey) {
            return error.headers.get(headerKey);
        };
        HttpServiceImpl.prototype.isPlatformSessionTimeout = function(error) {
            var MSG_SESSION_NOT_FOUND = "Session Not Found";
            return error.status === 401 && this.getHeader(error, "x-wm-login-errormessage") === MSG_SESSION_NOT_FOUND;
        };
        HttpServiceImpl.prototype.get = function(url, options) {
            options = options || {};
            options.url = url;
            options.method = "get";
            return this.send(options).then(function(response) {
                return response.body;
            });
        };
        HttpServiceImpl.prototype.post = function(url, data, options) {
            options = options || {};
            options.url = url;
            options.method = "post";
            options.data = data;
            return this.send(options);
        };
        HttpServiceImpl.prototype.put = function(url, data, options) {
            options = options || {};
            options.url = url;
            options.method = "put";
            options.data = data;
            return this.send(options);
        };
        HttpServiceImpl.prototype.patch = function(url, data, options) {
            options = options || {};
            options.url = url;
            options.method = "patch";
            options.data = data;
            return this.send(options);
        };
        HttpServiceImpl.prototype.delete = function(url, options) {
            options = options || {};
            options.url = url;
            options.method = "delete";
            return this.send(options);
        };
        HttpServiceImpl.prototype.head = function(url, options) {
            options = options || {};
            options.url = url;
            options.method = "head";
            return this.send(options);
        };
        HttpServiceImpl.prototype.jsonp = function(url, options) {
            options = options || {};
            options.url = url;
            options.method = "jsonp";
            return this.send(options);
        };
        HttpServiceImpl.prototype.upload = function(url, data, options) {
            var req = new http.HttpRequest("POST", url, data, {
                reportProgress: true
            });
            return this.httpClient.request(req);
        };
        HttpServiceImpl.prototype.registerOnSessionTimeout = function(callback) {
            this.sessionTimeoutObservable.asObservable().subscribe(callback);
        };
        HttpServiceImpl.prototype.on401 = function() {
            this.sessionTimeoutObservable.next();
        };
        HttpServiceImpl.prototype.pushToSessionFailureQueue = function(callback) {
            this.sessionTimeoutQueue.push({
                callback: callback
            });
        };
        HttpServiceImpl.prototype.executeSessionFailureRequests = function() {
            var queue = this.sessionTimeoutQueue;
            var that = this;
            that.sessionTimeoutQueue = [];
            queue.forEach(function(data) {
                if (_.isFunction(data.callback)) {
                    data.callback();
                } else {
                    data.requestInfo.headers.headers.delete("x-wm-xsrf-token");
                    that.httpClient.request(data.requestInfo).subscribe(function(response) {
                        if (response && response.type && data.sub401) {
                            data.sub401.next(response);
                        }
                    }, function(reason) {
                        data.sub401.error(reason);
                    });
                }
            });
        };
        HttpServiceImpl.decorators = [ {
            type: core.Injectable
        } ];
        HttpServiceImpl.ctorParameters = function() {
            return [ {
                type: http.HttpClient
            } ];
        };
        return HttpServiceImpl;
    }(core$1.AbstractHttpService);
    var WmHttpRequest = function() {
        function WmHttpRequest() {
            this.headers = [];
        }
        WmHttpRequest.prototype.wmToAngularRequest = function(reqObj) {
            var angReq;
            angReq = new http.HttpRequest(reqObj.method, reqObj.url);
            angReq = angReq.clone();
            angReq.body = reqObj.body;
            angReq.method = reqObj.method;
            angReq.responseType = reqObj.responseType;
            angReq.urlWithParams = reqObj.url;
            angReq.withCredentials = reqObj.withCredentials;
            reqObj.headers.forEach(function(value, header) {
                angReq.headers = angReq.headers.append(header, value);
            });
            return angReq;
        };
        WmHttpRequest.prototype.angularToWmRequest = function(req) {
            var wmReq = new WmHttpRequest();
            var headerMap = new Map();
            wmReq.body = req.body;
            wmReq.method = req.method;
            wmReq.responseType = req.responseType;
            wmReq.url = req.urlWithParams;
            wmReq.withCredentials = req.withCredentials;
            req.headers.keys().forEach(function(header) {
                headerMap.set(header, req.headers.headers.get(header.toLowerCase())[0]);
            });
            wmReq.headers = headerMap;
            return wmReq;
        };
        return WmHttpRequest;
    }();
    var WmHttpResponse = function(_super) {
        __extends(WmHttpResponse, _super);
        function WmHttpResponse() {
            return _super.call(this) || this;
        }
        WmHttpResponse.prototype.wmToAngularResponse = function(respObj) {
            var angResp;
            angResp = new http.HttpResponse();
            angResp = angResp.clone();
            angResp.body = respObj.body;
            angResp.error = respObj.error;
            angResp.message = respObj.message;
            angResp.url = respObj.url;
            angResp.ok = respObj.ok;
            angResp.status = respObj.status;
            angResp.statusText = respObj.statusText;
            respObj.headers.forEach(function(value, header) {
                angResp.headers = angResp.headers.append(header, value);
            });
            return angResp;
        };
        WmHttpResponse.prototype.angularToWmResponse = function(respObj) {
            var wmResp;
            var headerMap = new Map();
            wmResp = new WmHttpResponse();
            wmResp.body = respObj.body;
            wmResp.error = respObj.error;
            wmResp.message = respObj.message;
            wmResp.url = respObj.url;
            wmResp.ok = respObj.ok;
            wmResp.status = respObj.status;
            wmResp.statusText = respObj.statusText;
            respObj.headers.keys().forEach(function(header) {
                headerMap.set(header, respObj.headers.headers.get(header.toLowerCase())[0]);
            });
            wmResp.headers = headerMap;
            return wmResp;
        };
        return WmHttpResponse;
    }(WmHttpRequest);
    var HttpServiceModule = function() {
        function HttpServiceModule() {}
        HttpServiceModule.forRoot = function() {
            return {
                ngModule: common.CommonModule,
                providers: [ {
                    provide: core$1.AbstractHttpService,
                    useClass: HttpServiceImpl
                } ]
            };
        };
        HttpServiceModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, http.HttpClientModule ],
                declarations: []
            } ]
        } ];
        return HttpServiceModule;
    }();
    exports.HttpServiceModule = HttpServiceModule;
    exports.HttpServiceImpl = HttpServiceImpl;
    exports.WmHttpRequest = WmHttpRequest;
    exports.WmHttpResponse = WmHttpResponse;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/core"), require("rxjs"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/oAuth", [ "exports", "@angular/core", "rxjs", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.oAuth = {}), global.ng.core, global.rxjs, global.wm.core);
})(this, function(exports, core, rxjs, core$1) {
    "use strict";
    var accessTokenSuffix = ".access_token";
    var parseConfig = function(serviceParams) {
        var val, param, config;
        var urlParams = serviceParams.urlParams;
        config = {
            url: "services/oauth2/:providerId/authorizationUrl",
            method: "GET"
        };
        if (serviceParams.config) {
            config.url = (serviceParams.config.url || "") + config.url;
            config.method = serviceParams.config.method || config.method;
            config.headers = config.headers || {};
            for (var key in serviceParams.config.headers) {
                val = serviceParams.config.headers[key];
                config.headers[key] = val;
            }
        }
        if (urlParams) {
            for (param in urlParams) {
                if (urlParams.hasOwnProperty(param)) {
                    val = urlParams[param];
                    if (!_.isUndefined(val) && val !== null) {
                        config.url = config.url.replace(new RegExp(":" + param, "g"), val);
                    }
                }
            }
        }
        if (serviceParams.params) {
            config.params = serviceParams.params;
        }
        if (!_.isUndefined(serviceParams.data)) {
            config.data = serviceParams.data;
        }
        if (serviceParams.dataParams) {
            config.data.params = serviceParams.dataParams;
        }
        if (serviceParams.headers) {
            config.headers = serviceParams.headers;
        }
        config.byPassResult = serviceParams.byPassResult;
        config.isDirectCall = serviceParams.isDirectCall;
        config.isExtURL = serviceParams.isExtURL;
        config.preventMultiple = serviceParams.preventMultiple;
        config.responseType = serviceParams.responseType;
        return config;
    };
    var listeners = {}, ACCESSTOKEN_PLACEHOLDERS = {
        STUDIO: "WM_STUDIO_",
        RUN: "WM_RUN_"
    }, newWindowProps = "width=400,height=600";
    var removeAccessToken = function(provider) {
        var accessTokenKey = getAccessTokenPlaceholder(provider);
        sessionStorage.removeItem(accessTokenKey);
    };
    function getAccessTokenPlaceholder(provider) {
        var accessTokenKey;
        accessTokenKey = ACCESSTOKEN_PLACEHOLDERS.RUN + core$1._WM_APP_PROJECT.id + "_" + provider + accessTokenSuffix;
        return accessTokenKey;
    }
    function performFakeLocalStorageUpdate() {
        var dummy_key = "dummy_key";
        localStorage.setItem(dummy_key, dummy_key);
        localStorage.removeItem(dummy_key);
    }
    function setAccessToken(provider, accesstoken) {
        var accessTokenKey = getAccessTokenPlaceholder(provider);
        sessionStorage.setItem(accessTokenKey, accesstoken);
    }
    function checkAuthenticationStatus(providerId, successCallback, removeProviderConfigCallBack, evt) {
        var accessTokenKey = providerId + accessTokenSuffix, accessToken = localStorage.getItem(accessTokenKey);
        if (evt && evt.origin !== window.location.origin) {
            return;
        }
        if (accessToken) {
            removeProviderConfigCallBack(providerId);
            localStorage.removeItem(accessTokenKey);
            setAccessToken(providerId, accessToken);
            window.removeEventListener("message", listeners[providerId]);
            setTimeout(function() {
                delete listeners[providerId];
                if (successCallback) {
                    successCallback(accessToken);
                }
            });
        }
    }
    function checkAccessTokenInWindow(providerId, onSuccess, onError, startTime, loginObj, removeProviderConfigCallBack) {
        performFakeLocalStorageUpdate();
        var currentTime = moment.duration(moment().format("HH:mm"), "HH:mm"), timeDiff = currentTime.subtract(startTime), accessToken = getAccessToken(providerId, true);
        if (accessToken) {
            loginObj.accesstoken_retrieved = true;
            setAccessToken(providerId, accessToken);
            localStorage.removeItem(providerId + accessTokenSuffix);
            removeProviderConfigCallBack(providerId);
            if (onSuccess) {
                onSuccess();
            }
        } else if (timeDiff.minutes() > 1 && onSuccess && !loginObj.accesstoken_retrieved) {
            onSuccess("error");
        } else {
            setTimeout(function() {
                checkAccessTokenInWindow(providerId, onSuccess, onError, startTime, loginObj, removeProviderConfigCallBack);
            }, 3e3);
        }
    }
    function checkForWindowExistence(oAuthWindow, provider, callback) {
        if (oAuthWindow && listeners[provider]) {
            if (!oAuthWindow.closed) {
                setTimeout(checkForWindowExistence.bind(undefined, oAuthWindow, provider, callback), 3e3);
            } else {
                window.removeEventListener("message", listeners[provider]);
                delete listeners[provider];
                if (callback) {
                    callback("error");
                }
            }
        }
    }
    function handleLoginForIE(url, providerId, onSuccess, onError, removeProviderConfigCallBack) {
        var loginObj = {
            accesstoken_retrieved: false
        };
        window.open(url, "_blank", newWindowProps);
        checkAccessTokenInWindow(providerId, onSuccess, onError, moment.duration(moment().format("HH:mm"), "HH:mm"), loginObj, removeProviderConfigCallBack);
    }
    function onAuthWindowOpen(provider, callback, removeProviderConfigCallBack) {
        listeners[provider] = checkAuthenticationStatus.bind(undefined, provider, callback, removeProviderConfigCallBack);
        window.addEventListener("message", listeners[provider], false);
    }
    function postGetAuthorizationURL(url, providerId, onSuccess, removeProviderConfigCallBack) {
        var oAuthWindow;
        if (core$1.hasCordova()) {
            window.open(url, "_system");
            window["OAuthInMobile"](providerId).then(function(accessToken) {
                var key = providerId + accessTokenSuffix;
                if (accessToken) {
                    localStorage.setItem(key, accessToken);
                    checkAuthenticationStatus(providerId, onSuccess, removeProviderConfigCallBack, null);
                } else {
                    onSuccess("error");
                }
            });
        } else {
            oAuthWindow = window.open(url, "_blank", newWindowProps);
            onAuthWindowOpen(providerId, onSuccess, removeProviderConfigCallBack);
            checkForWindowExistence(oAuthWindow, providerId, onSuccess);
        }
    }
    function getAuthorizationUrl(params, http) {
        var action = "getAuthorizationUrl", serviceSettings = parseConfig({
            target: "oauthConfiguration",
            action: action,
            urlParams: {
                projectId: core$1._WM_APP_PROJECT.id,
                providerId: params.providerId
            },
            params: {
                requestSourceType: params.requestSourceType
            }
        });
        return http.send(serviceSettings);
    }
    var getAccessToken = function(provider, checkLocalStorage) {
        var accessTokenKey = getAccessTokenPlaceholder(provider);
        if (checkLocalStorage) {
            return localStorage.getItem(provider + accessTokenSuffix);
        }
        return sessionStorage.getItem(accessTokenKey);
    };
    var performAuthorization = function(url, providerId, onSuccess, onError, http, addProviderConfigCallBack, removeProviderConfigCallBack) {
        var requestSourceType = "WEB";
        if (url) {
            if (core$1.isIE()) {
                handleLoginForIE(url, providerId, onSuccess, onError, removeProviderConfigCallBack);
            } else {
                postGetAuthorizationURL(url, providerId, onSuccess, removeProviderConfigCallBack);
            }
        } else {
            if (window["WaveLens"]) {
                requestSourceType = "WAVELENS";
            } else if (core$1.hasCordova()) {
                requestSourceType = "MOBILE";
            }
            return getAuthorizationUrl({
                providerId: providerId,
                requestSourceType: requestSourceType
            }, http).then(function(response) {
                addProviderConfigCallBack({
                    name: providerId,
                    url: response.body,
                    invoke: function() {
                        if (core$1.isIE()) {
                            handleLoginForIE(response, providerId, onSuccess, onError, removeProviderConfigCallBack);
                        } else {
                            postGetAuthorizationURL(response.body, providerId, onSuccess, removeProviderConfigCallBack);
                        }
                    }
                });
            });
        }
    };
    var OAuthService = function() {
        function OAuthService(httpService) {
            this.httpService = httpService;
            this.providers = new rxjs.Subject();
            this.providersConfig = [];
        }
        OAuthService.prototype.getOAuthProvidersAsObservable = function() {
            return this.providers.asObservable();
        };
        OAuthService.prototype.addProviderConfig = function(provider) {
            if (!_.find(this.providersConfig, {
                name: provider.name
            })) {
                this.providersConfig.push(provider);
            }
            this.providers.next(this.providersConfig);
        };
        OAuthService.prototype.removeProviderConfig = function(providerId) {
            _.remove(this.providersConfig, function(provider) {
                return provider.name === providerId;
            });
            this.providers.next(this.providersConfig);
        };
        OAuthService.prototype.perfromOAuthorization = function(url, providerId, onSuccess, onError) {
            performAuthorization(url, providerId, onSuccess, onError, this.httpService, this.addProviderConfig.bind(this), this.removeProviderConfig.bind(this));
        };
        OAuthService.prototype.getAccessToken = function(provider, checkLocalStorage) {
            return getAccessToken(provider, checkLocalStorage);
        };
        OAuthService.prototype.removeAccessToken = function(provider) {
            removeAccessToken(provider);
        };
        OAuthService.decorators = [ {
            type: core.Injectable
        } ];
        OAuthService.ctorParameters = function() {
            return [ {
                type: core$1.AbstractHttpService
            } ];
        };
        return OAuthService;
    }();
    var OAuthModule = function() {
        function OAuthModule() {}
        OAuthModule.forRoot = function() {
            return {
                ngModule: OAuthModule,
                providers: [ OAuthService ]
            };
        };
        OAuthModule.decorators = [ {
            type: core.NgModule,
            args: [ {} ]
        } ];
        return OAuthModule;
    }();
    exports.OAuthModule = OAuthModule;
    exports.OAuthService = OAuthService;
    exports.parseConfig = parseConfig;
    exports.removeAccessToken = removeAccessToken;
    exports.getAccessToken = getAccessToken;
    exports.performAuthorization = performAuthorization;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/core"), require("@angular/common"), require("@angular/router"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/security", [ "exports", "@angular/core", "@angular/common", "@angular/router", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.security = {}), global.ng.core, global.ng.common, global.ng.router, global.wm.core);
})(this, function(exports, core, common, router, core$1) {
    "use strict";
    var XSRF_COOKIE_NAME = "wm_xsrf_token";
    var SecurityService = function() {
        function SecurityService(injector, $http, routerService, activatedRoute, _location) {
            this.injector = injector;
            this.$http = $http;
            this.routerService = routerService;
            this.activatedRoute = activatedRoute;
            this._location = _location;
            this.requestQueue = {};
        }
        SecurityService.prototype.isLoaded = function() {
            return this.config;
        };
        SecurityService.prototype.get = function() {
            return this.config;
        };
        SecurityService.prototype.load = function() {
            var _this = this;
            if (this.loadPromise) {
                return this.loadPromise;
            }
            this.loadPromise = new Promise(function(resolve, reject) {
                _this.$http.send({
                    url: "./services/security/info",
                    method: "GET"
                }).then(function(response) {
                    _this.config = response.body;
                    _this.lastLoggedInUser = core$1.getClonedObject(_this.loggedInUser);
                    _this.loggedInUser = _this.config.userInfo;
                    resolve(response.body);
                }).catch(function(err) {
                    reject(err);
                }).finally(function() {
                    _this.loadPromise = null;
                });
            });
            return this.loadPromise;
        };
        SecurityService.prototype.getWebConfig = function(success, error) {
            if (this.get()) {
                core$1.triggerFn(success, this.get());
                return;
            }
            this.load().then(function(config) {
                core$1.triggerFn(success, config);
            }, error);
        };
        SecurityService.prototype.getConfig = function(successCallback, failureCallback) {
            function invokeQueuedCallbacks(id, method, data) {
                _.forEach(this.requestQueue[id], function(fn) {
                    return core$1.triggerFn(fn[method], data);
                });
                this.requestQueue[id] = null;
            }
            function onSuccess(config) {
                config.homePage = core$1.getWmProjectProperties().homePage;
                if (config.userInfo) ;
                this.config = config;
                this.lastLoggedInUser = core$1.getClonedObject(this.loggedInUser);
                this.loggedInUser = config.userInfo;
                invokeQueuedCallbacks.call(this, "config", "success", this.get());
            }
            function onError(error) {
                invokeQueuedCallbacks.call(this, "config", "error", error);
            }
            if (this.get()) {
                core$1.triggerFn(successCallback, this.get());
                return;
            }
            this.requestQueue.config = this.requestQueue.config || [];
            this.requestQueue.config.push({
                success: successCallback,
                error: failureCallback
            });
            if (this.requestQueue.config.length > 1) {
                return;
            }
            if (!core$1.hasCordova() || core$1.isSpotcues) {
                this.getWebConfig(onSuccess.bind(this), onError.bind(this));
            }
        };
        SecurityService.prototype.getLastLoggedInUsername = function() {
            return this.lastLoggedInUser && this.lastLoggedInUser.userName;
        };
        SecurityService.prototype.getCurrentRoutePage = function() {
            var p = this._location.path();
            var lIndex = p.indexOf("?");
            lIndex = lIndex === -1 ? p.length : lIndex - 1;
            return p.substr(1, lIndex);
        };
        SecurityService.prototype.getCurrentRouteQueryParam = function(paramName) {
            var paramVal;
            this.activatedRoute.queryParams.subscribe(function(params) {
                paramVal = params[paramName];
            });
            return paramVal;
        };
        SecurityService.prototype.isNoPageLoaded = function() {
            return !_.isEmpty(this.getCurrentRoutePage());
        };
        SecurityService.prototype.getPageByLoggedInUser = function() {
            var that = this;
            return new Promise(function(resolve) {
                var page;
                {
                    that.getConfig(function(config) {
                        if (config.securityEnabled && config.authenticated) {
                            page = config.userInfo.landingPage || core$1.getWmProjectProperties().homePage;
                            if (that.isXsrfEnabled()) ;
                        } else {
                            page = core$1.getWmProjectProperties().homePage;
                        }
                        resolve(page);
                    }, function() {
                        resolve(core$1.getWmProjectProperties().homePage);
                    });
                }
            });
        };
        SecurityService.prototype.loadPageByUserRole = function(forcePageLoad) {
            var that = this;
            return this.getPageByLoggedInUser().then(function(page) {
                if (that.isNoPageLoaded() || forcePageLoad) {
                    if (that.getCurrentRoutePage() === page) {
                        window.location.reload();
                    } else {
                        that.routerService.navigate([ "/" + page ]);
                    }
                }
            });
        };
        SecurityService.prototype.navigateOnLogin = function() {
            this.loadPageByUserRole(true);
        };
        SecurityService.prototype.getRedirectPage = function(config, page) {
            var homePage = core$1.getWmProjectProperties().homePage, loginPage = _.get(config, "loginConfig.pageName");
            var prevRedirectPage, redirectPage = page || this.getCurrentRoutePage();
            if (redirectPage === homePage || redirectPage === loginPage) {
                prevRedirectPage = this.getCurrentRouteQueryParam("redirectTo");
                redirectPage = !_.isEmpty(prevRedirectPage) ? prevRedirectPage : undefined;
            }
            return redirectPage;
        };
        SecurityService.prototype.getRedirectedRouteQueryParams = function() {
            var queryParams = {};
            this.activatedRoute.queryParams.subscribe(function(paramVal) {
                _.forEach(paramVal, function(val, key) {
                    queryParams[key] = val;
                });
            });
            return queryParams;
        };
        SecurityService.prototype.getQueryString = function(queryObject) {
            var params = [];
            _.forEach(queryObject, function(value, key) {
                params.push(key + "=" + value);
            });
            return _.join(params, "&");
        };
        SecurityService.prototype.appLogin = function(params, successCallback, failureCallback) {
            var _this = this;
            var payload = "";
            _.each(params, function(value, name) {
                payload += (payload ? "&" : "") + encodeURIComponent(name) + "=" + encodeURIComponent(value);
            });
            return this.$http.send({
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                url: "j_spring_security_check",
                data: payload
            }).then(function(response) {
                var xsrfCookieValue = response.body ? response.body[XSRF_COOKIE_NAME] : "";
                if (xsrfCookieValue) {
                    if (core$1.hasCordova()) {
                        localStorage.setItem(XSRF_COOKIE_NAME, xsrfCookieValue || "");
                    }
                }
                _this.injector.get(core$1.App).notify("userLoggedIn", {});
                core$1.triggerFn(successCallback, response);
            }, failureCallback);
        };
        SecurityService.prototype.isAuthenticated = function(successCallback, failureCallback) {
            this.getConfig(function(config) {
                core$1.triggerFn(successCallback, config.authenticated);
            }, failureCallback);
        };
        SecurityService.prototype.appLogout = function(successCallback, failureCallback) {
            var _this = this;
            return this.$http.send({
                target: "Security",
                url: "j_spring_security_logout",
                method: "POST",
                responseType: "text",
                byPassResult: true
            }).then(function(response) {
                _.set(_this.get(), "authenticated", false);
                _.set(_this.get(), "userInfo", null);
                _this.injector.get(core$1.App).notify("userLoggedOut", {});
                core$1.triggerFn(successCallback, response);
            }, failureCallback);
        };
        SecurityService.prototype.getCookieByName = function(name) {
            return "cookie";
        };
        SecurityService.prototype.isXsrfEnabled = function() {
            if (core$1.hasCordova()) {
                return localStorage.getItem(XSRF_COOKIE_NAME);
            }
            return this.getCookieByName(XSRF_COOKIE_NAME);
        };
        SecurityService.prototype.onUserLogin = function() {
            var _this = this;
            return new Promise(function(resolve, reject) {
                _this.getConfig(function(config) {
                    if (config.securityEnabled) {
                        if (config.authenticated) {
                            resolve();
                        } else {
                            var unsubscribe_1 = _this.injector.get(core$1.App).subscribe("userLoggedIn", function() {
                                resolve();
                                unsubscribe_1();
                            });
                        }
                    } else {
                        resolve();
                    }
                }, reject);
            });
        };
        SecurityService.prototype.getLoggedInUser = function() {
            var _this = this;
            return new Promise(function(resolve, reject) {
                _this.getConfig(function(config) {
                    if (config && config.userInfo) {
                        resolve(config.userInfo);
                    } else {
                        reject();
                    }
                }, reject);
            });
        };
        SecurityService.prototype.authInBrowser = function() {
            return Promise.reject("This authInBrowser should not be called");
        };
        SecurityService.decorators = [ {
            type: core.Injectable
        } ];
        SecurityService.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.AbstractHttpService
            }, {
                type: router.Router
            }, {
                type: router.ActivatedRoute
            }, {
                type: common.Location
            } ];
        };
        return SecurityService;
    }();
    var SecurityModule = function() {
        function SecurityModule() {}
        SecurityModule.forRoot = function() {
            return {
                ngModule: SecurityModule,
                providers: [ SecurityService ]
            };
        };
        SecurityModule.decorators = [ {
            type: core.NgModule,
            args: [ {} ]
        } ];
        return SecurityModule;
    }();
    exports.SecurityModule = SecurityModule;
    exports.SecurityService = SecurityService;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/platform-browser"), require("@angular/core"), require("rxjs"), require("@wm/security"), require("@swipey"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/base", [ "exports", "@angular/common", "@angular/platform-browser", "@angular/core", "rxjs", "@wm/security", "@swipey", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.base = {}), global.ng.common, global.ng.platformBrowser, global.ng.core, global.rxjs, global.wm.security, global.swipey, global.wm.core);
})(this, function(exports, common, platformBrowser, core, rxjs, security, _swipey, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m) return m.call(o);
        return {
            next: function() {
                if (o && i >= o.length) o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var WidgetRef = function() {
        function WidgetRef() {}
        return WidgetRef;
    }();
    var DialogRef = function() {
        function DialogRef() {}
        return DialogRef;
    }();
    var Context = new core.InjectionToken("Context Provider Reference");
    var DATASET_WIDGETS = new Set([ core$1.FormWidgetType.SELECT, core$1.FormWidgetType.CHECKBOXSET, core$1.FormWidgetType.RADIOSET, core$1.FormWidgetType.SWITCH, core$1.FormWidgetType.AUTOCOMPLETE, core$1.FormWidgetType.CHIPS, core$1.FormWidgetType.TYPEAHEAD, core$1.FormWidgetType.RATING ]);
    var getUpdatedExpr = function(expr) {
        var updated = "", ch, next, i, j, matchCh, matchCount, isQuotedStr, subStr, isQuotedStrEvaluated;
        expr = expr.replace(/\$\[data\[\$i\]/g, "$[__1");
        for (i = 0; i < expr.length; i++) {
            ch = expr[i];
            next = expr[i + 1];
            if (ch === "$" && next === "[") {
                matchCount = 1;
                isQuotedStrEvaluated = false;
                isQuotedStr = false;
                for (j = i + 2; j < expr.length; j++) {
                    matchCh = expr[j];
                    if (matchCh === " ") {
                        continue;
                    }
                    if (!isQuotedStrEvaluated) {
                        isQuotedStr = expr[j] === '"' || expr[j] === "'";
                        isQuotedStrEvaluated = true;
                    }
                    if (matchCh === "[") {
                        matchCount++;
                    } else if (matchCh === "]") {
                        matchCount--;
                    }
                    if (!matchCount) {
                        subStr = expr.substring(i + 2, j);
                        if (isQuotedStr) {
                            updated += "__1[" + subStr + "]";
                        } else {
                            updated += subStr;
                        }
                        break;
                    }
                }
                i = j;
            } else {
                updated += ch;
            }
        }
        return updated;
    };
    var getObjValueByKey = function(obj, strKey) {
        if (strKey) {
            var val_1;
            strKey.replace(/\[(\w+)\]/g, ".$1").split(".").forEach(function(key) {
                val_1 = val_1 && val_1[key] || (_.isNull(obj) ? obj : obj[key]);
            });
            return val_1;
        }
        return obj;
    };
    var getEvaluatedData = function(dataObj, options, context) {
        var expressionValue;
        var field = options.field, expr = options.expression, bindExpr = options.bindExpression;
        if (bindExpr) {
            expressionValue = bindExpr.replace("bind:", "");
            expressionValue = getUpdatedExpr(expressionValue);
        } else {
            expressionValue = expr ? expr : field;
        }
        if (!bindExpr && !expr) {
            return _.get(dataObj, field);
        }
        return core$1.$parseExpr(expressionValue)(context, Object.assign({}, dataObj, {
            __1: dataObj
        }));
    };
    var isActiveNavItem = function(link, routeName) {
        if (!link || !routeName) {
            return false;
        }
        routeName = routeName.indexOf("?") === -1 ? routeName : routeName.substring(0, routeName.indexOf("?"));
        link = link.indexOf("?") === -1 ? link : link.substring(0, link.indexOf("?"));
        var routeRegex = new RegExp("^(#/|#)" + routeName + "$");
        return routeRegex.test(link);
    };
    var getOrderByExpr = function(pageableObj) {
        pageableObj = pageableObj || [];
        var expressions = [], KEY_VAL_SEPARATOR = " ", FIELD_SEPARATOR = ",";
        _.forEach(pageableObj, function(obj) {
            expressions.push(obj.property + KEY_VAL_SEPARATOR + obj.direction.toLowerCase());
        });
        return _.join(expressions, FIELD_SEPARATOR);
    };
    var isDataSetWidget = function(widget) {
        return DATASET_WIDGETS.has(widget);
    };
    var getImageUrl = function(urlString, shouldEncode, defaultUrl) {
        if (core$1.isValidWebURL(urlString)) {
            return urlString;
        }
        if (!urlString) {
            urlString = defaultUrl || "resources/images/imagelists/default-image.png";
        }
        urlString = shouldEncode ? core$1.encodeUrl(urlString) : urlString;
        if (core$1.stringStartsWith(urlString, "services/prefabs")) {
            return urlString;
        }
        return urlString;
    };
    var getBackGroundImageUrl = function(urlString) {
        if (urlString === "" || urlString === "none") {
            return urlString;
        }
        return "url(" + getImageUrl(urlString) + ")";
    };
    function provideAs(reference, key, multi) {
        return {
            provide: key,
            useExisting: core.forwardRef(function() {
                return reference;
            }),
            multi: multi
        };
    }
    function provideAsWidgetRef(reference) {
        return provideAs(reference, WidgetRef);
    }
    function provideAsDialogRef(reference) {
        return provideAs(reference, DialogRef);
    }
    var NAVIGATION_TYPE = {
        ADVANCED: "Advanced",
        BASIC: "Basic",
        CLASSIC: "Classic",
        INLINE: "Inline",
        NONE: "None",
        ONDEMAND: "On-Demand",
        PAGER: "Pager",
        SCROLL: "Scroll"
    };
    var getWatchIdentifier = function() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        return args.join("_");
    };
    var typesMap = {
        number: [ "number", "integer", "big_integer", "short", "float", "big_decimal", "double", "long", "byte" ],
        string: [ "string", "text" ],
        character: [ "character" ],
        date: [ "date", "time", "timestamp", "datetime" ]
    };
    var modes = {
        number: [ "exact", "notequals", "lessthan", "lessthanequal", "greaterthan", "greaterthanequal", "null", "isnotnull" ],
        string: [ "anywhereignorecase", "anywhere", "startignorecase", "start", "endignorecase", "end", "exactignorecase", "exact", "notequalsignorecase", "notequals", "null", "isnotnull", "empty", "isnotempty", "nullorempty" ],
        character: [ "exactignorecase", "exact", "notequalsignorecase", "notequals", "null", "isnotnull", "empty", "isnotempty", "nullorempty" ],
        date: [ "exact", "lessthan", "lessthanequal", "greaterthan", "greaterthanequal", "null", "notequals", "isnotnull" ]
    };
    var matchModeTypesMap = {
        boolean: [ "exact", "null", "isnotnull" ],
        clob: [],
        blob: []
    };
    var getMatchModeTypesMap = function(multiMode) {
        if (multiMode) {
            modes.number.push("in", "notin", "between");
            modes.date.push("between");
            modes.string.push("in", "notin");
            modes.character.push("in", "notin");
        }
        _.forEach(typesMap, function(types, primType) {
            _.forEach(types, function(type) {
                matchModeTypesMap[type] = modes[primType];
            });
        });
        matchModeTypesMap["default"] = _.union(modes["number"], modes["string"], modes["character"], modes["date"], modes["date"]);
        return matchModeTypesMap;
    };
    var getMatchModeMsgs = function(appLocale) {
        return {
            start: appLocale.LABEL_STARTS_WITH,
            startignorecase: appLocale.LABEL_STARTS_WITH_IGNORECASE,
            end: appLocale.LABEL_ENDS_WITH,
            endignorecase: appLocale.LABEL_ENDS_WITH_IGNORECASE,
            anywhere: appLocale.LABEL_CONTAINS,
            anywhereignorecase: appLocale.LABEL_CONTAINS_IGNORECASE,
            exact: appLocale.LABEL_IS_EQUAL_TO,
            exactignorecase: appLocale.LABEL_IS_EQUAL_TO_IGNORECASE,
            notequals: appLocale.LABEL_IS_NOT_EQUAL_TO,
            notequalsignorecase: appLocale.LABEL_IS_NOT_EQUAL_TO_IGNORECASE,
            lessthan: appLocale.LABEL_LESS_THAN,
            lessthanequal: appLocale.LABEL_LESS_THAN_OR_EQUALS_TO,
            greaterthan: appLocale.LABEL_GREATER_THAN,
            greaterthanequal: appLocale.LABEL_GREATER_THAN_OR_EQUALS_TO,
            null: appLocale.LABEL_IS_NULL,
            isnotnull: appLocale.LABEL_IS_NOT_NULL,
            empty: appLocale.LABEL_IS_EMPTY,
            isnotempty: appLocale.LABEL_IS_NOT_EMPTY,
            nullorempty: appLocale.LABEL_IS_NULL_OR_EMPTY,
            in: appLocale.LABEL_IN,
            notin: appLocale.LABEL_NOT_IN,
            between: appLocale.LABEL_BETWEEN
        };
    };
    var getClassesArray = function(classVal) {
        var classes = [];
        if (_.isArray(classVal)) {
            classVal.forEach(function(v) {
                classes = classes.concat(getClassesArray(v));
            });
            return classes;
        }
        if (_.isObject(classVal)) {
            _.forEach(classVal, function(val, key) {
                if (val) {
                    classes = classes.concat(key.split(" "));
                }
            });
            return classes;
        }
    };
    var getConditionalClasses = function(nv, ov) {
        var toAdd;
        var toRemove;
        var classToAdd = nv.toAdd || nv;
        var classToRemove = nv.toRemove || ov;
        if (_.isObject(nv)) {
            toAdd = _.isArray(classToAdd) ? classToAdd : getClassesArray(classToAdd || []);
            toRemove = classToRemove ? _.isArray(classToRemove) ? classToRemove : getClassesArray(classToRemove) : [];
        } else {
            toAdd = classToAdd ? [ classToAdd ] : [];
            toRemove = classToRemove ? [ classToRemove ] : [];
        }
        return {
            toAdd: toAdd,
            toRemove: toRemove
        };
    };
    var pushFieldDef = function(dataObject, columnDefObj, namePrefix, options) {
        var modifiedTitle, relatedTable, relatedField, relatedInfo, fieldName, isRelated;
        if (!options) {
            options = {};
        }
        _.forEach(dataObject, function(value, title) {
            if (_.includes(title, ".")) {
                relatedInfo = _.split(title, ".");
                relatedTable = relatedInfo[0];
                relatedField = relatedInfo[1];
                isRelated = true;
            }
            if (options.noModifyTitle) {
                modifiedTitle = title;
            } else {
                if (_.isString(title)) {
                    modifiedTitle = core$1.prettifyLabel(title);
                    modifiedTitle = core$1.deHyphenate(modifiedTitle);
                    modifiedTitle = namePrefix ? core$1.initCaps(namePrefix) + " " + modifiedTitle : modifiedTitle;
                } else {
                    modifiedTitle = title;
                }
            }
            title = namePrefix ? namePrefix + "." + title : title;
            if (isRelated) {
                fieldName = _.split(modifiedTitle, " ");
                fieldName = fieldName.length > 1 ? fieldName[fieldName.length - 2] + " " + fieldName[fieldName.length - 1] : fieldName[0];
            } else {
                fieldName = modifiedTitle;
            }
            var defObj = options.setBindingField ? {
                displayName: fieldName,
                field: title,
                relatedTable: relatedTable,
                relatedField: relatedField || modifiedTitle
            } : {
                displayName: fieldName,
                relatedTable: relatedTable,
                relatedField: relatedField || modifiedTitle
            };
            if (!_.isObject(value) || _.isArray(value) && !value[0]) {
                if (options.upperBound && options.columnCount === options.upperBound) {
                    return;
                }
                columnDefObj.terminals.push(defObj);
                options.columnCount += 1;
            } else {
                if (options.columnCount !== options.upperBound) {
                    columnDefObj.objects.push(defObj);
                }
                if (_.isArray(value) && value[0]) {
                    pushFieldDef(value[0], columnDefObj, title + "[0]", options);
                } else {
                    pushFieldDef(value, columnDefObj, title, options);
                }
            }
        });
    };
    var getMetaDataFromData = function(data) {
        var dataObject;
        if (_.isArray(data)) {
            if (_.isObject(data[0])) {
                dataObject = core$1.getClonedObject(data[0]);
                _.forEach(data, function(row, index) {
                    if (index + 1 >= 10) {
                        return false;
                    }
                    _.assignWith(dataObject, row, function(objValue, srcValue) {
                        return objValue === null || objValue === undefined ? srcValue : objValue;
                    });
                });
            } else {
                dataObject = data[0];
            }
        } else {
            dataObject = data;
        }
        return dataObject;
    };
    var prepareFieldDefs = function(data, options) {
        var dataObject;
        var columnDef = {
            objects: [],
            terminals: []
        };
        if (!data) {
            data = [];
        }
        if (!options) {
            options = {};
        }
        options.setBindingField = true;
        options.columnCount = 0;
        dataObject = getMetaDataFromData(data);
        pushFieldDef(dataObject, columnDef, "", options);
        if (!options || options && !options.filter) {
            return columnDef.terminals;
        }
        switch (options.filter) {
          case "all":
            return columnDef;

          case "objects":
            return columnDef.objects;

          case "terminals":
            return columnDef.terminals;
        }
        return columnDef;
    };
    (function(APPLY_STYLES_TYPE) {
        APPLY_STYLES_TYPE[APPLY_STYLES_TYPE["CONTAINER"] = 0] = "CONTAINER";
        APPLY_STYLES_TYPE[APPLY_STYLES_TYPE["SCROLLABLE_CONTAINER"] = 1] = "SCROLLABLE_CONTAINER";
        APPLY_STYLES_TYPE[APPLY_STYLES_TYPE["INNER_SHELL"] = 2] = "INNER_SHELL";
        APPLY_STYLES_TYPE[APPLY_STYLES_TYPE["SHELL"] = 3] = "SHELL";
    })(exports.APPLY_STYLES_TYPE || (exports.APPLY_STYLES_TYPE = {}));
    var propNameCSSKeyMap = {
        backgroundattachment: "backgroundAttachment",
        backgroundcolor: "backgroundColor",
        backgroundgradient: "backgroundGradient",
        backgroundimage: "backgroundImage",
        backgroundposition: "backgroundPosition",
        backgroundrepeat: "backgroundRepeat",
        backgroundsize: "backgroundSize",
        bordercolor: "borderColor",
        borderradius: "borderRadius",
        borderstyle: "borderStyle",
        borderwidth: "borderWidth",
        borderbottomwidth: "borderBottomWidth",
        borderleftwidth: "borderLeftWidth",
        borderrightwidth: "borderRightWidth",
        bordertopwidth: "borderTopWidth",
        color: "color",
        cursor: "cursor",
        display: "display",
        fontsize: "fontSize",
        fontfamily: "fontFamily",
        fontstyle: "fontStyle",
        fontunit: "fontunit",
        fontvariant: "fontVariant",
        fontweight: "fontWeight",
        height: "height",
        horizontalalign: "textAlign",
        lineheight: "lineHeight",
        margin: "margin",
        marginbottom: "marginBottom",
        marginleft: "marginLeft",
        marginright: "marginRight",
        margintop: "marginTop",
        opacity: "opacity",
        overflow: "overflow",
        padding: "padding",
        paddingbottom: "paddingBottom",
        paddingleft: "paddingLeft",
        paddingright: "paddingRight",
        paddingtop: "paddingTop",
        picturesource: "backgroundImage",
        textalign: "textAlign",
        textdecoration: "textDecoration",
        verticalalign: "verticalAlign",
        visibility: "visibility",
        whitespace: "whiteSpace",
        width: "width",
        wordbreak: "wordbreak",
        zindex: "zIndex"
    };
    var isStyle = function(key) {
        return !!propNameCSSKeyMap[key];
    };
    var MAP_SHELL_TYPE_IGNORE_LIST = {
        height: true,
        overflow: true,
        padding: true,
        paddingbottom: true,
        paddingleft: true,
        paddingright: true,
        paddingtop: true
    };
    var MAP_CONTAINER_TYPE_IGNORE_LIST = {
        textalign: true
    };
    var MAP_SCROLLABLE_CONTAINER_TYPE_IGNORE_LIST = {
        textalign: true,
        width: true
    };
    function styler($node, component, type, skipList) {
        var skipListMap = Object.create(null);
        if (skipList) {
            skipList.forEach(function(k) {
                return skipListMap[k] = true;
            });
        }
        component.registerStyleChangeListener(function(key, nv) {
            if (skipListMap[key]) {
                return;
            }
            if (type === exports.APPLY_STYLES_TYPE.SHELL && MAP_SHELL_TYPE_IGNORE_LIST[key]) {
                return;
            }
            if (type === exports.APPLY_STYLES_TYPE.INNER_SHELL) {
                if (!MAP_SHELL_TYPE_IGNORE_LIST[key]) {
                    return;
                }
                if (key === "height") {
                    core$1.setCSS($node, "overflow", nv ? "auto" : "");
                }
            }
            if (type === exports.APPLY_STYLES_TYPE.CONTAINER && MAP_CONTAINER_TYPE_IGNORE_LIST[key]) {
                return;
            }
            if (type === exports.APPLY_STYLES_TYPE.SCROLLABLE_CONTAINER) {
                if (MAP_SCROLLABLE_CONTAINER_TYPE_IGNORE_LIST[key]) {
                    return;
                }
                if (key === "height") {
                    core$1.setCSS($node, "overflow", nv ? "auto" : "");
                }
            }
            if (key === "fontsize" || key === "fontunit") {
                core$1.setCSS($node, "fontSize", component.fontsize === "" ? "" : component.fontsize + (component.fontunit || "px"));
            } else if (key === "backgroundimage") {
                core$1.setCSS($node, "backgroundImage", component.picturesource || getBackGroundImageUrl(nv));
            } else if (propNameCSSKeyMap[key]) {
                core$1.setCSS($node, propNameCSSKeyMap[key], nv);
            }
        });
    }
    var formFieldPrefix = "wm-form-field-";
    var \u02750$1 = function() {
        var props = new Map();
        for (var key in core$1.FormWidgetType) {
            props.set(formFieldPrefix + core$1.FormWidgetType[key], new Map());
        }
        return props;
    };
    var widgetProps = \u02750$1();
    var getWidgetPropsByType = function(identifier) {
        return widgetProps.get(identifier);
    };
    var register = function(identifier, props) {
        widgetProps.set(identifier, props);
        window.WM_LOADED_COMPONENTS = __spread(window.WM_LOADED_COMPONENTS || [], [ identifier ]);
    };
    var registerFormWidget = function(identifier, props) {
        var widgetName = formFieldPrefix + identifier;
        var existingProps = widgetProps.get(widgetName);
        if (existingProps) {
            props.forEach(function(v, k) {
                return existingProps.set(k, v);
            });
        }
    };
    (function(PROP_TYPE) {
        PROP_TYPE[PROP_TYPE["BOOLEAN"] = 1] = "BOOLEAN";
        PROP_TYPE[PROP_TYPE["NUMBER"] = 2] = "NUMBER";
        PROP_TYPE[PROP_TYPE["STRING"] = 3] = "STRING";
    })(exports.PROP_TYPE || (exports.PROP_TYPE = {}));
    var PROP_STRING = {
        type: exports.PROP_TYPE.STRING
    };
    var PROP_NUMBER = {
        type: exports.PROP_TYPE.NUMBER
    };
    var PROP_BOOLEAN = {
        type: exports.PROP_TYPE.BOOLEAN
    };
    var PROP_ANY = {};
    var registerProps = function() {
        register("wm-container", new Map([ [ "animation", PROP_STRING ], [ "class", PROP_STRING ], [ "conditionalclass", PROP_ANY ], [ "conditionalstyle", PROP_ANY ], [ "content", PROP_STRING ], [ "name", PROP_STRING ], [ "show", __assign({
            value: true
        }, PROP_BOOLEAN) ] ]));
    };
    var registryById = new Map();
    var register$1 = function(widget, viewParent, widgetId, name) {
        var registered = false;
        registryById.set(widgetId, widget);
        if (name) {
            if (core$1.isDefined(viewParent.Widgets)) {
                registered = true;
                viewParent.Widgets[name] = widget;
            }
        }
        return function() {
            registryById.delete(widgetId);
            if (registered) {
                viewParent.Widgets[name] = undefined;
            }
        };
    };
    var renameWidget = function(viewParent, widget, nv, ov) {
        if (!core$1.isDefined(viewParent.Widgets)) {
            return;
        }
        if (ov) {
            viewParent.Widgets[ov] = undefined;
        }
        if (nv) {
            viewParent.Widgets[nv] = widget;
        }
    };
    var widgetIdGenerator = new core$1.IDGenerator("widget-id");
    var EVENTS_MAP = new Map([ [ "tap", "click" ] ]);
    var DISPLAY_TYPE = {
        BLOCK: "block",
        INLINE_BLOCK: "inline-block",
        INLINE: "inline"
    };
    var BOOLEAN_ATTRS = new Set([ "readonly", "autofocus", "disabled", "startchecked", "multiple", "selected", "required", "controls", "autoplay", "loop", "muted", "show" ]);
    var isBooleanAttr = function(key) {
        return BOOLEAN_ATTRS.has(key);
    };
    var DIMENSION_PROPS = new Set([ "width", "height", "iconheight", "iconwidth", "popoverwidth", "popoverheight", "imagewidth", "imageheight" ]);
    var isDimensionProp = function(key) {
        return DIMENSION_PROPS.has(key);
    };
    var DEBOUNCE_TIMES = {
        PAGINATION_DEBOUNCE_TIME: 250
    };
    var parseValue = function(key, value, type) {
        if (type === exports.PROP_TYPE.BOOLEAN) {
            return core$1.toBoolean(value, isBooleanAttr(key) && key);
        }
        if (type === exports.PROP_TYPE.NUMBER) {
            return +value;
        }
        return value;
    };
    var globalPropertyChangeHandler = function(component, key, nv) {
        var widgetId = component.widgetId;
        var ov = component[key];
        if (!core$1.isChangeFromWatch()) {
            core$1.$unwatch(getWatchIdentifier(widgetId, key));
        }
        core$1.resetChangeFromWatch();
        var widgetProps = getWidgetPropsByType(component.getWidgetSubType());
        var propInfo = widgetProps.get(key);
        if (propInfo) {
            var type = propInfo.type;
            if (type) {
                nv = parseValue(key, nv, type);
            }
        }
        if (nv !== ov || core$1.isObject(nv) || core$1.isObject(ov)) {
            if (isDimensionProp(key)) {
                nv = core$1.toDimension(nv);
            } else if (_.startsWith(nv, "resources/")) {
                var ref = component;
                if (ref._parentPrefab_ === undefined) {
                    ref._parentPrefab_ = component.$element.closest('[prefabname][prefabname!="__self__"]').attr("prefabname") || "";
                }
                if (ref._parentPrefab_) {
                    nv = "./app/prefabs/" + ref._parentPrefab_ + "/" + nv;
                }
            }
            component[key] = nv;
            if (isStyle(key)) {
                component.notifyStyleChange(key, nv, ov);
            } else {
                if (key === "conditionalclass") {
                    nv = getConditionalClasses(nv, ov);
                }
                if (propInfo) {
                    component.notifyPropertyChange(key, nv, ov);
                }
            }
            core$1.$appDigest();
        }
    };
    var proxyHandler = {
        set: function(target, key, value) {
            globalPropertyChangeHandler(target, key, value);
            return true;
        },
        get: function(target, key) {
            var v = target[key];
            if (_.isFunction(v)) {
                return v.bind(target);
            }
            return v;
        }
    };
    var $RAF = window.requestAnimationFrame;
    var $RAFQueue = [];
    var invokeLater = function(fn) {
        if (!$RAFQueue.length) {
            $RAF(function() {
                $RAFQueue.forEach(function(f) {
                    return f();
                });
                $RAFQueue.length = 0;
            });
        }
        $RAFQueue.push(fn);
    };
    var WidgetProxyProvider = function() {
        function WidgetProxyProvider() {}
        WidgetProxyProvider.create = function(instance, widgetSubType, propsByWidgetSubType) {
            if (window.Proxy) {
                return new Proxy(instance, proxyHandler);
            } else {
                var widget_1 = Object.create(instance);
                invokeLater(function() {
                    for (var key in instance) {
                        if (_.isFunction(instance[key]) && key !== "constructor" && key !== "super" && !_.startsWith(key, "ng")) {
                            instance[key] = instance[key].bind(instance);
                        }
                    }
                });
                Object.keys(propNameCSSKeyMap).forEach(function(key) {
                    Object.defineProperty(widget_1, key, {
                        get: function() {
                            return instance[key];
                        },
                        set: function(nv) {
                            return globalPropertyChangeHandler(instance, key, nv);
                        }
                    });
                });
                if (propsByWidgetSubType) {
                    propsByWidgetSubType.forEach(function(value, key) {
                        Object.defineProperty(widget_1, key, {
                            get: function() {
                                return instance[key];
                            },
                            set: function(nv) {
                                return globalPropertyChangeHandler(instance, key, nv);
                            }
                        });
                    });
                }
                return widget_1;
            }
        };
        return WidgetProxyProvider;
    }();
    var updateClasses = function(toAdd, toRemove, el) {
        if (toRemove && toRemove.length) {
            core$1.removeClass(el, _.join(toRemove, " "));
        }
        if (toAdd && toAdd.length) {
            core$1.addClass(el, _.join(toAdd, " "));
        }
    };
    var updateStyles = function(nv, ov, el) {
        if (ov && _.isObject(ov)) {
            var keys = Object.keys(ov || {});
            keys.forEach(function(key) {
                core$1.setCSS(el, key, "");
            });
        }
        if (nv && _.isObject(nv)) {
            core$1.setCSSFromObj(el, nv);
        }
    };
    var BaseComponent = function() {
        function BaseComponent(inj, config, initPromise) {
            var _this = this;
            this.inj = inj;
            this.styleChange = new rxjs.ReplaySubject();
            this.propertyChange = new rxjs.Subject();
            this.readyState = new rxjs.Subject();
            this.destroy = new rxjs.Subject();
            this.eventHandlers = new Map();
            this.toBeSetupEventsQueue = [];
            this.__cloneable__ = false;
            this.$attrs = new Map();
            var elementRef = inj.get(core.ElementRef);
            this.nativeElement = elementRef.nativeElement;
            this.widgetType = config.widgetType;
            this.widgetSubType = config.widgetSubType || config.widgetType;
            this.viewParent = inj.view.component;
            this.displayType = config.displayType || DISPLAY_TYPE.BLOCK;
            this.context = inj.view.context;
            this.widget = this.createProxy();
            this.eventManager = inj.get(platformBrowser.EventManager);
            this.nativeElement.widget = this.widget;
            this.appLocale = inj.get(core$1.App).appLocale || {};
            this.initContext();
            if (config.hostClass) {
                core$1.addClass(this.nativeElement, config.hostClass);
            }
            this.widgetId = this.generateWidgetId();
            core$1.setAttr(this.nativeElement, "widget-id", this.widgetId, true);
            this.registerStyleChangeListener(this.onStyleChange, this);
            this.registerPropertyChangeListener(this.onPropertyChange, this);
            if (!initPromise) {
                this.initWidget();
            } else {
                this.delayedInit = true;
                initPromise.then(function() {
                    _this.initWidget();
                    _this.setInitProps();
                });
            }
        }
        Object.defineProperty(BaseComponent.prototype, "$element", {
            get: function() {
                return $(this.nativeElement);
            },
            enumerable: true,
            configurable: true
        });
        BaseComponent.prototype.getNativeElement = function() {
            return this.nativeElement;
        };
        BaseComponent.prototype.getWidgetType = function() {
            return this.widgetType;
        };
        BaseComponent.prototype.getWidgetSubType = function() {
            return this.widgetSubType;
        };
        BaseComponent.prototype.getWidget = function() {
            return this.widget;
        };
        BaseComponent.prototype.setProperty = function(propName, propValue) {
            this.widget[propName] = propValue;
        };
        BaseComponent.prototype.getViewParent = function() {
            return this.viewParent;
        };
        BaseComponent.prototype.notifyStyleChange = function(key, nv, ov) {
            this.styleChange.next({
                key: key,
                nv: nv,
                ov: ov
            });
        };
        BaseComponent.prototype.notifyPropertyChange = function(key, nv, ov) {
            this.propertyChange.next({
                key: key,
                nv: nv,
                ov: ov
            });
        };
        BaseComponent.prototype.registerStyleChangeListener = function(fn, ctx) {
            if (ctx) {
                fn = fn.bind(ctx);
            }
            this.styleChange.subscribe(function(_a) {
                var key = _a.key, nv = _a.nv, ov = _a.ov;
                return fn(key, nv, ov);
            });
        };
        BaseComponent.prototype.registerReadyStateListener = function(fn, ctx) {
            if (ctx) {
                fn = fn.bind(ctx);
            }
            if (this.readyState.isStopped) {
                fn();
                return;
            }
            this.readyState.subscribe(function() {
                return fn();
            });
        };
        BaseComponent.prototype.registerPropertyChangeListener = function(fn, ctx) {
            if (ctx) {
                fn = fn.bind(ctx);
            }
            this.propertyChange.subscribe(function(_a) {
                var key = _a.key, nv = _a.nv, ov = _a.ov;
                return fn(key, nv, ov);
            });
        };
        BaseComponent.prototype.registerDestroyListener = function(fn, ctx) {
            if (ctx) {
                fn = fn.bind(ctx);
            }
            this.destroy.subscribe(function() {}, function() {}, function() {
                return fn();
            });
        };
        BaseComponent.prototype.getDisplayType = function() {
            return this.displayType;
        };
        BaseComponent.prototype.createProxy = function() {
            return WidgetProxyProvider.create(this, this.widgetSubType, getWidgetPropsByType(this.widgetSubType));
        };
        BaseComponent.prototype.initContext = function() {
            var context = this.inj.view.context;
            var parentContexts = this.inj.get(Context, {});
            if (this.viewParent !== context) {
                this.context = context;
            } else {
                this.context = {};
            }
            if (parentContexts) {
                this.context = Object.assign.apply(Object, __spread([ {} ], parentContexts, [ this.context ]));
            }
        };
        BaseComponent.prototype.setWidgetProperty = function(key, value) {
            this.widget[key] = value;
        };
        BaseComponent.prototype.getAttr = function(attrName) {
            return this.$attrs.get(attrName);
        };
        BaseComponent.prototype.getAppInstance = function() {
            return this.inj.get(core$1.App);
        };
        BaseComponent.prototype.generateWidgetId = function() {
            return widgetIdGenerator.nextUid();
        };
        BaseComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "show") {
                this.nativeElement.hidden = !nv;
            } else if (key === "hint") {
                core$1.setAttr(this.nativeElement, "title", nv);
            } else if (key === "class") {
                core$1.switchClass(this.nativeElement, nv, ov);
            } else if (key === "name" || key === "tabindex") {
                core$1.setAttr(this.nativeElement, key, nv);
                if (key === "name" && nv) {
                    renameWidget(this.viewParent, this.widget, nv, ov);
                }
            } else if (key === "conditionalclass") {
                updateClasses(nv.toAdd, nv.toRemove, this.nativeElement);
            } else if (key === "autoplay") {
                var tagName = this.widgetType === "wm-audio" ? "audio" : "video";
                this.nativeElement.querySelector(tagName).load();
            } else if (key === "conditionalstyle") {
                updateStyles(nv, ov, this.nativeElement);
            } else if (key === "animation") {
                core$1.addClass(this.nativeElement, "animated " + nv);
            }
        };
        BaseComponent.prototype.onStyleChange = function(k, nv, ov) {};
        BaseComponent.prototype.registerWidget = function(widgetName) {
            this.registerDestroyListener(register$1(this.widget, this.viewParent, this.widgetId, widgetName));
        };
        BaseComponent.prototype.getMappedEventName = function(eventName) {
            return EVENTS_MAP.get(eventName) || eventName;
        };
        BaseComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals, meta) {
            this.eventManager.addEventListener(node, eventName, function(e) {
                locals.$event = e;
                if (meta === "delayed") {
                    setTimeout(function() {
                        return eventCallback();
                    }, 150);
                } else {
                    return eventCallback();
                }
            });
        };
        BaseComponent.prototype.processEventAttr = function(eventName, expr, meta) {
            var _this = this;
            var fn = core$1.$parseEvent(expr);
            var locals = this.context;
            locals.widget = this.widget;
            var boundFn = fn.bind(undefined, this.viewParent, locals);
            var eventCallback = function() {
                var boundFnVal;
                core$1.$invokeWatchers(true);
                try {
                    boundFnVal = boundFn();
                    if (boundFnVal instanceof Promise) {
                        boundFnVal.then(function(response) {
                            return response;
                        }, function(err) {
                            return err;
                        });
                    } else {
                        return boundFnVal;
                    }
                } catch (e) {
                    console.error(e);
                }
            };
            this.eventHandlers.set(this.getMappedEventName(eventName), {
                callback: eventCallback,
                locals: locals
            });
            var onEventName = _.camelCase("on-" + eventName);
            this[onEventName] = eventCallback;
            this.toBeSetupEventsQueue.push(function() {
                _this.handleEvent(_this.nativeElement, _this.getMappedEventName(eventName), eventCallback, locals, meta);
            });
        };
        BaseComponent.prototype.processBindAttr = function(propName, expr) {
            var _this = this;
            this.initState.delete(propName);
            this.registerDestroyListener(core$1.$watch(expr, this.viewParent, this.context, function(nv) {
                return _this.widget[propName] = nv;
            }, getWatchIdentifier(this.widgetId, propName), propName === "datasource"));
        };
        BaseComponent.prototype.removePropertyBinding = function(propName) {
            core$1.$unwatch(getWatchIdentifier(this.widgetId, propName));
        };
        BaseComponent.prototype.invokeEventCallback = function(eventName, extraLocals) {
            var callbackInfo = this.eventHandlers.get(eventName);
            if (callbackInfo) {
                var fn = callbackInfo.callback;
                var locals = callbackInfo.locals || {};
                if (fn) {
                    return fn(Object.assign(locals, extraLocals));
                }
            }
        };
        BaseComponent.prototype.processAttr = function(attrName, attrValue) {
            var _a = attrName.split("."), propName = _a[0], type = _a[1], meta = _a[2], length = _a.length;
            if (type === "bind") {
                if (propName === "show") {
                    this.nativeElement.hidden = true;
                }
                this.processBindAttr(propName, attrValue);
            } else if (type === "event") {
                this.processEventAttr(propName, attrValue, meta);
            } else if (length === 1) {
                if (attrName === "class") {
                    core$1.removeClass(this.nativeElement, attrValue);
                } else if (attrName === "tabindex" || attrName === "name") {
                    core$1.removeAttr(this.nativeElement, attrName);
                }
                this.initState.set(propName, attrValue);
            }
        };
        BaseComponent.prototype.processAttrs = function() {
            var e_1, _a;
            var elDef = this.inj.elDef;
            try {
                for (var _b = __values(elDef.element.attrs), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var _d = __read(_c.value, 3), attrName = _d[1], attrValue = _d[2];
                    this.$attrs.set(attrName, attrValue);
                    this.processAttr(attrName, attrValue);
                }
            } catch (e_1_1) {
                e_1 = {
                    error: e_1_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_1) throw e_1.error;
                }
            }
        };
        BaseComponent.prototype.initWidget = function() {
            var _this = this;
            this.initState = new Map();
            var widgetProps = getWidgetPropsByType(this.widgetSubType);
            widgetProps.forEach(function(v, k) {
                if (core$1.isDefined(v.value)) {
                    _this.initState.set(k, v.value);
                }
            });
            this.widgetProps = widgetProps;
            this.processAttrs();
            this.registerWidget(this.initState.get("name"));
        };
        BaseComponent.prototype.setInitProps = function() {
            var _this = this;
            if (this.initState.get("name")) {
                this.widget.name = this.initState.get("name");
            }
            this.initState.forEach(function(v, k) {
                if ((_this.widgetProps.get(k) || isStyle(k)) && k !== "name") {
                    _this.widget[k] = v;
                }
            });
            this.initState.clear();
            this.initState = undefined;
            this.readyState.next();
            this.readyState.complete();
        };
        BaseComponent.prototype.hasEventCallback = function(eventName) {
            return this.eventHandlers.has(eventName);
        };
        BaseComponent.prototype.focus = function() {
            var $target = this.$element[0].querySelector("[focus-target]");
            if (!$target) {
                $target = this.$element[0];
            }
            $target.focus();
        };
        BaseComponent.prototype.execute = function(operation, options) {};
        BaseComponent.prototype.ngOnInit = function() {
            if (!this.delayedInit) {
                this.setInitProps();
            }
        };
        BaseComponent.prototype.ngAfterViewInit = function() {
            var e_2, _a;
            if (this.toBeSetupEventsQueue.length) {
                try {
                    for (var _b = __values(this.toBeSetupEventsQueue), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var fn = _c.value;
                        fn();
                    }
                } catch (e_2_1) {
                    e_2 = {
                        error: e_2_1
                    };
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    } finally {
                        if (e_2) throw e_2.error;
                    }
                }
            }
            this.toBeSetupEventsQueue.length = 0;
        };
        BaseComponent.prototype.ngAfterContentInit = function() {};
        BaseComponent.prototype.ngOnDestroy = function() {
            this.isDestroyed = true;
            this.widget = Object.create(null);
            this.styleChange.complete();
            this.propertyChange.complete();
            this.destroy.complete();
        };
        return BaseComponent;
    }();
    var StylableComponent = function(_super) {
        __extends(StylableComponent, _super);
        function StylableComponent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return StylableComponent;
    }(BaseComponent);
    var DEFAULT_CLS = "app-container";
    var WIDGET_CONFIG = {
        widgetType: "wm-container",
        hostClass: DEFAULT_CLS
    };
    var ContainerDirective = function(_super) {
        __extends(ContainerDirective, _super);
        function ContainerDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            core$1.addClass(_this.nativeElement, DEFAULT_CLS);
            styler(_this.nativeElement, _this, exports.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        ContainerDirective.initializeProps = registerProps();
        ContainerDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmContainer]",
                providers: [ provideAsWidgetRef(ContainerDirective) ]
            } ]
        } ];
        ContainerDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return ContainerDirective;
    }(StylableComponent);
    var ImagePipe = function() {
        function ImagePipe() {}
        ImagePipe.prototype.transform = function(url, encode, defaultImageUrl) {
            return getImageUrl(url, encode, defaultImageUrl);
        };
        ImagePipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "image"
            } ]
        } ];
        return ImagePipe;
    }();
    var LazyLoadDirective = function() {
        function LazyLoadDirective(inj, templateRef, viewContainer) {
            this.templateRef = templateRef;
            this.viewContainer = viewContainer;
            this.viewParent = inj.view.component;
            this.context = inj.view.context;
        }
        Object.defineProperty(LazyLoadDirective.prototype, "lazyLoad", {
            set: function(expr) {
                var _this = this;
                this.unSubscribeFn = core$1.$watch(expr, this.viewParent, this.context, function(val) {
                    if (!_this.embeddedView && val) {
                        _this.embeddedView = _this.viewContainer.createEmbeddedView(_this.templateRef, _this.context);
                        _this.unSubscribeFn();
                    }
                });
            },
            enumerable: true,
            configurable: true
        });
        LazyLoadDirective.prototype.ngOnDestroy = function() {
            this.unSubscribeFn();
        };
        LazyLoadDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[lazyLoad]"
            } ]
        } ];
        LazyLoadDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.TemplateRef
            }, {
                type: core.ViewContainerRef
            } ];
        };
        LazyLoadDirective.propDecorators = {
            lazyLoad: [ {
                type: core.Input
            } ]
        };
        return LazyLoadDirective;
    }();
    var registerProps$1 = function() {
        register("wm-message", new Map([ [ "animation", PROP_STRING ], [ "caption", __assign({
            value: "Message"
        }, PROP_STRING) ], [ "class", PROP_STRING ], [ "hideclose", __assign({
            value: false
        }, PROP_BOOLEAN) ], [ "name", PROP_STRING ], [ "show", __assign({
            value: true
        }, PROP_BOOLEAN) ], [ "type", __assign({
            value: "success"
        }, PROP_STRING) ] ]));
    };
    var DEFAULT_CLS$1 = "alert app-message";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-message",
        hostClass: DEFAULT_CLS$1
    };
    var MessageComponent = function(_super) {
        __extends(MessageComponent, _super);
        function MessageComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            _this.messageClass = "";
            _this.messageIconClass = "";
            _this.type = "";
            styler(_this.nativeElement, _this);
            return _this;
        }
        MessageComponent.prototype.showMessage = function(caption, type) {
            if (caption) {
                this.caption = caption;
            }
            if (type) {
                this.setWidgetProperty("type", type);
            }
            this.setWidgetProperty("show", true);
        };
        MessageComponent.prototype.hideMessage = function() {
            this.setWidgetProperty("show", false);
        };
        MessageComponent.prototype.dismiss = function($event) {
            this.hideMessage();
            this.invokeEventCallback("close", {
                $event: $event
            });
        };
        MessageComponent.prototype.onMessageTypeChange = function(nv) {
            var msgCls, msgIconCls;
            switch (nv) {
              case "success":
                msgCls = "alert-success";
                msgIconCls = "wi wi-done";
                break;

              case "error":
                msgCls = "alert-danger";
                msgIconCls = "wi wi-cancel";
                break;

              case "warn":
              case "warning":
                msgCls = "alert-warning";
                msgIconCls = "wi wi-bell";
                break;

              case "info":
                msgCls = "alert-info";
                msgIconCls = "wi wi-info";
                break;

              case "loading":
                msgCls = "alert-info alert-loading";
                msgIconCls = "fa fa-spinner fa-spin";
                break;
            }
            core$1.switchClass(this.nativeElement, msgCls, this.messageClass);
            this.messageClass = msgCls;
            this.messageIconClass = msgIconCls;
        };
        MessageComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "type") {
                this.onMessageTypeChange(nv);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        MessageComponent.initializeProps = registerProps$1();
        MessageComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmMessage]",
                template: '<i [title]="type + \'Alert\'" class="icon {{type}} {{messageIconClass}}"></i>\n<span [innerHtml]="caption | trustAs: \'html\'"></span>\n<button title="Close" type="button" class="btn-transparent close" [hidden]="hideclose" (click)="dismiss($event)" aria-label="Close">\n    <span aria-hidden="true">&times;</span>\n</button>',
                providers: [ provideAsWidgetRef(MessageComponent) ]
            } ]
        } ];
        MessageComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return MessageComponent;
    }(StylableComponent);
    var registerProps$2 = function() {
        register("wm-partial", new Map([ [ "name", PROP_STRING ] ]));
    };
    var DEFAULT_CLS$2 = "app-partial clearfix";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-partial",
        hostClass: DEFAULT_CLS$2
    };
    var PartialDirective = function(_super) {
        __extends(PartialDirective, _super);
        function PartialDirective(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$2) || this;
        }
        PartialDirective.initializeProps = registerProps$2();
        PartialDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmPartial]",
                providers: [ provideAsWidgetRef(PartialDirective) ]
            } ]
        } ];
        PartialDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return PartialDirective;
    }(StylableComponent);
    var PartialParamHandlerDirective = function() {
        function PartialParamHandlerDirective(widgetRef) {
            this.widgetRef = widgetRef;
            this.widgetRef.partialParams = {};
            this.widgetRef.pageParams = this.widgetRef.partialParams;
            this.widgetRef.params$ = new rxjs.Subject();
        }
        PartialParamHandlerDirective.prototype.registerParams = function(name, value, bindExpr, type) {
            var _this = this;
            this.widgetRef.partialParams[name] = value;
            if (!value && bindExpr) {
                this.widgetRef.registerDestroyListener(core$1.$watch(bindExpr, this.widgetRef.getViewParent(), _.get(this.widgetRef, "context"), function(nv) {
                    _this.widgetRef.partialParams[name] = nv;
                    _this.widgetRef.params$.next();
                }));
            } else {
                this.widgetRef.params$.next();
            }
        };
        PartialParamHandlerDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[partialContainer]"
            } ]
        } ];
        PartialParamHandlerDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ WidgetRef ]
                } ]
            } ];
        };
        return PartialParamHandlerDirective;
    }();
    var PartialParamDirective = function() {
        function PartialParamDirective(bindValue, type, partialParamsProvider) {
            this.bindValue = bindValue;
            this.type = type;
            this.partialParamsProvider = partialParamsProvider;
        }
        PartialParamDirective.prototype.ngOnInit = function() {
            this.partialParamsProvider.registerParams(this.name, this.value, this.bindValue, this.type);
        };
        PartialParamDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmParam]"
            } ]
        } ];
        PartialParamDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "value.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "type" ]
                } ]
            }, {
                type: PartialParamHandlerDirective
            } ];
        };
        PartialParamDirective.propDecorators = {
            name: [ {
                type: core.Input
            } ],
            value: [ {
                type: core.Input
            } ]
        };
        return PartialParamDirective;
    }();
    var RedrawableDirective = function() {
        function RedrawableDirective(widget) {
            this.redraw = function() {
                return widget.redraw();
            };
        }
        RedrawableDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[redrawable]"
            } ]
        } ];
        RedrawableDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ WidgetRef ]
                } ]
            } ];
        };
        return RedrawableDirective;
    }();
    var ShowInDeviceDirective = function() {
        function ShowInDeviceDirective(elRef, showInDevice, widget) {
            var displayType = widget.getDisplayType();
            if (showInDevice) {
                showInDevice.split(",").forEach(function(deviceType) {
                    core$1.addClass(elRef.nativeElement, "visible-" + deviceType + "-" + displayType);
                });
            }
        }
        ShowInDeviceDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[showInDevice]"
            } ]
        } ];
        ShowInDeviceDirective.ctorParameters = function() {
            return [ {
                type: core.ElementRef
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "showInDevice" ]
                } ]
            }, {
                type: BaseComponent,
                decorators: [ {
                    type: core.Inject,
                    args: [ WidgetRef ]
                } ]
            } ];
        };
        return ShowInDeviceDirective;
    }();
    var SmoothScrollDirective = function() {
        function SmoothScrollDirective(inj, elRef, app) {
            this._isEnabled = false;
            this._lastScrollY = -1;
            this._waitRefreshTill = -1;
            this.pendingIscrolls = [];
            this._$el = $(elRef.nativeElement);
            this.app = app;
        }
        SmoothScrollDirective.prototype.ngOnInit = function() {
            var _this = this;
            this.cancelSubscription = this.app.subscribe("no-iscroll", function(el) {
                _this.pendingIscrolls.push(el);
            });
        };
        SmoothScrollDirective.prototype.ngDoCheck = function() {
            if (this._isEnabled) {
                if (!this._smoothScrollInstance) {
                    this._smoothScrollInstance = this.applySmoothScroll();
                } else {
                    this.refreshIScroll();
                }
            } else if (this._smoothScrollInstance && this._smoothScrollInstance.destroy) {
                this._smoothScrollInstance.destroy();
            }
        };
        SmoothScrollDirective.prototype.ngOnDestroy = function() {
            if (this._smoothScrollInstance && this._smoothScrollInstance.destroy) {
                this._smoothScrollInstance.destroy();
            }
            if (this.cancelSubscription) {
                this.cancelSubscription();
            }
        };
        Object.defineProperty(SmoothScrollDirective.prototype, "wmSmoothscroll", {
            set: function(val) {
                this._isEnabled = val === true || val === "true";
                if (this._isEnabled) {
                    if (!this._smoothScrollInstance) {
                        this._smoothScrollInstance = this.applySmoothScroll();
                    }
                } else {
                    this.ngOnDestroy();
                }
            },
            enumerable: true,
            configurable: true
        });
        SmoothScrollDirective.prototype.applySmoothScroll = function($events, activeEl) {
            var _this = this;
            if (!core$1.isMobileApp() || core$1.isKitkatDevice()) {
                return null;
            }
            var scrollOptions = {
                scrollbars: true,
                preventDefault: false,
                momentum: true,
                bounce: false,
                mouseWheel: true,
                disablePointer: true,
                disableTouch: false,
                disableMouse: false
            }, el = this._$el[0];
            if (!el.children.length) {
                return null;
            }
            this._$el.addClass("smoothscroll-wrapper");
            el.onscroll = function(e) {
                if (e.target.iscroll && e.target.scrollTop) {
                    e.target.iscroll.scrollTo(e.target.iscroll.x, e.target.iscroll.y - e.target.scrollTop);
                    e.target.scrollTop = 0;
                }
            };
            if (activeEl && activeEl.tagName === "INPUT") {
                activeEl.focus();
            }
            if ($events) {
                scrollOptions["fadeScrollbars"] = true;
            }
            var iScroll = new IScroll(el, scrollOptions);
            if ($events) {
                _.forEach($events, function(listeners, key) {
                    _.forEach(listeners, function(l) {
                        iScroll.on(key, l);
                    });
                });
                iScroll.on("scrollStart", function() {
                    this._scrolling = true;
                });
                iScroll.on("scrollEnd", function() {
                    this._scrolling = false;
                });
                iScroll.refresh();
            }
            iScroll.indicatorRefresh = function() {
                var indicators = _this._$el[0].iscroll.indicators;
                var i;
                if (indicators.length) {
                    for (i = 0; i < indicators.length; i++) {
                        indicators[i].refresh();
                    }
                }
            };
            this._$el[0].iscroll = iScroll;
            _.forEach(this.pendingIscrolls, function(_el, index) {
                if (_el.isSameNode(_this._$el[0])) {
                    _this.app.notify("iscroll-update", {
                        el: _el
                    });
                    _this.pendingIscrolls.splice(index, 1);
                    return;
                }
            });
            this.app.notify("iscroll-update", {});
            return {
                iScroll: iScroll,
                destroy: function() {
                    iScroll.destroy();
                    $(iScroll.scroller).css({
                        "transition-timing-function": "",
                        "transition-duration": "",
                        transform: ""
                    });
                    iScroll = null;
                    delete el.iscroll;
                }
            };
        };
        SmoothScrollDirective.prototype.refreshIScroll = function() {
            var iScroll = this._smoothScrollInstance.iScroll;
            var waitTime = 500;
            if (iScroll._scrolling || this._waitRefreshTill > Date.now()) {
                return;
            }
            if (iScroll.wrapper && !_.includes(iScroll.wrapper.children[0].classList, "smoothscroll-container") && iScroll.wrapper.scrollHeight > iScroll.wrapper.clientHeight) {
                var cloneEvents = iScroll._events;
                var prevActiveEl = document.activeElement;
                $(iScroll.wrapper.children).wrapAll('<div class="smoothscroll-container"></div>');
                this._smoothScrollInstance.destroy();
                this._smoothScrollInstance = this.applySmoothScroll(cloneEvents, prevActiveEl);
            }
            if (this._lastScrollY !== this._$el[0].iscroll.maxScrollY) {
                refreshIscrolls(this._smoothScrollInstance.iScroll);
                this._lastScrollY = this._$el[0].iscroll.maxScrollY;
            } else {
                this._smoothScrollInstance.iScroll.refresh();
            }
            this._waitRefreshTill = Date.now() + waitTime;
        };
        SmoothScrollDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmSmoothscroll]"
            } ]
        } ];
        SmoothScrollDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.ElementRef
            }, {
                type: core$1.App
            } ];
        };
        SmoothScrollDirective.propDecorators = {
            wmSmoothscroll: [ {
                type: core.Input
            } ]
        };
        return SmoothScrollDirective;
    }();
    var refreshIscrolls = function(iScroll) {
        var scrollContainer = !iScroll && $(".smoothscroll-container");
        var bScrollIntoView = iScroll && iScroll.wrapper && iScroll.wrapper.contains(document.activeElement);
        if (bScrollIntoView && $(document.activeElement).offset().top + document.activeElement.clientHeight > window.innerHeight * .9) {
            document.activeElement.scrollIntoView({
                behavior: "auto",
                block: "end",
                inline: "end"
            });
        }
        if (iScroll) {
            if (iScroll.indicatorRefresh) {
                iScroll.indicatorRefresh();
            }
            if (iScroll.refresh) {
                iScroll.refresh();
            }
        } else if (scrollContainer.length) {
            scrollContainer.parent().each(function(i, el) {
                el.iscroll.indicatorRefresh();
                el.iscroll.refresh();
            });
        }
    };
    window.addEventListener("resize", core$1.debounce(refreshIscrolls, 200));
    var TextContentDirective = function() {
        function TextContentDirective(elRef) {
            this.elRef = elRef;
        }
        Object.defineProperty(TextContentDirective.prototype, "textContent", {
            set: function(nv) {
                var v = nv;
                if (nv === undefined || nv === null) {
                    v = "";
                }
                this.elRef.nativeElement.textContent = v;
            },
            enumerable: true,
            configurable: true
        });
        TextContentDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[textContent]"
            } ]
        } ];
        TextContentDirective.ctorParameters = function() {
            return [ {
                type: core.ElementRef
            } ];
        };
        TextContentDirective.propDecorators = {
            textContent: [ {
                type: core.Input
            } ]
        };
        return TextContentDirective;
    }();
    var getEpochValue = function(data) {
        var epoch;
        if (!_.isDate(data) && !isNaN(data)) {
            data = parseInt(data, 10);
        }
        epoch = moment(data).valueOf() || moment(new Date().toDateString() + " " + data).valueOf();
        return epoch;
    };
    var ToDatePipe = function() {
        function ToDatePipe(datePipe) {
            this.datePipe = datePipe;
        }
        ToDatePipe.prototype.transform = function(data, format) {
            var timestamp;
            if (data === "null" || data === "") {
                return "";
            }
            if (!core$1.isDefined(data)) {
                return "";
            }
            timestamp = getEpochValue(data);
            if (timestamp) {
                if (format === "timestamp") {
                    return timestamp;
                }
                return this.datePipe.transform(timestamp, format);
            }
            return "";
        };
        ToDatePipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "toDate"
            } ]
        } ];
        ToDatePipe.ctorParameters = function() {
            return [ {
                type: common.DatePipe
            } ];
        };
        return ToDatePipe;
    }();
    var ToNumberPipe = function() {
        function ToNumberPipe(decimalPipe) {
            this.decimalPipe = decimalPipe;
        }
        ToNumberPipe.prototype.transform = function(data, fracSize) {
            if (fracSize && !String(fracSize).match(/^(\d+)?\.((\d+)(-(\d+))?)?$/)) {
                fracSize = "1." + fracSize + "-" + fracSize;
            }
            if (!_.isNaN(+data)) {
                return this.decimalPipe.transform(data, fracSize);
            }
        };
        ToNumberPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "toNumber"
            } ]
        } ];
        ToNumberPipe.ctorParameters = function() {
            return [ {
                type: common.DecimalPipe
            } ];
        };
        return ToNumberPipe;
    }();
    var ToCurrencyPipe = function() {
        function ToCurrencyPipe(decimalPipe) {
            this.decimalPipe = decimalPipe;
        }
        ToCurrencyPipe.prototype.transform = function(data, currencySymbol, fracSize) {
            var _currencySymbol = (core$1.CURRENCY_INFO[currencySymbol] || {}).symbol || currencySymbol || "", _val = new ToNumberPipe(this.decimalPipe).transform(data, fracSize);
            return _val ? _currencySymbol + _val : "";
        };
        ToCurrencyPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "toCurrency"
            } ]
        } ];
        ToCurrencyPipe.ctorParameters = function() {
            return [ {
                type: common.DecimalPipe
            } ];
        };
        return ToCurrencyPipe;
    }();
    var PrefixPipe = function() {
        function PrefixPipe() {}
        PrefixPipe.prototype.transform = function(data, padding) {
            return _.isUndefined(data) || data === null || data === "" ? data : (padding || "") + data;
        };
        PrefixPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "prefix"
            } ]
        } ];
        return PrefixPipe;
    }();
    var SuffixPipe = function() {
        function SuffixPipe() {}
        SuffixPipe.prototype.transform = function(data, padding) {
            return _.isUndefined(data) || data === null || data === "" ? data : data + (padding || "");
        };
        SuffixPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "suffix"
            } ]
        } ];
        return SuffixPipe;
    }();
    var TimeFromNowPipe = function() {
        function TimeFromNowPipe() {}
        TimeFromNowPipe.prototype.transform = function(data) {
            var timestamp;
            if (!core$1.isDefined(data)) {
                return undefined;
            }
            timestamp = getEpochValue(data);
            return timestamp ? moment(timestamp).fromNow() : undefined;
        };
        TimeFromNowPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "timeFromNow"
            } ]
        } ];
        return TimeFromNowPipe;
    }();
    var NumberToStringPipe = function(_super) {
        __extends(NumberToStringPipe, _super);
        function NumberToStringPipe() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        NumberToStringPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "numberToString"
            } ]
        } ];
        return NumberToStringPipe;
    }(ToNumberPipe);
    var StringToNumberPipe = function() {
        function StringToNumberPipe() {}
        StringToNumberPipe.prototype.transform = function(data) {
            return Number(data) || undefined;
        };
        StringToNumberPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "stringToNumber"
            } ]
        } ];
        return StringToNumberPipe;
    }();
    var FilterPipe = function() {
        function FilterPipe() {}
        FilterPipe.prototype.transform = function(data, field, value) {
            if (!data) {
                return [];
            }
            if (_.isObject(field)) {
                return _.filter(data, field);
            }
            return _.filter(data, function(item) {
                return _.includes(item[field], value);
            });
        };
        FilterPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "filter"
            } ]
        } ];
        return FilterPipe;
    }();
    var FileSizePipe = function() {
        function FileSizePipe() {}
        FileSizePipe.prototype.transform = function(bytes, precision) {
            var units = [ "bytes", "KB", "MB", "GB", "TB", "PB" ];
            var unit = 0;
            while (bytes >= 1024) {
                bytes /= 1024;
                unit++;
            }
            return bytes.toFixed(+precision) + " " + units[unit];
        };
        FileSizePipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "filesize"
            } ]
        } ];
        return FileSizePipe;
    }();
    var FileIconClassPipe = function() {
        function FileIconClassPipe() {}
        FileIconClassPipe.prototype.transform = function(fileExtension) {
            var fileClassMapping = {
                zip: "fa-file-zip-o",
                pdf: "fa-file-pdf-o",
                rar: "fa-file-archive-o",
                txt: "fa-file-text-o",
                ppt: "fa-file-powerpoint-o",
                pot: "fa-file-powerpoint-o",
                pps: "fa-file-powerpoint-o",
                pptx: "fa-file-powerpoint-o",
                potx: "fa-file-powerpoint-o",
                ppsx: "fa-file-powerpoint-o",
                mpg: "fa-file-movie-o",
                mp4: "fa-file-movie-o",
                mov: "fa-file-movie-o",
                avi: "fa-file-movie-o",
                mp3: "fa-file-audio-o",
                docx: "fa-file-word-o",
                js: "fa-file-code-o",
                md: "fa-file-code-o",
                html: "fa-file-code-o",
                css: "fa-file-code-o",
                xlsx: "fa-file-excel-o",
                png: "fa-file-image-o",
                jpg: "fa-file-image-o",
                jpeg: "fa-file-image-o",
                file: "fa-file-o",
                default: "fa-file-o"
            };
            return "fa " + (fileClassMapping[fileExtension] || "fa-file-o");
        };
        FileIconClassPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "fileIconClass"
            } ]
        } ];
        return FileIconClassPipe;
    }();
    var StateClassPipe = function() {
        function StateClassPipe() {}
        StateClassPipe.prototype.transform = function(state) {
            var stateClassMap = {
                success: "wi wi-done text-success",
                error: "wi wi-cancel text-danger"
            };
            return stateClassMap[state.toLowerCase()];
        };
        StateClassPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "stateClass"
            } ]
        } ];
        return StateClassPipe;
    }();
    var FileExtensionFromMimePipe = function() {
        function FileExtensionFromMimePipe() {}
        FileExtensionFromMimePipe.prototype.transform = function(mimeType) {
            var typeMapping = {
                "audio/aac": ".aac",
                "application/x-abiword": ".abw",
                "application/vnd.android.package-archive": ".apk",
                "video/x-msvideo": ".avi",
                "application/vnd.amazon.ebook": ".azw",
                "application/octet-stream": ".bin",
                "image/bmp": ".bmp",
                "application/x-bzip": ".bz",
                "application/x-bzip2": ".bz2",
                "application/x-csh": ".csh",
                "text/css": ".css",
                "text/csv": ".csv",
                "application/msword": ".doc",
                "application/vnd.openxmlformats-officedocument.wordprocessingml.document": ".docx",
                "application/vnd.ms-fontobject": ".eot",
                "application/epub+zip": ".epub",
                "application/ecmascript": ".es",
                "image/gif": ".gif",
                "text/html": ".html",
                "image/x-icon": ".ico",
                "text/calendar": ".ics",
                "application/java-archive": ".jar",
                "image/jpeg": [ ".jpeg", ".jpg" ],
                "application/javascript": ".js",
                "application/json": ".json",
                "audio/midi": ".mid",
                "audio/x-midi": ".midi",
                "video/mpeg": ".mpeg",
                "application/vnd.apple.installer+xml": "mpkg",
                "application/vnd.oasis.opendocument.presentation": ".odp",
                "application/vnd.oasis.opendocument.spreadsheet": ".ods",
                "application/vnd.oasis.opendocument.text": ".odt",
                "audio/ogg": ".oga",
                "video/ogg": ".ogv",
                "application/ogg": ".ogx",
                "font/otf": ".otf",
                "image/png": ".png",
                "application/pdf": ".pdf",
                "application/vnd.ms-powerpoint": ".ppt",
                "application/vnd.openxmlformats-officedocument.presentationml.presentation": ".pptx",
                "application/x-rar-compressed": ".rar",
                "application/rtf": ".rtf",
                "application/x-sh": ".sh",
                "image/svg+xml": ".svg",
                "application/x-shockwave-flash": ".swf",
                "application/x-tar": ".tar",
                "image/tiff": ".tiff",
                "application/typescript": ".ts",
                "font/ttf": ".ttf",
                "text/plain": ".txt",
                "application/vnd.visio": ".vsd",
                "audio/wav": ".wav",
                "audio/webm": ".weba",
                "video/webm": ".webm",
                "image/webp": ".webp",
                "font/woff": ".woff",
                "font/woff2": ".woff2",
                "application/xhtml+xml": ".xhtml",
                "application/vnd.ms-excel": ".xls",
                "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet": ".xlsx",
                "application/xml": ".xml",
                "application/vnd.mozilla.xul+xml": ".xul",
                "application/zip": ".zip",
                "video/3gpp": ".3gp",
                "audio/3gpp": ".3gp",
                "video/3gpp2": ".3g2",
                "audio/3gpp2": ".3g2",
                "application/x-7z-compressed": ".7z"
            };
            return typeMapping[mimeType];
        };
        FileExtensionFromMimePipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "fileExtensionFromMime"
            } ]
        } ];
        return FileExtensionFromMimePipe;
    }();
    var TrustAsPipe = function() {
        function TrustAsPipe(domSanitizer) {
            this.domSanitizer = domSanitizer;
        }
        TrustAsPipe.prototype.transform = function(content, as) {
            if (as === "resource" || as === core.SecurityContext.RESOURCE_URL) {
                if (!content) {
                    return "";
                }
                return this.domSanitizer.bypassSecurityTrustResourceUrl(content);
            }
            if (as === "html" || as === core.SecurityContext.HTML) {
                if (content === null || content === undefined) {
                    return "";
                }
                return this.domSanitizer.sanitize(core.SecurityContext.HTML, content);
            }
        };
        TrustAsPipe.decorators = [ {
            type: core.Pipe,
            args: [ {
                name: "trustAs"
            } ]
        } ];
        TrustAsPipe.ctorParameters = function() {
            return [ {
                type: platformBrowser.DomSanitizer
            } ];
        };
        return TrustAsPipe;
    }();
    var openedDialogs = [];
    var closeDialogsArray = [];
    var DialogServiceImpl = function() {
        function DialogServiceImpl() {
            this.dialogRefsCollection = new Map();
            this.appConfirmDialog = "_app-confirm-dialog";
        }
        DialogServiceImpl.prototype.register = function(name, dialogRef, scope) {
            if (!name) {
                return;
            }
            if (this.dialogRefsCollection.get(name)) {
                this.dialogRefsCollection.get(name).set(scope, dialogRef);
            } else {
                this.dialogRefsCollection.set(name, new Map([ [ scope, dialogRef ] ]));
            }
        };
        DialogServiceImpl.prototype.getDialogRefsCollection = function() {
            return this.dialogRefsCollection;
        };
        DialogServiceImpl.prototype.deRegister = function(name, scope) {
            if (!name) {
                return;
            }
            if (this.dialogRefsCollection.get(name)) {
                this.dialogRefsCollection.get(name).delete(scope);
            }
        };
        DialogServiceImpl.prototype.getDialogRef = function(name, scope) {
            var dialogRefMap = this.dialogRefsCollection.get(name);
            var dialogRef;
            if (scope) {
                dialogRef = dialogRefMap.get(scope);
                if (!dialogRef) {
                    if (!scope.pageName && !scope.partialName && !scope.prefabName) {
                        dialogRefMap.forEach(function(dRef, dialogScope) {
                            if (dialogScope && dialogScope.partialName === "Common") {
                                dialogRef = dRef;
                            } else {
                                console.error('No dialog with the name "' + name + '" found in the App scope.');
                            }
                        });
                    } else {
                        console.error('No dialog with the name "' + name + '" found in the given scope.');
                    }
                }
            } else {
                if (dialogRefMap.size === 1) {
                    dialogRef = dialogRefMap.entries().next().value[1];
                } else {
                    console.error("There are multiple instances of this dialog name. Please provide the Page/Partial/App instance in which the dialog exists.");
                }
            }
            return dialogRef;
        };
        DialogServiceImpl.prototype.open = function(name, scope, initState) {
            var dialogRef = this.getDialogRef(name, scope);
            if (!dialogRef) {
                return;
            }
            dialogRef.open(initState);
        };
        DialogServiceImpl.prototype.close = function(name, scope) {
            var dialogRef = this.getDialogRef(name, scope);
            if (!dialogRef) {
                return;
            }
            dialogRef.close();
        };
        DialogServiceImpl.prototype.closeAllDialogs = function() {
            _.forEach(openedDialogs.reverse(), function(dialog) {
                dialog.close();
            });
        };
        DialogServiceImpl.prototype.showAppConfirmDialog = function(initState) {
            this.open(this.getAppConfirmDialog(), undefined, initState);
        };
        DialogServiceImpl.prototype.closeAppConfirmDialog = function() {
            this.close(this.getAppConfirmDialog());
        };
        DialogServiceImpl.prototype.getAppConfirmDialog = function() {
            return this.appConfirmDialog;
        };
        DialogServiceImpl.prototype.setAppConfirmDialog = function(dialogName) {
            this.appConfirmDialog = dialogName;
        };
        DialogServiceImpl.prototype.addToOpenedDialogs = function(ref) {
            openedDialogs.push(ref);
        };
        DialogServiceImpl.prototype.getLastOpenedDialog = function() {
            return openedDialogs[openedDialogs.length - 1];
        };
        DialogServiceImpl.prototype.removeFromOpenedDialogs = function(ref) {
            if (openedDialogs.indexOf(ref) !== -1) {
                openedDialogs.splice(openedDialogs.indexOf(ref), 1);
            }
        };
        DialogServiceImpl.prototype.getOpenedDialogs = function() {
            return openedDialogs;
        };
        DialogServiceImpl.prototype.addToClosedDialogs = function(ref) {
            closeDialogsArray.push(ref);
        };
        DialogServiceImpl.prototype.removeFromClosedDialogs = function(ref) {
            if (closeDialogsArray.indexOf(ref) !== -1) {
                closeDialogsArray.splice(closeDialogsArray.indexOf(ref), 1);
            }
        };
        DialogServiceImpl.prototype.getDialogRefFromClosedDialogs = function() {
            return closeDialogsArray[closeDialogsArray.length - 1];
        };
        DialogServiceImpl.decorators = [ {
            type: core.Injectable
        } ];
        DialogServiceImpl.ctorParameters = function() {
            return [];
        };
        return DialogServiceImpl;
    }();
    var wmComponents = [ ContainerDirective, LazyLoadDirective, MessageComponent, PartialDirective, PartialParamHandlerDirective, PartialParamDirective, RedrawableDirective, ShowInDeviceDirective, SmoothScrollDirective, TextContentDirective ];
    var PIPES = [ ToDatePipe, FileIconClassPipe, FileExtensionFromMimePipe, FilterPipe, FileSizePipe, ToNumberPipe, ToCurrencyPipe, PrefixPipe, SuffixPipe, TimeFromNowPipe, NumberToStringPipe, StateClassPipe, StringToNumberPipe, TrustAsPipe, ImagePipe ];
    var WmComponentsModule = function() {
        function WmComponentsModule() {}
        WmComponentsModule.forRoot = function() {
            return {
                ngModule: WmComponentsModule,
                providers: [ ToDatePipe, FilterPipe, TrustAsPipe, ImagePipe, common.Location, {
                    provide: core$1.AbstractDialogService,
                    useClass: DialogServiceImpl
                } ]
            };
        };
        WmComponentsModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, security.SecurityModule ],
                declarations: __spread(wmComponents, PIPES),
                exports: __spread(wmComponents, PIPES)
            } ]
        } ];
        return WmComponentsModule;
    }();
    var noop = function() {};
    var \u02750$7 = noop;
    (function(Live_Operations) {
        Live_Operations["INSERT"] = "insert";
        Live_Operations["UPDATE"] = "update";
        Live_Operations["DELETE"] = "delete";
        Live_Operations["READ"] = "read";
    })(exports.Live_Operations || (exports.Live_Operations = {}));
    var ALLFIELDS = "All Fields";
    var LIVE_CONSTANTS = {
        EMPTY_KEY: "EMPTY_NULL_FILTER",
        EMPTY_VALUE: "No Value",
        LABEL_KEY: "key",
        LABEL_VALUE: "value",
        NULL_EMPTY: [ "null", "empty" ],
        NULL: "null",
        EMPTY: "empty"
    };
    function isSearchWidgetType(widget) {
        return _.includes([ core$1.FormWidgetType.AUTOCOMPLETE, core$1.FormWidgetType.TYPEAHEAD, core$1.FormWidgetType.CHIPS ], widget);
    }
    function onSuccess(response, res, rej) {
        if (response.error) {
            rej(response);
        } else {
            res(response);
        }
    }
    function performDataOperation(dataSource, requestData, options) {
        return new Promise(function(res, rej) {
            if (dataSource.execute(core$1.DataSource.Operation.SUPPORTS_CRUD)) {
                var fn = void 0;
                var operationType = options.operationType;
                switch (operationType) {
                  case exports.Live_Operations.UPDATE:
                    fn = core$1.DataSource.Operation.UPDATE_RECORD;
                    break;

                  case exports.Live_Operations.INSERT:
                    fn = core$1.DataSource.Operation.INSERT_RECORD;
                    break;

                  case exports.Live_Operations.DELETE:
                    fn = core$1.DataSource.Operation.DELETE_RECORD;
                    break;
                }
                dataSource.execute(fn, requestData).then(function(response) {
                    return onSuccess(response, res, rej);
                }, rej);
            } else if (dataSource.execute(core$1.DataSource.Operation.IS_API_AWARE)) {
                dataSource.execute(core$1.DataSource.Operation.SET_INPUT, requestData);
                dataSource.execute(core$1.DataSource.Operation.INVOKE, {
                    skipNotification: true
                }).then(res, rej);
            } else {
                res(requestData);
            }
        });
    }
    function refreshDataSource(dataSource, options) {
        return new Promise(function(res, rej) {
            if (!dataSource) {
                rej();
                return;
            }
            dataSource.execute(core$1.DataSource.Operation.LIST_RECORDS, {
                filterFields: options.filterFields || {},
                orderBy: options.orderBy,
                page: options.page || 1
            }).then(res, rej);
        });
    }
    function fetchRelatedFieldData(dataSource, formField, options) {
        var primaryKeys;
        var displayField;
        var relatedField = options.relatedField;
        var datafield = options.datafield;
        if (!dataSource) {
            return;
        }
        primaryKeys = dataSource.execute(core$1.DataSource.Operation.GET_RELATED_PRIMARY_KEYS, relatedField);
        formField.datafield = datafield;
        formField._primaryKey = _.isEmpty(primaryKeys) ? undefined : primaryKeys[0];
        formField.compareby = primaryKeys && primaryKeys.join(",");
        displayField = datafield === ALLFIELDS ? undefined : datafield;
        formField.displayfield = displayField = formField.displayfield || displayField || formField._primaryKey;
        if (isSearchWidgetType(formField[options.widget])) {
            formField.dataoptions = {
                relatedField: relatedField,
                filterExpr: formField.filterexpressions ? formField.filterexpressions : {}
            };
            formField.datasource = dataSource;
            formField.searchkey = formField.searchkey || displayField;
            formField.displaylabel = formField.displayfield = formField.displaylabel || displayField;
        } else {
            interpolateBindExpressions(formField.viewParent, formField.filterexpressions, function(filterexpressions) {
                formField.filterexpressions = filterexpressions;
                dataSource.execute(core$1.DataSource.Operation.GET_RELATED_TABLE_DATA, {
                    relatedField: relatedField,
                    pagesize: formField.limit,
                    orderBy: formField.orderby ? _.replace(formField.orderby, /:/g, " ") : "",
                    filterFields: {},
                    filterExpr: formField.filterexpressions ? formField.filterexpressions : {}
                }).then(function(response) {
                    formField.dataset = response.data;
                    formField.displayfield = formField.displayfield || _.head(_.keys(_.get(response, "[0]")));
                }, noop);
            });
        }
    }
    var interpolateBindExpressions = function(context, filterexpressions, callbackFn) {
        var debouncedFn = core$1.debounce(function() {
            if (_.isFunction(callbackFn)) {
                callbackFn(filterexpressions);
            }
        }, 300);
        debouncedFn();
        var filterExpressions = filterexpressions ? _.isObject(filterexpressions) ? filterexpressions : JSON.parse(filterexpressions) : {};
        var destroyFn = context.registerDestroyListener ? context.registerDestroyListener.bind(context) : _.noop;
        var filterSubscription = core$1.processFilterExpBindNode(context, filterExpressions).subscribe(function(response) {
            filterexpressions = JSON.stringify(response.filterExpressions);
            debouncedFn();
        });
        destroyFn(function() {
            return filterSubscription.unsubscribe();
        });
    };
    var getDistinctFieldProperties = function(dataSource, formField) {
        var props = {};
        var fieldColumn;
        if (formField["is-related"]) {
            props.tableName = formField["lookup-type"];
            fieldColumn = formField["lookup-field"];
            props.distinctField = fieldColumn;
            props.aliasColumn = fieldColumn.replace(".", "$");
            props.filterExpr = formField.filterexpressions ? _.isObject(formField.filterexpressions) ? formField.filterexpressions : JSON.parse(formField.filterexpressions) : {};
        } else {
            props.tableName = dataSource.execute(core$1.DataSource.Operation.GET_ENTITY_NAME);
            fieldColumn = formField.field || formField.key;
            props.distinctField = fieldColumn;
            props.aliasColumn = fieldColumn;
        }
        return props;
    };
    function getDistinctValues(dataSource, formField, widget) {
        var props;
        return new Promise(function(res, rej) {
            if (isDataSetWidget(formField[widget]) && (!formField.isDataSetBound || widget === "filterwidget")) {
                props = getDistinctFieldProperties(dataSource, formField);
                dataSource.execute(core$1.DataSource.Operation.GET_DISTINCT_DATA_BY_FIELDS, {
                    fields: props.distinctField,
                    entityName: props.tableName,
                    pagesize: formField.limit,
                    filterExpr: formField.filterexpressions ? JSON.parse(formField.filterexpressions) : {}
                }).then(function(response) {
                    res({
                        field: formField,
                        data: response.data,
                        aliasColumn: props.aliasColumn
                    });
                }, rej);
            }
        });
    }
    function setDataFields(formField, options) {
        if (isSearchWidgetType(formField[options.widget])) {
            formField.datafield = options.aliasColumn || LIVE_CONSTANTS.LABEL_KEY;
            formField.searchkey = options.distinctField || LIVE_CONSTANTS.LABEL_KEY;
            formField.displaylabel = formField.displayfield = options.aliasColumn || LIVE_CONSTANTS.LABEL_VALUE;
            return;
        }
        formField.datafield = LIVE_CONSTANTS.LABEL_KEY;
        formField.displayfield = LIVE_CONSTANTS.LABEL_VALUE;
    }
    function setFieldDataSet(formField, data, options) {
        var emptySupportWidgets = [ core$1.FormWidgetType.SELECT, core$1.FormWidgetType.RADIOSET ];
        var emptyOption = {};
        var dataSet = [];
        if (options.isEnableEmptyFilter && _.includes(emptySupportWidgets, formField[options.widget]) && !formField["is-range"] && !formField.multiple) {
            emptyOption[LIVE_CONSTANTS.LABEL_KEY] = LIVE_CONSTANTS.EMPTY_KEY;
            emptyOption[LIVE_CONSTANTS.LABEL_VALUE] = options.EMPTY_VALUE || LIVE_CONSTANTS.EMPTY_VALUE;
            dataSet.push(emptyOption);
        }
        _.each(data, function(key) {
            var value = key[options.aliasColumn];
            var option = {};
            if (value !== null && value !== "") {
                option[LIVE_CONSTANTS.LABEL_KEY] = value;
                option[LIVE_CONSTANTS.LABEL_VALUE] = value;
                dataSet.push(option);
            }
        });
        setDataFields(formField, options);
        formField.dataset = dataSet;
    }
    function fetchDistinctValues(dataSource, formFields, options) {
        if (_.isEmpty(formFields)) {
            return;
        }
        formFields.forEach(function(formField) {
            getDistinctValuesForField(dataSource, formField, options);
        });
    }
    function getDistinctValuesForField(dataSource, formField, options) {
        if (!dataSource || !formField || formField.isDataSetBound) {
            return;
        }
        if (isSearchWidgetType(formField[options.widget])) {
            var dataoptions = getDistinctFieldProperties(dataSource, formField);
            formField.dataoptions = dataoptions;
            setDataFields(formField, Object.assign(options || {}, dataoptions));
            formField.datasource = dataSource;
        } else {
            interpolateBindExpressions(formField.viewParent, formField.filterexpressions, function(filterexpressions) {
                formField.filterexpressions = filterexpressions;
                getDistinctValues(dataSource, formField, options.widget).then(function(res) {
                    setFieldDataSet(res.field, res.data, {
                        aliasColumn: res.aliasColumn,
                        widget: options.widget,
                        isEnableEmptyFilter: getEnableEmptyFilter(options.enableemptyfilter),
                        EMPTY_VALUE: options.EMPTY_VALUE
                    });
                });
            });
        }
    }
    function isDefinedAndNotEmpty(val) {
        return core$1.isDefined(val) && val !== "" && val !== null;
    }
    function getRangeFieldValue(minValue, maxValue) {
        var fieldValue;
        if (isDefinedAndNotEmpty(minValue) && isDefinedAndNotEmpty(maxValue)) {
            fieldValue = [ minValue, maxValue ];
        } else if (isDefinedAndNotEmpty(minValue)) {
            fieldValue = minValue;
        } else if (isDefinedAndNotEmpty(maxValue)) {
            fieldValue = maxValue;
        }
        return fieldValue;
    }
    function getRangeMatchMode(minValue, maxValue) {
        var matchMode;
        if (isDefinedAndNotEmpty(minValue) && isDefinedAndNotEmpty(maxValue)) {
            matchMode = core$1.MatchMode.BETWEEN;
        } else if (isDefinedAndNotEmpty(minValue)) {
            matchMode = core$1.MatchMode.GREATER;
        } else if (isDefinedAndNotEmpty(maxValue)) {
            matchMode = core$1.MatchMode.LESSER;
        }
        return matchMode;
    }
    function getEnableEmptyFilter(enableemptyfilter) {
        return enableemptyfilter && _.intersection(enableemptyfilter.split(","), LIVE_CONSTANTS.NULL_EMPTY).length > 0;
    }
    function getEmptyMatchMode(enableemptyfilter) {
        var matchMode;
        var emptyFilterOptions = _.split(enableemptyfilter, ",");
        if (_.intersection(emptyFilterOptions, LIVE_CONSTANTS.NULL_EMPTY).length === 2) {
            matchMode = core$1.MatchMode.NULLOREMPTY;
        } else if (_.includes(emptyFilterOptions, LIVE_CONSTANTS.NULL)) {
            matchMode = core$1.MatchMode.NULL;
        } else if (_.includes(emptyFilterOptions, LIVE_CONSTANTS.EMPTY)) {
            matchMode = core$1.MatchMode.EMPTY;
        }
        return matchMode;
    }
    var createArrayFrom = function(data) {
        if (_.isUndefined(data) || _.isNull(data)) {
            return [];
        }
        if (_.isString(data)) {
            data = data.split(",").map(Function.prototype.call, String.prototype.trim);
        }
        if (!_.isArray(data)) {
            data = [ data ];
        }
        return data;
    };
    function applyFilterOnField(dataSource, filterDef, formFields, newVal, options) {
        if (options === void 0) {
            options = {};
        }
        var fieldName = filterDef.field || filterDef.key;
        var filterOnFields = _.filter(formFields, {
            "filter-on": fieldName
        });
        newVal = filterDef["is-range"] ? getRangeFieldValue(filterDef.minValue, filterDef.maxValue) : core$1.isDefined(newVal) ? newVal : filterDef.value;
        if (!dataSource || options.isFirst && (_.isUndefined(newVal) || newVal === "")) {
            return;
        }
        _.forEach(filterOnFields, function(filterField) {
            var filterKey = filterField.field || filterField.key;
            var lookUpField = filterDef["lookup-field"] || filterDef._primaryKey;
            var filterWidget = filterField["edit-widget-type"] || filterField.widgettype;
            var filterFields = {};
            var filterOn = filterField["filter-on"];
            var filterVal;
            var fieldColumn;
            var matchMode;
            if (!isDataSetWidget(filterWidget) || filterField.isDataSetBound || filterOn === filterKey) {
                return;
            }
            if (filterDef && filterDef["is-related"]) {
                filterOn += "." + lookUpField;
            }
            if (core$1.isDefined(newVal)) {
                if (filterDef["is-range"]) {
                    matchMode = getRangeMatchMode(filterDef.minValue, filterDef.maxValue);
                } else if (getEnableEmptyFilter(options.enableemptyfilter) && newVal === LIVE_CONSTANTS.EMPTY_KEY) {
                    matchMode = getEmptyMatchMode(options.enableemptyfilter);
                } else {
                    matchMode = core$1.MatchMode.EQUALS;
                }
                filterVal = _.isObject(newVal) && !_.isArray(newVal) ? newVal[lookUpField] : newVal;
                filterFields[filterOn] = {
                    value: filterVal,
                    matchMode: matchMode
                };
            } else {
                filterFields = {};
            }
            fieldColumn = filterKey;
            if (isSearchWidgetType(filterWidget) && filterField.dataoptions) {
                filterField.dataoptions.filterFields = filterFields;
            } else {
                dataSource.execute(core$1.DataSource.Operation.GET_DISTINCT_DATA_BY_FIELDS, {
                    fields: fieldColumn,
                    filterFields: filterFields,
                    pagesize: filterField.limit
                }).then(function(response) {
                    setFieldDataSet(filterField, response.data, {
                        aliasColumn: fieldColumn,
                        widget: options.widget || "widgettype",
                        isEnableEmptyFilter: getEnableEmptyFilter(options.enableemptyfilter),
                        EMPTY_VALUE: options.EMPTY_VALUE
                    });
                }, noop);
            }
        });
    }
    function transformData(dataObject, variableName) {
        var newObj, tempArr, keys, oldKeys, numKeys, newObject, tempObj;
        dataObject = dataObject || [];
        if (!_.isArray(dataObject)) {
            if (_.isString(dataObject)) {
                keys = variableName.substring(variableName.indexOf(".") + 1, variableName.length).split(".");
                oldKeys = [];
                numKeys = keys.length;
                newObject = {};
                tempObj = newObject;
                keys.forEach(function(key, index) {
                    oldKeys.forEach(function(oldKey) {
                        tempObj = newObject[oldKey];
                    });
                    tempObj[key] = index === numKeys - 1 ? dataObject : {};
                    oldKeys.push(key);
                });
                dataObject = newObject;
            }
            dataObject = [ dataObject ];
        } else {
            if (_.isString(dataObject[0])) {
                tempArr = [];
                _.forEach(dataObject, function(str) {
                    newObj = {};
                    newObj[variableName.split(".").join("-")] = str;
                    tempArr.push(newObj);
                });
                dataObject = tempArr;
            }
        }
        return dataObject;
    }
    var momentLocale = moment.localeData();
    var momentCalendarOptions = core$1.getClonedObject(momentLocale._calendar);
    var momentCalendarDayOptions = momentLocale._calendarDay || {
        lastDay: "[Yesterday]",
        lastWeek: "[Last] dddd",
        nextDay: "[Tomorrow]",
        nextWeek: "dddd",
        sameDay: "[Today]",
        sameElse: "L"
    };
    var GROUP_BY_OPTIONS = {
        ALPHABET: "alphabet",
        WORD: "word",
        OTHERS: "Others"
    };
    var TIME_ROLLUP_OPTIONS = {
        HOUR: "hour",
        DAY: "day",
        WEEK: "week",
        MONTH: "month",
        YEAR: "year"
    };
    var ROLLUP_PATTERNS = {
        DAY: "yyyy-MM-dd",
        WEEK: "w 'Week',  yyyy",
        MONTH: "MMM, yyyy",
        YEAR: "YYYY",
        HOUR: "hh:mm a"
    };
    var getOrderedDataset = function(dataSet, orderBy, innerItem) {
        if (!orderBy) {
            return _.cloneDeep(dataSet);
        }
        var items = orderBy.split(","), fields = [], directions = [];
        items.forEach(function(obj) {
            var item = obj.split(":");
            fields.push(innerItem ? innerItem + "." + item[0] : item[0]);
            directions.push(item[1]);
        });
        return _.orderBy(dataSet, fields, directions);
    };
    var transformDataWithKeys = function(dataSet) {
        var data = [];
        if (_.isObject(dataSet[0]) || _.isObject(dataSet) && !(dataSet instanceof Array)) {
            var objectKeys = Object.keys(dataSet[0] || dataSet);
            _.forEach(objectKeys, function(objKey, index) {
                data.push({
                    key: objKey,
                    label: objKey,
                    value: objKey,
                    index: index + 1
                });
            });
        }
        return data;
    };
    var extractDataAsArray = function(data) {
        if (_.isUndefined(data) || _.isNull(data) || _.trim(data) === "") {
            return [];
        }
        if (_.isString(data)) {
            data = _.split(data, ",").map(function(str) {
                return str.trim();
            });
        }
        if (!_.isArray(data)) {
            data = [ data ];
        }
        return data;
    };
    var convertDataToObject = function(dataResult) {
        if (_.isString(dataResult)) {
            dataResult = _.split(dataResult, ",").map(function(str) {
                return str.trim();
            });
        }
        return dataResult;
    };
    var transformFormData = function(context, dataSet, myDataField, displayOptions, startIndex) {
        var data = [];
        if (!dataSet) {
            return;
        }
        dataSet = convertDataToObject(dataSet);
        if (_.isUndefined(startIndex)) {
            startIndex = 1;
        }
        if (_.isString(dataSet)) {
            dataSet = dataSet.split(",").map(function(str) {
                return str.trim();
            });
            dataSet.forEach(function(option, index) {
                data.push({
                    key: option,
                    value: option,
                    label: core$1.isDefined(option) && option !== null ? option.toString() : "",
                    index: startIndex + index
                });
            });
        } else if (_.isArray(dataSet) && !_.isObject(dataSet[0])) {
            dataSet.forEach(function(option, index) {
                data.push({
                    key: option,
                    value: option,
                    label: core$1.isDefined(option) && option !== null ? option.toString() : "",
                    index: startIndex + index
                });
            });
        } else if (!(dataSet instanceof Array) && _.isObject(dataSet)) {
            _.forEach(dataSet, function(value, key) {
                data.push({
                    key: _.trim(key),
                    value: key,
                    label: core$1.isDefined(value) && value !== null ? value.toString() : "",
                    index: startIndex,
                    dataObject: dataSet
                });
            });
        } else {
            if (!myDataField) {
                myDataField = ALLFIELDS;
            }
            dataSet.forEach(function(option, index) {
                var key = myDataField === ALLFIELDS ? startIndex + index : getObjValueByKey(option, myDataField);
                if (!_.isUndefined(key) && !_.isNull(key)) {
                    var label = getEvaluatedData(option, {
                        field: displayOptions.displayField,
                        expression: displayOptions.displayExpr,
                        bindExpression: displayOptions.bindDisplayExpr
                    }, context);
                    var dataSetItem = {
                        key: key,
                        label: core$1.isDefined(label) && label !== null ? label.toString() : "",
                        value: myDataField === ALLFIELDS ? option : key,
                        dataObject: option,
                        index: startIndex + index
                    };
                    if (displayOptions.displayImgSrc || displayOptions.bindDisplayImgSrc) {
                        dataSetItem.imgSrc = getEvaluatedData(option, {
                            expression: displayOptions.displayImgSrc,
                            bindExpression: displayOptions.bindDisplayImgSrc
                        }, context);
                    }
                    data.push(dataSetItem);
                }
            });
        }
        return data;
    };
    var getUniqObjsByDataField = function(data, dataField, displayField, allowEmptyFields) {
        var uniqData;
        var isAllFields = dataField === ALLFIELDS;
        uniqData = isAllFields ? _.uniqWith(data, _.isEqual) : _.uniqBy(data, "key");
        if (!displayField || allowEmptyFields) {
            return uniqData;
        }
        return _.filter(uniqData, function(obj) {
            if (isAllFields) {
                return _.trim(obj.label);
            }
            return _.trim(obj.key) && _.trim(obj.label);
        });
    };
    var setItemByCompare = function(datasetItems, compareWithDataObj, compareByField) {
        _.forEach(datasetItems, function(opt) {
            if (core$1.isEqualWithFields(opt.value, compareWithDataObj, compareByField)) {
                opt.selected = true;
                return false;
            }
        });
    };
    var getSortedGroupedData = function(groupedLiData, groupBy, orderby) {
        var _groupedData = [];
        _.forEach(_.keys(groupedLiData), function(groupkey, index) {
            var liData = getOrderedDataset(groupedLiData[groupkey], orderby, "dataObject");
            _groupedData.push({
                key: groupkey,
                data: _.sortBy(liData, function(data) {
                    data._groupIndex = index + 1;
                    return _.get(data, groupBy) || _.get(data.dataObject, groupBy);
                })
            });
        });
        return _groupedData;
    };
    var groupData = function(compRef, data, groupby, match, orderby, dateformat, datePipe, innerItem, AppDefaults) {
        var groupedLiData = {};
        if (_.includes(groupby, "(")) {
            var groupDataByUserDefinedFn_1 = core$1.$parseEvent(groupby);
            groupedLiData = _.groupBy(data, function(val) {
                return groupDataByUserDefinedFn_1(compRef.viewParent, {
                    row: val.dataObject || val
                });
            });
        } else {
            groupedLiData = getGroupedData(data, groupby, match, orderby, dateformat, datePipe, innerItem, AppDefaults);
        }
        return getSortedGroupedData(groupedLiData, groupby, orderby);
    };
    var getGroupedData = function(fieldDefs, groupby, match, orderby, dateFormat, datePipe, innerItem, AppDefaults) {
        if (match === TIME_ROLLUP_OPTIONS.DAY) {
            momentLocale._calendar = momentCalendarDayOptions;
        }
        fieldDefs = _.orderBy(fieldDefs, function(fieldDef) {
            var groupKey = _.get(innerItem ? fieldDef[innerItem] : fieldDef, groupby);
            if (groupKey) {
                return _.toLower(groupKey);
            }
        });
        var groupedLiData = _.groupBy(fieldDefs, groupDataByField.bind(undefined, groupby, match, innerItem, dateFormat, datePipe, AppDefaults));
        momentLocale._calendar = momentCalendarOptions;
        return groupedLiData;
    };
    var \u02751$2 = getGroupedData;
    var filterDate = function(value, format, defaultFormat, datePipe) {
        if (format === "timestamp") {
            return value;
        }
        return core$1.getFormattedDate(datePipe, value, format || defaultFormat);
    };
    var getTimeRolledUpString = function(concatStr, rollUp, dateformat, datePipe, AppDefaults) {
        var groupByKey, strMoment = moment(concatStr), dateFormat = dateformat;
        var currMoment = moment(), getSameElseFormat = function() {
            return "[" + filterDate(this.valueOf(), dateFormat, ROLLUP_PATTERNS.DAY, datePipe) + "]";
        };
        switch (rollUp) {
          case TIME_ROLLUP_OPTIONS.HOUR:
            dateFormat = dateFormat || AppDefaults.timeFormat;
            if (!strMoment.isValid()) {
                strMoment = moment(new Date().toDateString() + " " + concatStr);
                if (strMoment.isValid()) {
                    momentLocale._calendar.sameDay = function() {
                        return "[" + filterDate(this.valueOf(), dateFormat, ROLLUP_PATTERNS.HOUR, datePipe) + "]";
                    };
                }
            }
            strMoment = strMoment.startOf("hour");
            momentLocale._calendar.sameElse = getSameElseFormat;
            groupByKey = strMoment.calendar(currMoment);
            break;

          case TIME_ROLLUP_OPTIONS.WEEK:
            groupByKey = filterDate(strMoment.valueOf(), dateFormat, ROLLUP_PATTERNS.WEEK, datePipe);
            break;

          case TIME_ROLLUP_OPTIONS.MONTH:
            groupByKey = filterDate(strMoment.valueOf(), dateFormat, ROLLUP_PATTERNS.MONTH, datePipe);
            break;

          case TIME_ROLLUP_OPTIONS.YEAR:
            groupByKey = strMoment.format(ROLLUP_PATTERNS.YEAR);
            break;

          case TIME_ROLLUP_OPTIONS.DAY:
            dateFormat = dateFormat || AppDefaults.dateFormat;
            strMoment = strMoment.startOf("day");
            momentLocale._calendar.sameElse = getSameElseFormat;
            groupByKey = strMoment.calendar(currMoment);
            break;
        }
        if (groupByKey === "Invalid date") {
            return GROUP_BY_OPTIONS.OTHERS;
        }
        return groupByKey;
    };
    var \u02752$1 = getTimeRolledUpString;
    var groupDataByField = function(groupby, match, innerItem, dateFormat, datePipe, AppDefaults, liData) {
        var concatStr = _.get(innerItem ? liData[innerItem] : liData, groupby);
        if (_.isUndefined(concatStr) || _.isNull(concatStr) || concatStr.toString().trim() === "") {
            return GROUP_BY_OPTIONS.OTHERS;
        }
        if (match === GROUP_BY_OPTIONS.ALPHABET) {
            concatStr = concatStr.substr(0, 1);
        }
        if (_.includes(_.values(TIME_ROLLUP_OPTIONS), match)) {
            concatStr = getTimeRolledUpString(concatStr, match, dateFormat, datePipe, AppDefaults);
        }
        return concatStr;
    };
    var \u02753$1 = groupDataByField;
    var toggleAllHeaders = function(el) {
        var groups = $(el.nativeElement).find(".item-group");
        groups.find(".group-list-item").toggle();
        var groupIcons = groups.find("li.list-group-header .app-icon");
        if (groupIcons) {
            _.forEach(groupIcons, function(icon) {
                icon = $(icon);
                if (icon.hasClass("wi-chevron-down")) {
                    icon.removeClass("wi-chevron-down").addClass("wi-chevron-up");
                } else {
                    icon.removeClass("wi-chevron-up").addClass("wi-chevron-down");
                }
            });
        }
    };
    var handleHeaderClick = function($event) {
        var selectedGroup = $($event.target).closest(".item-group"), selectedAppIcon = selectedGroup.find("li.list-group-header .app-icon");
        if (selectedAppIcon.hasClass("wi-chevron-down")) {
            selectedAppIcon.removeClass("wi-chevron-down").addClass("wi-chevron-up");
        } else {
            selectedAppIcon.removeClass("wi-chevron-up").addClass("wi-chevron-down");
        }
        selectedGroup.find(".group-list-item").toggle();
    };
    var configureDnD = function($el, options, startCb, updateCb) {
        var sortOptions = Object.assign({
            containment: $el,
            delay: 100,
            opacity: .8,
            helper: "clone",
            zIndex: 1050,
            tolerance: "pointer",
            start: startCb,
            update: updateCb
        }, options);
        $el.sortable(sortOptions);
    };
    var DataSetItem = function() {
        function DataSetItem() {}
        return DataSetItem;
    }();
    var VIEW_MODE_OPTIONS = {
        DEFAULT: "default",
        LABEL: "label"
    };
    var EDIT_MODE = {
        QUICK_EDIT: "quickedit",
        INLINE: "inline",
        FORM: "form",
        DIALOG: "dialog"
    };
    var setHeaderConfig = function(headerConfig, config, field) {
        _.forEach(headerConfig, function(cols) {
            if (cols.isGroup) {
                if (cols.field === field) {
                    cols.columns.push(config);
                } else {
                    setHeaderConfig(cols.columns, config, field);
                }
            }
        });
    };
    var setHeaderConfigForTable = function(headerConfig, config, fieldName) {
        if (fieldName) {
            setHeaderConfig(headerConfig, config, fieldName);
        } else {
            headerConfig.push(config);
        }
    };
    var getRowOperationsColumn = function() {
        return {
            field: "rowOperations",
            type: "custom",
            displayName: "Actions",
            width: "120px",
            readonly: true,
            sortable: false,
            searchable: false,
            resizable: false,
            selectable: false,
            show: true,
            operations: [],
            opConfig: {},
            pcDisplay: true,
            mobileDisplay: true,
            include: true,
            isRowOperation: true
        };
    };
    var getFieldLayoutConfig = function(captionWidth, captionPosition, os) {
        var captionCls = "", widgetCls = "";
        captionPosition = captionPosition || "top";
        if (captionPosition === "top") {
            if (os && os === "android" || !core$1.isMobileApp() || core$1.isAndroid()) {
                captionCls = widgetCls = "col-xs-12";
            } else if (core$1.isMobileApp()) {
                captionCls = "col-xs-4";
                widgetCls = "col-xs-8";
            }
        } else if (captionWidth) {
            _.forEach(_.split(captionWidth, " "), function(cls) {
                var keys = _.split(cls, "-"), tier = keys[0];
                var _captionWidth, widgetWidth;
                _captionWidth = parseInt(keys[1], 10);
                widgetWidth = 12 - _captionWidth;
                widgetWidth = widgetWidth <= 0 ? 12 : widgetWidth;
                captionCls += " " + "col-" + tier + "-" + _captionWidth;
                widgetCls += " " + "col-" + tier + "-" + widgetWidth;
            });
        }
        return {
            captionCls: captionCls,
            widgetCls: widgetCls
        };
    };
    var getDefaultViewModeWidget = function(widget) {
        if (_.includes([ "checkbox", "toggle", "rating" ], widget)) {
            return VIEW_MODE_OPTIONS.DEFAULT;
        }
        return VIEW_MODE_OPTIONS.LABEL;
    };
    var parseBooleanValue = function(value) {
        if (value === "true") {
            return true;
        }
        if (value === "false") {
            return false;
        }
        if (/^\d+$/.test(value)) {
            return +value;
        }
        return value;
    };
    var parseValueByType = function(value, type, widget) {
        if (widget) {
            if (widget === core$1.FormWidgetType.NUMBER || widget === core$1.FormWidgetType.SLIDER || widget === core$1.FormWidgetType.CURRENCY) {
                return isNaN(Number(value)) ? null : Number(value);
            }
            if (widget === core$1.FormWidgetType.CHECKBOX || widget === core$1.FormWidgetType.TOGGLE) {
                return parseBooleanValue(value);
            }
            return value;
        }
        if (core$1.isNumberType(type)) {
            return isNaN(Number(value)) ? null : Number(value);
        }
        if (type === core$1.DataType.BOOLEAN) {
            return parseBooleanValue(value);
        }
        return value;
    };
    var fieldTypeWidgetTypeMap = {
        integer: [ "number", "text", "select", "checkboxset", "radioset", "rating", "slider", "currency", "autocomplete", "chips" ],
        big_integer: [ "number", "text", "select", "checkboxset", "radioset", "rating", "slider", "currency", "autocomplete", "chips" ],
        short: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        float: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        big_decimal: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        number: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        double: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        long: [ "number", "text", "select", "checkboxset", "radioset", "rating", "slider", "currency", "autocomplete", "chips" ],
        byte: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        string: [ "text", "number", "textarea", "password", "richtext", "select", "checkboxset", "radioset", "date", "time", "timestamp", "switch", "currency", "autocomplete", "chips", "colorpicker" ],
        character: [ "text", "number", "textarea", "password", "richtext", "select", "checkboxset", "radioset", "switch", "currency", "autocomplete", "chips" ],
        text: [ "text", "number", "textarea", "password", "richtext", "select", "checkboxset", "radioset", "date", "time", "timestamp", "switch", "currency", "autocomplete", "chips", "colorpicker" ],
        date: [ "date", "text", "number", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        time: [ "time", "text", "number", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        timestamp: [ "timestamp", "text", "number", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        datetime: [ "datetime", "text", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        boolean: [ "checkbox", "radioset", "toggle", "select" ],
        list: [ "select", "radioset", "checkboxset", "switch", "autocomplete", "chips" ],
        clob: [ "text", "textarea", "richtext" ],
        blob: [ "upload" ],
        file: [ "upload" ],
        custom: [ "text", "number", "textarea", "password", "checkbox", "toggle", "slider", "richtext", "currency", "switch", "select", "checkboxset", "radioset", "date", "time", "timestamp", "rating", "datetime", "autocomplete", "chips", "colorpicker" ]
    };
    var getFieldTypeWidgetTypesMap = function() {
        return fieldTypeWidgetTypeMap;
    };
    var getDataTableFilterWidget = function(type) {
        var widget = fieldTypeWidgetTypeMap[type] && fieldTypeWidgetTypeMap[type][0];
        if (type === core$1.DataType.BOOLEAN) {
            widget = core$1.FormWidgetType.SELECT;
        }
        if (_.includes([ core$1.FormWidgetType.TEXT, core$1.FormWidgetType.NUMBER, core$1.FormWidgetType.SELECT, core$1.FormWidgetType.AUTOCOMPLETE, core$1.FormWidgetType.DATE, core$1.FormWidgetType.TIME, core$1.FormWidgetType.DATETIME ], widget)) {
            return widget;
        }
        return core$1.FormWidgetType.TEXT;
    };
    var getEditModeWidget = function(colDef) {
        if (colDef["related-entity-name"] && colDef["primary-key"]) {
            return core$1.FormWidgetType.SELECT;
        }
        return fieldTypeWidgetTypeMap[colDef.type] && fieldTypeWidgetTypeMap[colDef.type][0] || core$1.FormWidgetType.TEXT;
    };
    var getDefaultValue = function(value, type, widget) {
        if (widget) {
            if (widget === core$1.FormWidgetType.NUMBER || widget === core$1.FormWidgetType.SLIDER || widget === core$1.FormWidgetType.CURRENCY) {
                return isNaN(Number(value)) ? null : Number(value);
            }
            if (widget === core$1.FormWidgetType.CHECKBOX || widget === core$1.FormWidgetType.TOGGLE) {
                return parseBooleanValue(value);
            }
            return value;
        }
        if (core$1.isNumberType(type)) {
            return isNaN(Number(value)) ? null : Number(value);
        }
        if (type === core$1.DataType.BOOLEAN) {
            return parseBooleanValue(value);
        }
        return value;
    };
    var getValidLink = function(link) {
        var routRegex = /^(\/|#\/|#)(?!\W).*/;
        if (link) {
            if (routRegex.test(link)) {
                link = _.first(link.match(/[\w]+.*/g)) || "";
                return "#/" + link;
            }
            if (_.startsWith(link, "www.")) {
                return "//" + link;
            }
            return link;
        }
    };
    var DatasetAwareNavComponent = function(_super) {
        __extends(DatasetAwareNavComponent, _super);
        function DatasetAwareNavComponent(inj, WIDGET_CONFIG) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.nodes = [];
            _this.nodes$ = new rxjs.Subject();
            _this._resetNodes = _.debounce(_this.resetNodes, 50);
            _this.securityService = _this.inj.get(security.SecurityService);
            _this.binditemlabel = _this.nativeElement.getAttribute("itemlabel.bind");
            _this.binditemicon = _this.nativeElement.getAttribute("itemicon.bind");
            _this.binditemaction = _this.nativeElement.getAttribute("itemaction.bind");
            _this.binditembadge = _this.nativeElement.getAttribute("itembadge.bind");
            _this.binditemchildren = _this.nativeElement.getAttribute("itemchildren.bind");
            _this.binditemid = _this.nativeElement.getAttribute("itemid.bind");
            _this.binditemlink = _this.nativeElement.getAttribute("itemlink.bind");
            _this.binditemtarget = _this.nativeElement.getAttribute("itemtarget.bind");
            _this.binduserrole = _this.nativeElement.getAttribute("userrole.bind");
            _this.bindisactive = _this.nativeElement.getAttribute("isactive.bind");
            return _this;
        }
        DatasetAwareNavComponent.prototype.getNode = function(fields, node) {
            var context = this.viewParent.pageScope || this.viewParent;
            var children = getEvaluatedData(node, {
                expression: "itemchildren",
                bindExpression: this.binditemchildren
            }, context) || _.get(node, fields.childrenField);
            var navNode = {
                action: getEvaluatedData(node, {
                    expression: "itemaction",
                    bindExpression: this.binditemaction
                }, context) || _.get(node, fields.actionField),
                badge: getEvaluatedData(node, {
                    expression: "itembadge",
                    bindExpression: this.binditembadge
                }, context) || _.get(node, fields.badgeField),
                children: Array.isArray(children) ? this.getNodes(children) : [],
                class: _.get(node, fields.classField),
                disabled: node.disabled,
                icon: getEvaluatedData(node, {
                    expression: "itemicon",
                    bindExpression: this.binditemicon
                }, context) || _.get(node, fields.iconField),
                id: getEvaluatedData(node, {
                    expression: "itemid",
                    bindExpression: this.binditemid
                }, context) || _.get(node, fields.idField),
                label: getEvaluatedData(node, {
                    expression: "itemlabel",
                    bindExpression: this.binditemlabel
                }, context) || _.get(node, fields.labelField),
                link: getValidLink(getEvaluatedData(node, {
                    expression: "itemlink",
                    bindExpression: this.binditemlink
                }, context) || _.get(node, fields.linkField)),
                target: getValidLink(getEvaluatedData(node, {
                    expression: "itemtarget",
                    bindExpression: this.binditemtarget
                }, context) || _.get(node, fields.targetField)),
                role: getEvaluatedData(node, {
                    expression: "userrole",
                    bindExpression: this.binduserrole
                }, context),
                isactive: this.bindisactive ? getEvaluatedData(node, {
                    expression: "isactive",
                    bindExpression: this.bindisactive
                }, context) : _.get(node, fields.isactiveField),
                value: this.datafield ? this.datafield === "All Fields" ? node : core$1.findValueOf(node, this.datafield) : node
            };
            return _.omitBy(navNode, _.isUndefined);
        };
        DatasetAwareNavComponent.prototype.resetItemFieldMap = function() {
            this._itemFieldMap = null;
        };
        DatasetAwareNavComponent.prototype.getItemFieldsMap = function() {
            if (!this._itemFieldMap) {
                this._itemFieldMap = {
                    idField: this.itemid || "itemid",
                    iconField: this.itemicon || "icon",
                    labelField: this.itemlabel || "label",
                    linkField: this.itemlink || "link",
                    targetField: this.itemtarget || "target",
                    badgeField: this.itembadge || "badge",
                    childrenField: this.itemchildren || "children",
                    classField: this.itemclass || "class",
                    actionField: this.itemaction || "action",
                    isactiveField: this.isactive || "isactive"
                };
            }
            return this._itemFieldMap;
        };
        DatasetAwareNavComponent.prototype.prepareNodeDataSet = function(nv) {
            nv = createArrayFrom(nv);
            return nv.map(function(val) {
                if (!core$1.isObject(val)) {
                    return {
                        label: val,
                        value: val
                    };
                }
                return val;
            });
        };
        DatasetAwareNavComponent.prototype.getNodes = function(nv) {
            var _this = this;
            if (nv === void 0) {
                nv = this.dataset || {};
            }
            var nodes = getOrderedDataset(this.prepareNodeDataSet(nv), this.orderby) || [];
            if (nodes.length) {
                var userRole_1 = this.userrole;
                var nodeFields_1 = this.getItemFieldsMap();
                nodes = nodes.reduce(function(result, node) {
                    if (core$1.validateAccessRoles(node[userRole_1], _this.securityService.loggedInUser)) {
                        result.push(_this.getNode(nodeFields_1, node));
                    }
                    return result;
                }, []);
            }
            return nodes;
        };
        DatasetAwareNavComponent.prototype.resetNodes = function() {
            this.resetItemFieldMap();
            this.nodes = this.getNodes();
            core$1.$appDigest();
            this.nodes$.next();
        };
        DatasetAwareNavComponent.prototype.onPropertyChange = function(key, nv, ov) {
            switch (key) {
              case "dataset":
              case "itemicon":
              case "itemlabel":
              case "itemlink":
              case "itemtarget":
              case "itemclass":
              case "itemchildren":
              case "isactive":
              case "orderby":
                this._resetNodes();
                break;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        return DatasetAwareNavComponent;
    }(StylableComponent);
    var PullToRefresh = function(_super) {
        __extends(PullToRefresh, _super);
        function PullToRefresh($el, app, onPullToRefresh) {
            var _this = _super.call(this) || this;
            _this.$el = $el;
            _this.app = app;
            _this.onPullToRefresh = onPullToRefresh;
            _this.count = 0;
            var template = '<div class="refresh-container"></div>';
            _this.$el.prepend(template);
            _this.infoContainer = _this.$el.find(".refresh-container");
            if (core$1.isIos()) {
                _this.infoContainer.addClass("ios-refresh-container");
            }
            _this.init(_this.$el);
            return _this;
        }
        PullToRefresh.prototype.threshold = function() {
            return 10;
        };
        PullToRefresh.prototype.direction = function() {
            return $.fn.swipey.DIRECTIONS.VERTICAL;
        };
        PullToRefresh.prototype.subscribe = function() {
            var _this = this;
            this.cancelSubscription = this.app.subscribe("toggle-variable-state", function(data) {
                if (data.active && _this.animationInProgress) {
                    _this.count++;
                    _this.wait();
                } else if (_this.count > 0) {
                    _this.count--;
                }
                if (!_this.count && _this.animationInProgress) {
                    _this.stopAnimation();
                }
            });
        };
        PullToRefresh.prototype.bounds = function($event, $d) {
            var pageIscroll = this.$el[0].iscroll;
            if ($d < 0 || pageIscroll && !isNaN(pageIscroll.y) && pageIscroll.y !== 0) {
                return {
                    lower: undefined,
                    upper: undefined
                };
            }
            if (!this.spinner) {
                this.spinner = core$1.isIos() ? new IOSSpinner(this.infoContainer) : new AndroidSpinner(this.infoContainer);
                this.subscribe();
            }
            return {
                lower: 0,
                center: 0,
                upper: core$1.isIos() ? 0 : 150,
                strict: !core$1.isIos()
            };
        };
        PullToRefresh.prototype.context = function() {
            var _this = this;
            this.infoContainer.show();
            if (core$1.isIos()) {
                this.infoContainer.addClass("entry");
            }
            return {
                spin: function($d) {
                    _this.spinner.setRotation($d * 2);
                }
            };
        };
        PullToRefresh.prototype.animation = function() {
            if (core$1.isIos()) {
                return {
                    css: {
                        transform: "translate3d(0, ${{$D + $d}}px, 0)",
                        spin: "${{spin($d)}}"
                    }
                };
            }
            return {
                target: this.infoContainer,
                css: {
                    transform: "translate3d(0, ${{$D + $d}}px, 0)",
                    spin: "${{spin($d)}}",
                    opacity: "${{min(($D + $d) / 100, 1)}}"
                }
            };
        };
        PullToRefresh.prototype.onAnimation = function() {
            var _this = this;
            this.animationInProgress = true;
            this.spinner.start();
            if (this.onPullToRefresh) {
                this.onPullToRefresh();
            }
            setTimeout(function() {
                if (_this.runAnimation) {
                    return;
                }
                _this.stopAnimation();
            });
        };
        PullToRefresh.prototype.stopAnimation = function() {
            var _this = this;
            setTimeout(function() {
                _this.runAnimation = false;
                _this.animationInProgress = false;
                _this.spinner.stop();
                _this.infoContainer.hide();
                core$1.setCSS(_this.infoContainer[0], "transform", "none");
                if (!core$1.isIos()) {
                    core$1.setCSS(_this.infoContainer[0], "opacity", 0);
                }
                _this.infoContainer.removeClass("entry");
            }, 800);
        };
        PullToRefresh.prototype.wait = function() {
            this.runAnimation = true;
        };
        return PullToRefresh;
    }(_swipey.SwipeAnimation);
    var AndroidSpinner = function() {
        function AndroidSpinner($el, options) {
            this.$el = $el;
            this.options = options || {};
        }
        AndroidSpinner.prototype.polarToCartesian = function(centerX, centerY, radius, angleInDegrees) {
            var angleInRadians = (angleInDegrees - 90) * Math.PI / 180;
            return {
                x: centerX + radius * Math.cos(angleInRadians),
                y: centerY + radius * Math.sin(angleInRadians)
            };
        };
        AndroidSpinner.prototype.describeArc = function(x, y, radius, startAngle, endAngle) {
            var start = this.polarToCartesian(x, y, radius, endAngle);
            var end = this.polarToCartesian(x, y, radius, startAngle);
            var arcSweep = endAngle - startAngle <= 180 ? "0" : "1";
            return [ "M", start.x, start.y, "A", radius, radius, 0, arcSweep, 0, end.x, end.y, "L", end.x, end.y ].join(" ");
        };
        AndroidSpinner.prototype.init = function() {
            if (this.initialized) {
                return;
            }
            var androidTemplate = $('<svg><path id="arc1"/></svg>');
            var container = $('<div class="android-spinner"></div>');
            container.append(androidTemplate);
            this.$el.append(container);
            this.cx = container.outerWidth() / 2;
            this.cy = container.outerHeight() / 2;
            this.r = this.cx * .6;
            this.path = container.find("path");
            this.initialized = true;
            this.container = container;
        };
        AndroidSpinner.prototype.setRotation = function(deg) {
            this.init();
            this.path.attr("d", this.describeArc(this.cx, this.cy, this.r, 0, deg));
        };
        AndroidSpinner.prototype.start = function() {
            var _this = this;
            this.init();
            var self = this, totalTime = this.options.time || 1800, degreesToTraverse = 10;
            var i = 0;
            this.container.addClass("spin");
            this.intervalId = setInterval(function() {
                var deg;
                i = i + degreesToTraverse;
                if (i > 720) {
                    deg = i = 0;
                } else if (i > 360) {
                    deg = 720 - i;
                } else {
                    deg = i;
                }
                self.path.attr("d", _this.describeArc(self.cx, self.cy, self.r, 0, deg));
            }, totalTime * degreesToTraverse / 360);
        };
        AndroidSpinner.prototype.stop = function() {
            if (this.intervalId) {
                clearInterval(this.intervalId);
                this.intervalId = 0;
            }
            this.container.removeClass("spin");
        };
        return AndroidSpinner;
    }();
    var IOSSpinner = function() {
        function IOSSpinner($el) {
            this.$el = $el;
        }
        IOSSpinner.prototype.init = function() {
            if (this.svg) {
                return;
            }
            var container = $('<div class="ios-spinner"><svg></svg></div>');
            var svg = container.find("svg");
            this.$el.append(container);
            var d = container.width();
            for (var i = 0; i < 12; i++) {
                svg[0].innerHTML += '<line y1="' + .15 * d + '" y2="' + .3 * d + '"\n                                    transform="translate(' + .5 * d + ", " + .5 * d + ") rotate(" + i * 30 + ')">\n                                </line>';
            }
            container.append(svg);
            this.svg = svg;
        };
        IOSSpinner.prototype.setRotation = function(d) {
            this.init();
            this.svg.css("transform", "rotateZ( " + Math.round(d / 30) * 30 + "deg)");
        };
        IOSSpinner.prototype.start = function() {
            var _this = this;
            this.init();
            var i = 0;
            this.intervalId = setInterval(function() {
                i += 10;
                _this.setRotation(i);
            }, 20);
        };
        IOSSpinner.prototype.stop = function() {
            if (this.intervalId) {
                clearInterval(this.intervalId);
                this.intervalId = 0;
            }
        };
        return IOSSpinner;
    }();
    var _this = this;
    var CLASS_NAME;
    (function(CLASS_NAME) {
        CLASS_NAME["LEFT_PANEL"] = "page-left-panel";
        CLASS_NAME["RIGHT_PANEL"] = "page-right-panel";
        CLASS_NAME["SWIPE_ELEM"] = "page-left-panel-icon";
        CLASS_NAME["CONTENT"] = "app-content-column";
        CLASS_NAME["HEADER"] = "page-header";
        CLASS_NAME["SEARCH"] = "app-search";
    })(CLASS_NAME || (CLASS_NAME = {}));
    var roleSelector = function(roleName) {
        return "[data-role='" + roleName + "']";
    };
    var bindTapEvtHandler = function(selector, handler) {
        $(selector).off("click.deviceview").on("click.deviceview", handler);
    };
    var hidePageContainers = function(leftNavEle, searchEle) {
        if (core$1.isMobile()) {
            if (leftNavEle) {
                try {
                    leftNavEle.widget.collapse();
                } catch (e) {}
            }
            if (searchEle) {
                core$1.setCSS(searchEle, "display", "none");
            }
        }
    };
    var bindContentEvents = function(leftNavEle, pageContainer, searchContainer, isTablet) {
        if (isTablet === void 0) {
            isTablet = false;
        }
        if (!isTablet) {
            bindTapEvtHandler(pageContainer, hidePageContainers.bind(_this, leftNavEle, searchContainer));
        }
    };
    var bindLeftPanelEvents = function(leftNavEle, searchEle) {
        bindTapEvtHandler(roleSelector(CLASS_NAME.SWIPE_ELEM), function() {
            if (leftNavEle) {
                leftNavEle.widget.toggle();
                if (leftNavEle.classList.contains("visible")) {
                    if (searchEle) {
                        core$1.setCSS(searchEle, "display", "none");
                    }
                }
            }
        });
    };
    var \u02754 = bindLeftPanelEvents;
    var bindRightPanelEvents = function(rightNavEle) {
        bindTapEvtHandler(rightNavEle, hidePageContainers);
    };
    var \u02755 = bindRightPanelEvents;
    var toggleSearchContainer = function(searchEle, leftNavEle) {
        if ($(searchEle).css("display") === "none") {
            hidePageContainers(leftNavEle);
            core$1.setCSS(searchEle, "display", "inline-table");
        } else {
            hidePageContainers(leftNavEle, searchEle);
        }
    };
    var \u02756 = toggleSearchContainer;
    var bindSearchIconEvent = function(searchElements, leftNavEle) {
        $(searchElements).each(function(index, ele) {
            var searchEle = $('<a class="app-header-action"><i class="wi wi-search"></i></a>');
            $(ele).before(searchEle);
            bindTapEvtHandler(searchEle, function() {
                return toggleSearchContainer(ele, leftNavEle);
            });
        });
    };
    var \u02757 = bindSearchIconEvent;
    var updateDeviceView = function(element, isTablet) {
        if (isTablet === void 0) {
            isTablet = false;
        }
        var leftNavEle = element.querySelector(roleSelector(CLASS_NAME.LEFT_PANEL));
        var rightNavEle = element.querySelector(roleSelector(CLASS_NAME.RIGHT_PANEL));
        var headerEle = element.querySelector(roleSelector(CLASS_NAME.HEADER));
        var searchEle = headerEle && headerEle.querySelector("." + CLASS_NAME.SEARCH);
        var pageEle = element.querySelector("." + CLASS_NAME.CONTENT);
        bindContentEvents(leftNavEle, pageEle, searchEle, isTablet);
        if (leftNavEle) {
            bindLeftPanelEvents(leftNavEle, searchEle);
        } else {
            $(headerEle).find(roleSelector(CLASS_NAME.SWIPE_ELEM)).remove();
        }
        if (rightNavEle) {
            bindRightPanelEvents(rightNavEle);
        }
        if (searchEle) {
            bindSearchIconEvent(searchEle, leftNavEle);
        }
    };
    exports.\u0275h = ShowInDeviceDirective;
    exports.\u0275j = TextContentDirective;
    exports.\u0275a = ContainerDirective;
    exports.\u0275b = registerProps;
    exports.\u0275c = LazyLoadDirective;
    exports.\u0275d = registerProps$1;
    exports.\u0275g = PartialParamDirective;
    exports.\u0275f = PartialParamHandlerDirective;
    exports.\u0275e = registerProps$2;
    exports.\u0275i = SmoothScrollDirective;
    exports.WmComponentsModule = WmComponentsModule;
    exports.ALLFIELDS = ALLFIELDS;
    exports.LIVE_CONSTANTS = LIVE_CONSTANTS;
    exports.performDataOperation = performDataOperation;
    exports.refreshDataSource = refreshDataSource;
    exports.fetchRelatedFieldData = fetchRelatedFieldData;
    exports.interpolateBindExpressions = interpolateBindExpressions;
    exports.getDistinctFieldProperties = getDistinctFieldProperties;
    exports.getDistinctValues = getDistinctValues;
    exports.fetchDistinctValues = fetchDistinctValues;
    exports.getDistinctValuesForField = getDistinctValuesForField;
    exports.getRangeFieldValue = getRangeFieldValue;
    exports.getRangeMatchMode = getRangeMatchMode;
    exports.getEnableEmptyFilter = getEnableEmptyFilter;
    exports.getEmptyMatchMode = getEmptyMatchMode;
    exports.createArrayFrom = createArrayFrom;
    exports.applyFilterOnField = applyFilterOnField;
    exports.transformData = transformData;
    exports.\u02750 = \u02750$7;
    exports.getOrderedDataset = getOrderedDataset;
    exports.transformDataWithKeys = transformDataWithKeys;
    exports.extractDataAsArray = extractDataAsArray;
    exports.convertDataToObject = convertDataToObject;
    exports.transformFormData = transformFormData;
    exports.getUniqObjsByDataField = getUniqObjsByDataField;
    exports.setItemByCompare = setItemByCompare;
    exports.groupData = groupData;
    exports.filterDate = filterDate;
    exports.toggleAllHeaders = toggleAllHeaders;
    exports.handleHeaderClick = handleHeaderClick;
    exports.configureDnD = configureDnD;
    exports.DataSetItem = DataSetItem;
    exports.\u02751 = \u02751$2;
    exports.\u02752 = \u02752$1;
    exports.\u02753 = \u02753$1;
    exports.EDIT_MODE = EDIT_MODE;
    exports.setHeaderConfig = setHeaderConfig;
    exports.setHeaderConfigForTable = setHeaderConfigForTable;
    exports.getRowOperationsColumn = getRowOperationsColumn;
    exports.getFieldLayoutConfig = getFieldLayoutConfig;
    exports.getDefaultViewModeWidget = getDefaultViewModeWidget;
    exports.parseValueByType = parseValueByType;
    exports.getFieldTypeWidgetTypesMap = getFieldTypeWidgetTypesMap;
    exports.getDataTableFilterWidget = getDataTableFilterWidget;
    exports.getEditModeWidget = getEditModeWidget;
    exports.getDefaultValue = getDefaultValue;
    exports.getObjValueByKey = getObjValueByKey;
    exports.getEvaluatedData = getEvaluatedData;
    exports.isActiveNavItem = isActiveNavItem;
    exports.getOrderByExpr = getOrderByExpr;
    exports.isDataSetWidget = isDataSetWidget;
    exports.getImageUrl = getImageUrl;
    exports.getBackGroundImageUrl = getBackGroundImageUrl;
    exports.provideAs = provideAs;
    exports.provideAsWidgetRef = provideAsWidgetRef;
    exports.provideAsDialogRef = provideAsDialogRef;
    exports.NAVIGATION_TYPE = NAVIGATION_TYPE;
    exports.getWatchIdentifier = getWatchIdentifier;
    exports.getMatchModeTypesMap = getMatchModeTypesMap;
    exports.getMatchModeMsgs = getMatchModeMsgs;
    exports.getConditionalClasses = getConditionalClasses;
    exports.prepareFieldDefs = prepareFieldDefs;
    exports.BaseComponent = BaseComponent;
    exports.DatasetAwareNavComponent = DatasetAwareNavComponent;
    exports.StylableComponent = StylableComponent;
    exports.MessageComponent = MessageComponent;
    exports.PullToRefresh = PullToRefresh;
    exports.PartialDirective = PartialDirective;
    exports.RedrawableDirective = RedrawableDirective;
    exports.EVENTS_MAP = EVENTS_MAP;
    exports.DISPLAY_TYPE = DISPLAY_TYPE;
    exports.isBooleanAttr = isBooleanAttr;
    exports.isDimensionProp = isDimensionProp;
    exports.DEBOUNCE_TIMES = DEBOUNCE_TIMES;
    exports.updateDeviceView = updateDeviceView;
    exports.\u02754 = \u02754;
    exports.\u02755 = \u02755;
    exports.\u02756 = \u02756;
    exports.\u02757 = \u02757;
    exports.propNameCSSKeyMap = propNameCSSKeyMap;
    exports.isStyle = isStyle;
    exports.styler = styler;
    exports.WidgetRef = WidgetRef;
    exports.DialogRef = DialogRef;
    exports.Context = Context;
    exports.getWidgetPropsByType = getWidgetPropsByType;
    exports.register = register;
    exports.registerFormWidget = registerFormWidget;
    exports.PROP_STRING = PROP_STRING;
    exports.PROP_NUMBER = PROP_NUMBER;
    exports.PROP_BOOLEAN = PROP_BOOLEAN;
    exports.PROP_ANY = PROP_ANY;
    exports.DialogServiceImpl = DialogServiceImpl;
    exports.ToDatePipe = ToDatePipe;
    exports.ToNumberPipe = ToNumberPipe;
    exports.ToCurrencyPipe = ToCurrencyPipe;
    exports.PrefixPipe = PrefixPipe;
    exports.SuffixPipe = SuffixPipe;
    exports.TimeFromNowPipe = TimeFromNowPipe;
    exports.NumberToStringPipe = NumberToStringPipe;
    exports.StringToNumberPipe = StringToNumberPipe;
    exports.FilterPipe = FilterPipe;
    exports.FileSizePipe = FileSizePipe;
    exports.FileIconClassPipe = FileIconClassPipe;
    exports.StateClassPipe = StateClassPipe;
    exports.FileExtensionFromMimePipe = FileExtensionFromMimePipe;
    exports.TrustAsPipe = TrustAsPipe;
    exports.ImagePipe = ImagePipe;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/compiler"), require("@wm/core"), require("@wm/transpiler")) : typeof define === "function" && define.amd ? define("@wm/buildTask", [ "exports", "@angular/compiler", "@wm/core", "@wm/transpiler" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.buildTask = {}), global.ng.compiler, global.wm.core, global.wm.transpiler);
})(this, function(exports, compiler, core, transpiler) {
    "use strict";
    var carouselTagName = "carousel";
    var dataSetKey = "dataset";
    var idGen = new core.IDGenerator("wm_carousel_ref_");
    var isDynamicCarousel = function(node) {
        return node.attrs.find(function(attr) {
            return attr.name === "type" && attr.value === "dynamic";
        });
    };
    var \u02750 = isDynamicCarousel;
    transpiler.register("wm-carousel", function() {
        return {
            pre: function(attrs, shared) {
                var counter = idGen.nextUid();
                shared.set("carousel_ref", counter);
                return '<div class="app-carousel carousel"><' + carouselTagName + " wmCarousel #" + counter + '="wmCarousel"  ' + transpiler.getAttrMarkup(attrs) + ' interval="0" [ngClass]="' + counter + '.navigationClass">';
            },
            post: function() {
                return "</" + carouselTagName + "></div>";
            },
            template: function(node) {
                if (isDynamicCarousel(node)) {
                    var datasetAttr = node.attrs.find(function(attr) {
                        return attr.name === dataSetKey;
                    });
                    var widgetNameAttr = node.attrs.find(function(attr) {
                        return attr.name === "name";
                    });
                    if (!datasetAttr) {
                        return;
                    }
                    var boundExpr = transpiler.getBoundToExpr(datasetAttr.value);
                    if (!boundExpr) {
                        return;
                    }
                    core.updateTemplateAttrs(node, boundExpr, widgetNameAttr.value);
                }
            },
            provide: function(attrs, shared) {
                var provider = new Map();
                provider.set("carousel_ref", shared.get("carousel_ref"));
                return provider;
            }
        };
    });
    var carouselContentTagName = "slide";
    transpiler.register("wm-carousel-content", function() {
        return {
            pre: function(attrs) {
                return "<" + carouselContentTagName + " wmCarouselTemplate  " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + carouselContentTagName + ">";
            }
        };
    });
    transpiler.register("wm-carousel-template", function() {
        return {
            requires: [ "wm-carousel" ],
            pre: function(attrs, shared, parentCarousel) {
                var carouselRef = parentCarousel.get("carousel_ref");
                return '<div *ngIf="!' + carouselRef + '.fieldDefs">{{' + carouselRef + ".nodatamessage}}</div>\n                    <" + carouselContentTagName + " wmCarouselTemplate  " + transpiler.getAttrMarkup(attrs) + ' *ngFor="let item of ' + carouselRef + '.fieldDefs; let i = index;">\n                        <ng-container [ngTemplateOutlet]="tempRef" [ngTemplateOutletContext]="{item:item, index:i}"></ng-container>\n                    </' + carouselContentTagName + '>\n                    <ng-template #tempRef let-item="item" let-index="index">';
            },
            post: function() {
                return "</ng-template>";
            }
        };
    });
    var tagName = "div";
    transpiler.register("wm-login", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName + " wmLogin " + transpiler.getAttrMarkup(attrs) + ' eventsource.bind="Actions.loginAction">';
            },
            post: function() {
                return "</" + tagName + ">";
            },
            provide: function() {
                var provider = new Map();
                provider.set("isLogin", true);
                return provider;
            }
        };
    });
    var tagName$1 = "marquee";
    transpiler.register("wm-marquee", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1 + ' onmouseover="this.stop();" onmouseout="this.start();" wmMarquee role="marquee" aria-live="off" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1 + ">";
            }
        };
    });
    var tagName$2 = "a";
    transpiler.register("wm-anchor", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$2 + ' wmAnchor role="link" data-identifier="anchor" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$2 + ">";
            }
        };
    });
    var tagName$3 = "div";
    transpiler.register("wm-audio", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$3 + " wmAudio " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$3 + ">";
            }
        };
    });
    var tagName$4 = "div";
    transpiler.register("wm-html", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$4 + " wmHtml " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$4 + ">";
            }
        };
    });
    var tagName$5 = "span";
    transpiler.register("wm-icon", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$5 + ' wmIcon aria-hidden="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$5 + ">";
            }
        };
    });
    var tagName$6 = "div";
    transpiler.register("wm-iframe", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$6 + " wmIframe " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$6 + ">";
            }
        };
    });
    var tagName$7 = "label";
    transpiler.register("wm-label", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$7 + " wmLabel " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$7 + ">";
            }
        };
    });
    var tagName$8 = "img";
    transpiler.register("wm-picture", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$8 + ' wmPicture alt="image" wmImageCache="' + (attrs.get("offline") || "true") + '" ' + transpiler.getAttrMarkup(attrs) + ">";
            }
        };
    });
    var tagName$9 = "div";
    transpiler.register("wm-spinner", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$9 + ' wmSpinner role="loading" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$9 + ">";
            }
        };
    });
    var tagName$a = "div";
    var getAttr = function(node, attrName) {
        return node.attrs.find(function(attr) {
            return attr.name === attrName;
        });
    };
    var getAttrValue = function(node, attrName) {
        var match = getAttr(node, attrName);
        if (match) {
            return match.value;
        }
    };
    var \u02751 = getAttrValue;
    var getReplaceRegex = function(v) {
        return new RegExp("bind:(" + v + "|" + v + "\\[\\$i])\\.", "g");
    };
    var \u02752 = getReplaceRegex;
    transpiler.register("wm-progress-bar", function() {
        return {
            template: function(node) {
                var dataset = getAttrValue(node, "dataset");
                var boundExpr = transpiler.getBoundToExpr(dataset);
                if (boundExpr) {
                    var type = getAttrValue(node, "type");
                    var datavalue = getAttrValue(node, "datavalue");
                    var replaceRegex = getReplaceRegex(boundExpr);
                    if (type && type.includes(boundExpr)) {
                        type = type.replace(replaceRegex, "");
                        getAttr(node, "type").value = type;
                    }
                    if (datavalue && datavalue.includes(boundExpr)) {
                        datavalue = datavalue.replace(replaceRegex, "");
                        getAttr(node, "datavalue").value = datavalue;
                    }
                }
            },
            pre: function(attrs) {
                return "<" + tagName$a + " wmProgressBar " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$a + ">";
            }
        };
    });
    var tagName$b = "div";
    transpiler.register("wm-progress-circle", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$b + " wmProgressCircle " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$b + ">";
            }
        };
    });
    var tagName$c = "div";
    transpiler.register("wm-richtexteditor", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$c + ' wmRichTextEditor role="textbox" ' + transpiler.getFormMarkupAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$c + ">";
            }
        };
    });
    var tagName$d = "div";
    transpiler.register("wm-search", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$d + " wmSearch " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$d + ">";
            }
        };
    });
    var tagName$e = "div";
    transpiler.register("wm-tree", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$e + " wmTree redrawable " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$e + ">";
            }
        };
    });
    var tagName$f = "div";
    transpiler.register("wm-card", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$f + " wmCard " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$f + ">";
            }
        };
    });
    var tagName$g = "div";
    transpiler.register("wm-card-content", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$g + " wmCardContent partialContainer " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$g + ">";
            }
        };
    });
    var tagName$h = "div";
    transpiler.register("wm-card-actions", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$h + " wmCardActions " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$h + ">";
            }
        };
    });
    var tagName$i = "div";
    transpiler.register("wm-card-footer", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$i + " wmCardFooter " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$i + ">";
            }
        };
    });
    var tagName$j = "div";
    transpiler.register("wm-chart", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$j + " wmChart redrawable " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$j + ">";
            }
        };
    });
    var tagName$k = "div";
    transpiler.register("wm-accordion", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$k + ' wmAccordion role="tablist" aria-multiselectable="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$k + ">";
            }
        };
    });
    var tagName$l = "div";
    transpiler.register("wm-accordionpane", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$l + ' wmAccordionPane partialContainer wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$l + ">";
            }
        };
    });
    var tagName$m = "div";
    transpiler.register("wm-container", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$m + ' wmContainer partialContainer wmSmoothscroll="' + (attrs.get("smoothscroll") || "false") + '" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$m + ">";
            }
        };
    });
    var tagName$n = "div";
    transpiler.register("wm-gridcolumn", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$n + " wmLayoutGridColumn " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$n + ">";
            }
        };
    });
    var tagName$o = "div";
    transpiler.register("wm-gridrow", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$o + " wmLayoutGridRow " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$o + ">";
            }
        };
    });
    var tagName$p = "div";
    transpiler.register("wm-layoutgrid", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$p + " wmLayoutGrid " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$p + ">";
            }
        };
    });
    var tagName$q = "div";
    transpiler.register("wm-panel", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$q + ' wmPanel partialContainer aria-label="panel" wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$q + ">";
            }
        };
    });
    transpiler.register("wm-panel-footer", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$q + ' wmPanelFooter aria-label="panel footer" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$q + ">";
            }
        };
    });
    var tagName$r = "div";
    transpiler.register("wm-segmented-control", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$r + " wmSegmentedControl " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$r + ">";
            }
        };
    });
    var tagName$s = "li";
    transpiler.register("wm-segment-content", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$s + " wmSegmentContent partialContainer wmSmoothscroll=" + (attrs.get("smoothscroll") || "true") + ' wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$s + ">";
            }
        };
    });
    var tagName$t = "div";
    transpiler.register("wm-tabs", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$t + " wmTabs " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$t + ">";
            }
        };
    });
    var tagName$u = "div";
    transpiler.register("wm-tabpane", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$u + " wmTabPane  partialContainer " + transpiler.getAttrMarkup(attrs) + ' wm-navigable-element="true" role="tabpanel">';
            },
            post: function() {
                return "</" + tagName$u + ">";
            }
        };
    });
    var tagName$v = "div";
    transpiler.register("wm-tile", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$v + ' wmTile aria-describedby="Tile" wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$v + ">";
            }
        };
    });
    var tagName$w = "div";
    transpiler.register("wm-wizard", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$w + ' wmWizard role="tablist" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$w + ">";
            }
        };
    });
    var tagName$x = "form";
    var idGen$1 = new core.IDGenerator("wizard_step_id_");
    transpiler.register("wm-wizardstep", function() {
        return {
            pre: function(attrs) {
                var counter = idGen$1.nextUid();
                return "<" + tagName$x + " wmWizardStep #" + counter + '="wmWizardStep" ' + transpiler.getAttrMarkup(attrs) + '>\n                       <ng-template [ngIf]="' + counter + '.isInitialized">';
            },
            post: function() {
                return "</ng-template></" + tagName$x + ">";
            }
        };
    });
    var tagName$y = "button";
    transpiler.register("wm-barcodescanner", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$y + " wmBarcodescanner " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$y + ">";
            }
        };
    });
    var tagName$z = "button";
    transpiler.register("wm-camera", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$z + " type='button' wmCamera " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$z + ">";
            }
        };
    });
    var tagName$A = "div";
    transpiler.register("wm-alertdialog", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$A + ' wmAlertDialog role="alertdialog" wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$A + ">";
            }
        };
    });
    var tagName$B = "div";
    transpiler.register("wm-confirmdialog", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$B + ' wmConfirmDialog wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$B + ">";
            }
        };
    });
    var tagName$C = "div";
    transpiler.register("wm-dialogactions", function() {
        return {
            pre: function(attrs) {
                return "<ng-template #dialogFooter><" + tagName$C + ' wmDialogFooter data-identfier="actions" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$C + "></ng-template>";
            }
        };
    });
    var tagName$D = "div";
    transpiler.register("wm-dialog", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$D + " wmDialog " + transpiler.getAttrMarkup(attrs) + ' wm-navigable-element="true"><ng-template #dialogBody>';
            },
            post: function() {
                return "</ng-template></" + tagName$D + ">";
            }
        };
    });
    transpiler.register("wm-view", function() {
        return {
            pre: function(attrs) {
                return "";
            },
            post: function() {
                return "";
            }
        };
    });
    var tagName$E = "div";
    transpiler.register("wm-iframedialog", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$E + ' wmIframeDialog wm-navigable-element="true" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$E + ">";
            }
        };
    });
    var tagName$F = "div";
    transpiler.register("wm-logindialog", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$F + " wmDialog wmLoginDialog " + transpiler.getAttrMarkup(attrs) + ' eventsource.bind="Actions.loginAction" wm-navigable-element="true"><ng-template #dialogBody>';
            },
            post: function() {
                return "</ng-template></" + tagName$F + ">";
            }
        };
    });
    var tagName$G = "div";
    transpiler.register("wm-pagedialog", function() {
        return {
            pre: function(attrs, shared) {
                var content = attrs.get("content");
                attrs.delete("content");
                var boundContent = attrs.get("content.bind");
                attrs.delete("content.bind");
                var onLoad = attrs.get("load.event");
                attrs.delete("load.event");
                var onLoadEvtMarkup = "";
                var contentMarkup = "";
                if (onLoad) {
                    onLoadEvtMarkup = 'load.event="' + onLoad + '"';
                }
                if (boundContent) {
                    contentMarkup = 'content.bind="' + boundContent + '"';
                } else if (content) {
                    contentMarkup = 'content="' + content + '"';
                }
                var containerMarkup = "";
                if (contentMarkup) {
                    shared.set("hasPartialContent", true);
                    containerMarkup += "<ng-template><div wmContainer partialContainer " + contentMarkup + ' width="100%" height="100%" ' + onLoadEvtMarkup + ">";
                }
                return "<" + tagName$G + " wmPartialDialog " + transpiler.getAttrMarkup(attrs) + ">" + containerMarkup;
            },
            post: function(attrs, shared) {
                var preContent = "";
                if (shared.get("hasPartialContent")) {
                    preContent = "</div></ng-template>";
                }
                return preContent + "</" + tagName$G + ">";
            }
        };
    });
    var ALLFIELDS = "All Fields";
    var EDIT_MODE = {
        QUICK_EDIT: "quickedit",
        INLINE: "inline",
        FORM: "form",
        DIALOG: "dialog"
    };
    var fieldTypeWidgetTypeMap = {
        integer: [ "number", "text", "select", "checkboxset", "radioset", "rating", "slider", "currency", "autocomplete", "chips" ],
        big_integer: [ "number", "text", "select", "checkboxset", "radioset", "rating", "slider", "currency", "autocomplete", "chips" ],
        short: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        float: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        big_decimal: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        number: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        double: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        long: [ "number", "text", "select", "checkboxset", "radioset", "rating", "slider", "currency", "autocomplete", "chips" ],
        byte: [ "number", "text", "select", "checkboxset", "radioset", "slider", "currency", "autocomplete", "chips" ],
        string: [ "text", "number", "textarea", "password", "richtext", "select", "checkboxset", "radioset", "date", "time", "timestamp", "switch", "currency", "autocomplete", "chips", "colorpicker" ],
        character: [ "text", "number", "textarea", "password", "richtext", "select", "checkboxset", "radioset", "switch", "currency", "autocomplete", "chips" ],
        text: [ "text", "number", "textarea", "password", "richtext", "select", "checkboxset", "radioset", "date", "time", "timestamp", "switch", "currency", "autocomplete", "chips", "colorpicker" ],
        date: [ "date", "text", "number", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        time: [ "time", "text", "number", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        timestamp: [ "timestamp", "text", "number", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        datetime: [ "datetime", "text", "select", "checkboxset", "radioset", "autocomplete", "chips" ],
        boolean: [ "checkbox", "radioset", "toggle", "select" ],
        list: [ "select", "radioset", "checkboxset", "switch", "autocomplete", "chips" ],
        clob: [ "text", "textarea", "richtext" ],
        blob: [ "upload" ],
        file: [ "upload" ],
        custom: [ "text", "number", "textarea", "password", "checkbox", "toggle", "slider", "richtext", "currency", "switch", "select", "checkboxset", "radioset", "date", "time", "timestamp", "rating", "datetime", "autocomplete", "chips", "colorpicker" ]
    };
    var DATASET_WIDGETS = new Set([ core.FormWidgetType.SELECT, core.FormWidgetType.CHECKBOXSET, core.FormWidgetType.RADIOSET, core.FormWidgetType.SWITCH, core.FormWidgetType.AUTOCOMPLETE, core.FormWidgetType.CHIPS, core.FormWidgetType.TYPEAHEAD, core.FormWidgetType.RATING ]);
    var isDataSetWidget = function(widget) {
        return DATASET_WIDGETS.has(widget);
    };
    var getDataTableFilterWidget = function(type) {
        var widget = fieldTypeWidgetTypeMap[type] && fieldTypeWidgetTypeMap[type][0];
        if (type === core.DataType.BOOLEAN) {
            widget = core.FormWidgetType.SELECT;
        }
        var filterWidgets = [ core.FormWidgetType.TEXT, core.FormWidgetType.NUMBER, core.FormWidgetType.SELECT, core.FormWidgetType.AUTOCOMPLETE, core.FormWidgetType.DATE, core.FormWidgetType.TIME, core.FormWidgetType.DATETIME ];
        if (filterWidgets.includes(widget)) {
            return widget;
        }
        return core.FormWidgetType.TEXT;
    };
    var getEditModeWidget = function(colDef) {
        if (colDef["related-entity-name"] && colDef["primary-key"]) {
            return core.FormWidgetType.SELECT;
        }
        return fieldTypeWidgetTypeMap[colDef.type] && fieldTypeWidgetTypeMap[colDef.type][0] || core.FormWidgetType.TEXT;
    };
    var tagName$H = "div";
    var idGen$2 = new core.IDGenerator("formfield_");
    var getEventsTemplate = function(attrs) {
        var eventAttrs = new Map();
        if (!attrs.has("focus.event")) {
            attrs.set("focus.event", "");
        }
        if (!attrs.has("blur.event")) {
            attrs.set("blur.event", "");
        }
        attrs.forEach(function(value, key) {
            if (key.endsWith(".event")) {
                if (key === "focus.event") {
                    value = "_onFocusField($event);" + value;
                } else if (key === "blur.event") {
                    value = "_onBlurField($event);" + value;
                }
                eventAttrs.set(key, value);
                attrs.delete(key);
            }
        });
        return transpiler.getFormMarkupAttr(eventAttrs);
    };
    var DEFAULT_PLACEHOLDERS = new Map([ [ core.FormWidgetType.SELECT, [ "Select Min value", "Select Max value", "Select value" ] ], [ core.FormWidgetType.DATETIME, [ "Select Min date time", "Select Max date time", "Select date time" ] ], [ core.FormWidgetType.TIME, [ "Select Min time", "Select Max time", "Select time" ] ], [ core.FormWidgetType.DATE, [ "Select Min date", "Select Max date", "Select date" ] ], [ core.FormWidgetType.TEXTAREA, [ "", "", "Enter value" ] ], [ core.FormWidgetType.RICHTEXT, [ "", "", "Enter value" ] ], [ core.FormWidgetType.COLORPICKER, [ "Select Color", "Select Color", "Select Color" ] ], [ core.FormWidgetType.CHIPS, [ "", "", "Type here..." ] ], [ core.FormWidgetType.PASSWORD, [ "Enter Min value", "Enter Max value", "Enter value" ] ], [ core.FormWidgetType.NUMBER, [ "Enter Min value", "Enter Max value", "Enter value" ] ], [ core.FormWidgetType.TEXT, [ "Enter Min value", "Enter Max value", "Enter value" ] ], [ core.FormWidgetType.CURRENCY, [ "Enter Min value", "Enter Max value", "Enter value" ] ], [ core.FormWidgetType.AUTOCOMPLETE, [ "", "", "Search" ] ] ]);
    var setDefaultPlaceholder = function(attrs, widgetType, index) {
        var prop = index === 1 ? "maxplaceholder" : "placeholder";
        var placeholder = attrs.get(prop);
        if (placeholder || placeholder === "") {
            return;
        }
        placeholder = DEFAULT_PLACEHOLDERS.get(widgetType) && DEFAULT_PLACEHOLDERS.get(widgetType)[index];
        if (placeholder) {
            attrs.set(prop, placeholder);
        }
    };
    var getWidgetTemplate = function(attrs, options) {
        var name = attrs.get("name");
        var fieldName = (attrs.get("key") || name || "").trim();
        var formControl = options.isMaxWidget ? 'formControlName="' + fieldName + '_max"' : options.isInList ? '[formControlName]="' + options.counter + '._fieldName"' : 'formControlName="' + fieldName + '"';
        var tmplRef = options.isMaxWidget ? "#formWidgetMax" : "#formWidget";
        var widgetName = name ? options.isMaxWidget ? 'name="' + name + '_formWidgetMax"' : 'name="' + name + '_formWidget"' : "";
        var defaultTmpl = '[class.hidden]="!' + options.pCounter + ".isUpdateMode && " + options.counter + ".viewmodewidget !== 'default'\" " + formControl + " " + options.eventsTmpl + " " + tmplRef + " " + widgetName;
        return core.getFormWidgetTemplate(options.widgetType, defaultTmpl, attrs, {
            counter: options.counter,
            pCounter: options.pCounter
        });
    };
    var getTemplate = function(attrs, widgetType, eventsTmpl, counter, pCounter, isInList) {
        var isRange = attrs.get("is-range") === "true";
        if (!isRange) {
            return getWidgetTemplate(attrs, {
                widgetType: widgetType,
                eventsTmpl: eventsTmpl,
                counter: counter,
                pCounter: pCounter,
                isInList: isInList
            });
        }
        var layoutClass = core.isMobileApp() ? "col-xs-6" : "col-sm-6";
        return '<div class="' + layoutClass + '">' + getWidgetTemplate(attrs, {
            widgetType: widgetType,
            eventsTmpl: eventsTmpl,
            counter: counter,
            pCounter: pCounter
        }) + '</div>\n                <div class="' + layoutClass + '">' + getWidgetTemplate(attrs, {
            widgetType: widgetType,
            eventsTmpl: eventsTmpl,
            counter: counter,
            pCounter: pCounter,
            isMaxWidget: true
        }) + "</div>";
    };
    var \u02753 = getTemplate;
    var getCaptionByWidget = function(attrs, widgetType, counter) {
        if (attrs.get("is-related") === "true") {
            return counter + ".getDisplayExpr()";
        }
        if (widgetType === core.FormWidgetType.PASSWORD) {
            return "'********'";
        }
        var caption = counter + ".value";
        if (widgetType === core.FormWidgetType.DATETIME || widgetType === core.FormWidgetType.TIMESTAMP) {
            caption += " | toDate:" + counter + ".formWidget.datepattern || 'yyyy-MM-dd hh:mm:ss a'";
            return caption;
        }
        if (widgetType === core.FormWidgetType.TIME) {
            caption += " | toDate:" + counter + ".formWidget.timepattern || 'hh:mm a'";
            return caption;
        }
        if (widgetType === core.FormWidgetType.DATE) {
            caption += " | toDate:" + counter + ".formWidget.datepattern ||  'yyyy-MMM-dd'";
            return caption;
        }
        if (widgetType === core.FormWidgetType.RATING || widgetType === core.FormWidgetType.UPLOAD) {
            return "";
        }
        if (isDataSetWidget(widgetType) && attrs.get("datafield") === ALLFIELDS) {
            return counter + ".getDisplayExpr()";
        }
        return counter + ".getCaption()";
    };
    var \u02754 = getCaptionByWidget;
    var registerFormField = function(isFormField) {
        return {
            requires: [ "wm-form", "wm-liveform", "wm-livefilter", "wm-list" ],
            pre: function(attrs, shared, parentForm, parentLiveForm, parentFilter, parentList) {
                var counter = idGen$2.nextUid();
                var parent = parentForm || parentLiveForm || parentFilter;
                var pCounter = parent && parent.get("form_reference") || "form";
                var widgetType = attrs.get("widget") || core.FormWidgetType.TEXT;
                var dataRole = isFormField ? "form-field" : "filter-field";
                var validationMsg = isFormField ? '<p *ngIf="' + counter + "._control?.invalid && " + counter + "._control?.touched && " + pCounter + '.isUpdateMode"\n                                   class="help-block text-danger"\n                                   [textContent]="' + counter + '.validationmessage"></p>' : "";
                var eventsTmpl = widgetType === core.FormWidgetType.UPLOAD ? "" : getEventsTemplate(attrs);
                var controlLayout = core.isMobileApp() ? "col-xs-12" : "col-sm-12";
                var isInList = pCounter === (parentList && parentList.get("parent_form_reference"));
                attrs.set("__widgetType", widgetType);
                attrs.delete("widget");
                shared.set("counter", counter);
                if (attrs.get("is-range") === "true") {
                    setDefaultPlaceholder(attrs, widgetType, 0);
                    setDefaultPlaceholder(attrs, widgetType, 1);
                } else {
                    setDefaultPlaceholder(attrs, widgetType, 2);
                }
                return "<" + tagName$H + ' data-role="' + dataRole + '" [formGroup]="' + pCounter + '.ngform" wmFormField #' + counter + '="wmFormField" widgettype="' + widgetType + '" ' + transpiler.getFormMarkupAttr(attrs) + '>\n                        <div class="live-field form-group app-composite-widget clearfix caption-{{' + pCounter + '.captionposition}}" widget="' + widgetType + '">\n                            <label [hidden]="!' + counter + '.displayname" class="app-label control-label formfield-label {{' + pCounter + '._captionClass}}" [title]="' + counter + '.displayname"\n                                        [ngStyle]="{width: ' + pCounter + ".captionsize}\" [ngClass]=\"{'text-danger': " + counter + "._control?.invalid && " + counter + "._control?.touched && " + pCounter + ".isUpdateMode,\n                                         required: " + pCounter + ".isUpdateMode && " + counter + '.required}" [textContent]="' + counter + '.displayname"> </label>\n                            <div [ngClass]="' + counter + ".displayname ? " + pCounter + "._widgetClass : '" + controlLayout + '\'">\n                                 <label class="form-control-static app-label"\n                                       [hidden]="' + pCounter + ".isUpdateMode || " + counter + ".viewmodewidget === 'default' || " + counter + ".widgettype === 'upload'\" [innerHTML]=\"" + getCaptionByWidget(attrs, widgetType, counter) + '"></label>\n                                ' + getTemplate(attrs, widgetType, eventsTmpl, counter, pCounter, isInList) + '\n                                <span aria-hidden="true" *ngIf="' + counter + '.showPendingSpinner" class="form-field-spinner fa fa-circle-o-notch fa-spin form-control-feedback"></span>\n                                <p *ngIf="!(' + counter + "._control?.invalid && " + counter + "._control?.touched) && " + pCounter + '.isUpdateMode"\n                                   class="help-block" [textContent]="' + counter + '.hint"></p>\n                                ' + validationMsg + "\n                            </div>\n                        </div>";
            },
            post: function() {
                return "</" + tagName$H + ">";
            },
            provide: function(attrs, shared) {
                var provider = new Map();
                provider.set("form_reference", shared.get("counter"));
                return provider;
            },
            imports: function(attrs) {
                var requiredWidget = core.getRequiredFormWidget(attrs.get("__widgetType") || attrs.get("type"));
                attrs.delete("__widgetType");
                return [ requiredWidget, "wm-form" ];
            }
        };
    };
    var \u02755 = registerFormField;
    transpiler.register("wm-form-field", registerFormField.bind(this, true));
    transpiler.register("wm-filter-field", registerFormField.bind(this, false));
    var tagName$I = "div";
    var registerAction = function(tmpl) {
        return {
            pre: function(attrs) {
                return "<" + tagName$I + ' wmFormAction name="' + (attrs.get("name") || attrs.get("key")) + '" ' + transpiler.getAttrMarkup(attrs) + " " + tmpl + ">";
            },
            post: function() {
                return "</" + tagName$I + ">";
            }
        };
    };
    transpiler.register("wm-form-action", registerAction.bind(this, ""));
    transpiler.register("wm-filter-action", registerAction.bind(this, ' update-mode="true" '));
    var tagName$J = "form";
    var idGen$3 = new core.IDGenerator("form_");
    var formWidgets = new Set([ "wm-text", "wm-textarea", "wm-checkbox", "wm-slider", "wm-richtexteditor", "wm-currency", "wm-switch", "wm-select", "wm-checkboxset", "wm-radioset", "wm-date", "wm-time", "wm-timestamp", "wm-upload", "wm-rating", "wm-datetime", "wm-search", "wm-chips", "wm-colorpicker", "wm-table" ]);
    var addFormControlName = function(children) {
        if (children === void 0) {
            children = [];
        }
        children.forEach(function(childNode) {
            if (formWidgets.has(childNode.name)) {
                var key = childNode.attrs.find(function(attr) {
                    return attr.name === "key" || attr.name === "name";
                });
                key = key && key.value;
                childNode.attrs.push(new compiler.Attribute("formControlName", key, 1, 1));
                childNode.attrs.push(new compiler.Attribute("wmFormWidget", "", 1, 1));
            }
            addFormControlName(childNode.children);
        });
    };
    var updateFormDataSource = function(attrMap) {
        if (attrMap.get("formdata.bind")) {
            var formDataSource = transpiler.getDataSource(attrMap.get("formdata.bind"));
            if (formDataSource) {
                attrMap.set("formdatasource.bind", formDataSource);
            }
        }
    };
    var buildTask = function(directiveAttr) {
        if (directiveAttr === void 0) {
            directiveAttr = "";
        }
        return {
            requires: [ "wm-livetable", "wm-login" ],
            template: function(node) {
                addFormControlName(node.children);
            },
            pre: function(attrs, shared, parentLiveTable, parentLoginWidget) {
                var tmpl;
                var dialogId;
                var role = parentLoginWidget && parentLoginWidget.get("isLogin") ? "app-login" : "";
                var counter = idGen$3.nextUid();
                var dependsOn = attrs.get("dependson") ? 'dependson="' + attrs.get("dependson") + '"' : "";
                var classProp = attrs.get("formlayout") === "page" ? "app-device-liveform panel liveform-inline" : "";
                var dialogAttributes = [ "title", "title.bind", "iconclass", "iconclass.bind", "width" ];
                attrs.delete("dependson");
                var liveFormTmpl = "<" + tagName$J + ' wmForm role="' + role + '" ' + directiveAttr + " #" + counter + ' ngNativeValidate [formGroup]="' + counter + '.ngform" [noValidate]="' + counter + ".validationtype !== 'html'\"\n                    class=\"" + classProp + '" [class]="' + counter + '.captionAlignClass" [autocomplete]="' + counter + ".autocomplete ? 'on' : 'off'\" captionposition=" + attrs.get("captionposition");
                shared.set("counter", counter);
                updateFormDataSource(attrs);
                if (attrs.get("formlayout") === "dialog") {
                    dialogId = parentLiveTable ? parentLiveTable.get("liveform_dialog_id") : "liveform_dialog_id_" + counter;
                    attrs.set("dialogId", dialogId);
                    var dialogAttrsMap_1 = new Map();
                    dialogAttributes.forEach(function(attr) {
                        if (attrs.get(attr)) {
                            dialogAttrsMap_1.set(attr, attrs.get(attr));
                        }
                    });
                    attrs.set("width", "100%");
                    tmpl = transpiler.getAttrMarkup(attrs);
                    return '<div data-identifier="liveform" init-widget class="app-liveform liveform-dialog" ' + dependsOn + ' dialogid="' + dialogId + '">\n                            <div wmDialog class="app-liveform-dialog" name="' + dialogId + '" role="form" ' + transpiler.getAttrMarkup(dialogAttrsMap_1) + ' modal="true">\n                            <ng-template #dialogBody>\n                            ' + liveFormTmpl + " " + tmpl + ">";
                }
                var mobileFormContentTmpl = "";
                var buttonTemplate = "";
                if (attrs.get("formlayout") === "page") {
                    var name_1 = "device_liveform_header_" + counter;
                    var navbarAttrsMap = new Map();
                    navbarAttrsMap.set("title", attrs.get("title"));
                    navbarAttrsMap.set("backbtnclick.event", attrs.get("backbtnclick.event"));
                    buttonTemplate = '<ng-template #buttonRef let-btn="btn">\n                                            <button  wmButton name="{{btn.key}}" class="navbar-btn btn-primary btn-transparent" iconclass.bind="btn.iconclass" show.bind="btn.show"\n                                                     (click)="' + counter + '.invokeActionEvent($event, btn.action)" type.bind="btn.type" hint.bind="btn.title" shortcutkey.bind="btn.shortcutkey" disabled.bind="btn.disabled"\n                                                     tabindex.bind="btn.tabindex" [class.hidden]="btn.updateMode ? !' + counter + ".isUpdateMode : " + counter + '.isUpdateMode"></button>\n                                        </ng-template>';
                    mobileFormContentTmpl = '<header wmMobileNavbar name="' + name_1 + '" ' + transpiler.getAttrMarkup(navbarAttrsMap) + '>\n                                            <ng-container *ngFor="let btn of ' + counter + '.buttonArray" [ngTemplateOutlet]="buttonRef" [ngTemplateOutletContext]="{btn:btn}">\n                                            </ng-container>\n                                        </header>\n                                        <div class="form-elements panel-body" >';
                }
                tmpl = transpiler.getAttrMarkup(attrs);
                return liveFormTmpl + " " + tmpl + " " + dependsOn + ">\n                       " + buttonTemplate + " " + mobileFormContentTmpl;
            },
            post: function(attrs) {
                if (attrs.get("formlayout") === "dialog") {
                    return "</form></ng-template></div></div>";
                }
                if (attrs.get("formlayout") === "page") {
                    return "</div></" + tagName$J + ">";
                }
                return "</" + tagName$J + ">";
            },
            provide: function(attrs, shared) {
                var provider = new Map();
                provider.set("form_reference", shared.get("counter"));
                return provider;
            }
        };
    };
    transpiler.register("wm-form", buildTask);
    transpiler.register("wm-liveform", function() {
        return buildTask("wmLiveForm");
    });
    transpiler.register("wm-livefilter", function() {
        return buildTask("wmLiveFilter");
    });
    var tagName$K = "div";
    transpiler.register("wm-calendar", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$K + ' wmCalendar redrawable style="width:100%" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$K + ">";
            }
        };
    });
    var tagName$L = "ul";
    transpiler.register("wm-chips", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$L + ' wmChips role="listbox" ' + transpiler.getAttrMarkup(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$L + ">";
            }
        };
    });
    var tagName$M = "div";
    transpiler.register("wm-colorpicker", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$M + " wmColorPicker " + transpiler.getAttrMarkup(attrs) + ' role="input" ' + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$M + ">";
            }
        };
    });
    var tagName$N = "div";
    transpiler.register("wm-currency", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$N + " wmCurrency " + transpiler.getAttrMarkup(attrs) + ' role="input" ' + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$N + ">";
            }
        };
    });
    var tagName$O = "div";
    transpiler.register("wm-buttongroup", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$O + ' wmButtonGroup role="group" aria-labelledby="button group" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$O + ">";
            }
        };
    });
    var tagName$P = "button";
    transpiler.register("wm-button", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$P + " wmButton " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$P + ">";
            }
        };
    });
    var tagName$Q = "div";
    transpiler.register("wm-checkbox", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$Q + ' wmCheckbox role="input" ' + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$Q + ">";
            }
        };
    });
    var tagName$R = "ul";
    transpiler.register("wm-checkboxset", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$R + " wmCheckboxset " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$R + ">";
            }
        };
    });
    var tagName$S = "div";
    transpiler.register("wm-composite", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$S + ' wmComposite role="group" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$S + ">";
            }
        };
    });
    var tagName$T = "div";
    transpiler.register("wm-number", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$T + " wmNumber " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$T + ">";
            }
        };
    });
    var tagName$U = "ul";
    transpiler.register("wm-radioset", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$U + ' wmRadioset role="radiogroup" ' + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$U + ">";
            }
        };
    });
    var tagName$V = "wm-select";
    transpiler.register("wm-select", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$V + " " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$V + ">";
            }
        };
    });
    var tagName$W = "div";
    transpiler.register("wm-switch", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$W + " wmSwitch " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$W + ">";
            }
        };
    });
    var tagName$X = "wm-input";
    transpiler.register("wm-text", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$X + " " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$X + ">";
            }
        };
    });
    var tagName$Y = "wm-textarea";
    transpiler.register("wm-textarea", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$Y + " " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$Y + ">";
            }
        };
    });
    var tagName$Z = "div";
    transpiler.register("wm-datetime", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$Z + " wmDateTime " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$Z + ">";
            }
        };
    });
    var tagName$_ = "div";
    transpiler.register("wm-date", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$_ + " wmDate " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$_ + ">";
            }
        };
    });
    var tagName$10 = "div";
    transpiler.register("wm-time", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$10 + " wmTime " + transpiler.getFormMarkupAttr(attrs) + ' role="input" ' + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$10 + ">";
            }
        };
    });
    var tagName$11 = "div";
    transpiler.register("wm-fileupload", function() {
        return {
            pre: function(attrs) {
                if (attrs.get("select.event")) {
                    var onSelectBinding = transpiler.getDataSource(attrs.get("select.event"));
                    attrs.set("datasource.bind", onSelectBinding);
                }
                return "<" + tagName$11 + " wmFileUpload " + transpiler.getAttrMarkup(attrs) + ' role="input">';
            },
            post: function() {
                return "</" + tagName$11 + ">";
            }
        };
    });
    var tagName$12 = "div";
    transpiler.register("wm-rating", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$12 + " wmRating " + transpiler.getFormMarkupAttr(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$12 + ">";
            }
        };
    });
    var tagName$13 = "div";
    transpiler.register("wm-slider", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$13 + " wmSlider " + transpiler.getAttrMarkup(attrs) + " " + core.getNgModelAttr(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$13 + ">";
            }
        };
    });
    var wmlistTag = "wm-list";
    var tagName$14 = "div";
    var dataSetKey$1 = "dataset";
    function copyAttribute(from, fromAttrName, to, toAttrName) {
        var fromAttr = from.attrs.find(function(a) {
            return a.name === fromAttrName;
        });
        if (fromAttr) {
            to.attrs.push(new compiler.Attribute(toAttrName, fromAttr.value, fromAttr.sourceSpan, fromAttr.valueSpan));
        }
    }
    transpiler.register("wm-media-list", function() {
        return {
            template: function(node) {
                var bindDataset;
                var attrObj = node.attrs.find(function(attr) {
                    return attr.name === dataSetKey$1;
                }), replaceBind = function(children) {
                    if (children === void 0) {
                        children = [];
                    }
                    children.forEach(function(childNode) {
                        if (childNode.name) {
                            if (childNode.name !== wmlistTag) {
                                childNode.attrs.forEach(function(attr) {
                                    if (attr.value.startsWith("bind:" + bindDataset + ".data[$i]")) {
                                        attr.value = attr.value.replace(bindDataset + ".data[$i]", "item");
                                    } else if (attr.value.startsWith("bind:" + bindDataset)) {
                                        attr.value = attr.value.replace(bindDataset, "item");
                                    }
                                });
                                replaceBind(childNode.children);
                            }
                        }
                    });
                };
                if (attrObj && attrObj.value.startsWith("bind:")) {
                    bindDataset = attrObj.value.replace("bind:", "");
                }
                if (bindDataset) {
                    replaceBind(node.children);
                }
                var template = node.children.find(function(e) {
                    return e instanceof compiler.Element && e.name === "wm-media-template";
                });
                if (template != null) {
                    copyAttribute(template, "width", node, "thumbnailwidth");
                    copyAttribute(template, "height", node, "thumbnailheight");
                }
            },
            pre: function(attrs) {
                return "<" + tagName$14 + " wmMediaList " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$14 + ">";
            }
        };
    });
    var tagName$15 = "ng-template";
    transpiler.register("wm-media-template", function() {
        return {
            pre: function() {
                return "<" + tagName$15 + ' #mediaListTemplate let-item="item" let-index="index">';
            },
            post: function() {
                return "</" + tagName$15 + ">";
            }
        };
    });
    var wmListTag = "wm-list";
    var listTagName = "div";
    var dataSetKey$2 = "dataset";
    transpiler.register(wmListTag, function() {
        return {
            requires: [ "wm-form", "wm-liveform" ],
            template: function(node) {
                var datasetAttr = node.attrs.find(function(attr) {
                    return attr.name === dataSetKey$2;
                });
                var widgetNameAttr = node.attrs.find(function(attr) {
                    return attr.name === "name";
                });
                if (!datasetAttr) {
                    return;
                }
                var boundExpr = transpiler.getBoundToExpr(datasetAttr.value);
                if (!boundExpr) {
                    return;
                }
                core.updateTemplateAttrs(node, boundExpr, widgetNameAttr.value, "itemRef.");
            },
            pre: function(attrs, shared, parentForm, parentLiveForm) {
                var parent = parentForm || parentLiveForm;
                shared.set("form_reference", parent && parent.get("form_reference"));
                return "<" + listTagName + " wmList wmLiveActions " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + listTagName + ">";
            },
            provide: function(attrs, shared) {
                var provider = new Map();
                provider.set("parent_form_reference", shared.get("form_reference"));
                return provider;
            }
        };
    });
    transpiler.register("wm-listtemplate", function() {
        return {
            pre: function() {
                return '<ng-template #listTemplate let-item="item" let-$index="$index" let-itemRef="itemRef" let-$first="$first" let-$last="$last"  let-currentItemWidgets="currentItemWidgets" >';
            },
            post: function() {
                return "</ng-template>";
            }
        };
    });
    function copyAttribute$1(from, fromAttrName, to, toAttrName) {
        var fromAttr = from.attrs.find(function(a) {
            return a.name === fromAttrName;
        });
        if (fromAttr) {
            to.attrs.push(new compiler.Attribute(toAttrName, fromAttr.value, fromAttr.sourceSpan, fromAttr.valueSpan));
        }
    }
    transpiler.register("wm-list-action-template", function() {
        return {
            template: function(node) {
                var position = node.attrs.find(function(attr) {
                    return attr.name === "position";
                }).value;
                var btns = node.children.filter(function(e) {
                    return e instanceof compiler.Element && e.name === "wm-button";
                });
                btns.forEach(function(btnNode) {
                    copyAttribute$1(node, "position", btnNode, "swipe-position");
                });
            },
            pre: function(attrs, el) {
                if (attrs.get("position") === "left") {
                    return '<ng-template #listLeftActionTemplate>\n                            <li class="app-list-item-action-panel app-list-item-left-action-panel actionMenu" ' + transpiler.getAttrMarkup(attrs) + ">";
                }
                if (attrs.get("position") === "right") {
                    return '<ng-template #listRightActionTemplate>\n                            <li class="app-list-item-action-panel app-list-item-right-action-panel actionMenu" ' + transpiler.getAttrMarkup(attrs) + ">";
                }
            },
            post: function() {
                return "</li></ng-template>";
            }
        };
    });
    var tagName$16 = "div";
    var idGen$4 = new core.IDGenerator("liveform_dialog_id_");
    transpiler.register("wm-livetable", function() {
        return {
            pre: function(attrs, shared) {
                var counter = idGen$4.nextUid();
                shared.set("counter", counter);
                return "<" + tagName$16 + ' wmLiveTable role="table" ' + transpiler.getAttrMarkup(attrs) + ' dialogid="' + counter + '">';
            },
            post: function() {
                return "</" + tagName$16 + ">";
            },
            provide: function(attrs, shared) {
                var provider = new Map();
                provider.set("liveform_dialog_id", shared.get("counter"));
                return provider;
            }
        };
    });
    var tagName$17 = "p";
    transpiler.register("wm-message", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$17 + ' wmMessage aria-label="Notification Alerts" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$17 + ">";
            }
        };
    });
    var tagName$18 = "ol";
    transpiler.register("wm-breadcrumb", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$18 + " wmBreadcrumb " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$18 + ">";
            }
        };
    });
    var tagName$19 = "div";
    transpiler.register("wm-menu", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$19 + " wmMenu dropdown " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$19 + ">";
            }
        };
    });
    var tagName$1a = "li";
    transpiler.register("wm-nav-item", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1a + ' wmNavItem role="presentation" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1a + ">";
            }
        };
    });
    var tagName$1b = "ul";
    transpiler.register("wm-nav", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1b + ' wmNav data-element-type="wmNav" data-role="page-header" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1b + ">";
            }
        };
    });
    var tagName$1c = "nav";
    transpiler.register("wm-navbar", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1c + ' wmNavbar data-element-type="wmNavbar" role="navigation" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1c + ">";
            }
        };
    });
    var tagName$1d = "wm-popover";
    transpiler.register("wm-popover", function() {
        return {
            requires: [ "wm-table" ],
            pre: function(attrs, shared, table) {
                var contentSource = attrs.get("contentsource");
                var popoverTemplate;
                if (contentSource !== "inline") {
                    var content = attrs.get("content");
                    var bindContent = attrs.get("content.bind");
                    var contentMarkup = "";
                    if (content) {
                        contentMarkup = 'content="' + content + '"';
                    } else if (bindContent) {
                        contentMarkup = 'content.bind="' + bindContent + '"';
                    }
                    popoverTemplate = "<div wmContainer #partial partialContainer " + contentMarkup + ">";
                    shared.set("hasPopoverContent", true);
                }
                var markup = "<" + tagName$1d + " wmPopover " + transpiler.getAttrMarkup(attrs) + ">";
                var contextAttrs = table ? 'let-row="row"' : "";
                markup += "<ng-template " + contextAttrs + '><button class="popover-start"></button>';
                if (popoverTemplate) {
                    markup += "" + (popoverTemplate ? popoverTemplate : "");
                }
                return markup;
            },
            post: function(attrs, shared) {
                var markup = "";
                if (shared.get("hasPopoverContent")) {
                    markup += "</div>";
                }
                return markup + '<button class="popover-end"></button></ng-template></' + tagName$1d + ">";
            }
        };
    });
    var tagName$1e = "div";
    var findChild = function(node, childName) {
        var child = node && node.children.find(function(e) {
            return e instanceof compiler.Element && e.name === childName;
        });
        return child;
    };
    var createElement = function(name) {
        return new compiler.Element(name, [], [], noSpan, noSpan, noSpan);
    };
    var addAtrribute = function(node, name, value) {
        var attr = new compiler.Attribute(name, value, noSpan, noSpan);
        node.attrs.push(attr);
    };
    var noSpan = {};
    transpiler.register("wm-page", function() {
        return {
            template: function(node) {
                var pageContentNode = findChild(findChild(node, "wm-content"), "wm-page-content");
                if (pageContentNode) {
                    var conditionalNode = createElement("ng-container");
                    addAtrribute(conditionalNode, "*ngIf", "compilePageContent");
                    conditionalNode.children = conditionalNode.children.concat(pageContentNode.children);
                    conditionalNode.children.push(new compiler.Text("{{onPageContentReady()}}", null));
                    pageContentNode.children = [ conditionalNode ];
                    if (core.isMobileApp()) {
                        var loader = createElement("div");
                        addAtrribute(loader, "wmPageContentLoader", "");
                        addAtrribute(loader, "*ngIf", "!showPageContent");
                        pageContentNode.children.push(loader);
                    }
                }
            },
            pre: function(attrs) {
                return "<" + tagName$1e + ' wmPage data-role="pageContainer" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1e + ">";
            }
        };
    });
    var tagName$1f = "nav";
    transpiler.register("wm-pagination", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1f + ' wmPagination data-identifier="pagination" aria-label="Page navigation" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1f + ">";
            }
        };
    });
    var tagName$1g = "main";
    transpiler.register("wm-content", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1g + ' wmContent data-role="page-content" role="main" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1g + ">";
            }
        };
    });
    var tagName$1h = "footer";
    transpiler.register("wm-footer", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1h + ' wmFooter partialContainer data-role="page-footer" role="contentinfo" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1h + ">";
            }
        };
    });
    var tagName$1i = "header";
    transpiler.register("wm-header", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1i + ' wmHeader partialContainer data-role="page-header" role="banner" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1i + ">";
            }
        };
    });
    var tagName$1j = "aside";
    transpiler.register("wm-left-panel", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1j + ' wmLeftPanel partialContainer data-role="page-left-panel" role="complementary" wmSmoothscroll="' + (attrs.get("smoothscroll") || "true") + '" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1j + ">";
            }
        };
    });
    var tagName$1k = "header";
    transpiler.register("wm-mobile-navbar", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1k + " wmMobileNavbar " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1k + ">";
            }
        };
    });
    var tagName$1l = "aside";
    transpiler.register("wm-right-panel", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1l + ' wmRightPanel partialContainer data-role="page-right-panel" role="complementary" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1l + ">";
            }
        };
    });
    var tagName$1m = "div";
    transpiler.register("wm-page-content", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1m + ' wmPageContent wmSmoothscroll="' + (attrs.get("smoothscroll") || "true") + '" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1m + ">";
            }
        };
    });
    var tagName$1n = "div";
    transpiler.register("wm-mobile-tabbar", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1n + " wmMobileTabbar " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1n + ">";
            }
        };
    });
    var tagName$1o = "section";
    transpiler.register("wm-top-nav", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1o + ' wmTopNav partialContainer data-role="page-topnav" role="region" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1o + ">";
            }
        };
    });
    var tagName$1p = "section";
    var noSpan$1 = {};
    var createElement$1 = function(name) {
        return new compiler.Element(name, [], [], noSpan$1, noSpan$1, noSpan$1);
    };
    var addAtrribute$1 = function(node, name, value) {
        var attr = new compiler.Attribute(name, value, noSpan$1, noSpan$1);
        node.attrs.push(attr);
    };
    transpiler.register("wm-partial", function() {
        return {
            template: function(node) {
                var conditionalNode = createElement$1("ng-container");
                addAtrribute$1(conditionalNode, "*ngIf", "compileContent");
                conditionalNode.children = conditionalNode.children.concat(node.children);
                node.children.length = 0;
                node.children.push(conditionalNode);
            },
            pre: function(attrs) {
                return "<" + tagName$1p + ' wmPartial data-role="partial" role="region" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1p + ">";
            }
        };
    });
    var tagName$1q = "div";
    transpiler.register("wm-param", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1q + " wmParam hidden " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1q + ">";
            }
        };
    });
    var tagName$1r = "section";
    transpiler.register("wm-prefab", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1r + ' wmPrefab data-role="perfab" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1r + ">";
            }
        };
    });
    var noSpan$2 = {};
    var createElement$2 = function(name) {
        return new compiler.Element(name, [], [], noSpan$2, noSpan$2, noSpan$2);
    };
    var addAtrribute$2 = function(node, name, value) {
        var attr = new compiler.Attribute(name, value, noSpan$2, noSpan$2);
        node.attrs.push(attr);
    };
    var tagName$1s = "div";
    transpiler.register("wm-prefab-container", function() {
        return {
            template: function(node) {
                var conditionalNode = createElement$2("ng-container");
                addAtrribute$2(conditionalNode, "*ngIf", "compileContent");
                conditionalNode.children = conditionalNode.children.concat(node.children);
                node.children.length = 0;
                node.children.push(conditionalNode);
            },
            pre: function(attrs) {
                return "<" + tagName$1s + " wmPrefabContainer " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1s + ">";
            }
        };
    });
    var tagName$1t = "div";
    transpiler.register("wm-table-action", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1t + ' name="' + (attrs.get("name") || attrs.get("key")) + '" wmTableAction ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1t + ">";
            }
        };
    });
    var tagName$1u = "div";
    transpiler.register("wm-table-column-group", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1u + " wmTableColumnGroup " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1u + ">";
            }
        };
    });
    var tagName$1v = "div";
    var idGen$5 = new core.IDGenerator("data_table_form_");
    var formWidgets$1 = new Set([ "wm-text", "wm-textarea", "wm-checkbox", "wm-slider", "wm-currency", "wm-switch", "wm-select", "wm-checkboxset", "wm-radioset", "wm-date", "wm-time", "wm-timestamp", "wm-rating", "wm-datetime", "wm-search", "wm-chips", "wm-colorpicker" ]);
    var addNgModelStandalone = function(children) {
        if (children === void 0) {
            children = [];
        }
        children.forEach(function(childNode) {
            if (formWidgets$1.has(childNode.name)) {
                childNode.attrs.push(new compiler.Attribute("[ngModelOptions]", "{standalone: true}", 1, 1));
            }
            addNgModelStandalone(childNode.children);
        });
    };
    var getFilterTemplate = function(attrs, pCounter) {
        var widget = attrs.get("filterwidget") || getDataTableFilterWidget(attrs.get("type") || core.DataType.STRING);
        var fieldName = attrs.get("binding");
        var type = attrs.get("type") || "string";
        var datasourceBinding, submitEventBinding;
        var datasetAttr = attrs.get("filterdataset.bind");
        if (attrs.get("filterwidget") === "autocomplete") {
            if (datasetAttr) {
                var binddatasource = transpiler.getDataSource(datasetAttr);
                datasourceBinding = 'dataset.bind="' + datasetAttr + '" datasource.bind="' + binddatasource + '"';
            }
            submitEventBinding = "submit.event=\"changeFn('" + fieldName + "')\"";
        }
        var innerTmpl = '#filterWidget formControlName="' + (fieldName + "_filter") + '" ' + datasourceBinding + " " + submitEventBinding + " change.event=\"changeFn('" + fieldName + "')\"\n                        disabled.bind=\"isDisabled('" + fieldName + "')\"";
        var options = {
            inputType: "filterinputtype"
        };
        var widgetTmpl = "" + core.getFormWidgetTemplate(widget, innerTmpl, attrs, options);
        return '<ng-template #filterTmpl let-changeFn="changeFn" let-isDisabled="isDisabled">\n    <div class="input-group ' + widget + '" data-col-identifier="' + fieldName + '">\n        ' + widgetTmpl + '\n        <span class="input-group-addon filter-clear-icon" *ngIf="' + pCounter + ".showClearIcon('" + fieldName + '\')">\n            <button class="btn-transparent btn app-button" aria-label="Clear button" type="button" (click)="' + pCounter + ".clearRowFilter('" + fieldName + '\')">\n                <i class="app-icon wi wi-clear" aria-hidden="true"></i>\n            </button>\n         </span>\n        <span class="input-group-addon" dropdown container="body">\n            <button class="btn-transparent btn app-button" type="button" dropdownToggle><i class="app-icon wi wi-filter-list"></i></button>\n            <ul class="matchmode-dropdown dropdown-menu" *dropdownMenu>\n                   <li *ngFor="let matchMode of ' + pCounter + ".matchModeTypesMap['" + type + '\']"\n                        [ngClass]="{active: matchMode === (' + pCounter + ".rowFilter['" + fieldName + "'].matchMode || " + pCounter + ".matchModeTypesMap['" + type + '\'][0])}">\n                        <a href="javascript:void(0);" (click)="' + pCounter + ".onFilterConditionSelect('" + fieldName + '\', matchMode)" [innerText]="' + pCounter + '.matchModeMsgs[matchMode]"></a>\n                    </li>\n             </ul>\n        </span>\n    </div></ng-template>';
    };
    var getEventsTmpl = function(attrs) {
        var tmpl = "";
        attrs.forEach(function(val, key) {
            if (key.endsWith(".event")) {
                tmpl += key + '="' + val + '" ';
            }
        });
        return tmpl;
    };
    var getInlineEditRowPropsTmpl = function(attrs) {
        var propAttrs = new Map();
        var props = [ "disabled", "disabled.bind" ];
        props.forEach(function(prop) {
            if (attrs.get(prop)) {
                propAttrs.set(prop, attrs.get(prop));
                attrs.delete(prop);
            }
        });
        return transpiler.getAttrMarkup(propAttrs);
    };
    var getInlineEditWidgetTmpl = function(attrs, isNewRow, pCounter) {
        var options = {};
        var fieldName = attrs.get("binding");
        var widget = attrs.get("edit-widget-type") || getEditModeWidget({
            type: attrs.get("type"),
            "related-entity-name": attrs.get("related-entity-name"),
            "primary-key": attrs.get("primary-key")
        });
        var widgetRef = "";
        var formControl = "";
        var wmFormWidget = "";
        if (widget === core.FormWidgetType.UPLOAD) {
            options.uploadProps = {
                formName: idGen$5.nextUid(),
                name: fieldName
            };
            options.counter = pCounter;
        } else {
            widgetRef = isNewRow ? "#inlineWidgetNew" : "#inlineWidget";
            formControl = isNewRow ? 'formControlName="' + fieldName + '_new"' : 'formControlName="' + fieldName + '"';
            wmFormWidget = "wmFormWidget";
        }
        options.inputType = "editinputtype";
        var tmplRef = isNewRow ? "#inlineWidgetTmplNew" : "#inlineWidgetTmpl";
        var eventsTmpl = widget === core.FormWidgetType.UPLOAD ? "" : getEventsTmpl(attrs);
        var rowPropsTl = getInlineEditRowPropsTmpl(attrs);
        var innerTmpl = widgetRef + " " + wmFormWidget + ' key="' + fieldName + '" data-field-name="' + fieldName + '" ' + formControl + " " + eventsTmpl + " " + rowPropsTl;
        var widgetTmpl = core.getFormWidgetTemplate(widget, innerTmpl, attrs, options);
        return "<ng-template " + tmplRef + ' let-row="row" let-getControl="getControl" let-getValidationMessage="getValidationMessage">\n                <div data-col-identifier="' + fieldName + '" >\n                     ' + widgetTmpl + '\n                     <span placement="top" container="body" tooltip="{{getValidationMessage()}}" class="text-danger wi wi-error"\n                        *ngIf="getValidationMessage() && getControl() && getControl().invalid && getControl().touched">\n                     </span>\n                     <span class="sr-only" *ngIf="getValidationMessage()">{{getValidationMessage()}}</span>\n                 </div>\n            </ng-template>';
    };
    var getFormatExpression = function(attrs) {
        var columnValue = "row.getProperty('" + attrs.get("binding") + "')";
        var formatPattern = attrs.get("formatpattern");
        var colExpression = "";
        if (core.isDateTimeType(attrs.get("type")) && (!formatPattern || formatPattern === "None")) {
            attrs.set("formatpattern", "toDate");
            attrs.delete("datepattern");
            formatPattern = "toDate";
        }
        switch (formatPattern) {
          case "toDate":
            colExpression = "{{" + columnValue + " | toDate: colDef.datepattern}}";
            break;

          case "toCurrency":
            if (attrs.get("currencypattern")) {
                colExpression = "{{" + columnValue + " | toCurrency: '" + attrs.get("currencypattern");
                if (attrs.get("fractionsize")) {
                    colExpression += "': " + attrs.get("fractionsize") + "}}";
                } else {
                    colExpression += "'}}";
                }
            }
            break;

          case "numberToString":
            if (attrs.get("fractionsize")) {
                colExpression = "{{" + columnValue + " | numberToString: '" + attrs.get("fractionsize") + "'}}";
            }
            break;

          case "stringToNumber":
            colExpression = "{{" + columnValue + " | stringToNumber}}";
            break;

          case "timeFromNow":
            colExpression = "{{" + columnValue + " | timeFromNow}}";
            break;

          case "prefix":
            if (attrs.get("prefix")) {
                colExpression = "{{" + columnValue + " | prefix: '" + attrs.get("prefix") + "'}}";
            }
            break;

          case "suffix":
            if (attrs.get("suffix")) {
                colExpression = "{{" + columnValue + " | suffix: '" + attrs.get("suffix") + "'}}";
            }
            break;
        }
        return colExpression;
    };
    transpiler.register("wm-table-column", function() {
        return {
            requires: [ "wm-table" ],
            template: function(node, shared) {
                if (node.children.length) {
                    if (node.children.length === 1 && node.children[0] instanceof compiler.Text && node.children[0].value.trim().length === 0) {
                        return;
                    }
                    shared.set("customExpression", true);
                    addNgModelStandalone(node.children);
                }
            },
            pre: function(attrs, shared, parentTable) {
                var rowFilterTmpl = "";
                var inlineEditTmpl = "";
                var inlineNewEditTmpl = "";
                var parentForm = "";
                if (parentTable) {
                    var pCounter = parentTable.get("table_reference");
                    rowFilterTmpl = parentTable.get("filtermode") === "multicolumn" && attrs.get("searchable") !== "false" ? getFilterTemplate(attrs, pCounter) : "";
                    var editMode = parentTable.get("editmode");
                    var isInlineEdit = editMode !== EDIT_MODE.DIALOG && editMode !== EDIT_MODE.FORM && attrs.get("readonly") !== "true";
                    inlineEditTmpl = isInlineEdit ? getInlineEditWidgetTmpl(attrs, false, pCounter) : "";
                    inlineNewEditTmpl = isInlineEdit && editMode === EDIT_MODE.QUICK_EDIT && parentTable.get("shownewrow") !== "false" ? getInlineEditWidgetTmpl(attrs, true) : "";
                    parentForm = ' [formGroup]="' + pCounter + '.ngform" ';
                }
                var formatPattern = attrs.get("formatpattern");
                var customExpr = '<ng-template #customExprTmpl let-row="row" let-colDef="colDef" let-editRow="editRow" let-deleteRow="deleteRow" let-addNewRow="addNewRow">';
                var customExprTmpl = "";
                var formatExprTmpl = "";
                if (shared.get("customExpression")) {
                    attrs.set("customExpression", "true");
                    customExprTmpl = customExpr + '<div data-col-identifier="' + attrs.get("binding") + '">';
                } else if (formatPattern && formatPattern !== "None" || core.isDateTimeType(attrs.get("type"))) {
                    formatExprTmpl = getFormatExpression(attrs);
                    if (formatExprTmpl) {
                        shared.set("customExpression", true);
                        attrs.set("customExpression", "true");
                        customExprTmpl = customExpr + '<div data-col-identifier="' + attrs.get("binding") + '" title="' + formatExprTmpl + '">' + formatExprTmpl;
                    }
                }
                return "<" + tagName$1v + " wmTableColumn " + transpiler.getAttrMarkup(attrs) + " " + parentForm + ">\n                    " + rowFilterTmpl + "\n                    " + inlineEditTmpl + "\n                    " + inlineNewEditTmpl + "\n                    " + customExprTmpl;
            },
            post: function(attrs, shared) {
                var customExprTmpl = "";
                if (shared.get("customExpression")) {
                    customExprTmpl = "</div></ng-template>";
                }
                return customExprTmpl + "</" + tagName$1v + ">";
            },
            imports: function(attrs) {
                var editWidgetType = attrs.get("edit-widget-type");
                var filterWidgetType = attrs.get("filterwidget") || getDataTableFilterWidget(attrs.get("type") || core.DataType.STRING);
                return [ core.getRequiredFormWidget(editWidgetType), core.getRequiredFormWidget(filterWidgetType), "wm-table" ];
            }
        };
    });
    var tagName$1w = "div";
    var getRowExpansionActionTmpl = function(attrs) {
        var tag = attrs.get("widget-type") === "anchor" ? "a" : "button";
        var directive = attrs.get("widget-type") === "anchor" ? "wmAnchor" : "wmButton";
        return '<ng-template #rowExpansionActionTmpl let-row="row">\n               <' + tag + " " + directive + "\n                    " + core.getRowActionAttrs(attrs) + '\n                    class="' + attrs.get("class") + ' row-expansion-button"\n                    iconclass="' + attrs.get("collapseicon") + '"\n                    type="button"></' + tag + ">\n            </ng-template>";
    };
    transpiler.register("wm-table-row", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1w + " wmTableRow " + transpiler.getAttrMarkup(attrs) + ">\n                    " + getRowExpansionActionTmpl(attrs) + '\n                    <ng-template #rowExpansionTmpl let-row="row" let-rowDef="rowDef" let-containerLoad="containerLoad">\n                        <div wmContainer partialContainer content.bind="rowDef.content" load.event="containerLoad(widget)"\n                            [ngStyle]="{\'height\': rowDef.height, \'overflow-y\': \'auto\'}">\n                         <div *ngFor="let param of rowDef.partialParams | keyvalue" wmParam hidden\n                            [name]="param.key" [value]="param.value"></div>';
            },
            post: function() {
                return "</div></ng-template></" + tagName$1w + ">";
            }
        };
    });
    var tagName$1x = "div";
    var getSaveCancelTemplate = function() {
        return '<button type="button" aria-label="Save edit icon" class="save row-action-button btn app-button btn-transparent save-edit-row-button hidden" title="Save">\n                <i class="wi wi-done" aria-hidden="true"></i>\n            </button>\n            <button type="button" aria-label="Cancel edit icon" class="cancel row-action-button btn app-button btn-transparent cancel-edit-row-button hidden" title="Cancel">\n                <i class="wi wi-cancel" aria-hidden="true"></i>\n            </button>';
    };
    var getRowActionTmpl = function(attrs) {
        var action = attrs.get("action");
        var actionTmpl = action ? ' click.event.delayed="' + action + '" ' : "";
        var saveCancelTmpl = action && action.includes("editRow(") ? getSaveCancelTemplate() : "";
        var btnClass = action ? action.includes("editRow(") ? "edit edit-row-button" : action.includes("deleteRow(") ? "delete delete-row-button" : "" : "";
        var tabIndex = attrs.get("tabindex") ? 'tabindex="' + attrs.get("tabindex") + '"' : "";
        var tag = attrs.get("widget-type") === "anchor" ? "a" : "button";
        var directive = attrs.get("widget-type") === "anchor" ? "wmAnchor" : "wmButton";
        return '<ng-template #rowActionTmpl let-row="row">\n               <' + tag + " " + directive + ' data-action-key="' + attrs.get("key") + '"\n                    ' + core.getRowActionAttrs(attrs) + '\n                    class="row-action row-action-button ' + attrs.get("class") + " " + btnClass + '"\n                    iconclass="' + attrs.get("iconclass") + '"\n                    ' + actionTmpl + "\n                    " + tabIndex + '\n                    type="button"></' + tag + ">\n                " + saveCancelTmpl + "\n            </ng-template>";
    };
    transpiler.register("wm-table-row-action", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1x + " wmTableRowAction " + transpiler.getAttrMarkup(attrs) + ">\n                        " + getRowActionTmpl(attrs);
            },
            post: function() {
                return "</" + tagName$1x + ">";
            }
        };
    });
    var tagName$1y = "div";
    var dataSetKey$3 = "dataset";
    var idGen$6 = new core.IDGenerator("table_");
    transpiler.register("wm-table", function() {
        return {
            template: function(node, shared) {
                if (node.children.length) {
                    var isColumnsPresent = node.children.some(function(childNode) {
                        return childNode.name === "wm-table-column" || childNode.name === "wm-table-column-group";
                    });
                    shared.set("isdynamictable", isColumnsPresent ? "false" : "true");
                } else {
                    shared.set("isdynamictable", "true");
                }
                var datasetAttr = node.attrs.find(function(attr) {
                    return attr.name === dataSetKey$3;
                });
                var widgetNameAttr = node.attrs.find(function(attr) {
                    return attr.name === "name";
                });
                if (!datasetAttr) {
                    return;
                }
                var boundExpr = transpiler.getBoundToExpr(datasetAttr.value);
                if (!boundExpr) {
                    return;
                }
                core.updateTemplateAttrs(node, boundExpr, widgetNameAttr.value, "", "row");
            },
            pre: function(attrs, shared) {
                var counter = idGen$6.nextUid();
                shared.set("counter", counter);
                attrs.set("isdynamictable", shared.get("isdynamictable"));
                return "<" + tagName$1y + ' wmTable="' + counter + '" wmTableFilterSort wmTableCUD #' + counter + ' data-identifier="table" role="table" ' + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1y + ">";
            },
            provide: function(attrs, shared) {
                var provider = new Map();
                provider.set("table_reference", shared.get("counter"));
                provider.set("filtermode", attrs.get("filtermode"));
                provider.set("editmode", attrs.get("editmode"));
                provider.set("shownewrow", attrs.get("shownewrow"));
                return provider;
            }
        };
    });
    var tagName$1z = "div";
    transpiler.register("wm-video", function() {
        return {
            pre: function(attrs) {
                return "<" + tagName$1z + " wmVideo " + transpiler.getAttrMarkup(attrs) + ">";
            },
            post: function() {
                return "</" + tagName$1z + ">";
            }
        };
    });
    var initComponentsBuildTask = function() {};
    Object.keys(transpiler).forEach(function(key) {
        exports[key] = transpiler[key];
    });
    exports.initComponentsBuildTask = initComponentsBuildTask;
    exports.\u02750 = \u02750;
    exports.\u02751 = \u02751;
    exports.\u02752 = \u02752;
    exports.\u02753 = \u02753;
    exports.\u02754 = \u02754;
    exports.\u02755 = \u02755;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("angular2-text-mask"), require("rxjs"), require("@angular/common"), require("@angular/core"), require("@angular/forms"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input", [ "exports", "angular2-text-mask", "rxjs", "@angular/common", "@angular/core", "@angular/forms", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = {}), global.angular2TextMask, global.rxjs, global.ng.common, global.ng.core, global.ng.forms, global.wm.components.base, global.wm.core);
})(this, function(exports, angular2TextMask, rxjs, common, core, forms, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-button", new Map([ [ "animation", base.PROP_STRING ], [ "badgevalue", base.PROP_STRING ], [ "caption", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconposition", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "type", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "btn app-button";
    var WIDGET_CONFIG = {
        widgetType: "wm-button",
        hostClass: DEFAULT_CLS,
        displayType: base.DISPLAY_TYPE.INLINE_BLOCK
    };
    var ButtonComponent = function(_super) {
        __extends(ButtonComponent, _super);
        function ButtonComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        ButtonComponent.initializeProps = registerProps();
        ButtonComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "button[wmButton]",
                template: '<img data-identifier="img" alt="button image" class="button-image-icon" [src]="iconurl | image" *ngIf="iconurl" [ngStyle]="{width:iconwidth, height:iconheight, margin:iconmargin}"/>\n<i class="app-icon {{iconclass}}" aria-hidden="true" [ngStyle]="{width:iconwidth, height:iconheight, margin:iconmargin, fontSize:iconwidth}" *ngIf="iconclass"></i>\n<span class="sr-only" *ngIf="iconclass">{{caption | trustAs:\'html\'}} {{appLocale.LABEL_ICON}}</span>\n<span class="btn-caption" [innerHTML]="caption | trustAs:\'html\'"></span>\n<ng-content select=".caret"></ng-content>\n<span *ngIf="badgevalue" class="badge pull-right" [textContent]="badgevalue"></span>',
                providers: [ base.provideAsWidgetRef(ButtonComponent) ]
            } ]
        } ];
        ButtonComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        ButtonComponent.propDecorators = {
            type: [ {
                type: core.HostBinding,
                args: [ "type" ]
            } ],
            tabindex: [ {
                type: core.HostBinding,
                args: [ "tabIndex" ]
            } ],
            disabled: [ {
                type: core.HostBinding,
                args: [ "disabled" ]
            } ],
            shortcutkey: [ {
                type: core.HostBinding,
                args: [ "attr.accesskey" ]
            } ],
            iconposition: [ {
                type: core.HostBinding,
                args: [ "attr.icon-position" ]
            } ]
        };
        return ButtonComponent;
    }(base.StylableComponent);
    var registerProps$1 = function() {
        base.register("wm-buttongroup", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "vertical", base.PROP_BOOLEAN ] ]));
    };
    var DEFAULT_CLS$1 = "btn-group app-button-group";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-buttongroup",
        hostClass: DEFAULT_CLS$1
    };
    var ButtonGroupDirective = function(_super) {
        __extends(ButtonGroupDirective, _super);
        function ButtonGroupDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        ButtonGroupDirective.prototype.handleClick = function(event) {
            var $target = $(event.target).closest(".app-button");
            this.$element.find(".app-button").removeClass("selected");
            $target.addClass("selected");
        };
        ButtonGroupDirective.initializeProps = registerProps$1();
        ButtonGroupDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmButtonGroup]",
                providers: [ base.provideAsWidgetRef(ButtonGroupDirective) ]
            } ]
        } ];
        ButtonGroupDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        ButtonGroupDirective.propDecorators = {
            vertical: [ {
                type: core.HostBinding,
                args: [ "class.btn-group-vertical" ]
            } ],
            handleClick: [ {
                type: core.HostListener,
                args: [ "click", [ "$event" ] ]
            } ]
        };
        return ButtonGroupDirective;
    }(base.StylableComponent);
    var BaseFormComponent = function(_super) {
        __extends(BaseFormComponent, _super);
        function BaseFormComponent(inj, config, initPromise) {
            var _this = _super.call(this, inj, config, initPromise) || this;
            _this.inj = inj;
            _this.binddatavalue = _this.$element.attr("datavalue.bind");
            return _this;
        }
        BaseFormComponent.prototype.updateBoundVariable = function(value) {
            var binddatavalue = this.binddatavalue;
            if (this.datavaluesource && this.datavaluesource.execute(core$1.DataSource.Operation.IS_API_AWARE)) {
                return;
            } else if (this.datavaluesource && !this.datavaluesource.twoWayBinding) {
                return;
            }
            if (!binddatavalue || binddatavalue.startsWith("Widgets.") || binddatavalue.startsWith("itemRef.currentItemWidgets")) {
                return;
            }
            binddatavalue = binddatavalue.replace(/\[\$i\]/g, "[0]");
            if (_.has(this.context, binddatavalue.split(".")[0])) {
                _.set(this.context, binddatavalue, value);
            } else {
                _.set(this.viewParent, binddatavalue, value);
            }
        };
        BaseFormComponent.prototype.invokeOnChange = function(value, $event) {
            if ($event) {
                if (this.datavalue !== this.prevDatavalue) {
                    this.updateBoundVariable(value);
                    this.invokeEventCallback("change", {
                        $event: $event,
                        newVal: value,
                        oldVal: this.prevDatavalue
                    });
                }
            }
            this.prevDatavalue = value;
        };
        BaseFormComponent.prototype.updatePrevDatavalue = function(val) {
            this.prevDatavalue = val;
        };
        return BaseFormComponent;
    }(base.StylableComponent);
    var BaseFormCustomComponent = function(_super) {
        __extends(BaseFormCustomComponent, _super);
        function BaseFormCustomComponent() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this._onChange = function() {};
            _this._onTouched = function() {};
            return _this;
        }
        BaseFormCustomComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this._formControl = this.inj.get(forms.FormControlName, null);
        };
        BaseFormCustomComponent.prototype.registerOnChange = function(fn) {
            this._onChange = fn;
        };
        BaseFormCustomComponent.prototype.registerOnTouched = function(fn) {
            this._onTouched = fn;
        };
        BaseFormCustomComponent.prototype.writeValue = function(value) {
            if (this.isDestroyed) {
                return;
            }
            if (this._formControl) {
                this.datavalue = value;
                this.onPropertyChange("datavalue", value);
                this.updatePrevDatavalue(value);
            }
        };
        BaseFormCustomComponent.prototype.invokeOnChange = function(value, $event, valid) {
            this._onChange(value);
            if (valid) {
                _super.prototype.invokeOnChange.call(this, value, $event);
            }
        };
        BaseFormCustomComponent.prototype.invokeOnTouched = function($event) {
            this._onTouched();
            if ($event) {
                this.invokeEventCallback("blur", {
                    $event: $event
                });
            }
        };
        BaseFormCustomComponent.prototype.invokeOnFocus = function($event) {
            this.invokeEventCallback("focus", {
                $event: $event
            });
        };
        return BaseFormCustomComponent;
    }(BaseFormComponent);
    var checkboxProps = new Map([ [ "caption", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "checkedvalue", __assign({
        value: true
    }, base.PROP_STRING) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "uncheckedvalue", __assign({
        value: false
    }, base.PROP_STRING) ] ]);
    var registerProps$2 = function() {
        base.register("wm-checkbox", checkboxProps);
        base.registerFormWidget(core$1.FormWidgetType.CHECKBOX, checkboxProps);
        base.registerFormWidget(core$1.FormWidgetType.TOGGLE, checkboxProps);
    };
    var DEFAULT_CLS$2 = "app-checkbox checkbox";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-checkbox",
        hostClass: DEFAULT_CLS$2
    };
    var unStringify = function(val, defaultVal) {
        if (val === null) {
            return defaultVal;
        }
        if (val === true || val === "true") {
            return true;
        }
        if (val === false || val === "false") {
            return false;
        }
        var number = parseInt(val, 10);
        if (!isNaN(number)) {
            return number;
        }
        return val;
    };
    var CheckboxComponent = function(_super) {
        __extends(CheckboxComponent, _super);
        function CheckboxComponent(inj, checkedVal, uncheckedVal, type) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            _this._caption = "&nbsp";
            _this._checkedvalue = unStringify(checkedVal, true);
            _this._uncheckedvalue = unStringify(uncheckedVal, false);
            core$1.toggleClass(_this.nativeElement, "app-toggle", type === "toggle");
            return _this;
        }
        Object.defineProperty(CheckboxComponent.prototype, "datavalue", {
            get: function() {
                return core$1.isDefined(this.proxyModel) ? this.proxyModel ? this._checkedvalue : this._uncheckedvalue : undefined;
            },
            set: function(v) {
                this.proxyModel = core$1.isDefined(v) && v !== "" ? v === this._checkedvalue : undefined;
                this.updatePrevDatavalue(this.datavalue);
            },
            enumerable: true,
            configurable: true
        });
        CheckboxComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "caption") {
                if (!core$1.isDefined(nv) || nv === "") {
                    this._caption = "&nbsp;";
                } else {
                    this._caption = nv;
                }
            } else if (key === "checkedvalue") {
                this._checkedvalue = unStringify(nv, true);
            } else if (key === "uncheckedvalue") {
                this._uncheckedvalue = unStringify(nv, false);
            } else if (key === "datavalue") {
                this.datavalue = unStringify(nv);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        CheckboxComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName !== "change" && eventName !== "blur") {
                var $el = eventName === "tap" ? this.nativeElement.querySelector("label") : this.checkboxEl.nativeElement;
                _super.prototype.handleEvent.call(this, $el, eventName, callback, locals);
            }
        };
        CheckboxComponent.prototype.handleChange = function(newVal) {
            this.invokeOnChange(this.datavalue, {
                type: "change"
            }, this.ngModel.valid);
        };
        CheckboxComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.nativeElement.querySelector("label"), this);
        };
        CheckboxComponent.initializeProps = registerProps$2();
        CheckboxComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmCheckbox]",
                template: '<label [ngClass]="{\'unchecked\': !proxyModel, \'disabled\': (disabled || readonly), \'required\': (required && _caption)}" role="button">\n    <input type="checkbox" aria-describedby="checkbox"\n           #checkbox\n           [attr.name]="name"\n           focus-target\n           [(ngModel)]="proxyModel"\n           [readonly]="readonly"\n           [required]="required"\n           [disabled]="disabled || readonly"\n           [attr.accesskey]="shortcutkey"\n           [tabindex]="tabindex"\n           (blur)="invokeOnTouched($event)"\n           (ngModelChange)="handleChange($event)">\n    <span class="caption" [innerHtml]="_caption"></span>\n    <img alt="Checkbox Image" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="switch"/>\n</label>\n<input type="hidden" class="ng-hide model-holder" [disabled]="disabled" [value]="proxyModel">\n',
                providers: [ base.provideAs(CheckboxComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(CheckboxComponent) ]
            } ]
        } ];
        CheckboxComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "checkedvalue" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "uncheckedvalue" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "type" ]
                } ]
            } ];
        };
        CheckboxComponent.propDecorators = {
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ],
            checkboxEl: [ {
                type: core.ViewChild,
                args: [ "checkbox", {
                    read: core.ElementRef
                } ]
            } ]
        };
        return CheckboxComponent;
    }(BaseFormCustomComponent);
    var DatasetAwareFormComponent = function(_super) {
        __extends(DatasetAwareFormComponent, _super);
        function DatasetAwareFormComponent(inj, WIDGET_CONFIG) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.datasetItems = [];
            _this.acceptsArray = false;
            _this.dataset$ = new rxjs.Subject();
            _this.datavalue$ = new rxjs.Subject();
            _this.allowempty = true;
            _this._debounceDatavalueUpdation = _.debounce(function(values) {
                if (!core$1.isDefined(_this._modelByKey) || _.isArray(_this._modelByKey) && !_this._modelByKey.length) {
                    _this.toBeProcessedDatavalue = values;
                    _this._modelByValue = undefined;
                } else if (core$1.isDefined(_this.toBeProcessedDatavalue)) {
                    if (!core$1.isDefined(_this._modelByValue)) {
                        _this._modelByValue = !_this.multiple && _.isArray(_this.toBeProcessedDatavalue) ? _this.toBeProcessedDatavalue[0] : _this.toBeProcessedDatavalue;
                    }
                    _this.toBeProcessedDatavalue = undefined;
                }
                _this.initDisplayValues();
            }, 150);
            _this.binddisplayexpression = _this.nativeElement.getAttribute("displayexpression.bind");
            _this.binddisplayimagesrc = _this.nativeElement.getAttribute("displayimagesrc.bind");
            _this.binddisplaylabel = _this.nativeElement.getAttribute("displaylabel.bind");
            _this._debouncedInitDatasetItems = core$1.debounce(function() {
                _this.initDatasetItems();
                core$1.$appDigest();
            }, 150);
            return _this;
        }
        Object.defineProperty(DatasetAwareFormComponent.prototype, "modelByKey", {
            get: function() {
                return this._modelByKey;
            },
            set: function(val) {
                this.selectByKey(val);
                this.invokeOnChange(this._modelByValue);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DatasetAwareFormComponent.prototype, "datavalue", {
            get: function() {
                return this._modelByValue;
            },
            set: function(val) {
                if (this.multiple) {
                    val = base.extractDataAsArray(val);
                }
                this._modelByValue = val;
                this.selectByValue(val);
                this.datavalue$.next(val);
                this.invokeOnChange(val, undefined, true);
            },
            enumerable: true,
            configurable: true
        });
        DatasetAwareFormComponent.prototype.selectByKey = function(keys) {
            var _this = this;
            this.resetDatasetItems();
            if (!this.datasetItems.length) {
                return;
            }
            if (this.multiple && !_.isArray(keys)) {
                keys = [ keys ];
            }
            this._modelByKey = keys;
            if (this.multiple) {
                this._modelByValue = [];
                keys.forEach(function(key) {
                    var itemByKey = _.find(_this.datasetItems, function(item) {
                        return _.toString(item.key) === _.toString(key);
                    });
                    if (itemByKey) {
                        itemByKey.selected = true;
                        _this._modelByValue = __spread(_this._modelByValue, [ itemByKey.value ]);
                    }
                });
            } else {
                this._modelByValue = "";
                var itemByKey = _.find(this.datasetItems, function(item) {
                    return _.toString(item.key) === _.toString(keys);
                });
                if (itemByKey) {
                    itemByKey.selected = true;
                    this._modelByValue = itemByKey.value;
                }
            }
            this.initDisplayValues();
        };
        DatasetAwareFormComponent.prototype.selectByValue = function(values) {
            var _this = this;
            this.resetDatasetItems();
            if (!core$1.isDefined(values) || values === "" || _.isNull(values) || values instanceof Array && !values.length) {
                this._modelByKey = undefined;
                if (!this.allowempty || !core$1.isDefined(values)) {
                    return;
                }
            }
            if (this.acceptsArray && !_.isArray(values)) {
                values = this.allowempty ? [ values ] : base.extractDataAsArray(values);
            }
            if (!this.datasetItems.length && core$1.isDefined(values)) {
                this.toBeProcessedDatavalue = values;
                return;
            }
            var filterField = this.datafield === base.ALLFIELDS ? "dataObject" : "key";
            if (_.isArray(values)) {
                this._modelByKey = [];
                values.forEach(function(val) {
                    var itemByValue = _.find(_this.datasetItems, function(item) {
                        if (filterField === "dataObject") {
                            if (_this.compareby && _this.compareby.length) {
                                return core$1.isEqualWithFields(item[filterField], val, _this.compareby);
                            }
                        }
                        return _.isObject(item.value) ? _.isEqual(item.value, val) : _.toString(item.value).toLowerCase() === _.toString(val).toLowerCase();
                    });
                    if (itemByValue) {
                        itemByValue.selected = true;
                        _this._modelByKey.push(itemByValue.key);
                    }
                });
            } else {
                this._modelByKey = undefined;
                var itemByValue = _.find(this.datasetItems, function(item) {
                    if (filterField === "dataObject") {
                        if (_this.compareby && _this.compareby.length) {
                            return core$1.isEqualWithFields(item[filterField], values, _this.compareby);
                        }
                    }
                    return _.isObject(item.value) ? _.isEqual(item.value, values) : _.toString(item.value).toLowerCase() === _.toString(values).toLowerCase();
                });
                if (itemByValue) {
                    itemByValue.selected = true;
                    this._modelByKey = itemByValue.key;
                }
            }
            this._debounceDatavalueUpdation(values);
        };
        DatasetAwareFormComponent.prototype.initDisplayValues = function() {
            var displayValues = [];
            this.datasetItems.forEach(function(item) {
                if (item.selected) {
                    displayValues.push(item.label);
                }
            });
            this.displayValue = this.multiple ? displayValues : displayValues[0];
        };
        DatasetAwareFormComponent.prototype.initDatasetItems = function() {
            if (!this.dataset || _.isEmpty(this.dataset)) {
                this.datasetItems = [];
                this.dataset$.next(this.datasetItems);
                return;
            }
            var orderedDataset = base.getOrderedDataset(base.convertDataToObject(this.dataset), this.orderby);
            if (this.usekeys) {
                this.datasetItems = base.transformDataWithKeys(orderedDataset);
            } else {
                var displayOptions = base.transformFormData(this.viewParent, orderedDataset, this.datafield, {
                    displayField: this.displayfield || this.displaylabel,
                    displayExpr: this.displayexpression,
                    bindDisplayExpr: this.binddisplayexpression || this.binddisplaylabel,
                    bindDisplayImgSrc: this.binddisplayimagesrc,
                    displayImgSrc: this.displayimagesrc
                });
                this.datasetItems = __spread(base.getUniqObjsByDataField(displayOptions, this.datafield, this.displayfield || this.displaylabel, core$1.toBoolean(this.allowempty)));
            }
            this.postDatasetItemsInit();
        };
        DatasetAwareFormComponent.prototype.postDatasetItemsInit = function() {
            if (this.datasetItems.length && !this._defaultQueryInvoked) {
                var _datavalue = !core$1.isDefined(this.toBeProcessedDatavalue) ? this.datavalue : this.toBeProcessedDatavalue;
                this.selectByValue(_datavalue);
            }
            this.dataset$.next(this.datasetItems);
        };
        DatasetAwareFormComponent.prototype.resetDatasetItems = function() {
            this.datasetItems.forEach(function(item) {
                return item.selected = false;
            });
        };
        DatasetAwareFormComponent.prototype.onPropertyChange = function(key, nv, ov) {
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
            switch (key) {
              case "dataset":
              case "datafield":
              case "displayfield":
              case "displaylabel":
              case "displayexpression":
              case "orderby":
              case "usekeys":
                this._debouncedInitDatasetItems();
                break;
            }
        };
        return DatasetAwareFormComponent;
    }(BaseFormCustomComponent);
    var checkboxsetProps = new Map([ [ "class", base.PROP_STRING ], [ "collapsible", base.PROP_BOOLEAN ], [ "compareby", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "dataset", __assign({
        value: "Option 1, Option 2, Option 3"
    }, base.PROP_ANY) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "dateformat", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "displayexpression", base.PROP_STRING ], [ "displayfield", base.PROP_STRING ], [ "displayValue", base.PROP_STRING ], [ "groupby", base.PROP_STRING ], [ "itemclass", __assign({
        value: ""
    }, base.PROP_STRING) ], [ "layout", __assign({
        value: "stacked"
    }, base.PROP_STRING) ], [ "listclass", __assign({
        value: ""
    }, base.PROP_STRING) ], [ "match", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showcount", base.PROP_BOOLEAN ], [ "showindevice", __assign({
        displayType: "inline-block",
        value: "all"
    }, base.PROP_STRING) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "usekeys", base.PROP_BOOLEAN ] ]);
    var registerProps$3 = function() {
        base.register("wm-checkboxset", checkboxsetProps);
        base.registerFormWidget(core$1.FormWidgetType.CHECKBOXSET, new Map(checkboxsetProps));
    };
    var DEFAULT_CLS$3 = "app-checkboxset list-group";
    var WIDGET_CONFIG$3 = {
        widgetType: "wm-checkboxset",
        hostClass: DEFAULT_CLS$3
    };
    var CheckboxsetComponent = function(_super) {
        __extends(CheckboxsetComponent, _super);
        function CheckboxsetComponent(inj, groupby, appDefaults, datePipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$3) || this;
            _this.groupby = groupby;
            _this.appDefaults = appDefaults;
            _this.datePipe = datePipe;
            _this.layout = "";
            base.styler(_this.nativeElement, _this);
            _this.multiple = true;
            _this.handleHeaderClick = core$1.noop;
            return _this;
        }
        CheckboxsetComponent.prototype.onCheckboxLabelClick = function($event, key) {
            if (!$($event.target).is("input")) {
                return;
            }
            var inputElements = this.nativeElement.querySelectorAll("input:checked");
            var keys = [];
            _.forEach(inputElements, function($el) {
                keys.push($el.value);
            });
            this.modelByKey = keys;
            this.invokeOnTouched();
            this.invokeOnChange(this.datavalue, $event || {}, true);
        };
        CheckboxsetComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName === "click") {
                this.eventManager.addEventListener(node, eventName, function(e) {
                    if (!$(e.target).is("input")) {
                        return;
                    }
                    locals.$event = e;
                    return callback();
                });
            } else if (!_.includes([ "change" ], eventName)) {
                _super.prototype.handleEvent.call(this, node, eventName, callback, locals);
            }
        };
        CheckboxsetComponent.prototype.getGroupedData = function() {
            return this.datasetItems.length ? base.groupData(this, base.convertDataToObject(this.datasetItems), this.groupby, this.match, this.orderby, this.dateformat, this.datePipe, "dataObject", this.appDefaults) : [];
        };
        CheckboxsetComponent.prototype.datasetSubscription = function() {
            var _this = this;
            var datasetSubscription = this.dataset$.subscribe(function() {
                _this.groupedData = _this.getGroupedData();
            });
            this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
        };
        CheckboxsetComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "layout") {
                core$1.switchClass(this.nativeElement, nv, ov);
            } else if (key === "groupby" || key === "match") {
                this.datasetSubscription();
                this.groupedData = this.getGroupedData();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        CheckboxsetComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            if (this.groupby) {
                this.datasetSubscription();
                this.groupedData = this.getGroupedData();
            }
            if (this.groupby && this.collapsible) {
                this.handleHeaderClick = base.handleHeaderClick;
                this.toggleAllHeaders = base.toggleAllHeaders.bind(undefined, this);
            }
        };
        CheckboxsetComponent.initializeProps = registerProps$3();
        CheckboxsetComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmCheckboxset]",
                exportAs: "wmCheckboxset",
                template: '<ng-template [ngIf]="!groupby" [ngIfElse]="groupedListTemplate">\n    <li [ngClass]="[\'checkbox\', \'app-checkbox\', itemclass]"\n        [class.active]="item.selected"\n        *ngFor="let item of datasetItems; let i = index"\n        (click)="onCheckboxLabelClick($event, item.key)">\n        <label class="app-checkboxset-label" [ngClass]="{\'disabled\':disabled || readonly}" [title]="item.label">\n            <input [name]="\'checkboxset_\' + widgetId" type="checkbox" aria-label="checkbox group"\n                   [tabindex]="tabindex"\n                   [disabled]="disabled || readonly" [attr.data-attr-index]="i"\n                   [value]="item.key" [tabindex]="tabindex" [checked]="item.selected"/>\n            <span class="caption" [textContent]="item.label"></span>\n        </label>\n    </li>\n</ng-template>\n<input [disabled]="disabled || readonly" hidden class="model-holder">\n<div *ngIf="readonly || disabled" class="readonly-wrapper"></div>\n\n\x3c!-- This template will be displayed when groupby is specified. --\x3e\n<ng-template #groupedListTemplate>\n    <li *ngFor="let groupObj of groupedData" class="app-list-item-group">\n        <ul class="item-group">\n            <li class="list-group-header" (click)="handleHeaderClick($event)" [title]="groupObj.key" [ngClass]="{\'collapsible-content\': collapsible}">\n                <h4 class="group-title">{{groupObj.key}}\n                    <div class="header-action">\n                        <i class="app-icon wi action wi-chevron-up" *ngIf="collapsible" title="{{appLocale.LABEL_COLLAPSE}}/{{appLocale.LABEL_EXPAND}}"></i>\n                        <span *ngIf="showcount" class="label label-default" [textContent]="groupObj.data.length"></span>\n                    </div>\n                </h4>\n            </li>\n            <li *ngFor="let item of groupObj.data; let i = index;"\n                [ngClass]="[\'checkbox\', \'app-checkbox\', \'group-list-item\', itemclass]"\n                [class.active]="item.selected"\n                (click)="onCheckboxLabelClick($event, item)">\n                <label class="app-checkboxset-label" [ngClass]="{\'disabled\':disabled || readonly}" [title]="item.label">\n                    <input [name]="\'checkboxset_\' + widgetId" type="checkbox" aria-label="checkbox group"\n                           [tabindex]="tabindex"\n                           [disabled]="disabled || readonly" [attr.data-attr-index]="i"\n                           [value]="item.key" [tabindex]="tabindex" [checked]="item.selected"/>\n                    <span class="caption" [textContent]="item.label"></span>\n                </label>\n            </li>\n        </ul>\n    </li>\n</ng-template>',
                providers: [ base.provideAs(CheckboxsetComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(CheckboxsetComponent) ]
            } ]
        } ];
        CheckboxsetComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "groupby" ]
                } ]
            }, {
                type: core$1.AppDefaults
            }, {
                type: base.ToDatePipe
            } ];
        };
        return CheckboxsetComponent;
    }(DatasetAwareFormComponent);
    var registerProps$4 = function() {
        base.register("wm-form-group", new Map([ [ "captionposition", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$4 = "form-group app-composite-widget clearfix";
    var WIDGET_CONFIG$4 = {
        widgetType: "wm-form-group",
        hostClass: DEFAULT_CLS$4
    };
    var CAPTION_POSITION = {
        left: "caption-left",
        right: "caption-right",
        top: "caption-top"
    };
    var CompositeDirective = function(_super) {
        __extends(CompositeDirective, _super);
        function CompositeDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$4) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        CompositeDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "captionposition") {
                core$1.switchClass(this.nativeElement, CAPTION_POSITION[nv], CAPTION_POSITION[ov]);
            } else if (key === "required") {
                this.required = nv;
                this.assignRequiredToSubComponents();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        CompositeDirective.prototype.assignRequiredToSubComponents = function() {
            var _this = this;
            if (this.required && this.componentRefs) {
                setTimeout(function() {
                    _this.componentRefs.forEach(function(componentRef) {
                        return componentRef.widget.required = true;
                    });
                }, 50);
            }
        };
        CompositeDirective.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            core$1.addForIdAttributes(this.nativeElement);
            this.assignRequiredToSubComponents();
        };
        CompositeDirective.initializeProps = registerProps$4();
        CompositeDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "div[wmComposite]",
                providers: [ base.provideAsWidgetRef(CompositeDirective) ]
            } ]
        } ];
        CompositeDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        CompositeDirective.propDecorators = {
            componentRefs: [ {
                type: core.ContentChildren,
                args: [ base.WidgetRef, {
                    descendants: true
                } ]
            } ]
        };
        return CompositeDirective;
    }(base.StylableComponent);
    var numberProps = new Map([ [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "localefilter", base.PROP_STRING ], [ "minvalue", base.PROP_NUMBER ], [ "maxvalue", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "numberfilter", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter number"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "regexp", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "step", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$5 = function() {
        base.register("wm-number", numberProps);
        base.registerFormWidget(core$1.FormWidgetType.NUMBER, new Map(numberProps));
    };
    var BaseInput = function(_super) {
        __extends(BaseInput, _super);
        function BaseInput(inj, config) {
            var _this = _super.call(this, inj, config) || this;
            _this.ngModelOptions = {
                updateOn: ""
            };
            var updateOn = _this.nativeElement.getAttribute("updateon") || "blur";
            updateOn = updateOn === "default" ? "change" : updateOn;
            _this.ngModelOptions.updateOn = updateOn;
            return _this;
        }
        BaseInput.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "class") {
                if (this.inputEl.nativeElement) {
                    core$1.switchClass(this.inputEl.nativeElement, nv, ov);
                }
            } else if (key === "datavalue") {
                this.updatePrevDatavalue(nv);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        BaseInput.prototype.handleChange = function(newValue) {
            this.invokeOnChange(this.datavalue, {
                type: "change"
            }, this.ngModel.valid);
        };
        BaseInput.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            if (eventName !== "change" && eventName !== "blur") {
                _super.prototype.handleEvent.call(this, this.inputEl.nativeElement, eventName, eventCallback, locals);
            }
        };
        BaseInput.prototype.handleBlur = function($event) {
            this.invokeOnTouched($event);
        };
        BaseInput.prototype.flushViewChanges = function(val) {
            this.ngModel.update.next(val);
            core$1.$appDigest();
        };
        BaseInput.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            if (this.class) {
                core$1.addClass(this.inputEl.nativeElement, this.class);
            }
            base.styler(this.inputEl.nativeElement, this);
        };
        return BaseInput;
    }(BaseFormCustomComponent);
    var NumberLocale = function(_super) {
        __extends(NumberLocale, _super);
        function NumberLocale(inj, config, i18nService, decimalPipe) {
            var _this = _super.call(this, inj, config) || this;
            _this.decimalPipe = decimalPipe;
            _this.isDefaultQuery = true;
            _this.selectedLocale = i18nService.getSelectedLocale();
            _this.DECIMAL = common.getLocaleNumberSymbol(_this.localefilter || _this.selectedLocale, common.NumberSymbol.Decimal);
            _this.GROUP = common.getLocaleNumberSymbol(_this.localefilter || _this.selectedLocale, common.NumberSymbol.Group);
            _this.numberfilter = "1.0-16";
            _this.resetValidations();
            return _this;
        }
        Object.defineProperty(NumberLocale.prototype, "datavalue", {
            get: function() {
                return this.proxyModel;
            },
            set: function(value) {
                if (_.includes([ null, undefined, "" ], value)) {
                    var input = this.inputEl.nativeElement;
                    this.displayValue = input.value = this.proxyModel = null;
                    this.resetValidations();
                    this._onChange();
                    return;
                }
                if (this.isDefaultQuery) {
                    value = this.transformNumber(value);
                }
                var model = this.parseNumber(value.toString());
                if (this.isValid(model)) {
                    this.proxyModel = model;
                    this.updateDisplayText();
                    this.handleChange(model);
                } else {
                    this.displayValue = value.toString();
                    this.proxyModel = null;
                    this.handleChange(null);
                }
            },
            enumerable: true,
            configurable: true
        });
        NumberLocale.prototype.resetValidations = function() {
            this.isInvalidNumber = false;
            this.numberNotInRange = false;
        };
        NumberLocale.prototype.isValid = function(val) {
            if (_.isNaN(val) || !_.isFinite(val)) {
                this.isInvalidNumber = true;
                return false;
            }
            if (val !== this.getValueInRange(val)) {
                this.numberNotInRange = true;
                return true;
            }
            this.resetValidations();
            return true;
        };
        NumberLocale.prototype.getValueInRange = function(value) {
            if (!_.isNaN(this.minvalue) && value < this.minvalue) {
                return this.minvalue;
            }
            if (!_.isNaN(this.maxvalue) && value > this.maxvalue) {
                return this.maxvalue;
            }
            return value;
        };
        NumberLocale.prototype.transformNumber = function(number) {
            return this.decimalPipe.transform(number, this.numberfilter, this.localefilter || this.selectedLocale);
        };
        NumberLocale.prototype.resetCursorPosition = function(value) {
            var input = this.inputEl.nativeElement;
            var position = input.value.length - value;
            position = position < 0 ? 0 : position;
            input.setSelectionRange(position, position);
        };
        NumberLocale.prototype.parseNumber = function(val) {
            var parts = val.split(this.DECIMAL);
            if (!parts.length) {
                return null;
            }
            if (parts.length > 2) {
                return NaN;
            }
            if (parts[1] === "") {
                return NaN;
            }
            var number = Number(parts[0].split(this.GROUP).join(""));
            var decimal = Number("0." + (parts[1] || 0));
            if (Number.isNaN(number) || Number.isNaN(decimal)) {
                return NaN;
            }
            return number >= 0 ? number + decimal : number - decimal;
        };
        NumberLocale.prototype.updateDisplayText = function() {
            var input = this.inputEl.nativeElement;
            var position = input.selectionStart;
            var preValue = input.value;
            this.displayValue = input.value = this.transformNumber(this.proxyModel);
            if (this.updateon === "default" && !this.isDefaultQuery) {
                this.resetCursorPosition(preValue.length - position);
            }
        };
        NumberLocale.prototype.countDecimals = function(value) {
            if (value % 1 !== 0) {
                return value.toString().split(".")[1].length;
            }
            return 0;
        };
        NumberLocale.prototype.onArrowPress = function($event, key) {
            $event.preventDefault();
            if (this.readonly || this.step === 0) {
                return;
            }
            var proxyModel = this.proxyModel;
            var value;
            if (this.numberNotInRange) {
                var inputValue = this.parseNumber(this.inputEl.nativeElement.value);
                if (!_.isNaN(inputValue)) {
                    value = this.getValueInRange(inputValue);
                    proxyModel = inputValue;
                    this.resetValidations();
                }
            } else {
                if (_.isUndefined(proxyModel) || _.isNull(proxyModel)) {
                    proxyModel = value = this.getValueInRange(this.minvalue || 0);
                    this.resetValidations();
                } else {
                    value = this.getValueInRange(proxyModel + (key === "UP" ? this.step : -this.step));
                }
            }
            if (key === "UP" && proxyModel <= value || key === "DOWN" && proxyModel >= value) {
                var decimalRoundValue = Math.max(this.countDecimals(proxyModel), this.countDecimals(this.step));
                this.proxyModel = _.round(value, decimalRoundValue);
                this.updateDisplayText();
                this.handleChange(this.proxyModel);
            }
        };
        NumberLocale.prototype.validate = function(c) {
            if (this.isInvalidNumber) {
                return {
                    invalidNumber: {
                        valid: false
                    }
                };
            }
            if (this.numberNotInRange) {
                return {
                    numberNotInRange: {
                        valid: false
                    }
                };
            }
            return null;
        };
        NumberLocale.prototype.validateInputEntry = function($event) {
            this.isDefaultQuery = false;
            if ($event.ctrlKey || _.includes([ "Backspace", "ArrowRight", "ArrowLeft", "Tab", "Enter" ], $event.key)) {
                return;
            }
            var validity = new RegExp("^[\\d\\s-,.e+" + this.GROUP + this.DECIMAL + "]$", "i");
            var inputValue = $event.target.value;
            if (!validity.test($event.key)) {
                return false;
            }
            if (_.includes(inputValue, this.DECIMAL) && $event.key === this.DECIMAL) {
                return false;
            }
            if (_.intersection(_.toArray(inputValue), [ "e", "E" ]).length && _.includes("eE", $event.key)) {
                return false;
            }
            if ((_.includes(inputValue, "+") || _.includes(inputValue, "-")) && ($event.key === "+" || $event.key === "-")) {
                return false;
            }
        };
        NumberLocale.prototype.onEnter = function($event) {
            this.datavalue = $event.target.value;
        };
        return NumberLocale;
    }(BaseInput);
    var WIDGET_CONFIG$5 = {
        widgetType: "wm-number",
        hostClass: "app-input-wrapper"
    };
    var NumberComponent = function(_super) {
        __extends(NumberComponent, _super);
        function NumberComponent(inj, i18nService, decimalPipe) {
            return _super.call(this, inj, WIDGET_CONFIG$5, i18nService, decimalPipe) || this;
        }
        NumberComponent.initializeProps = registerProps$5();
        NumberComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmNumber]",
                template: '<input class="form-control app-textbox app-number-input"\n       inputmode="numeric"\n       focus-target\n       [attr.name]="name"\n       role="input"\n       type="text"\n       [ngModel]="displayValue"\n       [readonly]="readonly"\n       [disabled]="disabled"\n       [pattern]="regexp"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [autofocus]="autofocus"\n       (ngModelChange)="datavalue=$event"\n       (blur)="handleBlur($event)"\n       [ngModelOptions]="ngModelOptions"\n       [required]="required"\n       (keypress)="validateInputEntry($event)"\n       (keydown.enter)="onEnter($event)"\n       (keydown.ArrowUp)="onArrowPress($event, \'UP\')"\n       (keydown.ArrowDown)="onArrowPress($event, \'DOWN\')"\n       #input>',
                providers: [ base.provideAs(NumberComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAs(NumberComponent, forms.NG_VALIDATORS, true), base.provideAsWidgetRef(NumberComponent) ]
            } ]
        } ];
        NumberComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.AbstractI18nService
            }, {
                type: common.DecimalPipe
            } ];
        };
        NumberComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return NumberComponent;
    }(NumberLocale);
    var radiosetProps = new Map([ [ "class", base.PROP_STRING ], [ "compareby", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "dataset", __assign({
        value: "Option 1, Option 2, Option 3"
    }, base.PROP_ANY) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "displayexpression", base.PROP_STRING ], [ "displayfield", base.PROP_STRING ], [ "displayValue", base.PROP_STRING ], [ "itemclass", __assign({
        value: ""
    }, base.PROP_STRING) ], [ "layout", __assign({
        value: "stacked"
    }, base.PROP_STRING) ], [ "listclass", __assign({
        value: ""
    }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showindevice", __assign({
        displayType: "inline-block",
        value: "all"
    }, base.PROP_STRING) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "usekeys", base.PROP_BOOLEAN ] ]);
    var registerProps$6 = function() {
        base.register("wm-radioset", radiosetProps);
        base.registerFormWidget(core$1.FormWidgetType.RADIOSET, new Map(radiosetProps));
    };
    var DEFAULT_CLS$5 = "app-radioset list-group";
    var WIDGET_CONFIG$6 = {
        widgetType: "wm-radioset",
        hostClass: DEFAULT_CLS$5
    };
    var RadiosetComponent = function(_super) {
        __extends(RadiosetComponent, _super);
        function RadiosetComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$6) || this;
            _this.layout = "";
            base.styler(_this.nativeElement, _this);
            _this.multiple = false;
            return _this;
        }
        RadiosetComponent.prototype.onRadioLabelClick = function($event, key) {
            if (!$($event.target).is("input")) {
                return;
            }
            this.modelByKey = key;
            this.invokeOnTouched();
            this.invokeOnChange(this.datavalue, $event || {}, true);
        };
        RadiosetComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName === "click") {
                this.eventManager.addEventListener(node, eventName, function(e) {
                    if (!$(e.target).is("input")) {
                        return;
                    }
                    locals.$event = e;
                    return callback();
                });
            } else if (!_.includes([ "change" ], eventName)) {
                _super.prototype.handleEvent.call(this, node, eventName, callback, locals);
            }
        };
        RadiosetComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "layout") {
                core$1.switchClass(this.nativeElement, nv, ov);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        RadiosetComponent.initializeProps = registerProps$6();
        RadiosetComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmRadioset]",
                exportAs: "wmRadioset",
                template: '<li [ngClass]="[\'radio\', \'app-radio\', itemclass]"\n    [class.active]="item.selected"\n    *ngFor="let item of datasetItems;let i = index"\n    (click)="onRadioLabelClick($event, item.key)">\n    <label class="app-radioset-label"\n           [ngClass]="{\'disabled\':disabled || readonly}"\n           [title]="item.label">\n        <input [name]="\'radioset_\' + widgetId" type="radio" [attr.aria-checked]="item.selected" [attr.data-attr-index]="i"\n               [value]="item.key" [disabled]="disabled || readonly" [tabindex]="tabindex" [checked]="item.selected"/>\n        <span class="caption" [textContent]="item.label"></span>\n    </label>\n</li>\n\n<input [disabled]="disabled || readonly" hidden class="model-holder">\n<div *ngIf="readonly || disabled" aria-readonly="true" class="readonly-wrapper"></div>',
                providers: [ base.provideAs(RadiosetComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(RadiosetComponent) ]
            } ]
        } ];
        RadiosetComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return RadiosetComponent;
    }(DatasetAwareFormComponent);
    var selectProps = new Map([ [ "autofocus", base.PROP_BOOLEAN ], [ "class", __assign({
        value: ""
    }, base.PROP_STRING) ], [ "compareby", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "displayexpression", base.PROP_STRING ], [ "displayfield", base.PROP_STRING ], [ "displayValue", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "multiple", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "placeholder", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "usekeys", base.PROP_BOOLEAN ] ]);
    var registerProps$7 = function() {
        base.register("wm-select", selectProps);
        base.registerFormWidget(core$1.FormWidgetType.SELECT, new Map(selectProps));
        base.registerFormWidget(core$1.FormWidgetType.TYPEAHEAD, new Map(selectProps));
    };
    var WIDGET_CONFIG$7 = {
        widgetType: "wm-select",
        hostClass: "app-select-wrapper"
    };
    var SelectComponent = function(_super) {
        __extends(SelectComponent, _super);
        function SelectComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$7) || this;
            _this.acceptsArray = true;
            return _this;
        }
        Object.defineProperty(SelectComponent.prototype, "datasource", {
            set: function(ds) {
                if (ds && ds.execute && ds.execute(core$1.DataSource.Operation.IS_BOUND_TO_LOCALE)) {
                    this.datavalue = ds.execute(core$1.DataSource.Operation.GET_DEFAULT_LOCALE);
                }
            },
            enumerable: true,
            configurable: true
        });
        SelectComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.selectEl.nativeElement, this);
        };
        SelectComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            if (!_.includes([ "blur", "change" ], eventName)) {
                _super.prototype.handleEvent.call(this, this.selectEl.nativeElement, eventName, eventCallback, locals);
            }
        };
        SelectComponent.prototype.onSelectValueChange = function($event) {
            if (this.readonly) {
                if (this.placeholder) {
                    this.selectEl.nativeElement.value = this.placeholder;
                } else {
                    this.selectEl.nativeElement.value = "";
                }
                this.datavalue = this.prevDatavalue;
                return;
            }
            this.invokeOnTouched();
            this.invokeOnChange(this.datavalue, $event || {}, true);
        };
        SelectComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "class" || key === "tabindex") {
                return;
            } else if (key === "readonly") {
                nv === true ? core$1.setAttr(this.selectEl.nativeElement, "readonly", "readonly") : core$1.removeAttr(this.selectEl.nativeElement, "readonly");
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        SelectComponent.initializeProps = registerProps$7();
        SelectComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "wm-select",
                template: '<select role="input" aria-haspopup="true" aria-expanded="false" #select\n        focus-target\n        [ngClass]="[\'app-select form-control\', class]"\n        [disabled]="disabled"\n        [required]="required"\n        [tabindex]="tabindex"\n        [(ngModel)]="modelByKey"\n        [multiple]="multiple"\n        (change)="onSelectValueChange($event)"\n        (blur)="invokeOnTouched($event)"\n        [attr.name]="name"\n        [autofocus]="autofocus"\n>\n  <option selected value="undefined" [textContent]="placeholder" [hidden]="!placeholder" ></option>\n  <option\n          *ngFor="let item of datasetItems"\n          [value]="item.key" [selected]="item.selected" [textContent]="item.label"></option>\n</select>\n',
                providers: [ base.provideAs(SelectComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(SelectComponent) ]
            } ]
        } ];
        SelectComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        SelectComponent.propDecorators = {
            selectEl: [ {
                type: core.ViewChild,
                args: [ "select", {
                    read: core.ElementRef
                } ]
            } ]
        };
        return SelectComponent;
    }(DatasetAwareFormComponent);
    var switchProps = new Map([ [ "class", base.PROP_STRING ], [ "compareby", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "dataset", __assign({
        value: "yes, no, maybe"
    }, base.PROP_ANY) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "displayexpression", base.PROP_STRING ], [ "displayfield", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ] ]);
    var registerProps$8 = function() {
        base.register("wm-switch", switchProps);
        base.registerFormWidget(core$1.FormWidgetType.SWITCH, new Map(switchProps));
        base.registerFormWidget(core$1.FormWidgetType.TOGGLE, new Map(switchProps));
    };
    var DEFAULT_CLS$6 = "app-switch";
    var WIDGET_CONFIG$8 = {
        widgetType: "wm-switch",
        hostClass: DEFAULT_CLS$6
    };
    var SwitchComponent = function(_super) {
        __extends(SwitchComponent, _super);
        function SwitchComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$8) || this;
            _this.options = [];
            _this._debounceSetSelectedValue = core$1.debounce(function(val) {
                _this.setSelectedValue();
                _this.updateHighlighter(val);
                if (val) {
                    core$1.$appDigest();
                }
            }, 200);
            var datasetSubscription = _this.dataset$.subscribe(function() {
                return _this.updateSwitchOptions();
            });
            _this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
            var datavalueSubscription = _this.datavalue$.subscribe(function() {
                _this._debounceSetSelectedValue(true);
            });
            _this.registerDestroyListener(function() {
                return datavalueSubscription.unsubscribe();
            });
            return _this;
        }
        SwitchComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.nativeElement, this);
        };
        SwitchComponent.prototype.onStyleChange = function(key, nv, ov) {
            if (key === "height") {
                core$1.setCSS(this.nativeElement, "overflow", nv ? "auto" : "");
            } else {
                _super.prototype.onStyleChange.call(this, key, nv, ov);
            }
        };
        SwitchComponent.prototype.setSelectedValue = function() {
            if (core$1.isDefined(this.datavalue) || core$1.isDefined(this.toBeProcessedDatavalue)) {
                this.selectedItem = _.find(this.datasetItems, {
                    selected: true
                });
                return;
            }
            this.selectOptAtIndex(0);
        };
        SwitchComponent.prototype.updateSwitchOptions = function() {
            if (this.datasetItems.length) {
                this.btnwidth = 100 / this.datasetItems.length;
                core$1.setCSS(this.nativeElement.querySelector(".app-switch-overlay"), "width", this.btnwidth + "%");
            }
            this._debounceSetSelectedValue(true);
        };
        SwitchComponent.prototype.updateHighlighter = function(skipAnimation) {
            var handler = $(this.nativeElement).find("span.app-switch-overlay");
            this.setSelectedValue();
            var left, index = this.selectedItem ? _.findIndex(this.datasetItems, {
                key: this.selectedItem.key
            }) : -1;
            if (index === undefined || index === null) {
                index = -1;
            }
            left = index * this.btnwidth;
            if (skipAnimation) {
                handler.css("left", left + "%");
            } else {
                handler.animate({
                    left: left + "%"
                }, 300);
            }
        };
        SwitchComponent.prototype.selectOptAtIndex = function($index) {
            if (!this.datasetItems.length) {
                return;
            }
            var opt = this.datasetItems[$index];
            this._modelByValue = opt.value;
        };
        SwitchComponent.prototype.selectOpt = function($event, $index, option) {
            this.modelByKey = option.key;
            this.invokeOnTouched();
            $event.preventDefault();
            if (this.disabled) {
                return;
            }
            if (this.selectedItem && $index === _.findIndex(this.datasetItems, {
                key: this.selectedItem.key
            })) {
                if (this.datasetItems.length === 2) {
                    $index = $index === 1 ? 0 : 1;
                } else {
                    return;
                }
            }
            this.selectedItem = this.datasetItems[$index];
            this.updateHighlighter();
            this.invokeOnChange(this.datavalue, $event || {}, true);
            core$1.$appDigest();
        };
        SwitchComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "disabled" && !core$1.toBoolean(nv)) {
                this.nativeElement.removeAttribute(key);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        SwitchComponent.initializeProps = registerProps$8();
        SwitchComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmSwitch]",
                template: '<div role="group" aria-label="button switch" class="btn-group btn-group-justified">\n    <a *ngFor="let opt of datasetItems; let $index = index;"\n       [title]="opt.label" focus-target\n       href="javascript:void(0);"\n       class="btn btn-default"\n       [name]="\'wm-switch-\' + opt.key"\n       [ngClass]="{\'selected\': opt.selected, \'disabled\': disabled}"\n       (click)="selectOpt($event, $index, opt)"\n    >\n        <i *ngIf="opt.dataObject && opt.dataObject[iconclass]" aria-hidden="true" [ngClass]="[\'app-icon\', opt.dataObject[iconclass] || opt[\'icon\']]"></i>\n        <span class="caption" [textContent]="opt[displayfield] || opt.label"></span>\n    </a>\n</div>\n<span [title]="selectedItem ? selectedItem.label : modelByKey"\n      class="btn btn-primary app-switch-overlay switch-handle">\n    <i *ngIf="iconclass"\n       class="app-icon {{(selectedItem && selectedItem.dataObject) && selectedItem.dataObject[iconclass]}}"></i>\n    {{selectedItem ? selectedItem.label : modelByKey}}\n</span>\n<input [name]="name" class="model-holder ng-hide" [disabled]="disabled" [value]="modelByKey" [required]="required">\n',
                providers: [ base.provideAs(SwitchComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(SwitchComponent) ]
            } ]
        } ];
        SwitchComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return SwitchComponent;
    }(DatasetAwareFormComponent);
    var inputCalendarTypeProps = new Map([ [ "autocomplete", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datasource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "maxvalue", base.PROP_NUMBER ], [ "minvalue", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter text"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "step", base.PROP_NUMBER ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", base.PROP_STRING ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$9 = function() {
        base.register("wm-input-calendar", inputCalendarTypeProps);
    };
    var WIDGET_CONFIG$9 = {
        widgetType: "wm-input-calendar",
        hostClass: "app-input-wrapper"
    };
    var InputCalendarComponent = function(_super) {
        __extends(InputCalendarComponent, _super);
        function InputCalendarComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$9) || this;
        }
        InputCalendarComponent.initializeProps = registerProps$9();
        InputCalendarComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: 'wm-input[type="date"], wm-input[type="datetime-local"], wm-input[type="month"], wm-input[type="time"], wm-input[type="week"]',
                template: '<input class="form-control app-textbox"\n       focus-target\n       role="input"\n       [type]="type"\n       [attr.name]="name"\n       [(ngModel)]="datavalue"\n       [readonly]="readonly"\n       [required]="required"\n       [disabled]="disabled"\n       [min]="minvalue"\n       [max]="maxvalue"\n       [step]="step"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [autofocus]="autofocus"\n       (blur)="handleBlur($event)"\n       (ngModelChange)="handleChange($event)"\n       [autocomplete]="autocomplete ? \'on\' : \'off\'"\n       #input>\n',
                providers: [ base.provideAs(InputCalendarComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(InputCalendarComponent) ]
            } ]
        } ];
        InputCalendarComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        InputCalendarComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return InputCalendarComponent;
    }(BaseInput);
    var inputColorTypeProps = new Map([ [ "autocomplete", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter text"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", base.PROP_STRING ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$a = function() {
        base.register("wm-input-color", inputColorTypeProps);
    };
    var WIDGET_CONFIG$a = {
        widgetType: "wm-input-color",
        hostClass: "app-input-wrapper"
    };
    var InputColorComponent = function(_super) {
        __extends(InputColorComponent, _super);
        function InputColorComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$a) || this;
        }
        InputColorComponent.initializeProps = registerProps$a();
        InputColorComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: 'wm-input[type="color"]',
                template: '<input class="form-control app-textbox"\n       focus-target\n       type="color"\n       role="input"\n       [attr.name]="name"\n       [(ngModel)]="datavalue"\n       [readonly]="readonly"\n       [required]="required"\n       [disabled]="disabled"\n       [maxlength]="maxchars"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [autofocus]="autofocus"\n       (blur)="handleBlur($event)"\n       (ngModelChange)="handleChange($event)"\n       #input>',
                providers: [ base.provideAs(InputColorComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(InputColorComponent) ]
            } ]
        } ];
        InputColorComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        InputColorComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return InputColorComponent;
    }(BaseInput);
    var inputEmailTypeProps = new Map([ [ "autocomplete", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "maxchars", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter text"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "regexp", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", base.PROP_STRING ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$b = function() {
        base.register("wm-input-email", inputEmailTypeProps);
    };
    var WIDGET_CONFIG$b = {
        widgetType: "wm-input-email",
        hostClass: "app-input-wrapper"
    };
    var InputEmailComponent = function(_super) {
        __extends(InputEmailComponent, _super);
        function InputEmailComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$b) || this;
        }
        InputEmailComponent.initializeProps = registerProps$b();
        InputEmailComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: 'wm-input[type="email"]',
                template: '<input class="form-control app-textbox"\n       focus-target\n       role="input"\n       type="email"\n       [attr.name]="name"\n       [(ngModel)]="datavalue"\n       [ngModelOptions]="ngModelOptions"\n       [readonly]="readonly"\n       [required]="required"\n       [disabled]="disabled"\n       [maxlength]="maxchars"\n       [pattern]="regexp"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [autofocus]="autofocus"\n       (blur)="handleBlur($event)"\n       (ngModelChange)="handleChange($event)"\n       [autocomplete]="autocomplete ? \'on\' : \'off\'"\n       (keyup.enter)="flushViewChanges(input.value)"\n       email\n       #input>',
                providers: [ base.provideAs(InputEmailComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(InputEmailComponent) ]
            } ]
        } ];
        InputEmailComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        InputEmailComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return InputEmailComponent;
    }(BaseInput);
    var inputNumberTypeProps = new Map([ [ "autocomplete", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "maxchars", base.PROP_NUMBER ], [ "maxvalue", base.PROP_NUMBER ], [ "minvalue", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter text"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "regexp", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "step", base.PROP_NUMBER ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", base.PROP_STRING ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$c = function() {
        base.register("wm-input-number", inputNumberTypeProps);
    };
    var WIDGET_CONFIG$c = {
        widgetType: "wm-input-number",
        hostClass: "app-input-wrapper"
    };
    var InputNumberComponent = function(_super) {
        __extends(InputNumberComponent, _super);
        function InputNumberComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$c) || this;
        }
        InputNumberComponent.prototype.onArrowPress = function($event) {
            if (this.step === 0) {
                $event.preventDefault();
            }
        };
        InputNumberComponent.prototype.validateInputEntry = function($event) {
            if ($event.key === "e" && $event.target.value.indexOf($event.key) !== -1) {
                return false;
            }
        };
        InputNumberComponent.initializeProps = registerProps$c();
        InputNumberComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: 'wm-input[type="number"]',
                template: '<input class="form-control app-textbox"\n       [ngClass]="{\'step-hidden\': step === 0}"\n       focus-target\n       role="input"\n       type="number"\n       [attr.name]="name"\n       [(ngModel)]="datavalue"\n       [ngModelOptions]="ngModelOptions"\n       [readonly]="readonly"\n       [required]="required"\n       [disabled]="disabled"\n       [maxlength]="maxchars"\n       [min]="minvalue"\n       [max]="maxvalue"\n       [step]="step"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [autofocus]="autofocus"\n       (blur)="handleBlur($event)"\n       (ngModelChange)="handleChange($event)"\n       [autocomplete]="autocomplete ? \'on\' : \'off\'"\n       (keyup.enter)="flushViewChanges(input.value)"\n       (keydown.ArrowUp)="onArrowPress($event)"\n       (keydown.ArrowDown)="onArrowPress($event)"\n       (keypress)="validateInputEntry($event)"\n       #input>',
                providers: [ base.provideAs(InputNumberComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(InputNumberComponent) ]
            } ]
        } ];
        InputNumberComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        InputNumberComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return InputNumberComponent;
    }(BaseInput);
    var inputTextTypeProps = new Map([ [ "autocomplete", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "displayformat", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "maxchars", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter text"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "regexp", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", __assign({
        value: "text"
    }, base.PROP_STRING) ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$d = function() {
        base.register("wm-input-text", inputTextTypeProps);
        base.registerFormWidget(core$1.FormWidgetType.PASSWORD, new Map(inputTextTypeProps));
        var formTextProps = new Map(inputTextTypeProps);
        var mergeTextProps = function(typeProps) {
            typeProps.forEach(function(v, k) {
                return formTextProps.set(k, v);
            });
        };
        mergeTextProps(inputCalendarTypeProps);
        mergeTextProps(inputColorTypeProps);
        mergeTextProps(inputEmailTypeProps);
        mergeTextProps(inputNumberTypeProps);
        base.registerFormWidget(core$1.FormWidgetType.TEXT, new Map(formTextProps));
    };
    var WIDGET_CONFIG$d = {
        widgetType: "wm-input-text",
        hostClass: "app-input-wrapper"
    };
    var InputTextComponent = function(_super) {
        __extends(InputTextComponent, _super);
        function InputTextComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$d) || this;
        }
        InputTextComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            switch (key) {
              case "displayformat":
                this.maskVal = [];
                _.forEach(this.displayformat, function(dF) {
                    if (dF === "9") {
                        _this.maskVal.push(/\d/);
                    } else if (dF === "A") {
                        _this.maskVal.push(/[A-Z, a-z]/);
                    } else if (dF === "a") {
                        _this.maskVal.push(/[a-z]/);
                    } else if (dF === "*") {
                        _this.maskVal.push(/\w/);
                    } else {
                        _this.maskVal.push(dF);
                    }
                });
                break;

              default:
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        Object.defineProperty(InputTextComponent.prototype, "mask", {
            get: function() {
                if (this.displayformat) {
                    return {
                        mask: this.maskVal,
                        showMask: true
                    };
                } else {
                    return {
                        mask: false
                    };
                }
            },
            enumerable: true,
            configurable: true
        });
        InputTextComponent.initializeProps = registerProps$d();
        InputTextComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: 'wm-input[type="text"], wm-input:not([type]), wm-input[type="password"], wm-input[type="search"], wm-input[type="tel"], wm-input[type="url"]',
                template: '<input class="form-control app-textbox"\n       focus-target\n       role="input"\n       [type]="type"\n       [attr.name]="name"\n       [(ngModel)]="datavalue"\n       [textMask]="mask"\n       [ngModelOptions]="ngModelOptions"\n       [readonly]="readonly"\n       [required]="required"\n       [disabled]="disabled"\n       [maxlength]="maxchars"\n       [pattern]="regexp"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [autofocus]="autofocus"\n       (ngModelChange)="handleChange($event)"\n       (blur)="handleBlur($event)"\n       [autocomplete]="autocomplete ? \'on\' : \'off\'"\n       (keyup.enter)="flushViewChanges(input.value)"\n       #input>',
                providers: [ base.provideAs(InputTextComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(InputTextComponent) ]
            } ]
        } ];
        InputTextComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        InputTextComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return InputTextComponent;
    }(BaseInput);
    var textareaProps = new Map([ [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "maxchars", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Place your text"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "updateon", base.PROP_STRING ] ]);
    var registerProps$e = function() {
        base.register("wm-textarea", textareaProps);
        base.registerFormWidget(core$1.FormWidgetType.TEXTAREA, new Map(textareaProps));
    };
    var WIDGET_CONFIG$e = {
        widgetType: "wm-textarea",
        hostClass: "app-input-wrapper"
    };
    var TextareaComponent = function(_super) {
        __extends(TextareaComponent, _super);
        function TextareaComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$e) || this;
        }
        TextareaComponent.initializeProps = registerProps$e();
        TextareaComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "wm-textarea",
                template: '<textarea class="form-control app-textarea"\n          focus-target\n          role="input"\n          [attr.name]="name"\n          [(ngModel)]="datavalue"\n          [ngModelOptions]="ngModelOptions"\n          [readonly]="readonly"\n          [required]="required"\n          [disabled]="disabled"\n          [maxlength]="maxchars"\n          [attr.tabindex]="tabindex"\n          [attr.placeholder]="placeholder"\n          [attr.accesskey]="shortcutkey"\n          [autofocus]="autofocus"\n          (blur)="handleBlur($event)"\n          (ngModelChange)="handleChange($event)"\n          #textarea\n></textarea>',
                providers: [ base.provideAs(TextareaComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(TextareaComponent) ]
            } ]
        } ];
        TextareaComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        TextareaComponent.propDecorators = {
            inputEl: [ {
                type: core.ViewChild,
                args: [ "textarea" ]
            } ],
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return TextareaComponent;
    }(BaseInput);
    var components = [ ButtonComponent, ButtonGroupDirective, CheckboxComponent, CheckboxsetComponent, CompositeDirective, NumberComponent, RadiosetComponent, SelectComponent, SwitchComponent, InputCalendarComponent, InputColorComponent, InputEmailComponent, InputNumberComponent, InputTextComponent, TextareaComponent ];
    var InputModule = function() {
        function InputModule() {}
        InputModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, forms.FormsModule, angular2TextMask.TextMaskModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return InputModule;
    }();
    exports.\u0275b = ButtonGroupDirective;
    exports.\u0275c = registerProps$1;
    exports.\u0275a = registerProps;
    exports.\u0275d = CheckboxComponent;
    exports.\u0275e = registerProps$2;
    exports.\u0275f = CheckboxsetComponent;
    exports.\u0275g = registerProps$3;
    exports.\u0275h = CompositeDirective;
    exports.\u0275i = registerProps$4;
    exports.\u0275j = NumberComponent;
    exports.\u0275l = registerProps$5;
    exports.\u0275m = RadiosetComponent;
    exports.\u0275n = registerProps$6;
    exports.\u0275o = SelectComponent;
    exports.\u0275p = registerProps$7;
    exports.\u0275q = SwitchComponent;
    exports.\u0275r = registerProps$8;
    exports.\u0275k = BaseInput;
    exports.\u0275s = InputCalendarComponent;
    exports.\u0275t = registerProps$9;
    exports.\u0275u = InputColorComponent;
    exports.\u0275v = registerProps$a;
    exports.\u0275w = InputEmailComponent;
    exports.\u0275x = registerProps$b;
    exports.\u0275y = InputNumberComponent;
    exports.\u0275z = registerProps$c;
    exports.\u0275ba = InputTextComponent;
    exports.\u0275bb = registerProps$d;
    exports.\u0275bc = TextareaComponent;
    exports.\u0275bd = registerProps$e;
    exports.InputModule = InputModule;
    exports.ButtonComponent = ButtonComponent;
    exports.NumberLocale = NumberLocale;
    exports.BaseFormComponent = BaseFormComponent;
    exports.BaseFormCustomComponent = BaseFormCustomComponent;
    exports.DatasetAwareFormComponent = DatasetAwareFormComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/basic", [ "exports", "@angular/common", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.basic = {}), global.ng.common, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-anchor", new Map([ [ "animation", base.PROP_STRING ], [ "badgevalue", base.PROP_STRING ], [ "caption", __assign({
            value: "Link"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "encodeurl", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "hyperlink", __assign({
            value: ""
        }, base.PROP_STRING) ], [ "iconclass", base.PROP_STRING ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconposition", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "target", __assign({
            value: "_self"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS = "app-anchor";
    var WIDGET_CONFIG = {
        widgetType: "wm-anchor",
        hostClass: DEFAULT_CLS,
        displayType: base.DISPLAY_TYPE.INLINE_BLOCK
    };
    var regex = /Actions.goToPage_(\w+)\.invoke\(\)/g;
    var disableContextMenu = function($event) {
        $event.preventDefault();
    };
    var AnchorComponent = function(_super) {
        __extends(AnchorComponent, _super);
        function AnchorComponent(inj, app) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.app = app;
            _this._eventNotifier = new core$1.EventNotifier(false);
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        AnchorComponent.prototype.processEventAttr = function(eventName, expr, meta) {
            var _this = this;
            _super.prototype.processEventAttr.call(this, eventName, expr, meta);
            if (!this.hasNavigationToCurrentPageExpr) {
                var app_1 = this.inj.get(core$1.App);
                var fns = expr.split(";").map(Function.prototype.call, String.prototype.trim);
                if (fns.some(function(fn) {
                    regex.lastIndex = 0;
                    var matches = regex.exec(fn);
                    _this.hasGoToPageExpr = matches && matches.length > 0;
                    return _this.hasGoToPageExpr && matches[1] === app_1.activePageName;
                })) {
                    this.hasNavigationToCurrentPageExpr = true;
                }
            }
        };
        AnchorComponent.prototype.onActive = function(callback) {
            this._eventNotifier.subscribe("on-active", callback);
        };
        AnchorComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals, meta) {
            var _this = this;
            _super.prototype.handleEvent.call(this, node, eventName, function(e) {
                if (_this.hasGoToPageExpr && locals.$event) {
                    locals.$event.preventDefault();
                }
                eventCallback();
            }, locals, meta);
        };
        AnchorComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "hyperlink") {
                if (!nv) {
                    core$1.setAttr(this.nativeElement, "href", "javascript:void(0)");
                    this.nativeElement.addEventListener("contextmenu", disableContextMenu);
                    return;
                }
                if (this.encodeurl) {
                    nv = core$1.encodeUrl(nv);
                }
                if (nv.startsWith("www.")) {
                    nv = "//" + nv;
                }
                core$1.setAttr(this.nativeElement, "href", nv);
                this.nativeElement.removeEventListener("contextmenu", disableContextMenu);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        AnchorComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            if (this.hasNavigationToCurrentPageExpr) {
                core$1.addClass(this.nativeElement, "active");
            }
            setTimeout(function() {
                if (_this.hyperlink && core$1.getRouteNameFromLink(_this.hyperlink) === "/" + _this.app.activePageName || _this.hasNavigationToCurrentPageExpr) {
                    _this._eventNotifier.notify("on-active", {});
                }
            });
        };
        AnchorComponent.prototype.ngOnDestroy = function() {
            this._eventNotifier.destroy();
        };
        AnchorComponent.initializeProps = registerProps();
        AnchorComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "a[wmAnchor]",
                template: '<img data-identifier="img" alt="Image" class="anchor-image-icon" [src]="iconurl | image" *ngIf="iconurl" [ngStyle]="{width:iconwidth, height:iconheight, margin:iconmargin}"/>\n<i class="app-icon {{iconclass}}" aria-hidden="true" [ngStyle]="{width:iconwidth, height:iconheight, margin:iconmargin}" *ngIf="iconclass"></i>\n<span class="sr-only" *ngIf="iconclass">{{caption | trustAs:\'html\'}} {{appLocale.LABEL_ICON}}</span>\n<span class="anchor-caption" [innerHTML]="caption | trustAs:\'html\'"></span>\n<ng-content select=".caret"></ng-content>\n<span *ngIf="badgevalue" class="badge pull-right" [textContent]="badgevalue"></span>',
                providers: [ base.provideAsWidgetRef(AnchorComponent) ]
            } ]
        } ];
        AnchorComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.App
            } ];
        };
        AnchorComponent.propDecorators = {
            target: [ {
                type: core.HostBinding,
                args: [ "target" ]
            } ],
            shortcutkey: [ {
                type: core.HostBinding,
                args: [ "attr.accesskey" ]
            } ],
            iconposition: [ {
                type: core.HostBinding,
                args: [ "attr.icon-position" ]
            } ]
        };
        return AnchorComponent;
    }(base.StylableComponent);
    var registerProps$1 = function() {
        base.register("wm-audio", new Map([ [ "audiopreload", __assign({
            value: "none"
        }, base.PROP_STRING) ], [ "audiosupportmessage", __assign({
            value: "Your browser does not support the audio tag."
        }, base.PROP_STRING) ], [ "autoplay", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "controls", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "loop", base.PROP_BOOLEAN ], [ "mp3format", base.PROP_STRING ], [ "muted", base.PROP_BOOLEAN ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ] ]));
    };
    var DEFAULT_CLS$1 = "app-audio";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-audio",
        hostClass: DEFAULT_CLS$1,
        displayType: base.DISPLAY_TYPE.INLINE_BLOCK
    };
    var AudioComponent = function(_super) {
        __extends(AudioComponent, _super);
        function AudioComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        AudioComponent.initializeProps = registerProps$1();
        AudioComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmAudio]",
                template: '<audio [src]="mp3format | trustAs: \'resource\'" [muted]="muted" [autoplay]="autoplay" [controls]="controls" [loop]="loop" [preload]="audiopreload" role="application" aria-describedby="recorded audio">\n    <source type="audio/mp3" [src]="mp3format | trustAs: \'resource\'">\n    {{audiosupportmessage}}\n</audio>\n',
                providers: [ base.provideAsWidgetRef(AudioComponent) ]
            } ]
        } ];
        AudioComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return AudioComponent;
    }(base.StylableComponent);
    var registerProps$2 = function() {
        base.register("wm-html", new Map([ [ "class", base.PROP_STRING ], [ "content", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$2 = "app-html-container";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-html",
        hostClass: DEFAULT_CLS$2
    };
    var HtmlDirective = function(_super) {
        __extends(HtmlDirective, _super);
        function HtmlDirective(inj, height, boundContent, trustAsPipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            _this.boundContent = boundContent;
            _this.trustAsPipe = trustAsPipe;
            if (height) {
                core$1.setCSS(_this.nativeElement, "overflow", "auto");
            }
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        HtmlDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            if (this.boundContent) {
                this.nativeElement.innerHTML = "";
            }
            if (!this.content && this.nativeElement.innerHTML) {
                this.content = this.nativeElement.innerHTML;
            }
        };
        HtmlDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "content") {
                core$1.setProperty(this.nativeElement, "innerHTML", this.trustAsPipe.transform(nv, core.SecurityContext.HTML));
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        HtmlDirective.initializeProps = registerProps$2();
        HtmlDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmHtml]",
                providers: [ base.provideAsWidgetRef(HtmlDirective) ]
            } ]
        } ];
        HtmlDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "height" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "content.bind" ]
                } ]
            }, {
                type: base.TrustAsPipe
            } ];
        };
        return HtmlDirective;
    }(base.StylableComponent);
    var registerProps$3 = function() {
        base.register("wm-icon", new Map([ [ "animation", base.PROP_STRING ], [ "caption", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "hint", base.PROP_STRING ], [ "iconclass", __assign({
            value: "wi wi-star-border"
        }, base.PROP_STRING) ], [ "iconposition", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "iconsize", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$3 = "app-icon-wrapper";
    var WIDGET_CONFIG$3 = {
        widgetType: "wm-icon",
        hostClass: DEFAULT_CLS$3
    };
    var IconComponent = function(_super) {
        __extends(IconComponent, _super);
        function IconComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$3) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        IconComponent.initializeProps = registerProps$3();
        IconComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmIcon]",
                template: '<i class="app-icon {{iconclass}}"></i>\n<span class="sr-only" *ngIf="iconclass">{{caption}} {{appLocale.LABEL_ICON}}</span>\n<label class="app-label" [textContent]="caption" *ngIf="caption"></label>',
                providers: [ base.provideAsWidgetRef(IconComponent) ]
            } ]
        } ];
        IconComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        IconComponent.propDecorators = {
            iconposition: [ {
                type: core.HostBinding,
                args: [ "attr.icon-position" ]
            } ],
            iconsize: [ {
                type: core.HostBinding,
                args: [ "style.fontSize" ]
            } ]
        };
        return IconComponent;
    }(base.StylableComponent);
    var registerProps$4 = function() {
        base.register("wm-iframe", new Map([ [ "class", base.PROP_STRING ], [ "encodeurl", base.PROP_BOOLEAN ], [ "height", __assign({
            value: "150px"
        }, base.PROP_STRING) ], [ "iframesrc", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "width", __assign({
            value: "300px"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS$4 = "embed-responsive app-iframe";
    var WIDGET_CONFIG$4 = {
        widgetType: "wm-iframe",
        hostClass: DEFAULT_CLS$4
    };
    var IframeComponent = function(_super) {
        __extends(IframeComponent, _super);
        function IframeComponent(inj, trustAsPipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$4) || this;
            _this.trustAsPipe = trustAsPipe;
            _this.showContentLoadError = false;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        IframeComponent.prototype.computeIframeSrc = function() {
            this.showContentLoadError = false;
            this._iframesrc = undefined;
            if (this.iframesrc) {
                var url = this.iframesrc;
                if (this.encodeurl) {
                    url = core$1.encodeUrl(this.iframesrc);
                }
                var trustedUrl = this.trustAsPipe.transform(url, core.SecurityContext.RESOURCE_URL);
                if (core$1.isInsecureContentRequest(url)) {
                    this.showContentLoadError = true;
                    this.errorMsg = this.appLocale.MESSAGE_ERROR_CONTENT_DISPLAY + " " + this.iframesrc;
                    this.hintMsg = this.errorMsg;
                }
                this._iframesrc = trustedUrl;
            }
        };
        IframeComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "iframesrc" || key === "encodeurl") {
                this.computeIframeSrc();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        IframeComponent.initializeProps = registerProps$4();
        IframeComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmIframe]",
                template: '<iframe title="" class="embed-responsive-item iframe-content" role="document"\n        scrolling="auto"\n        marginheight="0"\n        marginwidth="0"\n        frameborder="0"\n        [name]="name"\n        [attr.src]="_iframesrc"\n        seamless="seamless">\n</iframe>\n<div class="wm-content-info readonly-wrapper" *ngIf="showContentLoadError">\n    <p class="wm-message" [title]="hintMsg" [textContent]="errMsg"></p>\n</div>',
                providers: [ base.provideAsWidgetRef(IframeComponent) ]
            } ]
        } ];
        IframeComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: base.TrustAsPipe
            } ];
        };
        return IframeComponent;
    }(base.StylableComponent);
    var registerProps$5 = function() {
        base.register("wm-label", new Map([ [ "animation", base.PROP_STRING ], [ "caption", __assign({
            value: "Label"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$5 = "app-label";
    var WIDGET_CONFIG$5 = {
        widgetType: "wm-label",
        hostClass: DEFAULT_CLS$5,
        displayType: base.DISPLAY_TYPE.INLINE_BLOCK
    };
    var LabelDirective = function(_super) {
        __extends(LabelDirective, _super);
        function LabelDirective(inj, trustAsPipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$5) || this;
            _this.trustAsPipe = trustAsPipe;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        LabelDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "caption") {
                if (_.isObject(nv)) {
                    core$1.setProperty(this.nativeElement, "textContent", JSON.stringify(nv));
                } else {
                    core$1.setProperty(this.nativeElement, "innerHTML", this.trustAsPipe.transform(nv, core.SecurityContext.HTML));
                }
            } else if (key === "required") {
                core$1.toggleClass(this.nativeElement, "required", nv);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        LabelDirective.initializeProps = registerProps$5();
        LabelDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLabel]",
                providers: [ base.provideAsWidgetRef(LabelDirective) ]
            } ]
        } ];
        LabelDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: base.TrustAsPipe
            } ];
        };
        return LabelDirective;
    }(base.StylableComponent);
    var registerProps$6 = function() {
        var props = new Map([ [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "encodeurl", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "pictureaspect", __assign({
            value: "None"
        }, base.PROP_STRING) ], [ "pictureplaceholder", base.PROP_STRING ], [ "picturesource", base.PROP_STRING ], [ "shape", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ] ]);
        if (core$1.isMobileApp()) {
            props.set("offline", __assign({
                value: true
            }, base.PROP_BOOLEAN));
        }
        base.register("wm-picture", props);
    };
    var DEFAULT_CLS$6 = "app-picture";
    var WIDGET_CONFIG$6 = {
        widgetType: "wm-picture",
        hostClass: DEFAULT_CLS$6,
        displayType: base.DISPLAY_TYPE.INLINE_BLOCK
    };
    var PictureDirective = function(_super) {
        __extends(PictureDirective, _super);
        function PictureDirective(inj, imagePipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$6) || this;
            _this.imagePipe = imagePipe;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        PictureDirective.prototype.setImgSource = function() {
            this.imgSource = this.imagePipe.transform(this.picturesource, this.encodeurl, this.pictureplaceholder);
        };
        PictureDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "pictureaspect") {
                var width = "";
                var height = "";
                switch (nv) {
                  case "None":
                    width = this.width;
                    height = this.height;
                    break;

                  case "H":
                    width = "100%";
                    break;

                  case "V":
                    height = "100%";
                    break;

                  case "Both":
                    width = "100%";
                    height = "100%";
                    break;
                }
                core$1.setCSS(this.nativeElement, "width", width, true);
                core$1.setCSS(this.nativeElement, "height", height, true);
            } else if (key === "encodeurl" || key === "pictureplaceholder") {
                this.setImgSource();
            } else if (key === "shape") {
                core$1.switchClass(this.nativeElement, "img-" + nv, "img-" + ov);
            } else if (key === "hint") {
                core$1.setAttr(this.nativeElement, "alt", nv);
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        PictureDirective.prototype.onStyleChange = function(key, nv, ov) {
            if (key === "picturesource") {
                this.setImgSource();
            } else {
                _super.prototype.onStyleChange.call(this, key, nv, ov);
            }
        };
        PictureDirective.prototype.ngOnInit = function() {
            this.setImgSource();
            _super.prototype.ngOnInit.call(this);
        };
        PictureDirective.initializeProps = registerProps$6();
        PictureDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "img[wmPicture]",
                providers: [ base.provideAsWidgetRef(PictureDirective) ]
            } ]
        } ];
        PictureDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: base.ImagePipe
            } ];
        };
        PictureDirective.propDecorators = {
            imgSource: [ {
                type: core.HostBinding,
                args: [ "src" ]
            } ]
        };
        return PictureDirective;
    }(base.StylableComponent);
    var registerProps$7 = function() {
        base.register("wm-spinner", new Map([ [ "animation", {
            value: "spin",
            PROP_STRING: base.PROP_STRING
        } ], [ "caption", __assign({
            value: "Loading..."
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "iconclass", __assign({
            value: "fa fa-circle-o-notch fa-spin"
        }, base.PROP_STRING) ], [ "iconsize", base.PROP_STRING ], [ "image", base.PROP_STRING ], [ "imageheight", base.PROP_STRING ], [ "imagewidth", __assign({
            value: "20px"
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "type", __assign({
            value: "icon"
        }, base.PROP_STRING) ], [ "servicevariabletotrack", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS$7 = "app-spinner";
    var WIDGET_CONFIG$7 = {
        widgetType: "wm-spinner",
        hostClass: DEFAULT_CLS$7
    };
    var SpinnerComponent = function(_super) {
        __extends(SpinnerComponent, _super);
        function SpinnerComponent(inj, imagePipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$7) || this;
            _this.imagePipe = imagePipe;
            _this.iconclass = "";
            _this.animation = "";
            _this.showCaption = true;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        Object.defineProperty(SpinnerComponent.prototype, "spinnerMessages", {
            get: function() {
                return this._spinnerMessages;
            },
            set: function(newVal) {
                this.showCaption = _.isEmpty(newVal);
                this._spinnerMessages = newVal;
            },
            enumerable: true,
            configurable: true
        });
        SpinnerComponent.prototype.listenOnDataSource = function() {
            var _this = this;
            var variables = _.split(this.servicevariabletotrack, ",");
            this.getAppInstance().subscribe("toggle-variable-state", function(data) {
                var name = data.variable.execute(core$1.DataSource.Operation.GET_NAME);
                if (_.includes(variables, name) && core$1.validateDataSourceCtx(data.variable, _this.getViewParent())) {
                    _this.widget.show = data.active;
                }
            });
        };
        SpinnerComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "image") {
                this.picture = this.imagePipe.transform(nv);
            } else if (key === "animation") {
                if (nv === "spin") {
                    this.animation = "fa-spin";
                } else {
                    this.animation = nv || "";
                }
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        SpinnerComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            if (this.servicevariabletotrack) {
                this.widget.show = false;
                this.listenOnDataSource();
            }
        };
        SpinnerComponent.initializeProps = registerProps$7();
        SpinnerComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmSpinner]",
                template: '<div class="spinner-message" aria-label="loading gif">\n    <span class="spinner-image animated infinite" [ngClass]="animation" aria-hidden="true"\n        [ngStyle]="{width: imagewidth, height: imageheight, backgroundImage: \'url(\' + picture + \')\', backgroundSize: imagewidth}"\n        *ngIf="type === \'image\'"></span>\n    <i class="spinner-image animated infinite" [ngClass]="[iconclass, animation]" [style.fonSize]="iconsize" *ngIf="type === \'icon\'"></i>\n    <span class="spinner-text" [innerHTML]="caption | trustAs: \'html\'" *ngIf="showCaption"></span>\n    <div class="spinner-messages" *ngIf="!showCaption && spinnerMessages">\n        <p *ngFor="let value of spinnerMessages" [textContent]="value"></p>\n    </div>\n</div>',
                providers: [ base.provideAsWidgetRef(SpinnerComponent) ]
            } ]
        } ];
        SpinnerComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: base.ImagePipe
            } ];
        };
        return SpinnerComponent;
    }(base.StylableComponent);
    var registerProps$8 = function() {
        base.register("wm-video", new Map([ [ "autoplay", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "controls", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "loop", base.PROP_BOOLEAN ], [ "mp4format", base.PROP_STRING ], [ "muted", base.PROP_BOOLEAN ], [ "name", base.PROP_STRING ], [ "oggformat", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "subtitlelang", __assign({
            value: "en"
        }, base.PROP_STRING) ], [ "subtitlesource", base.PROP_STRING ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "videoposter", __assign({
            value: "resources/images/imagelists/default-image.png"
        }, base.PROP_STRING) ], [ "videopreload", __assign({
            value: "none"
        }, base.PROP_STRING) ], [ "videosupportmessage", __assign({
            value: "Your browser does not support the video tag."
        }, base.PROP_STRING) ], [ "webmformat", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS$8 = "app-video";
    var WIDGET_CONFIG$8 = {
        widgetType: "wm-video",
        hostClass: DEFAULT_CLS$8,
        displayType: base.DISPLAY_TYPE.INLINE_BLOCK
    };
    var VideoComponent = function(_super) {
        __extends(VideoComponent, _super);
        function VideoComponent(inj, trustAsPipe) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$8) || this;
            _this.trustAsPipe = trustAsPipe;
            _this.subtitlelang = "en";
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        VideoComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "subtitlesource") {
                var track = this.nativeElement.querySelector("track");
                if (track) {
                    core$1.removeNode(track, true);
                }
                track = core$1.createElement("track", {
                    kind: "subtitles",
                    label: this.subtitlelang,
                    srclang: this.subtitlelang,
                    src: this.trustAsPipe.transform(nv, core.SecurityContext.RESOURCE_URL),
                    default: ""
                }, true);
                core$1.appendNode(track, this.nativeElement.querySelector("video"));
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        VideoComponent.initializeProps = registerProps$8();
        VideoComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmVideo]",
                template: '<video [preload]="videopreload" role="application"\n       [src]="mp4format | trustAs: \'resource\'"\n       [muted]="muted"\n       [poster]="videoposter | image"\n       [controls]="controls"\n       [loop]="loop"\n       [autoplay]="autoplay">\n    <source type="video/mp4" [src]="mp4format | trustAs: \'resource\'" *ngIf="mp4format">\n    <source type="video/webm" [src]="webmformat | trustAs: \'resource\'" *ngIf="webmformat">\n    <source type="video/ogg" [src]="oggformat | trustAs: \'resource\'" *ngIf="oggformat">\n    {{videosupportmessage}}\n</video>',
                providers: [ base.provideAsWidgetRef(VideoComponent) ]
            } ]
        } ];
        VideoComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: base.TrustAsPipe
            } ];
        };
        return VideoComponent;
    }(base.StylableComponent);
    var components = [ AnchorComponent, AudioComponent, HtmlDirective, IconComponent, IframeComponent, LabelDirective, PictureDirective, SpinnerComponent, VideoComponent ];
    var BasicModule = function() {
        function BasicModule() {}
        BasicModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return BasicModule;
    }();
    exports.\u0275a = registerProps;
    exports.\u0275b = AudioComponent;
    exports.\u0275c = registerProps$1;
    exports.\u0275d = HtmlDirective;
    exports.\u0275e = registerProps$2;
    exports.\u0275f = IconComponent;
    exports.\u0275g = registerProps$3;
    exports.\u0275h = IframeComponent;
    exports.\u0275i = registerProps$4;
    exports.\u0275j = LabelDirective;
    exports.\u0275k = registerProps$5;
    exports.\u0275l = PictureDirective;
    exports.\u0275m = registerProps$6;
    exports.\u0275n = SpinnerComponent;
    exports.\u0275o = registerProps$7;
    exports.\u0275p = VideoComponent;
    exports.\u0275q = registerProps$8;
    exports.disableContextMenu = disableContextMenu;
    exports.AnchorComponent = AnchorComponent;
    exports.BasicModule = BasicModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/core"), require("@angular/core"), require("ng-circle-progress"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/basic/progress", [ "exports", "@angular/common", "@wm/core", "@angular/core", "ng-circle-progress", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.basic = global.wm.components.basic || {}, 
    global.wm.components.basic.progress = {}), global.ng.common, global.wm.core, global.ng.core, global.ngCircleProgress, global.wm.components.base);
})(this, function(exports, common, core, core$1, ngCircleProgress, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-progress-bar", new Map([ [ "captionplacement", __assign({
            value: "hidden"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "displayformat", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "maxvalue", __assign({
            value: 100
        }, base.PROP_NUMBER) ], [ "minvalue", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "type", __assign({
            value: "default"
        }, base.PROP_STRING) ] ]));
    };
    var getDecimalCount = function(val) {
        val = val || "9";
        val = val.replace(/\%$/, "");
        var n = val.lastIndexOf(".");
        return n === -1 ? 0 : val.length - n - 1;
    };
    var isPercentageValue = function(val) {
        if (core.isString(val)) {
            val = val.trim();
            return val.charAt(val.length - 1) === "%";
        }
        return false;
    };
    var calculatePercent = function(value, min, max) {
        if (min === void 0) {
            min = 0;
        }
        if (max === void 0) {
            max = 0;
        }
        var percent = (value - min) / (max - min) * 100;
        if (_.isNaN(percent)) {
            console.warn("Circle Progress Bar: One of the properties Min, Max or datavalue is not a valid number");
            return 0;
        }
        return Math.abs(percent);
    };
    var DEFAULT_CLS = "progress app-progress";
    var WIDGET_CONFIG = {
        widgetType: "wm-progress-bar",
        hostClass: DEFAULT_CLS
    };
    var TYPE_CLASS_MAP = {
        default: "",
        "default-striped": "progress-bar-striped",
        success: "progress-bar-success",
        "success-striped": "progress-bar-success progress-bar-striped",
        info: "progress-bar-info",
        "info-striped": "progress-bar-info progress-bar-striped",
        warning: "progress-bar-warning",
        "warning-striped": "progress-bar-warning progress-bar-striped",
        danger: "progress-bar-danger",
        "danger-striped": "progress-bar-danger progress-bar-striped"
    };
    var ProgressBarComponent = function(_super) {
        __extends(ProgressBarComponent, _super);
        function ProgressBarComponent(inj, dataset, boundDataset) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.data = [ {
                cls: TYPE_CLASS_MAP.default,
                progressBarWidth: "0%",
                displayValue: "0"
            } ];
            _this.hasDataset = !!(dataset || boundDataset);
            base.styler(_this.nativeElement, _this);
            _this._prepareData = _.debounce(function() {
                return _this.prepareData();
            }, 50);
            return _this;
        }
        ProgressBarComponent.prototype.onTypeChange = function() {
            if (!this.hasDataset) {
                if (this.data[0]) {
                    this.data[0].cls = TYPE_CLASS_MAP[this.type];
                }
            }
        };
        ProgressBarComponent.prototype.getFormattedDisplayVal = function(val) {
            var format = this.displayformat || "9";
            val = parseFloat("" + val);
            val = val.toFixed(getDecimalCount(format));
            if (format && format.includes("%")) {
                val = val + "%";
            }
            return val;
        };
        ProgressBarComponent.prototype.prepareData = function() {
            var _this = this;
            if (this.dataset && _.isArray(this.dataset) && this.type && this.datavalue) {
                this.data = this.dataset.map(function(datum) {
                    var val = core.findValueOf(datum, _this.datavalue).toString();
                    var percentVal = val;
                    if (val && !val.includes("%")) {
                        percentVal = val + "%";
                    }
                    return {
                        cls: TYPE_CLASS_MAP[core.findValueOf(datum, _this.type)],
                        progressBarWidth: percentVal,
                        displayValue: _this.getFormattedDisplayVal(val)
                    };
                });
            } else {
                var width = 0;
                var displayVal = 0;
                if (this.datavalue) {
                    if (isPercentageValue(this.datavalue)) {
                        var val = this.datavalue || "0%";
                        width = displayVal = val;
                    } else {
                        if (core.isDefined(this.datavalue)) {
                            var denominator = +this.maxvalue - +this.minvalue || 1;
                            var val = (+this.datavalue - +this.minvalue) * 100 / denominator + "%";
                            width = displayVal = val;
                        }
                    }
                }
                this.data[0].displayValue = this.getFormattedDisplayVal(displayVal);
                this.data[0].progressBarWidth = width;
                this.data[0].cls = TYPE_CLASS_MAP[this.type];
            }
        };
        ProgressBarComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "type") {
                this.onTypeChange();
            } else if (key === "minvalue" || key === "maxvalue" || key === "datavalue" || key === "dataset" || key === "displayformat") {
                this._prepareData();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        ProgressBarComponent.initializeProps = registerProps();
        ProgressBarComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "[wmProgressBar]",
                template: '<div class="multi-bar progress-bar {{bar.cls}}" *ngFor="let bar of data" [style.width]="bar.progressBarWidth" role="progressbar"\n     [attr.aria-valuenow]="datavalue" [attr.aria-valuemin]="minvalue" [attr.aria-valuemax]="maxvalue">\n    <span class="app-progress-label" [attr.data-caption-placement]="captionplacement">{{bar.displayValue}}</span>\n</div>',
                providers: [ base.provideAsWidgetRef(ProgressBarComponent) ]
            } ]
        } ];
        ProgressBarComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "dataset" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            } ];
        };
        return ProgressBarComponent;
    }(base.StylableComponent);
    var registerProps$1 = function() {
        base.register("wm-progress-circle", new Map([ [ "captionplacement", __assign({
            value: "inside"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "datavalue", __assign({
            value: "30"
        }, base.PROP_STRING) ], [ "displayformat", __assign({
            value: "9%"
        }, base.PROP_STRING) ], [ "hint", base.PROP_STRING ], [ "maxvalue", __assign({
            value: 100
        }, base.PROP_NUMBER) ], [ "minvalue", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "subtitle", base.PROP_STRING ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", base.PROP_STRING ], [ "type", __assign({
            value: "default"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS$1 = "progress app-progress circle";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-progress-circle",
        hostClass: DEFAULT_CLS$1
    };
    var DEFAULT_OPTIONS = {
        responsive: true,
        innerStrokeWidth: 10,
        outerStrokeWidth: 10,
        unitsFontSize: "15",
        space: -10,
        toFixed: 0,
        maxPercent: 100,
        showSubtitle: false,
        clockwise: true,
        startFromZero: false,
        renderOnClick: false,
        innerStrokeColor: "",
        outerStrokeColor: ""
    };
    var TYPE_CLASS_MAP$1 = {
        default: "",
        success: "progress-circle-success",
        info: "progress-circle-info",
        warning: "progress-circle-warning",
        danger: "progress-circle-danger"
    };
    var ProgressCircleComponent = function(_super) {
        __extends(ProgressCircleComponent, _super);
        function ProgressCircleComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this);
            _this.options = _.clone(DEFAULT_OPTIONS);
            _this.redraw = _.debounce(_this._redraw, 100);
            return _this;
        }
        ProgressCircleComponent.prototype._redraw = function() {
            this.circleRef.render();
        };
        ProgressCircleComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            this.options = Object.assign(this.circleRef.options, this.options);
        };
        ProgressCircleComponent.prototype.updateDisplayValueFormat = function() {
            this.options.showTitle = this.options.showSubtitle = this.captionplacement === "inside";
            this.options.showUnits = !this.title && this.options.showTitle && isPercentageValue(this.displayformat);
            this.options.toFixed = getDecimalCount(this.displayformat);
            if (this.options.showTitle) {
                this.options.title = this.title || "auto";
                this.options.showSubtitle = !!this.subtitle;
                this.options.subtitle = this.subtitle || "";
            }
            this.redraw();
        };
        ProgressCircleComponent.prototype.onPropertyChange = function(key, nv, ov) {
            switch (key) {
              case "type":
                this.$element.removeClass(TYPE_CLASS_MAP$1[ov]);
                this.$element.addClass(TYPE_CLASS_MAP$1[nv]);
                break;

              case "minvalue":
              case "maxvalue":
              case "datavalue":
                if (isPercentageValue(this.datavalue)) {
                    this.percentagevalue = parseFloat(this.datavalue);
                } else {
                    this.percentagevalue = calculatePercent(parseFloat(this.datavalue), this.minvalue, this.maxvalue);
                }
                break;

              case "displayformat":
              case "captionplacement":
              case "title":
              case "subtitle":
                this.updateDisplayValueFormat();
                break;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        ProgressCircleComponent.initializeProps = registerProps$1();
        ProgressCircleComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "[wmProgressCircle]",
                template: '<circle-progress [percent]="percentagevalue" [options]="options"></circle-progress>\n',
                providers: [ base.provideAsWidgetRef(ProgressCircleComponent) ]
            } ]
        } ];
        ProgressCircleComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            } ];
        };
        ProgressCircleComponent.propDecorators = {
            circleRef: [ {
                type: core$1.ViewChild,
                args: [ ngCircleProgress.CircleProgressComponent ]
            } ]
        };
        return ProgressCircleComponent;
    }(base.StylableComponent);
    var components = [ ProgressBarComponent, ProgressCircleComponent ];
    var ProgressModule = function() {
        function ProgressModule() {}
        ProgressModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ common.CommonModule, ngCircleProgress.NgCircleProgressModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return ProgressModule;
    }();
    exports.\u0275a = ProgressBarComponent;
    exports.\u0275b = registerProps;
    exports.\u0275c = ProgressCircleComponent;
    exports.\u0275d = registerProps$1;
    exports.ProgressModule = ProgressModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@angular/forms"), require("@angular/platform-browser"), require("@wm/components/input"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/basic/rich-text-editor", [ "exports", "@angular/common", "@angular/core", "@angular/forms", "@angular/platform-browser", "@wm/components/input", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.basic = global.wm.components.basic || {}, 
    global.wm.components.basic.richtexteditor = {}), global.ng.common, global.ng.core, global.ng.forms, global.ng.platformBrowser, global.wm.components.input, global.wm.components.base, global.wm.core);
})(this, function(exports, common, core, forms, platformBrowser, input, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var richTextProps = new Map([ [ "class", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "height", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "placeholder", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showpreview", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ] ]);
    var registerProps = function() {
        base.register("wm-richtexteditor", richTextProps);
        base.registerFormWidget(core$1.FormWidgetType.RICHTEXT, new Map(richTextProps));
    };
    var WIDGET_INFO = {
        widgetType: "wm-richtexteditor",
        hostClass: "app-richtexteditor clearfix"
    };
    var getChangeEvt = function() {
        var changeEvt;
        if (typeof Event === "function") {
            changeEvt = new Event("change");
        } else {
            changeEvt = document.createEvent("Event");
            changeEvt.initEvent("change", true, true);
        }
        return changeEvt;
    };
    var overrideSummerNote = function() {
        if (!$.summernote.__overidden) {
            var origFn_1 = $.summernote.ui.button.bind($.summernote);
            $.summernote.ui.button = function() {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                var retVal = origFn_1.apply(void 0, __spread(args));
                var origCallback = retVal.callback;
                retVal.callback = function($node, options) {
                    $node.addClass("btn");
                    return origCallback($node, options);
                };
                return retVal;
            };
            $.summernote.__overidden = true;
        }
    };
    var RichTextEditorComponent = function(_super) {
        __extends(RichTextEditorComponent, _super);
        function RichTextEditorComponent(inj, domSanitizer, ngZone) {
            var _this = _super.call(this, inj, WIDGET_INFO) || this;
            _this.domSanitizer = domSanitizer;
            _this.ngZone = ngZone;
            _this._operationStack = [];
            _this.isEditorLoaded = false;
            _this.EDITOR_DEFAULT_OPTIONS = {
                toolbar: [ [ "misc", [ "undo", "redo" ] ], [ "style", [ "style" ] ], [ "fontname", [ "fontname" ] ], [ "fontsize", [ "fontsize" ] ], [ "height", [ "height" ] ], [ "style", [ "bold", "italic", "underline", "clear" ] ], [ "font", [ "strikethrough", "superscript", "subscript" ] ], [ "color", [ "color" ] ], [ "insert", [ "table", "picture", "link", "video", "hr" ] ], [ "para", [ "ul", "ol", "paragraph" ] ], [ "misc", [ "codeview", "fullscreen", "help" ] ] ],
                callbacks: {
                    onInit: function() {
                        _this.isEditorLoaded = true;
                        if (_this._operationStack.length) {
                            _this._operationStack.forEach(function(operationParam) {
                                var key = Array.from(operationParam.keys())[0], val = operationParam.get(key);
                                _this.performEditorOperation(key, val);
                            });
                            _this._operationStack = [];
                        }
                    },
                    onChange: function(contents, editable) {
                        _this.proxyModel = _this.domSanitizer.sanitize(core.SecurityContext.HTML, contents.toString());
                        _this.invokeOnChange(contents, getChangeEvt(), true);
                        _this.invokeOnTouched();
                    }
                },
                fontNames: [ "Arial", "Arial Black", "Comic Sans MS", "Courier New", "Merriweather" ],
                placeholder: "write here...",
                minHeight: 100,
                disableResizeEditor: true
            };
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER, [ "height" ]);
            overrideSummerNote();
            return _this;
        }
        Object.defineProperty(RichTextEditorComponent.prototype, "htmlcontent", {
            get: function() {
                return this.performEditorOperation("code");
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(RichTextEditorComponent.prototype, "datavalue", {
            get: function() {
                return this.htmlcontent;
            },
            set: function(nv) {
                if (nv !== undefined && nv !== null) {
                    this.$hiddenInputEle.val(nv);
                    this.performEditorOperation("reset");
                    this.performEditorOperation("code", nv);
                }
            },
            enumerable: true,
            configurable: true
        });
        RichTextEditorComponent.prototype.ngOnInit = function() {
            this.$richTextEditor = $(this.nativeElement.querySelector("[richTextEditor]"));
            this.$hiddenInputEle = $(this.nativeElement.querySelector("input.model-holder"));
            _super.prototype.ngOnInit.call(this);
            this.initEditor();
        };
        RichTextEditorComponent.prototype.initEditor = function() {
            var _this = this;
            this.ngZone.runOutsideAngular(function() {
                _this.$richTextEditor.summernote(_this.EDITOR_DEFAULT_OPTIONS);
            });
        };
        RichTextEditorComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "placeholder") {
                this.performEditorOperation("placeholder", nv);
            } else if (key === "disabled" || key === "readonly") {
                this.performEditorOperation(nv ? "disable" : "enable");
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        RichTextEditorComponent.prototype.onStyleChange = function(key, nv, ov) {
            if (key === "height") {
                this.performEditorOperation("height", nv);
            }
        };
        RichTextEditorComponent.prototype.performEditorOperation = function(key, value) {
            if (this.isEditorLoaded) {
                if (key === "height") {
                    core$1.setCSS(this.nativeElement.querySelector("div.note-editable"), key, value, true);
                } else if (key === "placeholder") {
                    core$1.setHtml(this.nativeElement.querySelector("div.note-placeholder"), value, true);
                } else {
                    if (arguments.length === 1 && key === "code" && this.$richTextEditor.summernote("isEmpty")) {
                        var content = this.$richTextEditor.summernote("code");
                        return content === "" ? content : undefined;
                    }
                    return this.$richTextEditor.summernote(key, value);
                }
            } else {
                var op = new Map();
                op.set(key, value);
                this._operationStack.push(op);
                return;
            }
        };
        RichTextEditorComponent.prototype.getCurrentPosition = function() {
            return this.performEditorOperation("createRange");
        };
        RichTextEditorComponent.prototype.undo = function() {
            this.performEditorOperation("undo");
        };
        RichTextEditorComponent.prototype.focus = function() {
            this.performEditorOperation("focus");
        };
        RichTextEditorComponent.prototype.ngOnDestroy = function() {
            this.performEditorOperation("destroy");
            _super.prototype.ngOnDestroy.call(this);
        };
        RichTextEditorComponent.initializeProps = registerProps();
        RichTextEditorComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmRichTextEditor]",
                template: '<div richTextEditor></div>\n<div [innerHTML]="proxyModel" class="ta-preview" *ngIf="showpreview"></div>\n<input class="model-holder" [disabled]="disabled" hidden>\n',
                providers: [ base.provideAs(RichTextEditorComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(RichTextEditorComponent) ]
            } ]
        } ];
        RichTextEditorComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: platformBrowser.DomSanitizer
            }, {
                type: core.NgZone
            } ];
        };
        return RichTextEditorComponent;
    }(input.BaseFormCustomComponent);
    var components = [ RichTextEditorComponent ];
    var RichTextEditorModule = function() {
        function RichTextEditorModule() {}
        RichTextEditorModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return RichTextEditorModule;
    }();
    exports.\u0275a = RichTextEditorComponent;
    exports.\u0275b = registerProps;
    exports.RichTextEditorModule = RichTextEditorModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/forms"), require("rxjs"), require("rxjs/operators"), require("ngx-bootstrap/typeahead"), require("@wm/components/input"), require("@wm/core"), require("@wm/components/base"), require("@angular/core")) : typeof define === "function" && define.amd ? define("@wm/components/basic/search", [ "exports", "@angular/common", "@angular/forms", "rxjs", "rxjs/operators", "ngx-bootstrap/typeahead", "@wm/components/input", "@wm/core", "@wm/components/base", "@angular/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.basic = global.wm.components.basic || {}, 
    global.wm.components.basic.search = {}), global.ng.common, global.ng.forms, global.rxjs, global.rxjs.operators, global.ngxBootstrap, global.wm.components.input, global.wm.core, global.wm.components.base, global.ng.core);
})(this, function(exports, common, forms, rxjs, operators, typeahead, input, core, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var searchProps = new Map([ [ "casesensitive", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "class", base.PROP_STRING ], [ "datacompletemsg", __assign({
        value: "No more data to load"
    }, base.PROP_STRING) ], [ "datafield", __assign({
        value: "All Fields"
    }, base.PROP_STRING) ], [ "dataoptions", base.PROP_ANY ], [ "dataset", base.PROP_ANY ], [ "datasource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "datavaluesource", base.PROP_ANY ], [ "disabled", base.PROP_BOOLEAN ], [ "displayimagesrc", base.PROP_STRING ], [ "displaylabel", base.PROP_STRING ], [ "dropup", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "imagewidth", __assign({
        value: "16px"
    }, base.PROP_STRING) ], [ "limit", base.PROP_NUMBER ], [ "loadingdatamsg", __assign({
        value: "Loading items..."
    }, base.PROP_STRING) ], [ "matchmode", base.PROP_STRING ], [ "minchars", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "navsearchbar", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "orderby", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Search"
    }, base.PROP_STRING) ], [ "position", base.PROP_STRING ], [ "query", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "searchkey", base.PROP_STRING ], [ "searchon", __assign({
        value: "typing"
    }, base.PROP_STRING) ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showsearchicon", base.PROP_BOOLEAN ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", __assign({
        value: "search"
    }, base.PROP_STRING) ], [ "debouncetime", __assign({
        value: 250
    }, base.PROP_NUMBER) ], [ "width", base.PROP_STRING ] ]);
    var registerProps = function() {
        base.register("wm-search", searchProps);
        base.registerFormWidget(core.FormWidgetType.AUTOCOMPLETE, new Map(searchProps));
        base.registerFormWidget(core.FormWidgetType.TYPEAHEAD, new Map(searchProps));
    };
    var LocalDataProvider = function() {
        function LocalDataProvider() {}
        LocalDataProvider.prototype.applyFilter = function(entry, queryText, filtername) {
            if (_.includes(filtername, "start")) {
                return _.startsWith(entry, queryText);
            } else if (_.includes(filtername, "end")) {
                return _.endsWith(entry, queryText);
            } else if (_.includes(filtername, "exact")) {
                return _.isEqual(entry, queryText);
            }
            return _.includes(entry, queryText);
        };
        LocalDataProvider.prototype.filter = function(config) {
            var _this = this;
            var entries = config.dataset;
            var casesensitive = config.casesensitive;
            var matchMode = config.matchMode;
            if (matchMode && !_.includes(matchMode, "ignorecase")) {
                casesensitive = true;
            }
            var queryText = config.query, filteredData;
            return new Promise(function(resolve, reject) {
                if (config.searchKey) {
                    var keys_1 = _.split(config.searchKey, ",");
                    filteredData = _.filter(config.dataset, function(item) {
                        return keys_1.some(function(key) {
                            var a = _.get(item, key), b = queryText;
                            if (!casesensitive) {
                                a = _.toLower(_.toString(a));
                                b = _.toLower(_.toString(b));
                            }
                            return _this.applyFilter(a, b, matchMode);
                        });
                    });
                } else {
                    if (_.isArray(entries) && _.isObject(entries[0])) {
                        filteredData = _.filter(entries, function(entry) {
                            var a = _.values(entry).join(" ");
                            if (!casesensitive) {
                                a = _.toLower(a);
                                queryText = _.toLower(queryText);
                            }
                            return _this.applyFilter(a, queryText);
                        });
                    } else {
                        filteredData = _.filter(entries, function(entry) {
                            if (!casesensitive) {
                                entry = _.toLower(entry);
                                queryText = _.toLower(queryText);
                            }
                            return _this.applyFilter(entry, queryText, matchMode);
                        });
                    }
                }
                resolve({
                    data: filteredData,
                    hasMoreData: false,
                    isLastPage: true
                });
            });
        };
        return LocalDataProvider;
    }();
    var RemoteDataProvider = function() {
        function RemoteDataProvider() {}
        RemoteDataProvider.prototype.filter = function(config) {
            var _this = this;
            return this.filterData(config).then(function(response) {
                return _this.onFilterSuccess(config, response);
            }, function() {
                return _this.onFilterFailure();
            });
        };
        RemoteDataProvider.prototype.filterData = function(config) {
            if (config.dataoptions) {
                var dataoptions_1 = config.dataoptions;
                var requestParams_1 = config.datasource.execute(core.DataSource.Operation.GET_REQUEST_PARAMS, config);
                if (dataoptions_1.relatedField) {
                    return new Promise(function(resolve, reject) {
                        base.interpolateBindExpressions(config.viewParent, dataoptions_1.filterExpr, function(filterexpressions) {
                            requestParams_1.filterExpr = dataoptions_1.filterExpr = filterexpressions;
                            dataoptions_1.filterExpr = filterexpressions;
                            config.datasource.execute(core.DataSource.Operation.GET_RELATED_TABLE_DATA, _.assign({
                                relatedField: dataoptions_1.relatedField
                            }, requestParams_1)).then(resolve, reject);
                        });
                    });
                }
                if (dataoptions_1.distinctField) {
                    return config.datasource.execute(core.DataSource.Operation.GET_DISTINCT_DATA_BY_FIELDS, {
                        pagesize: config.limit || config.pagesize,
                        page: config.page,
                        fields: dataoptions_1.distinctField,
                        entityName: dataoptions_1.tableName,
                        filterFields: _.assign(dataoptions_1.filterFields, requestParams_1.filterFields),
                        filterExpr: core.getClonedObject(dataoptions_1.filterExpr || {})
                    });
                }
            }
            return config.datasource.execute(core.DataSource.Operation.SEARCH_RECORDS, config);
        };
        RemoteDataProvider.prototype.isLast = function(page, dataSize, maxResults, currentResults) {
            if (dataSize === core.AppConstants.INT_MAX_VALUE) {
                return currentResults !== 0 && currentResults < maxResults;
            }
            var pageCount = dataSize > maxResults ? Math.ceil(dataSize / maxResults) : dataSize < 0 ? 0 : 1;
            return page === pageCount;
        };
        RemoteDataProvider.prototype.getTransformedData = function(variable, data) {
            var operationResult = variable.operation + "Result";
            var tempResponse = data[operationResult];
            if (tempResponse) {
                var tempObj = {};
                _.set(tempObj, operationResult, tempResponse);
                data = [ tempObj ];
            } else {
                data = [ data ];
            }
            return data;
        };
        RemoteDataProvider.prototype.onFilterFailure = function() {
            return [];
        };
        RemoteDataProvider.prototype.isLastPageForDistinctApi = function(data, page, totalElements, _isLastPage) {
            return page > 1 && !_isLastPage && _.isEmpty(data) && totalElements === core.AppConstants.INT_MAX_VALUE;
        };
        RemoteDataProvider.prototype.onFilterSuccess = function(config, response) {
            var _this = this;
            var data = response.data;
            var formattedData;
            var _isLastPage;
            var page;
            var isPaginatedData;
            var expressionArray = _.split(config.binddataset, ".");
            var dataExpression = _.slice(expressionArray, _.indexOf(expressionArray, "dataSet") + 1).join(".");
            var $I = "[$i]";
            return new Promise(function(resolve, reject) {
                var pageOptions = response.pagination;
                if (config.datasource.execute(core.DataSource.Operation.IS_PAGEABLE)) {
                    page = pageOptions.number + 1;
                    _isLastPage = _this.isLast(page, config.limit > 0 && config.limit || pageOptions.totalElements, pageOptions.size, pageOptions.numberOfElements);
                    isPaginatedData = true;
                    if (_this.isLastPageForDistinctApi(data, page, pageOptions.totalElements, _isLastPage)) {
                        _isLastPage = true;
                        resolve({
                            data: [],
                            isLastPage: _isLastPage,
                            hasMoreData: page > 1,
                            isPaginatedData: isPaginatedData,
                            page: page
                        });
                        return;
                    }
                }
                if (dataExpression) {
                    var index = dataExpression.lastIndexOf($I);
                    var restExpr_1 = dataExpression.substr(index + 5);
                    if (_.isArray(data)) {
                        formattedData = data.map(function(datum) {
                            return core.findValueOf(datum, restExpr_1);
                        });
                    } else if (_.isObject(data)) {
                        formattedData = _.get(data, dataExpression);
                    }
                    data = formattedData || data;
                }
                if (!_.isArray(data)) {
                    data = _this.getTransformedData(config.datasource, data);
                }
                if (!data.length) {
                    resolve({
                        data: [],
                        isLastPage: _isLastPage,
                        hasMoreData: page > 1,
                        isPaginatedData: isPaginatedData,
                        page: page
                    });
                } else {
                    resolve({
                        data: data,
                        isLastPage: _isLastPage,
                        hasMoreData: page > 1,
                        isPaginatedData: isPaginatedData,
                        page: page
                    });
                }
            });
        };
        return RemoteDataProvider;
    }();
    var DataProvider = function() {
        function DataProvider() {}
        DataProvider.prototype.filter = function(config) {
            var _this = this;
            var promise;
            var hasNoVariableDataset = config.datasource && config.datasource.execute(core.DataSource.Operation.IS_UPDATE_REQUIRED, config.hasData);
            if (!config.isLocalFilter && (config.dataoptions || config.datasource && config.datasource.execute(core.DataSource.Operation.IS_API_AWARE) && config.searchKey && hasNoVariableDataset)) {
                promise = DataProvider.remoteDataProvider.filter(config);
            } else {
                promise = DataProvider.localDataProvider.filter(config);
            }
            return promise.then(function(response) {
                _this.updateDataset = config.datasource && !config.datasource.execute(core.DataSource.Operation.SUPPORTS_CRUD) && hasNoVariableDataset;
                _this.hasMoreData = response.hasMoreData;
                _this.isLastPage = response.isLastPage;
                _this.page = response.page;
                _this.isPaginatedData = response.isPaginatedData;
                return response;
            });
        };
        DataProvider.remoteDataProvider = new RemoteDataProvider();
        DataProvider.localDataProvider = new LocalDataProvider();
        return DataProvider;
    }();
    var WIDGET_CONFIG = {
        widgetType: "wm-search",
        hostClass: "input-group"
    };
    var SearchComponent = function(_super) {
        __extends(SearchComponent, _super);
        function SearchComponent(inj, binddatavalue, binddataset) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.binddatavalue = binddatavalue;
            _this.binddataset = binddataset;
            _this.query = "";
            _this.page = 1;
            _this.allowempty = false;
            core.addClass(_this.nativeElement, "app-search", true);
            _this.typeaheadDataSource = rxjs.Observable.create(function(observer) {
                if (_this.listenQuery) {
                    _this._defaultQueryInvoked = false;
                    _this._loadingItems = true;
                    observer.next(_this.query);
                }
                if (_this.lastSelectedIndex) {
                    _this.typeahead._container = undefined;
                }
            }).pipe(operators.mergeMap(function(token) {
                return _this.getDataSourceAsObservable(token);
            }));
            _this.dataProvider = new DataProvider();
            var datavalueSubscription = _this.datavalue$.subscribe(function(val) {
                var query = _.isArray(val) ? val[0] : val;
                if (query === null || query === "") {
                    _this._modelByValue = "";
                    _this.query = _this.queryModel = "";
                    _this._lastResult = undefined;
                    return;
                }
                if (!_this._unsubscribeDv) {
                    _this._defaultQueryInvoked = false;
                    if (!_.isObject(val) && _this.prevDatavalue !== val) {
                        _this._modelByKey = undefined;
                        _this.query = _this.queryModel = "";
                    }
                    _this.updateByDatavalue(val);
                }
            });
            _this.registerDestroyListener(function() {
                return datavalueSubscription.unsubscribe();
            });
            var datasetSubscription = _this.dataset$.subscribe(function() {
                _this.startIndex = _this.datasetItems.length;
                _this._lastResult = undefined;
                var defaultValue = _this.datavalue || _this.toBeProcessedDatavalue;
                if (core.isDefined(defaultValue)) {
                    _this.updateByDataset(defaultValue);
                }
            });
            _this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
            return _this;
        }
        Object.defineProperty(SearchComponent.prototype, "datasource", {
            get: function() {
                return this._datasource;
            },
            set: function(nv) {
                this._datasource = nv;
                var data = this.datavalue || this.toBeProcessedDatavalue;
                this.updateByDatavalue(data);
            },
            enumerable: true,
            configurable: true
        });
        SearchComponent.prototype.clearSearch = function($event, loadOnClear) {
            this.query = "";
            this.onInputChange($event);
            this.dataProvider.isLastPage = false;
            this.listenQuery = false;
            if (loadOnClear) {
                this.listenQuery = true;
                this._unsubscribeDv = false;
                this.loadMoreData();
            }
            this.invokeEventCallback("clearsearch");
        };
        SearchComponent.prototype.clearText = function() {
            this.$element.find("input").val("");
            this.showClosebtn = false;
        };
        SearchComponent.prototype.closeSearch = function() {
            this._loadingItems = false;
            this.page = 1;
            this.insertAtIndex(this.elIndex);
            this.elIndex = undefined;
            this.parentEl = undefined;
            this.$element.removeClass("full-screen");
            if (this._domUpdated) {
                this._domUpdated = false;
            }
            this.listenQuery = false;
            this._unsubscribeDv = true;
            this.typeahead.hide();
        };
        SearchComponent.prototype.renderMobileAutoComplete = function() {
            if (!core.isDefined(this.elIndex)) {
                this.parentEl = this.$element.parent();
                this.elIndex = this.parentEl.children().index(this.$element);
            }
            if (!this.$element.hasClass("full-screen")) {
                this._domUpdated = true;
                this.$element.addClass("full-screen");
                if (this.position === "inline") {
                    this.$element.addClass(this.position);
                }
            }
            if (this.$element.hasClass("full-screen")) {
                this.$element.find(".app-search-input").focus();
            }
        };
        SearchComponent.prototype.getDataSourceAsObservable = function(query) {
            if (this._lastQuery === query && !_.get(this.dataoptions, "filterFields") && core.isDefined(this._lastResult)) {
                this._loadingItems = false;
                return rxjs.of(this._lastResult);
            }
            this._lastQuery = this.query;
            return rxjs.from(this.getDataSource(query));
        };
        SearchComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            if (!_.includes([ "blur", "focus", "select", "submit", "change" ], eventName)) {
                _super.prototype.handleEvent.call(this, node, eventName, eventCallback, locals);
            }
        };
        SearchComponent.prototype.highlight = function(match, query) {
            if (this.typeaheadContainer) {
                match.value = match.item.label.toString();
                return this.typeaheadContainer.highlight(match, query);
            }
        };
        SearchComponent.prototype.insertAtIndex = function(i) {
            if (i === 0) {
                this.parentEl.prepend(this.$element);
            } else {
                var $elAtIndex = this.parentEl.children().eq(i);
                if ($elAtIndex.length) {
                    this.$element.insertBefore(this.parentEl.children().eq(i));
                } else {
                    this.$element.insertAfter(this.parentEl.children().eq(i - 1));
                }
            }
        };
        SearchComponent.prototype.isMobileAutoComplete = function() {
            return this.type === "autocomplete" && core.isMobile();
        };
        SearchComponent.prototype.loadMoreData = function(incrementPage) {
            if (this.dataProvider.isLastPage) {
                return;
            }
            this.page = incrementPage ? this.page + 1 : this.page;
            this.isScrolled = true;
            this._loadingItems = true;
            if (incrementPage) {
                this._lastQuery = undefined;
            }
            this.typeahead.onInput({
                target: {
                    value: _.trim(this.query) || "0"
                }
            });
        };
        SearchComponent.prototype.onFocusOut = function() {
            var _this = this;
            this._unsubscribeDv = false;
            this._loadingItems = false;
            this.page = 1;
            if (!this._domUpdated && this._isOpen) {
                this.listenQuery = false;
                setTimeout(function() {
                    if (_this.typeahead._typeahead.isShown) {
                        _this.typeahead.hide();
                    }
                }, 200);
            }
            this._isOpen = false;
            if (this._domUpdated && this.typeahead && this.typeahead._container) {
                this.typeahead._container.isFocused = true;
            }
        };
        SearchComponent.prototype.onInputChange = function($event) {
            this.result = [];
            this.page = 1;
            this.listenQuery = this.isUpdateOnKeyPress();
            this._modelByValue = undefined;
            if (this.query === "") {
                this.queryModel = "";
                this._modelByValue = "";
                this.invokeOnChange(this._modelByValue, {}, true);
                if ($event && $event.which !== 9) {
                    this.invokeEventCallback("submit", {
                        $event: $event
                    });
                }
            } else {
                this.invokeEventCallback("change", {
                    $event: $event,
                    newVal: this._modelByValue || this.query,
                    oldVal: this.prevDatavalue
                });
            }
            this.showClosebtn = this.query !== "";
        };
        SearchComponent.prototype.handleEnterEvent = function($event) {
            if (!this.typeahead._container) {
                this.onSearchSelect($event);
            }
        };
        SearchComponent.prototype.onSearchSelect = function($event) {
            if (!this.isUpdateOnKeyPress()) {
                this.listenQuery = true;
                this.typeahead.onInput({
                    target: {
                        value: this.query
                    }
                });
                return;
            }
            if (this.typeaheadContainer && this.liElements.length) {
                this.typeaheadContainer.selectActiveMatch();
            } else {
                this.queryModel = this.query;
                this.invokeEventCallback("submit", {
                    $event: $event
                });
            }
        };
        SearchComponent.prototype.invokeOnBeforeServiceCall = function(inputData) {
            this.invokeEventCallback("beforeservicecall", {
                inputData: inputData
            });
        };
        SearchComponent.prototype.onDropdownOpen = function() {
            var _this = this;
            var fn = _.debounce(function() {
                _this._isOpen = true;
                _this.typeaheadContainer = _this.typeahead._container || _this.typeahead._typeahead.instance;
                _this.typeaheadContainer.liElements = _this.liElements;
                _this.typeaheadContainer.ulElement = _this.ulElement;
                core.adjustContainerPosition($("typeahead-container"), _this.nativeElement, _this.typeahead._typeahead, $("typeahead-container .dropdown-menu"));
            });
            fn();
            if (this.isMobileAutoComplete()) {
                if (!this.$element.hasClass("full-screen")) {
                    this.renderMobileAutoComplete();
                }
                var dropdownEl = this.dropdownEl.closest("typeahead-container");
                dropdownEl.insertAfter(this.$element.find("input:first"));
                var screenHeight = this.$element.closest(".app-content").height();
                dropdownEl.css({
                    position: "relative",
                    top: 0,
                    height: screenHeight + "px"
                });
                this.showClosebtn = this.query && this.query !== "";
                if (!this.dataProvider.isLastPage) {
                    this.triggerSearch();
                }
            }
        };
        SearchComponent.prototype.selectNext = function() {
            var matches = this.typeaheadContainer.matches;
            if (!matches) {
                return;
            }
            var index = matches.indexOf(this.typeaheadContainer.active);
            if (!this._loadingItems && !this.dataProvider.isLastPage && index + 1 > matches.length - 1) {
                this.lastSelectedIndex = index;
                this.loadMoreData(true);
            }
        };
        SearchComponent.prototype.setLastActiveMatchAsSelected = function() {
            if (this.lastSelectedIndex) {
                this.typeaheadContainer._active = this.typeaheadContainer.matches[this.lastSelectedIndex];
                this.typeaheadContainer.nextActiveMatch();
                this.lastSelectedIndex = undefined;
            }
        };
        SearchComponent.prototype.triggerSearch = function() {
            if (this.dataProvider.isLastPage || !this.$element.hasClass("full-screen")) {
                return;
            }
            var typeAheadDropDown = this.dropdownEl;
            var $lastItem = typeAheadDropDown.find("li").last();
            if ($lastItem.length && typeAheadDropDown.length && typeAheadDropDown.height() + typeAheadDropDown.position().top > $lastItem.height() + $lastItem.position().top) {
                this.loadMoreData(true);
            }
        };
        SearchComponent.prototype.isUpdateOnKeyPress = function() {
            return this.searchon === "typing";
        };
        SearchComponent.prototype.debounceDefaultQuery = function(data) {
            var _this = this;
            this._defaultQueryInvoked = true;
            this.getDataSource(data, true).then(function(response) {
                if (response.length) {
                    _this.queryModel = response;
                    _this._lastQuery = _this.query = _this.queryModel[0].label || "";
                    _this._modelByValue = _this.queryModel[0].value;
                    _this._modelByKey = _this.queryModel[0].key;
                } else {
                    _this._modelByValue = undefined;
                    _this.queryModel = undefined;
                    _this.query = "";
                }
            });
        };
        SearchComponent.prototype.updateByDatavalue = function(data) {
            this.updateByDataset(data);
            this.updateByDataSource(data);
        };
        SearchComponent.prototype.updateByDataSource = function(data) {
            if (core.isDefined(data) && !_.isObject(data) && this.datasource && !core.isDefined(this._modelByKey) && this.datafield !== base.ALLFIELDS) {
                if (core.isDefined(this.queryModel) && !_.isEmpty(this.queryModel)) {
                    this.updateDatavalueFromQueryModel();
                    return;
                }
                if (!this._defaultQueryInvoked && this.datasource.execute(core.DataSource.Operation.SUPPORTS_CRUD)) {
                    this.debounceDefaultQuery(data);
                }
            }
        };
        SearchComponent.prototype.updateDatavalueFromQueryModel = function() {
            if (core.isDefined(this.queryModel)) {
                this._modelByValue = _.isArray(this.queryModel) ? this.queryModel[0].value : this.queryModel;
                this._modelByKey = _.isArray(this.queryModel) ? this.queryModel[0].key : this.queryModel;
                this.toBeProcessedDatavalue = undefined;
            }
        };
        SearchComponent.prototype.updateByDataset = function(data) {
            if (this._defaultQueryInvoked && this.searchkey) {
                return;
            }
            var selectedItem = _.find(this.datasetItems, function(item) {
                return _.isObject(item.value) ? _.isEqual(item.value, data) : _.toString(item.value).toLowerCase() === _.toString(data).toLowerCase();
            });
            if (selectedItem) {
                this.queryModel = [ selectedItem ];
            } else if (this.datafield === base.ALLFIELDS && _.isObject(data)) {
                this.queryModel = this.getTransformedData(base.extractDataAsArray(data));
            } else {
                if (this.prevDatavalue !== data) {
                    this.queryModel = undefined;
                    this.query = "";
                    return;
                }
            }
            this.updateDatavalueFromQueryModel();
            this._lastQuery = this.query = core.isDefined(this.queryModel) && this.queryModel.length ? _.get(this.queryModel[0], "label") : "";
        };
        SearchComponent.prototype.handleFocus = function($event) {
            if (this.type === "search" && this.query === this._lastQuery && this._lastResult) {
                this.typeahead.keyUpEventEmitter.emit(this.query);
            }
        };
        SearchComponent.prototype.getDataSource = function(query, searchOnDataField, nextItemIndex) {
            var _this = this;
            if (searchOnDataField && this.datafield === base.ALLFIELDS) {
                this._loadingItems = false;
                return Promise.resolve([]);
            }
            var dataConfig = {
                dataset: this.dataset ? base.convertDataToObject(this.dataset) : undefined,
                binddataset: this.binddataset,
                datasource: this.datasource,
                datafield: this.datafield,
                hasData: this.dataset && this.dataset.length,
                query: query,
                isLocalFilter: !this.searchkey,
                searchKey: searchOnDataField ? this.datafield : this.searchkey,
                matchMode: searchOnDataField ? "startignorecase" : this.matchmode,
                casesensitive: this.casesensitive,
                isformfield: this.isformfield,
                orderby: this.orderby,
                limit: this.limit,
                pagesize: this.pagesize,
                page: this.page,
                onBeforeservicecall: this.invokeOnBeforeServiceCall.bind(this)
            };
            if (this.dataoptions) {
                dataConfig.dataoptions = this.dataoptions;
                dataConfig.viewParent = this.viewParent;
            }
            this._loadingItems = true;
            return this.dataProvider.filter(dataConfig).then(function(response) {
                response = response.data || response;
                if ((!core.isDefined(_this.dataset) || !_this.dataset.length) && _this.dataProvider.updateDataset) {
                    _this.dataset = response;
                }
                if (_this.dataProvider.hasMoreData) {
                    _this.formattedDataset = _this.formattedDataset.concat(response);
                } else {
                    _this.formattedDataset = response;
                }
                if (_this.formattedDataset.length > 20 && !core.isDefined(_this.limit)) {
                    _this.typeahead.typeaheadOptionsLimit = _this.formattedDataset.length;
                }
                if (_this._isOpen && _this.isMobileAutoComplete() && !_this.dataProvider.isLastPage) {
                    _this.triggerSearch();
                }
                var transformedData = _this.getTransformedData(_this.formattedDataset, nextItemIndex);
                _this.result = _.map(transformedData, "value");
                return transformedData;
            }, function(error) {
                _this._loadingItems = false;
                return [];
            }).then(function(result) {
                if (_this.isScrolled) {
                    _.debounce(function() {
                        _this.setLastActiveMatchAsSelected();
                    }, 30)();
                    _this.isScrolled = false;
                }
                if (!result.length) {
                    _this._modelByValue = undefined;
                    _this.queryModel = query;
                }
                if (_this._unsubscribeDv) {
                    result = [];
                }
                _this._loadingItems = false;
                _this._lastResult = result;
                return result;
            });
        };
        SearchComponent.prototype.getContext = function(context) {
            if (context && _.get(context, "widget")) {
                return this.getContext(context.viewParent);
            }
            return context;
        };
        SearchComponent.prototype.getTransformedData = function(data, itemIndex, iscustom) {
            if (core.isDefined(itemIndex)) {
                itemIndex++;
            }
            var transformedData = base.transformFormData(this.getContext(this.viewParent), data, this.datafield, {
                displayField: this.displaylabel || this.displayfield,
                displayExpr: iscustom ? "" : this.displayexpression,
                bindDisplayExpr: iscustom ? "" : this.binddisplaylabel,
                bindDisplayImgSrc: this.binddisplayimagesrc,
                displayImgSrc: this.displayimagesrc
            }, itemIndex);
            return base.getUniqObjsByDataField(transformedData, this.datafield, this.displayfield || this.displaylabel, core.toBoolean(this.allowempty));
        };
        SearchComponent.prototype.onScroll = function($scrollEl, evt) {
            var totalHeight = $scrollEl.scrollHeight, clientHeight = $scrollEl.clientHeight;
            if (!this._loadingItems && !this.dataProvider.isLastPage && $scrollEl.scrollTop + clientHeight >= totalHeight) {
                this.loadMoreData(true);
            }
        };
        SearchComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            if (!core.isDefined(this.minchars)) {
                if (this.type === "autocomplete") {
                    this.minchars = 0;
                } else {
                    this.minchars = 1;
                }
            }
            this.listenQuery = this.isUpdateOnKeyPress();
            this.showsearchicon = core.isDefined(this.showsearchicon) ? this.showsearchicon : this.type === "search";
        };
        SearchComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.nativeElement, this);
        };
        SearchComponent.prototype.typeaheadOnSelect = function(match, $event) {
            var item = match.item;
            this.queryModel = item;
            item.selected = true;
            this.query = item.label;
            $event = $event || this.$typeaheadEvent;
            this._modelByKey = item.key;
            this._modelByValue = item.value;
            this.invokeOnTouched();
            this.invokeOnChange(this.datavalue, $event || {});
            if (this.datavalue !== this.prevDatavalue) {
                this.updateBoundVariable(this.datavalue);
            }
            if (this.$element.hasClass("full-screen")) {
                this.closeSearch();
            }
            this.invokeEventCallback("select", {
                $event: $event,
                selectedValue: this.datavalue
            });
            this.invokeEventCallback("submit", {
                $event: $event
            });
            this.updatePrevDatavalue(this.datavalue);
        };
        SearchComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "displaylabel" && this.dataoptions && this.binddisplaylabel === null) {
                this.query = _.get(this._modelByValue, nv) || this._modelByValue;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        SearchComponent.initializeProps = registerProps();
        SearchComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "[wmSearch]",
                template: '<ng-template #customItemTemplate let-model="item" let-index="index" let-query="query" let-match="match">\n    <a>\n        <img *ngIf="model.imgSrc" [src]="model.imgSrc" alt="Search" [style.width]="imagewidth">\n        <span [title]="model.label" [innerHtml]="highlight(match, query) || model.label"></span>\n    </a>\n</ng-template>\n\n<ng-template #customListTemplate let-matches="matches" let-itemTemplate="itemTemplate" let-query="query">\n    <ul #ulElement class="app-search dropdown-menu" scrollable>\n        <li #liElements *ngFor="let match of matches" [ngClass]="{active: typeaheadContainer && typeaheadContainer.isActive(match)}"\n            (mouseenter)="typeaheadContainer.selectActive(match);"\n            (click)="typeaheadContainer.selectMatch(match, $event); $typeaheadEvent = $event;">\n            \x3c!-- itemTemplate comes from the <input> --\x3e\n            <ng-container *ngIf="!match.isHeader()" [ngTemplateOutlet]="itemTemplate"\n                          [ngTemplateOutletContext]="{item: match.item, index: i, match: match, query: query}">\n            </ng-container>\n        </li>\n        <div class="status" [hidden]="_loadingItems || !(datacompletemsg && dataProvider.isLastPage)">\n            <span [textContent]="datacompletemsg"></span>\n        </div>\n        <div class="status" [hidden]="!_loadingItems">\n            <i class="fa fa-circle-o-notch fa-spin"></i>\n            <span [textContent]="loadingdatamsg"></span>\n        </div>\n    </ul>\n</ng-template>\n\n\x3c!--This template is for search inside mobile navbar.--\x3e\n<ng-container *ngIf="navsearchbar; else searchTemplate">\n    <input [title]="query || \'\'" type="text" class="app-textbox form-control list-of-objs app-search-input" [placeholder]="placeholder || \'\'"\n           focus-target\n           container="body"\n           [disabled]="disabled"\n           autocomplete="off"\n           [(ngModel)]="query"\n           [readonly]="readonly"\n           [disabled]="disabled"\n           [typeahead]="typeaheadDataSource"\n           [typeaheadWaitMs]="debouncetime"\n           [typeaheadItemTemplate]="customItemTemplate"\n           [optionsListTemplate]="customListTemplate"\n           (input)="onInputChange($event)"\n           (keydown)="listenQuery = true"\n           (keydown.enter)="$typeaheadEvent = $event;handleEnterEvent($event)"\n           (keydown.arrowdown)="selectNext($event)"\n           (blur)="invokeOnTouched($event)"\n           (click)="handleFocus($event);"\n           (focus)="_unsubscribeDv = false; listenQuery = true; handleFocus($event); invokeOnFocus($event);"\n           (focusout)="onFocusOut()"\n           [typeaheadMinLength]="minchars"\n           [typeaheadOptionsLimit]="limit"\n           (typeaheadLoading)="_loadingItems"\n           (typeaheadOnSelect)="typeaheadOnSelect($event)"\n           typeaheadOptionField="label"\n           [typeaheadAsync]="true"\n           [typeaheadScrollable]="true"\n           [typeaheadOptionsInScrollableView]="optionslimitinscrollableview"\n           [dropup]="dropup"\n           [tabindex]="tabindex"\n           [attr.name]="name"/>\n    <i class="btn-close wi wi-cancel" [hidden]="!showClosebtn" (click)="clearSearch($event);"></i>\n</ng-container>\n\x3c!--This template is for both web and fullscreen mode in mobile.--\x3e\n<ng-template #searchTemplate>\n    <span class="wi wi-arrow-left form-control-feedback back-btn" aria-hidden="true" (click)="closeSearch()"></span>\n    <span class="sr-only">Back button</span>\n    <input [title]="query || \'\'" type="text" class="app-textbox form-control list-of-objs app-search-input" [placeholder]="placeholder || \'\'"\n           focus-target\n           container="body"\n           [disabled]="disabled"\n           autocomplete="off"\n           [(ngModel)]="query"\n           [readonly]="readonly"\n           [typeahead]="typeaheadDataSource"\n           [typeaheadWaitMs]="debouncetime"\n           [typeaheadItemTemplate]="customItemTemplate"\n           [optionsListTemplate]="customListTemplate"\n           (input)="onInputChange($event)"\n           (keydown)="listenQuery = true"\n           (keydown.enter)="$typeaheadEvent = $event;handleEnterEvent($event)"\n           (keydown.arrowdown)="selectNext($event)"\n           (blur)="invokeOnTouched($event)"\n           (click)="handleFocus($event);"\n           (focus)="_unsubscribeDv = false; listenQuery = true; handleFocus($event); invokeOnFocus($event)"\n           (focusout)="onFocusOut()"\n           [typeaheadMinLength]="minchars"\n           [typeaheadOptionsLimit]="limit"\n           (typeaheadLoading)="_loadingItems"\n           (typeaheadOnSelect)="typeaheadOnSelect($event)"\n           typeaheadOptionField="label"\n           [typeaheadAsync]="true"\n           [typeaheadScrollable]="true"\n           [typeaheadOptionsInScrollableView]="optionslimitinscrollableview"\n           [tabindex]="tabindex"\n           [dropup]="dropup"\n           [attr.name]="name">\n    <input class="model-holder" ng-model="proxyModel" ng-required="required" tabindex="-1">\n    <span *ngIf="_loadingItems" aria-hidden="true" class="fa fa-circle-o-notch fa-spin form-control-feedback"></span>\n    <span class="wi wi-close form-control-feedback clear-btn" [hidden]="!showClosebtn" (click)="clearSearch($event, true)"></span>\n    <span class="sr-only">Clear button</span>\n    <span *ngIf="showsearchicon" class="input-group-addon" aria-label="search icon" [ngClass]="{\'disabled\': disabled}">\n        <form>\n            <button title="Search" [disabled]="disabled" class="app-search-button wi wi-search" type="submit"\n                    (click)="onSearchSelect($event)"></button>\n        </form>\n    </span>\n</ng-template>\n',
                providers: [ base.provideAs(SearchComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(SearchComponent) ]
            } ]
        } ];
        SearchComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "datavalue.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            } ];
        };
        SearchComponent.propDecorators = {
            typeahead: [ {
                type: core$1.ViewChild,
                args: [ typeahead.TypeaheadDirective ]
            } ],
            ulElement: [ {
                type: core$1.ViewChild,
                args: [ "ulElement" ]
            } ],
            liElements: [ {
                type: core$1.ViewChildren,
                args: [ "liElements" ]
            } ]
        };
        return SearchComponent;
    }(input.DatasetAwareFormComponent);
    var ScrollableDirective = function() {
        function ScrollableDirective(inj, searchRef) {
            this.searchRef = searchRef;
            this.elementRef = inj.get(core$1.ElementRef);
        }
        ScrollableDirective.prototype.ngAfterContentInit = function() {
            this.elementRef.nativeElement.addEventListener("scroll", this.notifyParent.bind(this));
            this.searchRef.dropdownEl = $(this.elementRef.nativeElement);
            this.searchRef.onDropdownOpen();
        };
        ScrollableDirective.prototype.ngAfterViewInit = function() {
            if (!this.searchRef.isMobileAutoComplete()) {
                var typeAheadInput = this.searchRef.$element.find("input:first");
                this.searchRef.dropdownEl.width(typeAheadInput.outerWidth());
            }
        };
        ScrollableDirective.prototype.notifyParent = function(evt) {
            this.searchRef.onScroll(this.elementRef.nativeElement, evt);
        };
        ScrollableDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[scrollable]"
            } ]
        } ];
        ScrollableDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: SearchComponent
            } ];
        };
        return ScrollableDirective;
    }();
    var components = [ SearchComponent, ScrollableDirective ];
    var SearchModule = function() {
        function SearchModule() {}
        SearchModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ common.CommonModule, forms.FormsModule, typeahead.TypeaheadModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return SearchModule;
    }();
    exports.\u0275b = ScrollableDirective;
    exports.\u0275a = registerProps;
    exports.SearchModule = SearchModule;
    exports.SearchComponent = SearchComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/basic/tree", [ "exports", "@angular/common", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.basic = global.wm.components.basic || {}, 
    global.wm.components.basic.tree = {}), global.ng.common, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-tree", new Map([ [ "class", base.PROP_STRING ], [ "dataset", __assign({
            value: "node1, node2, node3"
        }, base.PROP_ANY) ], [ "datavalue", base.PROP_STRING ], [ "levels", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "nodeaction", base.PROP_STRING ], [ "nodechildren", base.PROP_STRING ], [ "nodeclick", __assign({
            value: "none"
        }, base.PROP_STRING) ], [ "nodeicon", base.PROP_STRING ], [ "nodeid", base.PROP_STRING ], [ "nodelabel", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "treeicons", base.PROP_STRING ] ]));
    };
    var defaultTreeIconClass = "plus-minus";
    var ICON_CLASSES = {
        folder: {
            expanded: "wi-folder-open",
            collapsed: "wi-folder"
        },
        "circle-plus-minus": {
            expanded: "wi-remove-circle-outline",
            collapsed: "wi-add-circle-outline"
        },
        chevron: {
            expanded: "wi-keyboard-arrow-down",
            collapsed: "wi-keyboard-arrow-right"
        },
        menu: {
            expanded: "wi-arrow-down",
            collapsed: "wi-arrow-right"
        },
        triangle: {
            expanded: "wi-arrow-drop-down-circle",
            collapsed: "wi-play-circle-filled"
        },
        "expand-collapse": {
            expanded: "wi-expand-less",
            collapsed: "wi-expand-more"
        },
        "plus-minus": {
            expanded: "wi-minus",
            collapsed: "wi-plus"
        }
    };
    var WIDGET_INFO = {
        widgetType: "wm-tree",
        hostClass: "app-tree"
    };
    var TreeDirective = function(_super) {
        __extends(TreeDirective, _super);
        function TreeDirective(inj, binddatavalue, bindnodelabel, bindnodeicon, bindnodechildren, bindnodeid) {
            var _this = _super.call(this, inj, WIDGET_INFO) || this;
            _this.binddatavalue = binddatavalue;
            _this.bindnodelabel = bindnodelabel;
            _this.bindnodeicon = bindnodeicon;
            _this.bindnodechildren = bindnodechildren;
            _this.bindnodeid = bindnodeid;
            _this.bindEvents();
            return _this;
        }
        TreeDirective.prototype.onPropertyChange = function(key, nv, ov) {
            switch (key) {
              case "dataset":
                this.nodes = this.getNodes(nv);
                this._selectNode = undefined;
                this.renderTree();
                break;

              case "nodeicon":
              case "nodelabel":
              case "nodechildren":
              case "orderby":
                this.renderTree();
                break;

              case "treeicons":
                this.changeTreeIcons(nv, ov);
                break;

              case "datavalue":
                this.selectById(nv);
                break;

              default:
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        TreeDirective.prototype.constructNodes = function(nodes, parent, levels, deep, _evalDataValue) {
            var _this = this;
            var $ul = $("<ul></ul>");
            var _iconClses = ICON_CLASSES[this.treeicons || defaultTreeIconClass];
            var _expr = this.binddatavalue || this.datavalue;
            var _iconCls, _cls;
            _cls = levels > 0 ? " expanded " : " collapsed ";
            _iconCls = _cls + (levels > 0 ? _iconClses.expanded : _iconClses.collapsed);
            deep = deep || 0;
            parent.append($ul);
            nodes.forEach(function(node, idx) {
                var $li = $("<li></li>"), $iconNode = $("<i></i>"), nodeLabel = base.getEvaluatedData(node, {
                    expression: _this.nodelabel,
                    bindExpression: _this.bindnodelabel
                }, _this.viewParent) || node.label, nodeIcon = base.getEvaluatedData(node, {
                    expression: _this.nodeicon,
                    bindExpression: _this.bindnodeicon
                }, _this.viewParent) || node.icon, nodeChildren = base.getEvaluatedData(node, {
                    expression: _this.nodechildren,
                    bindExpression: _this.bindnodechildren
                }, _this.viewParent) || node.children, nodeIdValue = base.getEvaluatedData(node, {
                    expression: _this.nodeid,
                    bindExpression: _this.bindnodeid
                }, _this.viewParent) || node.children;
                var isNodeMatched = false, expandCollapseIcon;
                $li.data("nodedata", node).append($iconNode).append('<span class="title">' + nodeLabel + "</span>").appendTo($ul);
                if (_this.bindnodeid || _this.nodeid) {
                    isNodeMatched = _this.binddatavalue ? nodeIdValue === _evalDataValue : nodeIdValue === _expr;
                    if (nodeIdValue) {
                        $li.attr("id", nodeIdValue);
                    }
                } else if (_this.binddatavalue) {
                    isNodeMatched = !!core$1.$parseExpr(_expr)(_this, node);
                }
                if (!_this._selectNode) {
                    if (_expr === "FirstNode" && idx === 0 || !deep && _expr === "LastNode" && idx === nodes.length - 1 || isNodeMatched) {
                        _this._selectNode = $li;
                        _this.datavalue = nodeIdValue;
                    }
                }
                if (nodeIcon) {
                    $iconNode.addClass(nodeIcon);
                }
                if (nodeChildren && nodeChildren.length) {
                    $li.addClass("parent-node " + _cls);
                    expandCollapseIcon = $('<i class="wi ' + _iconCls + '"></i>');
                    if (nodeIcon) {
                        $iconNode.addClass(nodeIcon);
                    }
                    $li.prepend(expandCollapseIcon);
                    _this.constructNodes(nodeChildren, $li, levels - 1, deep + 1, _evalDataValue);
                } else {
                    if (!nodeIcon) {
                        $iconNode.addClass("leaf-node");
                    }
                    $li.addClass("leaf-node");
                }
            });
        };
        TreeDirective.prototype.getNodesFromString = function(value) {
            return value.split(",").map(function(item) {
                return {
                    label: item && item.trim()
                };
            });
        };
        TreeDirective.prototype.getNodes = function(newVal) {
            var nodes;
            if (_.isString(newVal) && !_.isEmpty(newVal)) {
                newVal = newVal.trim();
                if (newVal) {
                    nodes = this.getNodesFromString(newVal);
                }
            } else if (_.isArray(newVal)) {
                newVal = base.getOrderedDataset(newVal, this.orderby);
                nodes = newVal;
            } else if (_.isObject(newVal)) {
                nodes = [ newVal ];
            }
            return nodes;
        };
        TreeDirective.prototype.changeTreeIcons = function(nv, ov) {
            var $el = $(this.nativeElement);
            nv = nv || defaultTreeIconClass;
            ov = ov || defaultTreeIconClass;
            $el.find("i.expanded").removeClass(ICON_CLASSES[ov].expanded).addClass(ICON_CLASSES[nv].expanded);
            $el.find("i.collapsed").removeClass(ICON_CLASSES[ov].collapsed).addClass(ICON_CLASSES[nv].collapsed);
        };
        TreeDirective.prototype.toggleExpandCollapseNode = function($event, $i, $li) {
            var treeIcons = ICON_CLASSES[this.treeicons || defaultTreeIconClass], eventParams = {
                $event: $event
            };
            if ($i.hasClass("collapsed")) {
                $i.removeClass("collapsed " + treeIcons.collapsed).addClass("expanded " + treeIcons.expanded);
                $li.removeClass("collapsed").addClass("expanded");
                this.invokeEventCallback("expand", eventParams);
            } else if ($i.hasClass("expanded")) {
                $i.removeClass("expanded " + treeIcons.expanded).addClass("collapsed " + treeIcons.collapsed);
                $li.removeClass("expanded").addClass("collapsed");
                this.invokeEventCallback("collapse", eventParams);
            }
        };
        TreeDirective.prototype.renderTree = function(forceRender) {
            var _this = this;
            var docFrag, $li, $liPath, data, path = "";
            var levels = +this.nativeElement.getAttribute("levels") || 0, $el = $(this.nativeElement);
            $el.empty();
            if (forceRender) {
                this._selectNode = undefined;
            }
            if (this.nodes && this.nodes.length) {
                docFrag = document.createDocumentFragment();
                this.constructNodes(this.nodes, $(docFrag), levels, 0, this.datavalue);
                $el.append(docFrag);
            }
            if (this._selectNode) {
                $li = this._selectNode;
                $li.addClass("selected");
                data = $li.data("nodedata");
                $liPath = $li.parentsUntil($el, "li.parent-node.collapsed");
                if (!$liPath.length) {
                    $liPath = $li;
                }
                $liPath.each(function() {
                    var $current = $(_this), $i = $current.children("i.collapsed"), $title = $current.children(".title");
                    _this.toggleExpandCollapseNode(undefined, $i, $current);
                    path = "/" + ($title.text() + path);
                });
                this.selecteditem = core$1.getClonedObject(data) || {};
                this.selecteditem.path = path;
                this.invokeEventCallback("select", {
                    $event: undefined,
                    $item: data,
                    $path: path
                });
                core$1.$appDigest();
            }
        };
        TreeDirective.prototype.selectNode = function(evt, value) {
            var _this = this;
            var target = evt && $(evt.target), $el = $(this.nativeElement), $li = _.isObject(value) ? value : $el.find('li[id="' + value + '"]:first');
            var data, path = "", $liPath, nodeAction;
            $el.find(".selected").removeClass("selected");
            if (!$li.length) {
                return;
            }
            $li.addClass("selected");
            data = $li.data("nodedata");
            nodeAction = data[this.nodeaction || "action"];
            $liPath = target ? target.parents(".app-tree li") : $li.find("> span.title").parents(".app-tree li");
            $liPath.each(function(i, el) {
                var current = $(el).children(".title").text();
                path = "/" + (current + path);
            });
            $li.parentsUntil($el, "li.parent-node.collapsed").each(function(index, el) {
                var $current = $(el), $i = $current.children("i.collapsed");
                _this.toggleExpandCollapseNode(undefined, $i, $current);
            });
            this.selecteditem = core$1.getClonedObject(data) || {};
            this.selecteditem.path = path;
            if (target) {
                if (this.nodeid) {
                    this.datavalue = core$1.$parseExpr(this.nodeid)(this, data);
                } else if (this.bindnodeid) {
                    this.datavalue = base.getEvaluatedData(data, {
                        expression: this.nodeid,
                        bindExpression: this.bindnodeid
                    }, this.viewParent);
                } else {
                    this.datavalue = core$1.getClonedObject(data) || {};
                }
            }
            if (nodeAction) {
                core$1.$parseEvent(nodeAction)(this);
            }
            this.invokeEventCallback("select", {
                $event: evt,
                $item: data,
                $path: path
            });
            core$1.$appDigest();
        };
        TreeDirective.prototype.bindEvents = function() {
            var _this = this;
            $(this.nativeElement).on("click", function(evt) {
                var target = $(evt.target), li = target.closest("li"), $i = target.is("i") ? target : target.siblings("i.collapsed,i.expanded");
                evt.stopPropagation();
                if (target.is("span.title")) {
                    _this.selecteditem = {};
                    _this.selectNode(evt, li);
                }
                if (target.is("i") || target.is("span.title") && _this.nodeclick === "expand") {
                    _this.toggleExpandCollapseNode(evt, $i, li);
                }
            });
        };
        TreeDirective.prototype.selectById = function(value) {
            this.selectNode(undefined, value);
        };
        TreeDirective.prototype.deselectById = function(value) {
            this.selecteditem = {};
            this.selectById();
        };
        TreeDirective.prototype.redraw = function() {
            this.renderTree(true);
        };
        TreeDirective.initializeProps = registerProps();
        TreeDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "div[wmTree]",
                providers: [ base.provideAsWidgetRef(TreeDirective) ]
            } ]
        } ];
        TreeDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "datavalue.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "nodelabel.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "nodeicon.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "nodechildren.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "nodeid.bind" ]
                } ]
            } ];
        };
        return TreeDirective;
    }(base.StylableComponent);
    var components = [ TreeDirective ];
    var TreeModule = function() {
        function TreeModule() {}
        TreeModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return TreeModule;
    }();
    exports.\u0275a = TreeDirective;
    exports.\u0275b = registerProps;
    exports.TreeModule = TreeModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/forms"), require("ngx-bootstrap/datepicker"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/input/calendar", [ "exports", "@angular/common", "@angular/forms", "ngx-bootstrap/datepicker", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.calendar = {}), global.ng.common, global.ng.forms, global.ngxBootstrap, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, forms, datepicker, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        var props = new Map([ [ "calendartype", __assign({
            value: "basic"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "controls", __assign({
            value: "navigation, today, year, month, week, day"
        }, base.PROP_STRING) ], [ "dataset", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "eventallday", base.PROP_STRING ], [ "eventclass", base.PROP_STRING ], [ "eventend", base.PROP_STRING ], [ "eventstart", base.PROP_STRING ], [ "eventtitle", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showindevice", __assign({
            displayType: "inline-block",
            value: "all"
        }, base.PROP_STRING) ], [ "view", base.PROP_STRING ], [ "selectionmode", base.PROP_STRING ] ]);
        if (core$1.isMobileApp()) {
            props.set("view", __assign({
                value: "day"
            }, base.PROP_STRING));
        }
        base.register("wm-calendar", props);
    };
    var DEFAULT_CLS = "app-calendar";
    var dateFormats = [ "yyyy-MM-dd", "yyyy-M-dd", "M-dd-yyyy", "MM-dd-yy", "yyyy, dd MMMM", "yyyy, MMM dd", "MM/dd/yyyy", "M/d/yyyy", "EEE, dd MMM yyyy", "EEE MMM dd yyyy", "EEEE, MMMM dd, yyyy", "timestamp" ];
    var defaultHeaderOptions = {
        left: "prev next today",
        center: "title",
        right: "month basicWeek basicDay"
    };
    var VIEW_TYPES = {
        BASIC: "basic",
        AGENDA: "agenda",
        LIST: "list"
    };
    var BUTTON_TEXT = {
        YEAR: "Year",
        MONTH: "Month",
        WEEK: "Week",
        DAY: "Day",
        TODAY: "Today"
    };
    var SELECTION_MODES = {
        NONE: "none",
        SINGLE: "single",
        MULTIPLE: "multiple"
    };
    var NEXT_DAY_THRESHOLD = {
        START: "00:00",
        END: "24:00"
    };
    var getEventMomentValue = function(value, key) {
        var isDate = false;
        dateFormats.forEach(function(format) {
            if (moment(value, format.toUpperCase(), true).isValid()) {
                isDate = true;
                return false;
            }
        });
        if (isDate && key === "end") {
            return moment(value).endOf("day");
        }
        return moment(value);
    };
    var getUTCDateTime = function(dateObj) {
        dateObj = _.isObject(dateObj) ? dateObj : moment(dateObj);
        var year = dateObj.format("YYYY"), month = dateObj.format("MM") - 1, day = dateObj.format("DD"), hours = dateObj.format("HH"), minutes = dateObj.format("mm"), seconds = dateObj.format("ss");
        return new Date(year, month, day, hours, minutes, seconds);
    };
    var WIDGET_CONFIG = {
        widgetType: "wm-calendar",
        hostClass: DEFAULT_CLS
    };
    var multipleEventClass = "app-calendar-event";
    var doubleEventClass = multipleEventClass + " two";
    var singleEventClass = multipleEventClass + " one";
    var dateFormat = "YYYY/MM/DD";
    var CalendarComponent = function(_super) {
        __extends(CalendarComponent, _super);
        function CalendarComponent(inj, i18nService) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.controls = "navigation, today, year, month, week, day";
            _this.eventSources = [];
            _this.dataSetEvents = {
                events: []
            };
            _this.changesStack = [];
            _this.invokeOnViewRenderback = _.debounce(function() {
                return _this.invokeEventCallback("viewrender", {
                    $view: _this.calendarOptions
                });
            }, 300);
            _this.calendarOptions = {
                calendar: {
                    height: 600,
                    eventSources: _this.eventSources,
                    editable: true,
                    locale: core$1.getSessionStorageItem("selectedLocale") || "en",
                    selectable: false,
                    header: defaultHeaderOptions,
                    nextDayThreshold: NEXT_DAY_THRESHOLD,
                    views: {
                        month: {
                            eventLimit: 0
                        }
                    },
                    unselectAuto: false,
                    eventDrop: _this.eventDrop.bind(_this),
                    eventResizeStart: _this.onEventChangeStart.bind(_this),
                    eventDragStart: _this.onEventChangeStart.bind(_this),
                    eventResize: _this.eventResize.bind(_this),
                    eventClick: _this.eventClick.bind(_this),
                    select: _this.select.bind(_this),
                    eventRender: _this.eventRender.bind(_this),
                    viewRender: _this.viewRender.bind(_this)
                }
            };
            _this.dayClass = [];
            _this.mobileCalendar = core$1.isMobile();
            _this.eventSources.push(_this.dataSetEvents);
            var FullCalendar = window["FullCalendar"];
            if (!FullCalendar.__wm_locale_initialized) {
                i18nService.initCalendarLocale();
                FullCalendar.__wm_locale_initialized = true;
            }
            return _this;
        }
        CalendarComponent.prototype.selectDate = function() {
            var start, end;
            if (_.isObject(this.datavalue)) {
                start = this.datavalue.start;
                end = this.datavalue.end;
            } else {
                start = moment(this.datavalue);
                end = moment(this.datavalue).add(1, "day").startOf("day");
            }
            this.$fullCalendar.fullCalendar("gotoDate", start);
            this.$fullCalendar.fullCalendar("select", start, end);
        };
        CalendarComponent.prototype.gotoDate = function() {
            this.$fullCalendar.fullCalendar("gotoDate", moment(this.datavalue));
        };
        CalendarComponent.prototype.gotoNextYear = function() {
            this.$fullCalendar.fullCalendar("nextYear");
        };
        CalendarComponent.prototype.gotoPrevYear = function() {
            this.$fullCalendar.fullCalendar("prevYear");
        };
        CalendarComponent.prototype.gotoMonth = function(monthVal) {
            var presentDay = this.$fullCalendar.fullCalendar("getDate");
            var presentMonthVal = new Date(presentDay).getMonth();
            if (presentMonthVal < monthVal) {
                this.$fullCalendar.fullCalendar("gotoDate", presentDay.add(monthVal - presentMonthVal - 1, "M"));
            } else {
                this.$fullCalendar.fullCalendar("gotoDate", presentDay.subtract(presentMonthVal - monthVal + 1, "M"));
            }
        };
        CalendarComponent.prototype.gotoNextMonth = function() {
            var presentDay = this.$fullCalendar.fullCalendar("getDate");
            this.$fullCalendar.fullCalendar("gotoDate", presentDay.add(1, "M"));
        };
        CalendarComponent.prototype.gotoPrevMonth = function() {
            var presentDay = this.$fullCalendar.fullCalendar("getDate");
            this.$fullCalendar.fullCalendar("gotoDate", presentDay.subtract(1, "M"));
        };
        CalendarComponent.prototype.rerenderEvents = function() {
            this.$fullCalendar.fullCalendar("rerenderEvents");
        };
        CalendarComponent.prototype.setSelectedData = function(start, end) {
            var dataset = this.dataset;
            if (!dataset) {
                return;
            }
            var filteredDates = [];
            var eventStartKey = this.eventstart || "start";
            var eventEndKey = this.eventend || "end";
            var startDate = moment(new Date(start)).format("MM/DD/YYYY");
            var endDate = moment(new Date(end)).subtract(1, "days").format("MM/DD/YYYY");
            dataset = dataset.data || dataset;
            dataset.forEach(function(value) {
                if (!value[eventStartKey]) {
                    return;
                }
                var eventStartDate = moment(new Date(value[eventStartKey])).format("MM/DD/YYYY");
                var eventEndDate = moment(new Date(value[eventEndKey] || value[eventStartKey])).format("MM/DD/YYYY");
                var eventExists = moment(eventStartDate).isSameOrAfter(startDate) && moment(eventEndDate).isSameOrBefore(endDate);
                if (eventExists) {
                    filteredDates.push(value);
                }
            });
            return filteredDates;
        };
        CalendarComponent.prototype.eventDrop = function($newData, $delta, $revertFunc, $event, $ui, $view) {
            this.invokeEventCallback("eventdrop", {
                $event: $event,
                $newData: $newData,
                $oldData: this.oldData,
                $delta: $delta,
                $revertFunc: $revertFunc,
                $ui: $ui,
                $view: $view
            });
        };
        CalendarComponent.prototype.select = function(start, end, jsEvent, $view) {
            this.selecteddates = {
                start: getUTCDateTime(start),
                end: getUTCDateTime(end)
            };
            this.selecteddata = this.setSelectedData(start, end);
            this.invokeEventCallback("select", {
                $start: start.valueOf(),
                $end: end.valueOf(),
                $view: $view,
                $data: this.selecteddata
            });
        };
        CalendarComponent.prototype.eventResize = function($newData, $delta, $revertFunc, $event, $ui, $view) {
            this.invokeEventCallback("eventresize", {
                $event: $event,
                $newData: $newData,
                $oldData: this.oldData,
                $delta: $delta,
                $revertFunc: $revertFunc,
                $ui: $ui,
                $view: $view
            });
        };
        CalendarComponent.prototype.onEventChangeStart = function(event) {
            this.oldData = core$1.getClonedObject(event);
        };
        CalendarComponent.prototype.eventClick = function($data, $event, $view) {
            this.invokeEventCallback("eventclick", {
                $event: $event,
                $data: $data,
                $view: $view
            });
        };
        CalendarComponent.prototype.eventRender = function($data, $event, $view) {
            if (this.calendartype === VIEW_TYPES.LIST) {
                this.$fullCalendar.find(".fc-list-table").addClass("table");
            }
            this.invokeEventCallback("eventrender", {
                $event: $event,
                $data: $data,
                $view: $view
            });
        };
        CalendarComponent.prototype.viewRender = function($view) {
            this.currentview = {
                start: $view.start.format(),
                end: $view.end.subtract(1, "days").format()
            };
            if (this.calendartype === VIEW_TYPES.LIST) {
                this.$fullCalendar.find(".fc-list-table").addClass("table");
            }
            this.invokeEventCallback("viewrender", {
                $view: $view
            });
        };
        CalendarComponent.prototype.updateCalendarHeaderOptions = function() {
            var ctrls = this.controls, viewType = this.calendartype, regEx = new RegExp("\\bday\\b", "g");
            var left = "", right = "";
            if (ctrls && viewType) {
                if (_.includes(ctrls, "navigation")) {
                    left += " prev next";
                }
                if (_.includes(ctrls, "today")) {
                    left += " today";
                }
                if (_.includes(ctrls, "year")) {
                    right += viewType === VIEW_TYPES.LIST ? "listYear" : "";
                }
                if (_.includes(ctrls, "month")) {
                    right += viewType === VIEW_TYPES.LIST ? " listMonth" : " month";
                }
                if (_.includes(ctrls, "week")) {
                    right += viewType === VIEW_TYPES.BASIC ? " basicWeek" : viewType === VIEW_TYPES.LIST ? " listWeek" : " agendaWeek";
                }
                if (regEx.test(ctrls)) {
                    right += viewType === VIEW_TYPES.BASIC ? " basicDay" : viewType === VIEW_TYPES.LIST ? " listDay" : " agendaDay";
                }
                _.extend(this.calendarOptions.calendar.header, {
                    left: left,
                    right: right
                });
            }
        };
        CalendarComponent.prototype.calculateHeight = function(height) {
            var $parent = $(this.nativeElement).parent(), elHeight = height || "650px";
            var parentHeight = $parent.css("height"), computedHeight;
            if (_.includes(elHeight, "%")) {
                if (_.includes(parentHeight, "%")) {
                    parentHeight = $parent.height();
                }
                computedHeight = parseInt(parentHeight, 10) * Number(elHeight.replace(/\%/g, "")) / 100;
            } else {
                computedHeight = parseInt(elHeight, 10);
            }
            this.calendarOptions.calendar.views.month.eventLimit = parseInt("" + computedHeight / 200, 10) + 1;
            return computedHeight;
        };
        CalendarComponent.prototype.triggerMobileCalendarChange = function() {
            this.prepareCalendarEvents();
            this.proxyModel = this.proxyModel || moment().valueOf();
            this.selecteddates = {
                start: moment(this.proxyModel).valueOf(),
                end: moment(this.proxyModel).endOf("day").valueOf()
            };
            this.invokeEventCallback("eventrender", {
                $data: this.eventData
            });
        };
        CalendarComponent.prototype.prepareCalendarEvents = function() {
            var _this = this;
            var eventDay, dataset;
            this.eventData = {};
            if (!this.dataset) {
                return;
            }
            dataset = this.dataset;
            dataset = _.isArray(dataset) ? dataset : _.isObject(dataset) ? [ dataset ] : [];
            this.events = dataset || this.constructCalendarDataset(dataset);
            this.events.forEach(function(event) {
                var eventStart = event.start || event[_this.eventstart];
                if (eventStart) {
                    eventDay = moment(eventStart).startOf("day").format(dateFormat);
                    if (_this.eventData[eventDay]) {
                        _this.eventData[eventDay].push(event);
                    } else {
                        _this.eventData[eventDay] = [ event ];
                    }
                    if (_this.mobileCalendar) {
                        _this.dayClass.push({
                            date: new Date(eventStart).setHours(0, 0, 0, 0),
                            mode: "day",
                            clazz: _this.getDayClass({
                                eventDay: eventDay
                            })
                        });
                    }
                }
            });
            if (this.mobileCalendar && this._datepickerInnerComponent) {
                this._datepickerInnerComponent.refreshView();
            }
        };
        CalendarComponent.prototype.constructCalendarDataset = function(eventSource) {
            var _this = this;
            var properties = {
                title: this.eventtitle || "title",
                allDay: this.eventallday || "allday",
                start: this.eventstart || "start",
                end: this.eventend || "end",
                className: this.eventclass || "className"
            };
            eventSource.forEach(function(obj) {
                _.mapKeys(properties, function(value, key) {
                    var objVal;
                    if (key === "title") {
                        objVal = base.getEvaluatedData(obj, {
                            expression: value
                        }, _this.viewParent);
                    } else if (key === "allDay") {
                        objVal = !!_.get(obj, value);
                    } else {
                        objVal = _.get(obj, value);
                    }
                    if (!objVal) {
                        return;
                    }
                    if (key === "start" || key === "end") {
                        objVal = getEventMomentValue(objVal, key);
                    }
                    obj[key] = objVal;
                });
            });
            return eventSource;
        };
        CalendarComponent.prototype.setLocale = function() {
            var year = _.get(this.appLocale, "LABEL_CALENDAR_YEAR") || BUTTON_TEXT.YEAR;
            var month = _.get(this.appLocale, "LABEL_CALENDAR_MONTH") || BUTTON_TEXT.MONTH;
            var week = _.get(this.appLocale, "LABEL_CALENDAR_WEEK") || BUTTON_TEXT.WEEK;
            var day = _.get(this.appLocale, "LABEL_CALENDAR_DAY") || BUTTON_TEXT.DAY;
            var today = _.get(this.appLocale, "LABEL_CALENDAR_TODAY") || BUTTON_TEXT.TODAY;
            this.calendarOptions.calendar.buttonText = {
                year: year,
                month: month,
                week: week,
                day: day,
                today: today,
                listYear: year,
                listMonth: month,
                listWeek: week,
                listDay: day
            };
        };
        CalendarComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            base.styler(this.nativeElement, this, base.APPLY_STYLES_TYPE.CONTAINER, [ "height" ]);
            if (this.mobileCalendar) {
                if (!this.view || this.view === "week") {
                    this.view = "day";
                }
                this.triggerMobileCalendarChange();
            } else {
                this.setLocale();
            }
        };
        CalendarComponent.prototype.onStyleChange = function(key, nv, ov) {
            _super.prototype.onStyleChange.call(this, key, nv, ov);
            if (key === "height") {
                this.calendarOptions.calendar.height = this.calculateHeight(nv);
                this.updateCalendarOptions("option", "height", this.calendarOptions.calendar.height);
            }
        };
        CalendarComponent.prototype.onPropertyChange = function(key, nv, ov) {
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
            switch (key) {
              case "selectionmode":
                if (nv !== SELECTION_MODES.NONE) {
                    this.calendarOptions.calendar.selectable = true;
                    this.updateCalendarOptions("option", "selectable", true);
                    if (nv === SELECTION_MODES.SINGLE) {
                        this.calendarOptions.calendar.selectConstraint = {
                            start: "00:00",
                            end: "24:00"
                        };
                        this.updateCalendarOptions("option", "selectConstraint", this.calendarOptions.calendar.selectConstraint);
                    } else {
                        this.updateCalendarOptions("option", "selectConstraint", {});
                    }
                } else {
                    this.calendarOptions.calendar.selectable = false;
                    this.updateCalendarOptions("option", "selectable", false);
                }
                break;

              case "view":
                if (nv !== "month" || this.calendartype === VIEW_TYPES.LIST) {
                    this.calendarOptions.calendar.defaultView = this.calendartype + _.capitalize(nv);
                } else {
                    this.calendarOptions.calendar.defaultView = nv;
                }
                this.updateCalendarOptions("changeView", this.calendarOptions.calendar.defaultView);
                break;

              case "calendartype":
                this.calendartype = nv || "basic";

              case "controls":
                this.updateCalendarHeaderOptions();
                break;

              case "dataset":
                var dataSet = void 0;
                this.dataset = nv;
                dataSet = base.createArrayFrom(core$1.getClonedObject(nv));
                dataSet = this.constructCalendarDataset(dataSet);
                this.dataSetEvents.events = dataSet.filter(function(event) {
                    event.start = event.start || event.end;
                    if (event.start) {
                        return true;
                    }
                });
                if (this.mobileCalendar) {
                    this.triggerMobileCalendarChange();
                } else {
                    this.updateCalendarOptions("removeEvents");
                    this.updateCalendarOptions("addEventSource", this.dataSetEvents.events);
                    this.updateCalendarOptions("rerenderEvents");
                }
                break;
            }
        };
        CalendarComponent.prototype.getDefaultDate = function() {
            if (this.datavalue) {
                return new Date(this.datavalue);
            }
        };
        CalendarComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            if (this.mobileCalendar && this._datepicker) {
                var lastActiveDate_1 = this._datepicker.activeDate;
                this._datepicker.activeDateChange.subscribe(function(dt) {
                    var prevYear = lastActiveDate_1.getYear();
                    var prevMonth = lastActiveDate_1.getMonth();
                    var selectedYear = dt.getYear();
                    var selectedMonth = dt.getMonth();
                    if (prevMonth !== selectedMonth || prevYear !== selectedYear) {
                        lastActiveDate_1 = dt;
                        _this.renderMobileView(dt);
                    }
                });
                this._datepickerInnerComponent = this._datepicker._datePicker;
                this.renderMobileView(moment(this.datavalue));
                this.registerDestroyListener(core$1.$watch("_datepickerInnerComponent.datepickerMode", this, {}, function(nv, ov) {
                    if (ov && !_.isEmpty(ov)) {
                        _this.invokeOnViewRenderback();
                    }
                }));
                return;
            }
            this.$fullCalendar = $(this._calendar.nativeElement);
            this.$fullCalendar.fullCalendar(this.calendarOptions.calendar);
            if (this.changesStack.length) {
                this.changesStack.forEach(function(changeObj) {
                    _this.$fullCalendar.fullCalendar(changeObj.operationType, changeObj.argumentKey, changeObj.argumentValue);
                });
                this.changesStack.length = 0;
            }
        };
        CalendarComponent.prototype.updateCalendarOptions = function(operationType, argumentKey, argumentValue) {
            if (!this.$fullCalendar) {
                this.changesStack.push({
                    operationType: operationType,
                    argumentKey: argumentKey,
                    argumentValue: argumentValue
                });
                return;
            }
            this.$fullCalendar.fullCalendar(operationType, argumentKey, argumentValue);
        };
        CalendarComponent.prototype.redraw = function() {
            this.updateCalendarOptions("render");
        };
        CalendarComponent.prototype.onValueChange = function(value) {
            this.proxyModel = value;
            var selectedDate = this.proxyModel && moment(this.proxyModel).startOf("day").format(dateFormat), selectedEventData = this.eventData[selectedDate], start = moment(this.proxyModel), end = moment(this.proxyModel).endOf("day");
            this.selecteddata = selectedEventData;
            this.selecteddates = {
                start: moment(selectedDate).valueOf(),
                end: moment(selectedDate).endOf("day").valueOf()
            };
            this.calendarOptions.calendar.select(start.valueOf(), end.valueOf(), {}, this, selectedEventData);
            if (selectedEventData) {
                this.calendarOptions.calendar.eventClick(selectedEventData, {}, this);
            }
        };
        CalendarComponent.prototype.getDayClass = function(data) {
            var eventDay = data.eventDay;
            if (!_.isEmpty(this.eventData) && this.eventData[eventDay]) {
                var eventsLength = this.eventData[eventDay].length;
                if (eventsLength === 1) {
                    return singleEventClass;
                }
                if (eventsLength === 2) {
                    return doubleEventClass;
                }
                return multipleEventClass;
            }
            return "";
        };
        CalendarComponent.prototype.renderMobileView = function(viewObj) {
            var startDate, endDate;
            if (!viewObj) {
                return;
            }
            startDate = moment(viewObj).startOf("month").valueOf();
            endDate = moment(viewObj).endOf("month").valueOf();
            this.currentview = {
                start: startDate,
                end: endDate
            };
            this.invokeOnViewRenderback();
        };
        CalendarComponent.initializeProps = registerProps();
        CalendarComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmCalendar]",
                template: '<div *ngIf="!mobileCalendar" #calendar></div>\n\n<datepicker *ngIf="mobileCalendar" #datepicker [(ngModel)]="proxyModel"\n            [initDate]="getDefaultDate()"\n            [minDate]="minDate"\n            [datepickerMode]="view"\n            [showWeeks]="false"\n            [customClass]="dayClass"\n            (selectionDone)="onValueChange($event)">\n</datepicker>\n\n\n\n',
                providers: [ base.provideAsWidgetRef(CalendarComponent) ],
                encapsulation: core.ViewEncapsulation.None,
                styles: [ '/*!\n * FullCalendar v3.10.0\n * Docs & License: https://fullcalendar.io/\n * (c) 2018 Adam Shaw\n */.fc{direction:ltr;text-align:left}.fc-rtl{text-align:right}body .fc{font-size:1em}.fc-highlight{background:#bce8f1;opacity:.3}.fc-bgevent{background:#8fdf82;opacity:.3}.fc-nonbusiness{background:#d7d7d7}.fc button{box-sizing:border-box;margin:0;height:2.1em;padding:0 .6em;font-size:1em;white-space:nowrap;cursor:pointer}.fc button::-moz-focus-inner{margin:0;padding:0}.fc-state-default{border:1px solid;background-color:#f5f5f5;background-image:-webkit-gradient(linear,left top,left bottom,from(#fff),to(#e6e6e6));background-image:linear-gradient(to bottom,#fff,#e6e6e6);background-repeat:repeat-x;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);color:#333;text-shadow:0 1px 1px rgba(255,255,255,.75);box-shadow:inset 0 1px 0 rgba(255,255,255,.2),0 1px 2px rgba(0,0,0,.05)}.fc-state-default.fc-corner-left{border-top-left-radius:4px;border-bottom-left-radius:4px}.fc-state-default.fc-corner-right{border-top-right-radius:4px;border-bottom-right-radius:4px}.fc button .fc-icon{position:relative;top:-.05em;margin:0 .2em;vertical-align:middle}.fc-state-active,.fc-state-disabled,.fc-state-down,.fc-state-hover{color:#333;background-color:#e6e6e6}.fc-state-hover{color:#333;text-decoration:none;background-position:0 -15px;-webkit-transition:background-position .1s linear;transition:background-position .1s linear}.fc-state-active,.fc-state-down{background-color:#ccc;background-image:none;box-shadow:inset 0 2px 4px rgba(0,0,0,.15),0 1px 2px rgba(0,0,0,.05)}.fc-state-disabled{cursor:default;background-image:none;opacity:.65;box-shadow:none}.fc-button-group{display:inline-block}.fc .fc-button-group>*{float:left;margin:0 0 0 -1px}.fc .fc-button-group>:first-child{margin-left:0}.fc-popover{position:absolute;box-shadow:0 2px 6px rgba(0,0,0,.15)}.fc-popover .fc-header{padding:2px 4px}.fc-popover .fc-header .fc-title{margin:0 2px}.fc-popover .fc-header .fc-close{cursor:pointer}.fc-ltr .fc-popover .fc-header .fc-title,.fc-rtl .fc-popover .fc-header .fc-close{float:left}.fc-ltr .fc-popover .fc-header .fc-close,.fc-rtl .fc-popover .fc-header .fc-title{float:right}.fc-divider{border-style:solid;border-width:1px}hr.fc-divider{height:0;margin:0;padding:0 0 2px;border-width:1px 0}.fc-clear{clear:both}.fc-bg,.fc-bgevent-skeleton,.fc-helper-skeleton,.fc-highlight-skeleton{position:absolute;top:0;left:0;right:0}.fc-bg{bottom:0}.fc-bg table{height:100%}.fc table{width:100%;box-sizing:border-box;table-layout:fixed;border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{border-style:solid;border-width:1px;padding:0;vertical-align:top}.fc td.fc-today{border-style:double}a[data-goto]{cursor:pointer}a[data-goto]:hover{text-decoration:underline}.fc .fc-row{border-style:solid;border-width:0}.fc-row table{border-left:0 hidden transparent;border-right:0 hidden transparent;border-bottom:0 hidden transparent}.fc-row:first-child table{border-top:0 hidden transparent}.fc-row{position:relative}.fc-row .fc-bg{z-index:1}.fc-row .fc-bgevent-skeleton,.fc-row .fc-highlight-skeleton{bottom:0}.fc-row .fc-bgevent-skeleton table,.fc-row .fc-highlight-skeleton table{height:100%}.fc-row .fc-bgevent-skeleton td,.fc-row .fc-highlight-skeleton td{border-color:transparent}.fc-row .fc-bgevent-skeleton{z-index:2}.fc-row .fc-highlight-skeleton{z-index:3}.fc-row .fc-content-skeleton{position:relative;z-index:4;padding-bottom:2px}.fc-row .fc-helper-skeleton{z-index:5}.fc .fc-row .fc-content-skeleton table,.fc .fc-row .fc-content-skeleton td,.fc .fc-row .fc-helper-skeleton td{background:0 0;border-color:transparent}.fc-row .fc-content-skeleton td,.fc-row .fc-helper-skeleton td{border-bottom:0}.fc-row .fc-content-skeleton tbody td,.fc-row .fc-helper-skeleton tbody td{border-top:0}.fc-scroller{-webkit-overflow-scrolling:touch}.fc-scroller>.fc-day-grid,.fc-scroller>.fc-time-grid{position:relative;width:100%}.fc-event{position:relative;display:block;font-size:.85em;line-height:1.3;border-radius:3px;border:1px solid #3a87ad}.fc-event,.fc-event-dot{background-color:#3a87ad}.fc-event,.fc-event:hover{color:#fff;text-decoration:none}.fc-event.fc-draggable,.fc-event[href]{cursor:pointer}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc-event .fc-bg{z-index:1;background:#fff;opacity:.25}.fc-event .fc-content{position:relative;z-index:2}.fc-event .fc-resizer{position:absolute;z-index:4;display:none}.fc-event.fc-allow-mouse-resize .fc-resizer,.fc-event.fc-selected .fc-resizer{display:block}.fc-event.fc-selected .fc-resizer:before{content:"";position:absolute;z-index:9999;top:50%;left:50%;width:40px;height:40px;margin-left:-20px;margin-top:-20px}.fc-event.fc-selected{z-index:9999!important;box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event.fc-selected.fc-dragging{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-h-event.fc-selected:before{content:"";position:absolute;z-index:3;top:-10px;bottom:-10px;left:0;right:0}.fc-ltr .fc-h-event.fc-not-start,.fc-rtl .fc-h-event.fc-not-end{margin-left:0;border-left-width:0;padding-left:1px;border-top-left-radius:0;border-bottom-left-radius:0}.fc-ltr .fc-h-event.fc-not-end,.fc-rtl .fc-h-event.fc-not-start{margin-right:0;border-right-width:0;padding-right:1px;border-top-right-radius:0;border-bottom-right-radius:0}.fc-ltr .fc-h-event .fc-start-resizer,.fc-rtl .fc-h-event .fc-end-resizer{cursor:w-resize;left:-1px}.fc-ltr .fc-h-event .fc-end-resizer,.fc-rtl .fc-h-event .fc-start-resizer{cursor:e-resize;right:-1px}.fc-h-event.fc-allow-mouse-resize .fc-resizer{width:7px;top:-1px;bottom:-1px}.fc-h-event.fc-selected .fc-resizer{border-radius:4px;width:6px;height:6px;background:#fff;top:50%;margin-top:-4px;border:1px solid;border-color:inherit}.fc-ltr .fc-h-event.fc-selected .fc-start-resizer,.fc-rtl .fc-h-event.fc-selected .fc-end-resizer{margin-left:-4px}.fc-ltr .fc-h-event.fc-selected .fc-end-resizer,.fc-rtl .fc-h-event.fc-selected .fc-start-resizer{margin-right:-4px}.fc-day-grid-event{margin:1px 2px 0;padding:0 1px}tr:first-child>td>.fc-day-grid-event{margin-top:2px}.fc-day-grid-event.fc-selected:after{content:"";position:absolute;z-index:1;top:-1px;right:-1px;bottom:-1px;left:-1px;background:#000;opacity:.25}.fc-day-grid-event .fc-content{white-space:nowrap;overflow:hidden}.fc-day-grid-event .fc-time{font-weight:700}.fc-ltr .fc-day-grid-event.fc-allow-mouse-resize .fc-start-resizer,.fc-rtl .fc-day-grid-event.fc-allow-mouse-resize .fc-end-resizer{margin-left:-2px}.fc-ltr .fc-day-grid-event.fc-allow-mouse-resize .fc-end-resizer,.fc-rtl .fc-day-grid-event.fc-allow-mouse-resize .fc-start-resizer{margin-right:-2px}a.fc-more{margin:1px 3px;font-size:.85em;cursor:pointer;text-decoration:none}a.fc-more:hover{text-decoration:underline}.fc-limited{display:none}.fc-day-grid .fc-row{z-index:1}.fc-more-popover{z-index:2;width:220px}.fc-more-popover .fc-event-container{padding:10px}.fc-now-indicator{position:absolute;border:0 solid red}.fc-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent}.fc-unthemed .fc-content,.fc-unthemed .fc-divider,.fc-unthemed .fc-list-heading td,.fc-unthemed .fc-list-view,.fc-unthemed .fc-popover,.fc-unthemed .fc-row,.fc-unthemed tbody,.fc-unthemed td,.fc-unthemed th,.fc-unthemed thead{border-color:#ddd}.fc-unthemed .fc-popover{background-color:#fff;border-width:1px;border-style:solid}.fc-unthemed .fc-divider,.fc-unthemed .fc-list-heading td,.fc-unthemed .fc-popover .fc-header{background:#eee}.fc-unthemed .fc-popover .fc-header .fc-close{color:#666;font-size:.9em;margin-top:2px}.fc-unthemed td.fc-today{background:#fcf8e3}.fc-unthemed .fc-disabled-day{background:#d7d7d7;opacity:.3}.fc-icon{display:inline-block;height:1em;line-height:1em;font-size:1em;text-align:center;overflow:hidden;font-family:"Courier New",Courier,monospace;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.fc-icon:after{position:relative}.fc-icon-left-single-arrow:after{content:"\\2039";font-weight:700;font-size:200%;top:-7%}.fc-icon-right-single-arrow:after{content:"\\203A";font-weight:700;font-size:200%;top:-7%}.fc-icon-left-double-arrow:after{content:"\\AB";font-size:160%;top:-7%}.fc-icon-right-double-arrow:after{content:"\\BB";font-size:160%;top:-7%}.fc-icon-left-triangle:after{content:"\\25C4";font-size:125%;top:3%}.fc-icon-right-triangle:after{content:"\\25BA";font-size:125%;top:3%}.fc-icon-down-triangle:after{content:"\\25BC";font-size:125%;top:2%}.fc-icon-x:after{content:"\\D7";font-size:200%;top:6%}.fc-unthemed .fc-list-item:hover td{background-color:#f5f5f5}.ui-widget .fc-disabled-day{background-image:none}.fc-popover>.ui-widget-header+.ui-widget-content{border-top:0}.ui-widget .fc-event{color:#fff;text-decoration:none;font-weight:400}.ui-widget td.fc-axis{font-weight:400}.fc-time-grid .fc-slats .ui-widget-content{background:0 0}.fc.fc-bootstrap3 a{text-decoration:none}.fc.fc-bootstrap3 a[data-goto]:hover{text-decoration:underline}.fc-bootstrap3 hr.fc-divider{border-color:inherit}.fc-bootstrap3 .fc-today.alert{border-radius:0}.fc-bootstrap3 .fc-popover .panel-body{padding:0}.fc-bootstrap3 .fc-time-grid .fc-slats table{background:0 0}.fc.fc-bootstrap4 a{text-decoration:none}.fc.fc-bootstrap4 a[data-goto]:hover{text-decoration:underline}.fc-bootstrap4 hr.fc-divider{border-color:inherit}.fc-bootstrap4 .fc-today.alert{border-radius:0}.fc-bootstrap4 a.fc-event:not([href]):not([tabindex]){color:#fff}.fc-bootstrap4 .fc-popover.card{position:absolute}.fc-bootstrap4 .fc-popover .card-body{padding:0}.fc-bootstrap4 .fc-time-grid .fc-slats table{background:0 0}.fc-toolbar{text-align:center}.fc-toolbar.fc-header-toolbar{margin-bottom:1em}.fc-toolbar.fc-footer-toolbar{margin-top:1em}.fc-toolbar .fc-left{float:left}.fc-toolbar .fc-right{float:right}.fc-toolbar .fc-center{display:inline-block}.fc .fc-toolbar>*>*{float:left;margin-left:.75em}.fc .fc-toolbar>*>:first-child{margin-left:0}.fc-toolbar h2{margin:0}.fc-toolbar button{position:relative}.fc-toolbar .fc-state-hover,.fc-toolbar .ui-state-hover{z-index:2}.fc-toolbar .fc-state-down{z-index:3}.fc-toolbar .fc-state-active,.fc-toolbar .ui-state-active{z-index:4}.fc-toolbar button:focus{z-index:5}.fc-view-container *,.fc-view-container :after,.fc-view-container :before{box-sizing:content-box}.fc-view,.fc-view>table{position:relative;z-index:1}.fc-basicDay-view .fc-content-skeleton,.fc-basicWeek-view .fc-content-skeleton{padding-bottom:1em}.fc-basic-view .fc-body .fc-row{min-height:4em}.fc-row.fc-rigid{overflow:hidden}.fc-row.fc-rigid .fc-content-skeleton{position:absolute;top:0;left:0;right:0}.fc-day-top.fc-other-month{opacity:.3}.fc-basic-view .fc-day-number,.fc-basic-view .fc-week-number{padding:2px}.fc-basic-view th.fc-day-number,.fc-basic-view th.fc-week-number{padding:0 2px}.fc-ltr .fc-basic-view .fc-day-top .fc-day-number{float:right}.fc-rtl .fc-basic-view .fc-day-top .fc-day-number{float:left}.fc-ltr .fc-basic-view .fc-day-top .fc-week-number{float:left;border-radius:0 0 3px}.fc-rtl .fc-basic-view .fc-day-top .fc-week-number{float:right;border-radius:0 0 0 3px}.fc-basic-view .fc-day-top .fc-week-number{min-width:1.5em;text-align:center;background-color:#f2f2f2;color:grey}.fc-basic-view td.fc-week-number{text-align:center}.fc-basic-view td.fc-week-number>*{display:inline-block;min-width:1.25em}.fc-agenda-view .fc-day-grid{position:relative;z-index:2}.fc-agenda-view .fc-day-grid .fc-row{min-height:3em}.fc-agenda-view .fc-day-grid .fc-row .fc-content-skeleton{padding-bottom:1em}.fc .fc-axis{vertical-align:middle;padding:0 4px;white-space:nowrap}.fc-ltr .fc-axis{text-align:right}.fc-rtl .fc-axis{text-align:left}.fc-time-grid,.fc-time-grid-container{position:relative;z-index:1}.fc-time-grid{min-height:100%}.fc-time-grid table{border:0 hidden transparent}.fc-time-grid>.fc-bg{z-index:1}.fc-time-grid .fc-slats,.fc-time-grid>hr{position:relative;z-index:2}.fc-time-grid .fc-content-col{position:relative}.fc-time-grid .fc-content-skeleton{position:absolute;z-index:3;top:0;left:0;right:0}.fc-time-grid .fc-business-container{position:relative;z-index:1}.fc-time-grid .fc-bgevent-container{position:relative;z-index:2}.fc-time-grid .fc-highlight-container{z-index:3;position:relative}.fc-time-grid .fc-event-container{position:relative;z-index:4}.fc-time-grid .fc-now-indicator-line{z-index:5}.fc-time-grid .fc-helper-container{position:relative;z-index:6}.fc-time-grid .fc-slats td{height:1.5em;border-bottom:0}.fc-time-grid .fc-slats .fc-minor td{border-top-style:dotted}.fc-time-grid .fc-highlight{position:absolute;left:0;right:0}.fc-ltr .fc-time-grid .fc-event-container{margin:0 2.5% 0 2px}.fc-rtl .fc-time-grid .fc-event-container{margin:0 2px 0 2.5%}.fc-time-grid .fc-bgevent,.fc-time-grid .fc-event{position:absolute;z-index:1}.fc-time-grid .fc-bgevent{left:0;right:0}.fc-v-event.fc-not-start{border-top-width:0;padding-top:1px;border-top-left-radius:0;border-top-right-radius:0}.fc-v-event.fc-not-end{border-bottom-width:0;padding-bottom:1px;border-bottom-left-radius:0;border-bottom-right-radius:0}.fc-time-grid-event{overflow:hidden}.fc-time-grid-event.fc-selected{overflow:visible}.fc-time-grid-event.fc-selected .fc-bg{display:none}.fc-time-grid-event .fc-content{overflow:hidden}.fc-time-grid-event .fc-time,.fc-time-grid-event .fc-title{padding:0 1px}.fc-time-grid-event .fc-time{font-size:.85em;white-space:nowrap}.fc-time-grid-event.fc-short .fc-content{white-space:nowrap}.fc-time-grid-event.fc-short .fc-time,.fc-time-grid-event.fc-short .fc-title{display:inline-block;vertical-align:top}.fc-time-grid-event.fc-short .fc-time span{display:none}.fc-time-grid-event.fc-short .fc-time:before{content:attr(data-start)}.fc-time-grid-event.fc-short .fc-time:after{content:"\\A0-\\A0"}.fc-time-grid-event.fc-short .fc-title{font-size:.85em;padding:0}.fc-time-grid-event.fc-allow-mouse-resize .fc-resizer{left:0;right:0;bottom:0;height:8px;overflow:hidden;line-height:8px;font-size:11px;font-family:monospace;text-align:center;cursor:s-resize}.fc-time-grid-event.fc-allow-mouse-resize .fc-resizer:after{content:"="}.fc-time-grid-event.fc-selected .fc-resizer{border-radius:5px;width:8px;height:8px;background:#fff;left:50%;margin-left:-5px;bottom:-5px;border:1px solid;border-color:inherit}.fc-time-grid .fc-now-indicator-line{border-top-width:1px;left:0;right:0}.fc-time-grid .fc-now-indicator-arrow{margin-top:-5px}.fc-ltr .fc-time-grid .fc-now-indicator-arrow{left:0;border-width:5px 0 5px 6px;border-top-color:transparent;border-bottom-color:transparent}.fc-rtl .fc-time-grid .fc-now-indicator-arrow{right:0;border-width:5px 6px 5px 0;border-top-color:transparent;border-bottom-color:transparent}.fc-event-dot{display:inline-block;width:10px;height:10px;border-radius:5px}.fc-rtl .fc-list-view{direction:rtl}.fc-list-view{border-width:1px;border-style:solid}.fc .fc-list-table{table-layout:auto}.fc-list-table td{border-width:1px 0 0;padding:8px 14px}.fc-list-table tr:first-child td{border-top-width:0}.fc-list-heading{border-bottom-width:1px}.fc-list-heading td{font-weight:700}.fc-ltr .fc-list-heading-main{float:left}.fc-ltr .fc-list-heading-alt,.fc-rtl .fc-list-heading-main{float:right}.fc-rtl .fc-list-heading-alt{float:left}.fc-list-item.fc-has-url{cursor:pointer}.fc-list-item-marker,.fc-list-item-time{white-space:nowrap;width:1px}.fc-ltr .fc-list-item-marker{padding-right:0}.fc-rtl .fc-list-item-marker{padding-left:0}.fc-list-item-title a{text-decoration:none;color:inherit}.fc-list-item-title a[href]:hover{text-decoration:underline}.fc-list-empty-wrap2{position:absolute;top:0;left:0;right:0;bottom:0}.fc-list-empty-wrap1{width:100%;height:100%;display:table}.fc-list-empty{display:table-cell;vertical-align:middle;text-align:center}.fc-unthemed .fc-list-empty{background-color:#eee}' ]
            } ]
        } ];
        CalendarComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.AbstractI18nService
            } ];
        };
        CalendarComponent.propDecorators = {
            _calendar: [ {
                type: core.ViewChild,
                args: [ "calendar" ]
            } ],
            _datepicker: [ {
                type: core.ViewChild,
                args: [ "datepicker" ]
            } ]
        };
        return CalendarComponent;
    }(base.StylableComponent);
    var components = [ CalendarComponent ];
    var CalendarModule = function() {
        function CalendarModule() {}
        CalendarModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ core$1.CoreModule, datepicker.DatepickerModule, common.CommonModule, forms.FormsModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return CalendarModule;
    }();
    exports.\u0275a = CalendarComponent;
    exports.\u0275b = registerProps;
    exports.CalendarModule = CalendarModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@angular/forms"), require("@wm/components/input"), require("@wm/components/basic/search"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input/chips", [ "exports", "@angular/common", "@angular/core", "@angular/forms", "@wm/components/input", "@wm/components/basic/search", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.chips = {}), global.ng.common, global.ng.core, global.ng.forms, global.wm.components.input, global.wm.components.basic.search, global.wm.components.base, global.wm.core);
})(this, function(exports, common, core, forms, input, search, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var chipsProps = new Map([ [ "allowonlyselect", base.PROP_BOOLEAN ], [ "autofocus", base.PROP_BOOLEAN ], [ "chipclass", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "compareby", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "dataoptions", base.PROP_ANY ], [ "dataset", __assign({
        value: "Option 1, Option 2, Option 3"
    }, base.PROP_ANY) ], [ "datasource", base.PROP_ANY ], [ "datavalue", base.PROP_ANY ], [ "datavaluesource", base.PROP_ANY ], [ "disabled", base.PROP_BOOLEAN ], [ "displayexpression", base.PROP_STRING ], [ "displayfield", base.PROP_STRING ], [ "displayimagesrc", base.PROP_STRING ], [ "enablereorder", base.PROP_BOOLEAN ], [ "inputposition", __assign({
        value: "last"
    }, base.PROP_STRING) ], [ "inputwidth", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "limit", base.PROP_NUMBER ], [ "loadingdatamsg", __assign({
        value: "Loading items..."
    }, base.PROP_STRING) ], [ "matchmode", base.PROP_STRING ], [ "maxsize", base.PROP_NUMBER ], [ "minchars", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "navsearchbar", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "orderby", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Type here.."
    }, base.PROP_STRING) ], [ "query", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "searchkey", base.PROP_STRING ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showsearchicon", base.PROP_BOOLEAN ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "type", __assign({
        value: "search"
    }, base.PROP_STRING) ], [ "debouncetime", __assign({
        value: 250
    }, base.PROP_NUMBER) ] ]);
    var registerProps = function() {
        base.register("wm-chips", chipsProps);
        base.registerFormWidget(core$1.FormWidgetType.CHIPS, new Map(chipsProps));
    };
    var WIDGET_CONFIG = {
        widgetType: "wm-chips",
        hostClass: "app-chips nav nav-pills list-inline"
    };
    var ChipsComponent = function(_super) {
        __extends(ChipsComponent, _super);
        function ChipsComponent(inj, bindDisplayField, bindDisplayExpr, bindDisplayImgSrc, bindDataField, bindDataSet, bindChipclass) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.bindDisplayField = bindDisplayField;
            _this.bindDisplayExpr = bindDisplayExpr;
            _this.bindDisplayImgSrc = bindDisplayImgSrc;
            _this.bindDataField = bindDataField;
            _this.bindDataSet = bindDataSet;
            _this.bindChipclass = bindChipclass;
            _this.chipsList = [];
            _this.maxSizeReached = "Max size reached";
            _this._unsubscribeDv = false;
            base.styler(_this.nativeElement, _this);
            if (!core$1.isDefined(_this.showsearchicon)) {
                _this.showsearchicon = false;
            }
            _this.multiple = true;
            _this.nextItemIndex = 0;
            _this._debounceUpdateQueryModel = core$1.debounce(function(val) {
                _this.updateQueryModel(val).then(function() {
                    if (_this.bindChipclass) {
                        _.forEach(_this.chipsList, function(item, index) {
                            _this.registerChipItemClass(item, index);
                        });
                    }
                });
            }, 150);
            var datasetSubscription = _this.dataset$.subscribe(function() {
                _this.searchComponent.dataset = _this.dataset;
                _this.nextItemIndex = _this.datasetItems.length;
                _this._debounceUpdateQueryModel(_this.datavalue || _this.toBeProcessedDatavalue);
            });
            _this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
            var datavalueSubscription = _this.datavalue$.subscribe(function(val) {
                if (!_this._unsubscribeDv) {
                    _this.chipsList = [];
                    _this._debounceUpdateQueryModel(val);
                }
            });
            _this.registerDestroyListener(function() {
                return datavalueSubscription.unsubscribe();
            });
            return _this;
        }
        Object.defineProperty(ChipsComponent.prototype, "datasource", {
            get: function() {
                return this._datasource;
            },
            set: function(nv) {
                this._datasource = nv;
                this.searchComponent.datasource = nv;
                this._debounceUpdateQueryModel(this.datavalue || this.toBeProcessedDatavalue);
            },
            enumerable: true,
            configurable: true
        });
        ChipsComponent.prototype.ngOnInit = function() {
            var _this = this;
            _super.prototype.ngOnInit.call(this);
            this.searchComponent.multiple = true;
            this.searchComponent.binddisplayimagesrc = this.bindDisplayImgSrc;
            this.searchComponent.displayimagesrc = this.displayimagesrc;
            this.searchComponent.binddisplaylabel = this.bindDisplayExpr;
            this.searchComponent.displaylabel = this.displayfield;
            this.searchComponent.datafield = this.bindDataField || this.datafield;
            this.searchComponent.binddataset = this.bindDataSet;
            this.searchComponent.dataset = this.dataset;
            this.searchComponent.searchkey = this.searchkey;
            this.searchComponent.limit = this.limit;
            this.searchComponent.debouncetime = this.debouncetime;
            this.searchComponent.matchmode = this.matchmode;
            this.getTransformedData = function(val, isCustom) {
                return _this.searchComponent.getTransformedData([ val ], _this.nextItemIndex++, isCustom);
            };
        };
        ChipsComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            if (this.enablereorder) {
                this.configureDnD();
            }
        };
        ChipsComponent.prototype.registerChipItemClass = function(item, $index) {
            var _this = this;
            if (this.bindChipclass) {
                var watchName = this.widgetId + "_chipItemClass_" + $index;
                core$1.$unwatch(watchName);
                this.registerDestroyListener(core$1.$watch(this.bindChipclass, this.viewParent, {
                    item: item,
                    $index: $index
                }, function(nv, ov) {
                    _this.applyItemClass(base.getConditionalClasses(nv, ov), $index);
                }, watchName));
            }
        };
        ChipsComponent.prototype.applyItemClass = function(val, index) {
            var chipItem = this.nativeElement.querySelectorAll(".chip-item").item(index);
            $(chipItem).removeClass(val.toRemove).addClass(val.toAdd);
        };
        ChipsComponent.prototype.removeDuplicates = function() {
            this.chipsList = base.getUniqObjsByDataField(this.chipsList, this.datafield, this.displayfield || this.displaylabel);
        };
        ChipsComponent.prototype.updateQueryModel = function(data) {
            var _this = this;
            var promises = [];
            if (!data) {
                this.chipsList = [];
                return Promise.resolve();
            }
            var dataValue = _.clone(data);
            var prevChipsList = this.chipsList;
            this.chipsList = [];
            if (this.maxsize && dataValue.length > this.maxsize) {
                this._modelByValue = dataValue = _.slice(dataValue, 0, this.maxsize);
                data = dataValue;
            }
            var searchQuery = [];
            dataValue.forEach(function(val, i) {
                var itemFound = _.find(_this.datasetItems, function(item) {
                    return _.isObject(item.value) ? _.isEqual(item.value, val) : _.toString(item.value) === _.toString(val);
                });
                if (itemFound) {
                    _this.chipsList.push(itemFound);
                } else if (_this.datafield !== base.ALLFIELDS) {
                    searchQuery.push(val);
                } else if (_this.datafield === base.ALLFIELDS) {
                    var dataObj = void 0, isCustom = false;
                    if (!_.isObject(val)) {
                        dataObj = _this.createCustomDataModel(val);
                        isCustom = true;
                        if (dataObj) {
                            data.splice(i, 1, dataObj);
                        }
                    } else {
                        var prevChipObj = prevChipsList.find(function(obj) {
                            return _.isEqual(obj.value, val);
                        });
                        if (prevChipObj) {
                            isCustom = prevChipObj.iscustom;
                        }
                    }
                    dataObj = dataObj || val;
                    var transformedData = _this.getTransformedData(dataObj, isCustom);
                    var chipObj = transformedData[0];
                    if (isCustom) {
                        chipObj.iscustom = isCustom;
                    }
                    _this.chipsList.push(chipObj);
                }
            });
            if (searchQuery.length) {
                promises.push(this.getDefaultModel(searchQuery, this.nextItemIndex).then(function(response) {
                    _this.chipsList = _this.chipsList.concat(response || []);
                    dataValue.forEach(function(val, i) {
                        var isExists = _.find(_this.chipsList, function(obj) {
                            return obj.value.toString() === val.toString();
                        });
                        if (!isExists) {
                            if (_this.allowonlyselect) {
                                var index = data.indexOf(val);
                                if (index > -1) {
                                    data.splice(index, 1);
                                }
                                return;
                            }
                            var transformedData = _this.getTransformedData(val, true);
                            var chipObj = transformedData[0];
                            chipObj.iscustom = true;
                            _this.chipsList.push(chipObj);
                        }
                    });
                }));
            }
            this.resetSearchModel(true);
            return Promise.all(promises).then(function() {
                _this._modelByValue = data;
                _this.removeDuplicates();
                _this.updateMaxSize();
                core$1.$appDigest();
            });
        };
        ChipsComponent.prototype.resetSearchModel = function(defaultQuery) {
            this._unsubscribeDv = true;
            this.searchComponent.clearSearch(undefined, !this.minchars && !defaultQuery);
            this._unsubscribeDv = false;
        };
        ChipsComponent.prototype.onSelect = function($event) {
            if (!this.searchComponent.liElements.length) {
                this.addItem($event);
            }
        };
        ChipsComponent.prototype.addItem = function($event, widget) {
            var searchComponent = widget;
            var allowAdd;
            var chipObj;
            if (searchComponent && core$1.isDefined(searchComponent.datavalue) && searchComponent.queryModel !== "") {
                if (!searchComponent.query || !_.trim(searchComponent.query)) {
                    return;
                }
                chipObj = searchComponent.queryModel;
            } else {
                if (this.allowonlyselect) {
                    return;
                }
                var dataObj = void 0;
                if (this.datafield === base.ALLFIELDS) {
                    if (!_.isObject(this.searchComponent.query) && _.trim(this.searchComponent.query)) {
                        dataObj = this.createCustomDataModel(this.searchComponent.query);
                        if (!dataObj) {
                            this.resetSearchModel();
                            return;
                        }
                    }
                }
                var data = dataObj || _.trim(this.searchComponent.query);
                if (data) {
                    var transformedData = this.getTransformedData(data, true);
                    chipObj = transformedData[0];
                    chipObj.iscustom = true;
                }
            }
            if (!core$1.isDefined(chipObj) || chipObj === "") {
                return;
            }
            allowAdd = this.invokeEventCallback("beforeadd", {
                $event: $event,
                newItem: chipObj
            });
            if (core$1.isDefined(allowAdd) && !core$1.toBoolean(allowAdd)) {
                return;
            }
            if (this.isDuplicate(chipObj)) {
                this.resetSearchModel();
                return;
            }
            this.registerChipItemClass(chipObj, this.chipsList.length);
            this.chipsList.push(chipObj);
            if (!this.datavalue) {
                this._modelByValue = [ chipObj.value ];
            } else {
                this._modelByValue = __spread(this._modelByValue, [ chipObj.value ]);
            }
            this._unsubscribeDv = true;
            this.invokeOnTouched();
            this.invokeOnChange(this._modelByValue, $event || {}, true);
            this.invokeEventCallback("add", {
                $event: $event,
                $item: chipObj
            });
            this.updateMaxSize();
            this.resetSearchModel();
            if ($event && ($event.key === "Enter" || $event.keyCode === 13)) {
                this.stopEvent($event);
            }
        };
        ChipsComponent.prototype.createCustomDataModel = function(val) {
            var key = this.displayfield || (this.datafield !== base.ALLFIELDS ? this.datafield : undefined);
            if (key) {
                var customObj = {};
                customObj[key] = val;
                return customObj;
            }
        };
        ChipsComponent.prototype.isDuplicate = function(item) {
            if (this.datafield === base.ALLFIELDS) {
                return _.findIndex(this.chipsList, {
                    value: item.value
                }) > -1;
            }
            return _.findIndex(this.chipsList, {
                key: item.key
            }) > -1;
        };
        ChipsComponent.prototype.updateMaxSize = function() {
            this.saturate = this.maxsize > 0 && this.chipsList.length === this.maxsize;
        };
        ChipsComponent.prototype.getDefaultModel = function(query, index) {
            this.nextItemIndex++;
            return this.searchComponent.getDataSource(query, true, index).then(function(response) {
                return _.filter(query, function(queryVal) {
                    _.find(response, {
                        value: queryVal
                    });
                });
            });
        };
        ChipsComponent.prototype.handleChipClick = function($event, chip) {
            if (this.readonly) {
                return;
            }
            $event.currentTarget.focus();
            this.invokeEventCallback("chipclick", {
                $event: $event,
                $item: chip
            });
        };
        ChipsComponent.prototype.handleChipFocus = function($event, chip) {
            if (this.readonly) {
                return;
            }
            chip.active = true;
            this.invokeEventCallback("chipselect", {
                $event: $event,
                $item: chip
            });
        };
        ChipsComponent.prototype.stopEvent = function($event) {
            $event.stopPropagation();
            $event.preventDefault();
        };
        ChipsComponent.prototype.onTextDelete = function($event) {
            if (core$1.isAppleProduct) {
                this.onInputClear($event);
            }
        };
        ChipsComponent.prototype.onInputClear = function($event) {
            if (!this.chipsList || !this.chipsList.length || this.searchComponent.query) {
                return;
            }
            this.$element.find("li.chip-item > a.app-chip:last").focus();
            this.stopEvent($event);
        };
        ChipsComponent.prototype.onBackspace = function($event, $item, $index) {
            if (this.readonly) {
                return;
            }
            this.removeItem($event, $item, $index, true);
        };
        ChipsComponent.prototype.onDelete = function($event, $item, $index) {
            if (this.readonly) {
                return;
            }
            this.removeItem($event, $item, $index);
        };
        ChipsComponent.prototype.onArrowLeft = function($item, $index) {
            if (this.readonly) {
                return;
            }
            if (!this.searchComponent.query && !core$1.isDefined($index) && !core$1.isDefined($item)) {
                this.$element.find("li.chip-item > a.app-chip:last").focus();
                return;
            }
            if ($index > 0) {
                this.$element.find("li.chip-item > a.app-chip").get($index - 1).focus();
            } else {
                this.focusSearchBox();
            }
        };
        ChipsComponent.prototype.onArrowRight = function($item, $index) {
            if (this.readonly) {
                return;
            }
            if (!this.searchComponent.query && !core$1.isDefined($index) && !core$1.isDefined($item)) {
                this.$element.find("li.chip-item > a.app-chip:first").focus();
                return;
            }
            if ($index < this.chipsList.length - 1) {
                this.$element.find("li.chip-item > a.app-chip").get($index + 1).focus();
            } else {
                this.focusSearchBox();
            }
        };
        ChipsComponent.prototype.focusSearchBox = function() {
            this.$element.find(".app-chip-input > input.app-textbox").focus();
        };
        ChipsComponent.prototype.removeItem = function($event, item, index, canFocus) {
            var _this = this;
            $event.stopPropagation();
            var indexes = _.isArray(index) ? index : [ index ];
            var focusIndex = _.max(indexes);
            var items = _.reduce(indexes, function(result, i) {
                result.push(_this.chipsList[i]);
                return result;
            }, []);
            var allowRemove = this.invokeEventCallback("beforeremove", {
                $event: $event,
                $item: items.length === 1 ? items[0] : items
            });
            if (core$1.isDefined(allowRemove) && !core$1.toBoolean(allowRemove)) {
                return;
            }
            var prevDatavalue = _.clone(this.datavalue);
            setTimeout(function() {
                var chipsLength = _this.chipsList.length;
                var $chipsList = _this.$element.find("li.chip-item > a.app-chip");
                if (!chipsLength || !canFocus) {
                    _this.focusSearchBox();
                } else if (chipsLength - 1 < focusIndex) {
                    $chipsList.get(chipsLength - 1).focus();
                } else {
                    _this.chipsList[focusIndex].active = true;
                    $chipsList.get(focusIndex).focus();
                }
            });
            var pulledItems = _.pullAt(this.chipsList, indexes);
            pulledItems.forEach(function(datasetItem) {
                _this._modelByValue = _.filter(_this._modelByValue, function(val) {
                    return !(_.isObject(val) ? _.isEqual(val, datasetItem.value) : _.toString(val) === _.toString(datasetItem.value));
                });
            });
            this._unsubscribeDv = false;
            this.invokeOnChange(this._modelByValue, $event, true);
            this.invokeEventCallback("change", {
                $event: $event,
                newVal: this.datavalue,
                oldVal: prevDatavalue
            });
            this.updateMaxSize();
            this.invokeEventCallback("remove", {
                $event: $event,
                $item: items.length === 1 ? items[0] : items
            });
        };
        ChipsComponent.prototype.swapElementsInArray = function(data, newIndex, currentIndex) {
            var draggedItem = _.pullAt(data, currentIndex)[0];
            data.splice(newIndex, 0, draggedItem);
        };
        ChipsComponent.prototype.resetReorder = function() {
            this.$element.removeData("oldIndex");
        };
        ChipsComponent.prototype.invokeOnBeforeServiceCall = function(inputData) {
            this.invokeEventCallback("beforeservicecall", {
                inputData: inputData
            });
        };
        ChipsComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            if (eventName === "remove" || eventName === "beforeremove" || eventName === "chipselect" || eventName === "chipclick" || eventName === "add" || eventName === "reorder" || eventName === "change") {
                return;
            }
            _super.prototype.handleEvent.call(this, node, eventName, eventCallback, locals);
        };
        ChipsComponent.prototype.configureDnD = function() {
            var options = {
                items: "> li:not(.app-chip-search)",
                placeholder: "chip-placeholder"
            };
            base.configureDnD(this.$element, options, this.onReorderStart.bind(this), this.update.bind(this));
        };
        ChipsComponent.prototype.onReorderStart = function(evt, ui) {
            var helper = ui.helper;
            helper.width(helper.width() + 1);
            this.$element.data("oldIndex", ui.item.index() - (this.inputposition === "first" ? 1 : 0));
        };
        ChipsComponent.prototype.update = function($event, ui) {
            var changedItem, newIndex, oldIndex;
            newIndex = ui.item.index() - (this.inputposition === "first" ? 1 : 0);
            oldIndex = this.$element.data("oldIndex");
            newIndex = this.chipsList.length === newIndex ? newIndex - 1 : newIndex;
            changedItem = {
                oldIndex: oldIndex,
                newIndex: newIndex,
                item: this.chipsList[oldIndex]
            };
            if (newIndex === oldIndex) {
                this.resetReorder();
                return;
            }
            changedItem.item = this.chipsList[oldIndex];
            var allowReorder = this.invokeEventCallback("beforereorder", {
                $event: $event,
                $data: this.chipsList,
                $changedItem: changedItem
            });
            if (core$1.isDefined(allowReorder) && core$1.toBoolean(allowReorder) === false) {
                this.resetReorder();
                return;
            }
            this.swapElementsInArray(this.chipsList, newIndex, oldIndex);
            this.swapElementsInArray(this._modelByValue, newIndex, oldIndex);
            changedItem.item = this.chipsList[newIndex];
            this.chipsList = __spread(this.chipsList);
            this.resetReorder();
            this.invokeEventCallback("reorder", {
                $event: $event,
                $data: this.chipsList,
                $changedItem: changedItem
            });
        };
        ChipsComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "tabindex") {
                return;
            }
            if (key === "dataoptions") {
                this.searchComponent.dataoptions = nv;
            }
            if (key === "datafield") {
                this.searchComponent.datafield = this.datafield;
            }
            if (key === "displayfield") {
                this.searchComponent.displaylabel = this.displayfield;
            }
            if (key === "displayexpression") {
                this.searchComponent.binddisplaylabel = this.binddisplayexpression ? this.binddisplayexpression : this.displayexpression;
            }
            if (key === "displayimagesrc") {
                this.searchComponent.binddisplayimagesrc = this.binddisplayimagesrc ? this.binddisplayimagesrc : this.displayimagesrc;
            }
            if (key === "limit") {
                this.searchComponent.limit = this.limit;
            }
            if (key === "matchmode") {
                this.searchComponent.matchmode = this.matchmode;
            }
            if (key === "enablereorder") {
                if (this.$element.hasClass("ui-sortable")) {
                    this.$element.sortable("option", "disabled", !nv);
                } else if (nv) {
                    this.configureDnD();
                }
            }
            if (key === "readonly") {
                if (nv) {
                    this.$element.addClass("readonly");
                } else {
                    this.$element.removeClass("readonly");
                }
            }
            if (key === "inputposition") {
                var $inputEl = this.$element.find("li.app-chip-search");
                if (nv === "first") {
                    this.$element.prepend($inputEl);
                } else {
                    this.$element.append($inputEl);
                }
            }
            if (key === "autofocus" && nv) {
                setTimeout(function() {
                    var $chipsList = _this.$element.find(".app-chip-input > input.app-textbox");
                    if ($chipsList && $chipsList.length) {
                        _this.focusSearchBox();
                    }
                });
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        ChipsComponent.initializeProps = registerProps();
        ChipsComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmChips]",
                template: '<li class="chip-item" role="option" *ngFor="let item of chipsList; let $index = index;"\n    [ngClass]="{\'active\': item.active, \'disabled\': disabled}">\n    <a class="app-chip" href="javascript:void(0);" tabindex="-1"\n       (click)="handleChipClick($event, item)"\n       (keydown.delete)="onDelete($event, item, $index)"\n       (keydown.backspace)="onBackspace($event, item, $index)"\n       (keydown.arrowleft)="onArrowLeft(item, $index)"\n       (keydown.arrowright)="onArrowRight(item, $index)"\n       (focus)="handleChipFocus($event, item)"\n       (blur)="readonly ? 0 : item.active = false"\n       [ngClass]="{\'chip-duplicate bg-danger\': item.isDuplicate, \'chip-picture\': item.imgSrc}">\n        <img data-identifier="img" alt="Chip Image" class="button-image-icon" [src]="item.imgSrc" *ngIf="item.imgSrc"/>\n        <span class="app-chip-title" [textContent]="item.label" [title]="item.label"></span>\n        <button type="button" tabindex="-1" arial-label="Clear Button" class="btn btn-transparent" (click)="removeItem($event, item, $index);" *ngIf="!readonly">\n            <i class="app-icon wi wi-close"></i>\n        </button>\n    </a>\n</li>\n<li class="app-chip-search" [ngClass]="{\'full-width\': inputwidth === \'full\'}">\n    <div #search wmSearch class="app-chip-input"\n         name="app-chip-search"\n         submit.event="addItem($event, widget)"\n         beforeservicecall.event="invokeOnBeforeServiceCall(inputData)"\n         disabled.bind="disabled || readonly || saturate"\n         datafield.bind="datafield"\n         allowonlyselect.bind="allowonlyselect"\n         searchkey.bind="searchkey"\n         orderby.bind="orderby"\n         placeholder.bind="saturate ? maxSizeReached : placeholder"\n         showsearchicon.bind="showsearchicon"\n         tabindex.bind="tabindex"\n         minchars.bind="minchars"\n         debouncetime.bind="debouncetime"\n         matchmode.bind="matchmode"\n         (keydown.enter)="onSelect($event)"\n         (keydown.delete)="onTextDelete($event)"\n         (keydown.backspace)="onInputClear($event)"\n         (keydown.arrowleft)="onArrowLeft()"\n         (keydown.arrowright)="onArrowRight()">\n    </div>\n</li>\n',
                providers: [ base.provideAs(ChipsComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(ChipsComponent) ]
            } ]
        } ];
        ChipsComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "displayfield.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "displayexpression.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "displayimagesrc.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "datafield.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "chipclass.bind" ]
                } ]
            } ];
        };
        ChipsComponent.propDecorators = {
            searchComponent: [ {
                type: core.ViewChild,
                args: [ search.SearchComponent ]
            } ]
        };
        return ChipsComponent;
    }(input.DatasetAwareFormComponent);
    var components = [ ChipsComponent ];
    var ChipsModule = function() {
        function ChipsModule() {}
        ChipsModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, search.SearchModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return ChipsModule;
    }();
    exports.\u0275a = ChipsComponent;
    exports.\u0275b = registerProps;
    exports.ChipsModule = ChipsModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("ngx-color-picker"), require("@angular/core"), require("@angular/forms"), require("@wm/components/input"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input/color-picker", [ "exports", "@angular/common", "ngx-color-picker", "@angular/core", "@angular/forms", "@wm/components/input", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.colorpicker = {}), global.ng.common, global.zef.ngxColorPicker, global.ng.core, global.ng.forms, global.wm.components.input, global.wm.components.base, global.wm.core);
})(this, function(exports, common, ngxColorPicker, core, forms, input, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var colorPickerProps = new Map([ [ "class", base.PROP_STRING ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Select Color"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ] ]);
    var registerProps = function() {
        base.register("wm-colorpicker", colorPickerProps);
        base.registerFormWidget(core$1.FormWidgetType.COLORPICKER, new Map(colorPickerProps));
    };
    var DEFAULT_CLS = "input-group app-colorpicker";
    var WIDGET_CONFIG = {
        widgetType: "wm-colorpicker",
        hostClass: DEFAULT_CLS,
        displayType: "inline-block"
    };
    var ColorPickerComponent = function(_super) {
        __extends(ColorPickerComponent, _super);
        function ColorPickerComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        ColorPickerComponent.prototype.colorPickerToggleChange = function(isOpen) {
            var colorPickerContainer = this.nativeElement.querySelector(".color-picker");
            !isOpen ? core$1.addClass(colorPickerContainer, "hidden") : core$1.removeClass(colorPickerContainer, "hidden");
        };
        ColorPickerComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName !== "change" && eventName !== "blur") {
                _super.prototype.handleEvent.call(this, this.inputEl.nativeElement, eventName, callback, locals);
            }
        };
        ColorPickerComponent.prototype.handleChange = function(newVal) {
            this.invokeOnChange(this.datavalue, {
                type: "change"
            }, this.ngModel.valid);
        };
        ColorPickerComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        ColorPickerComponent.initializeProps = registerProps();
        ColorPickerComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmColorPicker]",
                template: '<input class="form-control app-textbox" aria-label="Enter the color code" aria-haspopup="true" aria-expanded="false"\n       #input\n       focus-target\n       [attr.name]="name"\n       [(colorPicker)]="datavalue"\n       (colorPickerChange)="handleChange($event);"\n       (cpToggleChange)="colorPickerToggleChange($event)"\n       [cpPosition]="\'bottom\'"\n       [attr.placeholder]="placeholder"\n       [disabled]="readonly || disabled"\n       [required]="required"\n       [tabindex]="tabindex"\n       [(ngModel)]="datavalue"\n       (ngModelChange)="handleChange($event);"\n       [ngModelOptions]="{updateOn: \'change\'}"\n       (blur)="invokeOnTouched($event)"\n       [attr.accesskey]="shortcutkey">\n<span class="input-group-addon colorpicker-container">\n    <i class="colored-box" [style.backgroundColor]="datavalue">&nbsp;</i>\n</span>',
                providers: [ base.provideAs(ColorPickerComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(ColorPickerComponent) ]
            } ]
        } ];
        ColorPickerComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        ColorPickerComponent.propDecorators = {
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ],
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input", {
                    read: core.ElementRef
                } ]
            } ]
        };
        return ColorPickerComponent;
    }(input.BaseFormCustomComponent);
    var components = [ ColorPickerComponent ];
    var ColorPickerModule = function() {
        function ColorPickerModule() {}
        ColorPickerModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, ngxColorPicker.ColorPickerModule, forms.FormsModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return ColorPickerModule;
    }();
    exports.\u0275a = ColorPickerComponent;
    exports.\u0275b = registerProps;
    exports.ColorPickerModule = ColorPickerModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/core"), require("@angular/forms"), require("@angular/common"), require("@wm/components/input"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input/currency", [ "exports", "@angular/core", "@angular/forms", "@angular/common", "@wm/components/input", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.currency = {}), global.ng.core, global.ng.forms, global.ng.common, global.wm.components.input, global.wm.components.base, global.wm.core);
})(this, function(exports, core, forms, common, input, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var currencyProps = new Map([ [ "class", base.PROP_STRING ], [ "currency", __assign({
        value: "USD"
    }, base.PROP_STRING) ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "maxvalue", base.PROP_NUMBER ], [ "minvalue", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "placeholder", __assign({
        value: "Enter value"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "step", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ] ]);
    var registerProps = function() {
        base.register("wm-currency", currencyProps);
        base.registerFormWidget(core$1.FormWidgetType.CURRENCY, new Map(currencyProps));
    };
    var DEFAULT_CLS = "input-group app-currency";
    var WIDGET_CONFIG = {
        widgetType: "wm-currency",
        hostClass: DEFAULT_CLS
    };
    var CurrencyComponent = function(_super) {
        __extends(CurrencyComponent, _super);
        function CurrencyComponent(inj, i18nService, decimalPipe) {
            return _super.call(this, inj, WIDGET_CONFIG, i18nService, decimalPipe) || this;
        }
        CurrencyComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "currency") {
                this.currencySymbol = core$1.CURRENCY_INFO[this.currency || "USD"].symbol;
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        CurrencyComponent.initializeProps = registerProps();
        CurrencyComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmCurrency]",
                template: '<span class="input-group-addon" [textContent]="currencySymbol"></span>\n<input class="form-control app-textbox app-currency-input"\n       #input\n       role="input"\n       type="text"\n       focus-target\n       [autofocus]="autofocus"\n       [readonly]="readonly"\n       [disabled]="disabled"\n       [required]="required"\n       [pattern]="regexp"\n       [attr.name]="name"\n       [attr.aria-label]="name"\n       [attr.tabindex]="tabindex"\n       [attr.placeholder]="placeholder"\n       [attr.accesskey]="shortcutkey"\n       [ngModel]="displayValue"\n       [ngModelOptions]="ngModelOptions"\n\n       (blur)="handleBlur($event)"\n       (ngModelChange)="datavalue=$event"\n       (keypress)="validateInputEntry($event)"\n       (keydown.enter)="onEnter($event)"\n       (keydown.ArrowUp)="onArrowPress($event, \'UP\')"\n       (keydown.ArrowDown)="onArrowPress($event, \'DOWN\')">',
                providers: [ base.provideAs(CurrencyComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAs(CurrencyComponent, forms.NG_VALIDATORS, true), base.provideAsWidgetRef(CurrencyComponent) ]
            } ]
        } ];
        CurrencyComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.AbstractI18nService
            }, {
                type: common.DecimalPipe
            } ];
        };
        CurrencyComponent.propDecorators = {
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ],
            inputEl: [ {
                type: core.ViewChild,
                args: [ "input", {
                    read: core.ElementRef
                } ]
            } ]
        };
        return CurrencyComponent;
    }(input.NumberLocale);
    var components = [ CurrencyComponent ];
    var CurrencyModule = function() {
        function CurrencyModule() {}
        CurrencyModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, forms.FormsModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return CurrencyModule;
    }();
    exports.\u0275a = CurrencyComponent;
    exports.\u0275b = registerProps;
    exports.CurrencyModule = CurrencyModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("ngx-bootstrap/dropdown"), require("@wm/components/input"), require("ngx-bootstrap/datepicker"), require("@angular/core"), require("@angular/forms"), require("@angular/platform-browser"), require("ngx-bootstrap/timepicker"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/input/epoch", [ "exports", "@angular/common", "ngx-bootstrap/dropdown", "@wm/components/input", "ngx-bootstrap/datepicker", "@angular/core", "@angular/forms", "@angular/platform-browser", "ngx-bootstrap/timepicker", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.epoch = {}), global.ng.common, global.ngxBootstrap, global.wm.components.input, global.ngxBootstrap, global.ng.core, global.ng.forms, global.ng.platformBrowser, global.ngxBootstrap, global.wm.core, global.wm.components.base);
})(this, function(exports, common, dropdown, input, datepicker, core, forms, platformBrowser, timepicker, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var CURRENT_DATE = "CURRENT_DATE";
    var months = [ "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December" ];
    var DATEPICKER_DROPDOWN_OPTIONS = {
        BUTTON: "button",
        DEFAULT: "default"
    };
    var DATAENTRYMODE_DROPDOWN_OPTIONS = {
        PICKER: "picker",
        DEFAULT: "default"
    };
    var BaseDateTimeComponent = function(_super) {
        __extends(BaseDateTimeComponent, _super);
        function BaseDateTimeComponent(inj, WIDGET_CONFIG) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.useDatapicker = true;
            _this.isReadOnly = false;
            _this._dateOptions = new datepicker.BsDatepickerConfig();
            _this.datePipe = _this.inj.get(base.ToDatePipe);
            return _this;
        }
        BaseDateTimeComponent.prototype.isDropDownDisplayEnabledOnInput = function(dropdownvalue) {
            return dropdownvalue === DATEPICKER_DROPDOWN_OPTIONS.DEFAULT;
        };
        BaseDateTimeComponent.prototype.isDataEntryModeEnabledOnInput = function(dropdownvalue) {
            return dropdownvalue === DATAENTRYMODE_DROPDOWN_OPTIONS.DEFAULT;
        };
        BaseDateTimeComponent.prototype.showValidation = function($event, displayValue, isNativePicker, msg) {
            if (isNativePicker) {
                console.warn("min max date validation failed ", msg);
                return $($event.target).val(displayValue);
            }
        };
        BaseDateTimeComponent.prototype.resetDisplayInput = function() {
            $(this.nativeElement).find(".display-input").val("");
        };
        BaseDateTimeComponent.prototype.validate = function() {
            if (this.invalidDateTimeFormat) {
                this.validateType = "";
                return {
                    invalidDateTimeFormat: {
                        valid: false
                    }
                };
            }
            if (!_.isUndefined(this.dateNotInRange) && this.dateNotInRange) {
                return {
                    dateNotInRange: {
                        valid: false
                    }
                };
            }
            if (!_.isUndefined(this.timeNotInRange) && this.timeNotInRange) {
                return {
                    timeNotInRange: {
                        valid: false
                    }
                };
            }
            this.validateType = "";
            return null;
        };
        BaseDateTimeComponent.prototype.formatValidation = function(newVal, inputVal, isNativePicker) {
            var pattern = this.datepattern || this.timepattern;
            var formattedDate = core$1.getFormattedDate(this.datePipe, newVal, pattern);
            inputVal = inputVal.trim();
            if (inputVal) {
                if (pattern === "timestamp") {
                    if (!_.isNaN(inputVal) && _.parseInt(inputVal) !== formattedDate) {
                        this.invalidDateTimeFormat = true;
                        this.invokeOnChange(this.datavalue, undefined, false);
                        return false;
                    }
                } else {
                    if (isNativePicker) {
                        inputVal = core$1.getFormattedDate(this.datePipe, inputVal, pattern);
                    }
                    if (inputVal !== formattedDate) {
                        this.invalidDateTimeFormat = true;
                        this.invokeOnChange(this.datavalue, undefined, false);
                        return false;
                    }
                }
            }
            return true;
        };
        BaseDateTimeComponent.prototype.minDateMaxDateValidationOnInput = function(newVal, $event, displayValue, isNativePicker) {
            var _this = this;
            if (newVal) {
                newVal = moment(newVal).startOf("day").toDate();
                var minDate = moment(core$1.getDateObj(this.mindate)).startOf("day").toDate();
                var maxDate = moment(core$1.getDateObj(this.maxdate)).startOf("day").toDate();
                if (this.mindate && newVal < minDate) {
                    var msg = this.appLocale.LABEL_MINDATE_VALIDATION_MESSAGE + " " + this.mindate + ".";
                    this.dateNotInRange = true;
                    this.validateType = "mindate";
                    this.invokeOnChange(this.datavalue, undefined, false);
                    return this.showValidation($event, displayValue, isNativePicker, msg);
                }
                if (this.maxdate && newVal > maxDate) {
                    var msg = this.appLocale.LABEL_MAXDATE_VALIDATION_MESSAGE + " " + this.maxdate + ".";
                    this.dateNotInRange = true;
                    this.validateType = "maxdate";
                    this.invokeOnChange(this.datavalue, undefined, false);
                    return this.showValidation($event, displayValue, isNativePicker, msg);
                }
                if (this.excludedates) {
                    var excludeDatesArray = void 0;
                    if (core$1.isString(this.excludedates)) {
                        excludeDatesArray = _.split(this.excludedates, ",");
                    } else {
                        excludeDatesArray = this.excludedates;
                    }
                    excludeDatesArray = excludeDatesArray.map(function(d) {
                        return core$1.getFormattedDate(_this.datePipe, d, _this.datepattern);
                    });
                    if (excludeDatesArray.indexOf(core$1.getFormattedDate(this.datePipe, newVal, this.datepattern)) > -1) {
                        this.dateNotInRange = true;
                        this.validateType = "excludedates";
                        this.invokeOnChange(this.datavalue, undefined, false);
                        return;
                    }
                }
                if (this.excludedays) {
                    var excludeDaysArray = _.split(this.excludedays, ",");
                    if (excludeDaysArray.indexOf(newVal.getDay().toString()) > -1) {
                        this.dateNotInRange = true;
                        this.validateType = "excludedays";
                        this.invokeOnChange(this.datavalue, undefined, false);
                        return;
                    }
                }
            }
            if (!isNativePicker) {
                this.dateNotInRange = false;
                this.invokeOnChange(this.datavalue, undefined, false);
            }
        };
        BaseDateTimeComponent.prototype.hightlightToday = function() {
            var toDay = new Date().getDate().toString();
            _.filter($("span:contains(" + toDay + ")").not(".is-other-month"), function(obj) {
                if ($(obj).text() === toDay) {
                    $(obj).addClass("current-date text-info");
                }
            });
        };
        BaseDateTimeComponent.prototype.isOtheryear = function(newDate) {
            return newDate.getMonth() === 0 && this.activeDate.getMonth() === 11 || newDate.getMonth() === 11 && this.activeDate.getMonth() === 0;
        };
        BaseDateTimeComponent.prototype.setActiveDateFocus = function(newDate, isMouseEvent) {
            var _this = this;
            var activeMonth = this.activeDate.getMonth();
            if (!isMouseEvent) {
                if (newDate.getMonth() < activeMonth) {
                    this.isOtheryear(newDate) ? this.goToOtherMonthOryear("next", "days") : this.goToOtherMonthOryear("previous", "days");
                } else if (newDate.getMonth() > activeMonth) {
                    this.isOtheryear(newDate) ? this.goToOtherMonthOryear("previous", "days") : this.goToOtherMonthOryear("next", "days");
                }
            }
            setTimeout(function() {
                if (newDate.getMonth() === new Date().getMonth() && newDate.getFullYear() === new Date().getFullYear()) {
                    _this.hightlightToday();
                }
                var newDay = newDate.getDate().toString();
                _.filter($("span:contains(" + newDay + ")").not(".is-other-month"), function(obj) {
                    if ($(obj).text() === newDay) {
                        $(obj).focus();
                        _this.activeDate = newDate;
                    }
                });
            });
        };
        BaseDateTimeComponent.prototype.goToOtherMonthOryear = function(btnClass, timePeriod) {
            var $node = $(".bs-datepicker-head ." + btnClass);
            if ($node.attr("disabled")) {
                return;
            }
            $node.trigger("click");
            if (timePeriod === "days") {
                this.loadDays();
            } else if (timePeriod === "month") {
                this.loadMonths();
            } else if (timePeriod === "year") {
                this.loadYears();
            }
        };
        BaseDateTimeComponent.prototype.addDatepickerMouseEvents = function() {
            var _this = this;
            var datePikcerHead = $(".bs-datepicker-head");
            datePikcerHead.find(".previous").click(function(event) {
                if (event.originalEvent) {
                    _this.setFocusForDate(-1);
                }
            });
            datePikcerHead.find(".next").click(function(event) {
                if (event.originalEvent) {
                    _this.setFocusForDate(1);
                }
            });
            datePikcerHead.find(".current").click(function(event) {
                if (event.originalEvent) {
                    _this.setFocusForCurrentMonthOryear();
                }
            });
            $(".bs-datepicker-body").click(function(event) {
                event.stopPropagation();
                if (event.originalEvent) {
                    _this.setFocusForMonthOrDay();
                }
            });
        };
        BaseDateTimeComponent.prototype.setFocusForMonthOrDay = function() {
            var activeMonthOrYear = $(".bs-datepicker-head .current").first().text();
            var datePickerBody = $(".bs-datepicker-body");
            if (datePickerBody.find("table.months").length > 0) {
                if (_.parseInt(activeMonthOrYear) !== this.activeDate.getFullYear()) {
                    this.loadMonths();
                }
                var newDate = new Date(_.parseInt(activeMonthOrYear), this.activeDate.getMonth(), this.activeDate.getDate());
                this.setActiveMonthFocus(newDate, true);
            } else if (datePickerBody.find("table.days").length > 0) {
                var newMonth = months.indexOf(activeMonthOrYear);
                if (newMonth !== this.activeDate.getMonth()) {
                    this.loadDays();
                }
                var newDate = new Date(this.activeDate.getFullYear(), newMonth, 1);
                this.setActiveDateFocus(newDate, true);
            }
        };
        BaseDateTimeComponent.prototype.setFocusForCurrentMonthOryear = function() {
            var datePickerBody = $(".bs-datepicker-body");
            if (datePickerBody.find("table.months").length > 0) {
                this.loadMonths();
                this.setActiveMonthFocus(this.activeDate, true);
            } else if (datePickerBody.find("table.years").length > 0) {
                this.loadYears();
                this.setActiveYearFocus(this.activeDate, true);
            }
        };
        BaseDateTimeComponent.prototype.setFocusForDate = function(count) {
            var datePickerBody = $(".bs-datepicker-body");
            if (datePickerBody.find("table.months").length > 0) {
                this.loadMonths();
                var newDate = new Date(this.activeDate.getFullYear() + count, 0, this.activeDate.getDate());
                this.setActiveMonthFocus(newDate, true);
            } else if (datePickerBody.find("table.years").length > 0) {
                this.loadYears();
                var startYear = datePickerBody.find("table.years span").first().text();
                var newDate = new Date(_.parseInt(startYear), this.activeDate.getMonth(), this.activeDate.getDate());
                this.setActiveYearFocus(newDate, true);
            } else if (datePickerBody.find("table.days").length > 0) {
                this.loadDays();
                var newDate = new Date(this.activeDate.getFullYear(), this.activeDate.getMonth() + count, 1);
                this.setActiveDateFocus(newDate, true);
            }
        };
        BaseDateTimeComponent.prototype.addDatepickerKeyboardEvents = function(scope, isDateTime) {
            var _this = this;
            this.keyEventPluginInstance = scope.keyEventPlugin.constructor;
            this.elementScope = scope;
            var dateContainer = document.querySelector("." + scope.dateContainerCls);
            core$1.setAttr(dateContainer, "tabindex", "0");
            dateContainer.onkeydown = function(event) {
                var action = _this.keyEventPluginInstance.getEventFullKey(event);
                if (action === "shift.tab" || action === "escape" || action === "tab" && !isDateTime) {
                    _this.elementScope.hideDatepickerDropdown();
                    var displayInputElem_1 = _this.elementScope.nativeElement.querySelector(".display-input");
                    setTimeout(function() {
                        return displayInputElem_1.focus();
                    });
                }
                if (action === "tab" && isDateTime) {
                    _this.bsDatePickerDirective.hide();
                    _this.elementScope.toggleTimePicker(true);
                }
            };
            this.loadDays();
            this.setActiveDateFocus(this.activeDate);
        };
        BaseDateTimeComponent.prototype.loadDays = function() {
            var _this = this;
            setTimeout(function() {
                $(".bs-datepicker-body").attr("tabindex", "0");
                $("[bsdatepickerdaydecorator]").not(".is-other-month").attr("tabindex", "0");
                _this.addKeyBoardEventsForDays();
                _this.addDatepickerMouseEvents();
            });
        };
        BaseDateTimeComponent.prototype.addKeyBoardEventsForDays = function() {
            var _this = this;
            var datePickerBody = $(".bs-datepicker-body");
            if (datePickerBody.length > 0) {
                datePickerBody[0].addEventListener("mouseenter", function(event) {
                    event.stopPropagation();
                }, true);
            }
            datePickerBody.keydown(function(event) {
                var action = _this.keyEventPluginInstance.getEventFullKey(event);
                var newdate;
                if (action === "arrowdown") {
                    event.preventDefault();
                    newdate = moment(_this.activeDate).add(+7, "days").toDate();
                    _this.setActiveDateFocus(newdate);
                } else if (action === "arrowup") {
                    event.preventDefault();
                    newdate = moment(_this.activeDate).add(-7, "days").toDate();
                    _this.setActiveDateFocus(newdate);
                } else if (action === "arrowleft") {
                    newdate = moment(_this.activeDate).add(-1, "days").toDate();
                    _this.setActiveDateFocus(newdate);
                } else if (action === "arrowright") {
                    newdate = moment(_this.activeDate).add(+1, "days").toDate();
                    _this.setActiveDateFocus(newdate);
                } else if (action === "control.arrowup") {
                    $(".bs-datepicker-head .current").first().click();
                    _this.loadMonths();
                    _this.setActiveMonthFocus(_this.activeDate);
                } else if (action === "enter") {
                    if ($(document.activeElement).hasClass("disabled")) {
                        return;
                    }
                    $(document.activeElement).click();
                    _this.elementScope.hideDatepickerDropdown();
                    var displayInputElem_2 = _this.elementScope.nativeElement.querySelector(".display-input");
                    setTimeout(function() {
                        return displayInputElem_2.focus();
                    });
                }
            });
        };
        BaseDateTimeComponent.prototype.loadMonths = function() {
            var _this = this;
            setTimeout(function() {
                var datePickerBody = $(".bs-datepicker-body");
                datePickerBody.attr("tabindex", "0");
                datePickerBody.find("table.months span").attr("tabindex", "0");
                _this.addKeyBoardEventsForMonths();
                _this.addDatepickerMouseEvents();
            });
        };
        BaseDateTimeComponent.prototype.addKeyBoardEventsForMonths = function() {
            var _this = this;
            $(".bs-datepicker-body").keydown(function(event) {
                var action = _this.keyEventPluginInstance.getEventFullKey(event);
                var newdate;
                if (action === "arrowdown") {
                    event.preventDefault();
                    newdate = moment(_this.activeDate).add(+3, "month").toDate();
                    _this.setActiveMonthFocus(newdate);
                } else if (action === "arrowup") {
                    event.preventDefault();
                    newdate = moment(_this.activeDate).add(-3, "month").toDate();
                    _this.setActiveMonthFocus(newdate);
                } else if (action === "arrowleft") {
                    newdate = moment(_this.activeDate).add(-1, "month").toDate();
                    _this.setActiveMonthFocus(newdate);
                } else if (action === "arrowright") {
                    newdate = moment(_this.activeDate).add(+1, "month").toDate();
                    _this.setActiveMonthFocus(newdate);
                } else if (action === "control.arrowup") {
                    $(".bs-datepicker-head .current").first().click();
                    _this.loadYears();
                    _this.setActiveYearFocus(_this.activeDate);
                } else if (action === "control.arrowdown" || action === "enter") {
                    if ($(document.activeElement).parent().hasClass("disabled")) {
                        return;
                    }
                    $(document.activeElement).click();
                    _this.loadDays();
                    var newDate = new Date(_this.activeDate.getFullYear(), _this.activeDate.getMonth(), 1);
                    _this.setActiveDateFocus(newDate);
                }
            });
        };
        BaseDateTimeComponent.prototype.loadYears = function() {
            var _this = this;
            setTimeout(function() {
                var datePickerBody = $(".bs-datepicker-body");
                datePickerBody.attr("tabindex", "0");
                datePickerBody.find("table.years span").attr("tabindex", "0");
                _this.addKeyBoardEventsForYears();
                _this.addDatepickerMouseEvents();
            });
        };
        BaseDateTimeComponent.prototype.setActiveMonthFocus = function(newDate, isMoouseEvent) {
            var _this = this;
            var newMonth = months[newDate.getMonth()];
            if (!isMoouseEvent) {
                if (newDate.getFullYear() < this.activeDate.getFullYear()) {
                    this.goToOtherMonthOryear("previous", "month");
                } else if (newDate.getFullYear() > this.activeDate.getFullYear()) {
                    this.goToOtherMonthOryear("next", "month");
                }
            }
            setTimeout(function() {
                $(".bs-datepicker-body table.months span:contains(" + newMonth + ")").focus();
                _this.activeDate = newDate;
            });
        };
        BaseDateTimeComponent.prototype.addKeyBoardEventsForYears = function() {
            var _this = this;
            $(".bs-datepicker-body").keydown(function(event) {
                var action = _this.keyEventPluginInstance.getEventFullKey(event);
                var newdate;
                if (action === "arrowdown") {
                    event.preventDefault();
                    newdate = moment(_this.activeDate).add(+4, "year").toDate();
                    _this.setActiveYearFocus(newdate);
                } else if (action === "arrowup") {
                    event.preventDefault();
                    newdate = moment(_this.activeDate).add(-4, "year").toDate();
                    _this.setActiveYearFocus(newdate);
                } else if (action === "arrowleft") {
                    newdate = moment(_this.activeDate).add(-1, "year").toDate();
                    _this.setActiveYearFocus(newdate);
                } else if (action === "arrowright") {
                    newdate = moment(_this.activeDate).add(+1, "year").toDate();
                    _this.setActiveYearFocus(newdate);
                } else if (action === "control.arrowdown" || action === "enter") {
                    if ($(document.activeElement).parent().hasClass("disabled")) {
                        return;
                    }
                    $(document.activeElement).click();
                    _this.loadMonths();
                    _this.setActiveMonthFocus(_this.activeDate);
                }
            });
        };
        BaseDateTimeComponent.prototype.setActiveYearFocus = function(newDate, isMouseEvent) {
            var _this = this;
            var newYear = newDate.getFullYear();
            var datePickerYears = $(".bs-datepicker-body table.years span");
            var startYear = datePickerYears.first().text();
            var endYear = datePickerYears.last().text();
            if (!isMouseEvent) {
                if (newDate.getFullYear() < _.parseInt(startYear)) {
                    this.goToOtherMonthOryear("previous", "year");
                } else if (newDate.getFullYear() > _.parseInt(endYear)) {
                    this.goToOtherMonthOryear("next", "year");
                }
            }
            setTimeout(function() {
                $(".bs-datepicker-body table.years span:contains(" + newYear + ")").focus();
                _this.activeDate = newDate;
            });
        };
        BaseDateTimeComponent.prototype.focusTimePickerPopover = function(scope) {
            this.keyEventPluginInstance = scope.keyEventPlugin.constructor;
            this.elementScope = scope;
            this.elementScope.ngZone.runOutsideAngular(function() {
                setTimeout(function() {
                    $("timepicker .form-group:first > input.form-control").focus();
                });
            });
        };
        BaseDateTimeComponent.prototype.bindTimePickerKeyboardEvents = function() {
            var _this = this;
            setTimeout(function() {
                var $timepickerPopup = $("body").find("> bs-dropdown-container timepicker");
                $timepickerPopup.attr("tabindex", 0);
                _this.addEventsOnTimePicker($timepickerPopup);
            });
        };
        BaseDateTimeComponent.prototype.isValidDate = function(date) {
            return date && date instanceof Date && !isNaN(date.getTime());
        };
        BaseDateTimeComponent.prototype.timeFormatValidation = function() {
            var enteredDate = $(this.nativeElement).find("input").val();
            var newVal = core$1.getNativeDateObject(enteredDate);
            if (!this.formatValidation(newVal, enteredDate)) {
                return;
            }
            this.invalidDateTimeFormat = false;
            this.invokeOnChange(this.datavalue, undefined, false);
        };
        BaseDateTimeComponent.prototype.addEventsOnTimePicker = function($el) {
            var _this = this;
            $el.on("keydown", function(evt) {
                var $target = $(evt.target);
                var $parent = $target.parent();
                var elementScope = _this.elementScope;
                var action = _this.keyEventPluginInstance.getEventFullKey(evt);
                var stopPropogation, preventDefault;
                if (action === "escape") {
                    elementScope.hideTimepickerDropdown();
                }
                if ($target.hasClass("bs-timepicker-field")) {
                    if ($parent.is(":first-child")) {
                        if (action === "shift.tab" || action === "enter" || action === "escape") {
                            elementScope.setIsTimeOpen(false);
                            _this.focus();
                            stopPropogation = true;
                            preventDefault = true;
                        }
                    } else if ($parent.is(":last-child") || $parent.next().next().find("button.disabled").length) {
                        if (action === "tab" || action === "escape" || action === "enter") {
                            elementScope.setIsTimeOpen(false);
                            _this.focus();
                            stopPropogation = true;
                            preventDefault = true;
                        }
                    } else {
                        if (action === "enter" || action === "escape") {
                            elementScope.setIsTimeOpen(false);
                            _this.focus();
                            stopPropogation = true;
                            preventDefault = true;
                        }
                    }
                    if (stopPropogation) {
                        evt.stopPropagation();
                    }
                    if (preventDefault) {
                        evt.preventDefault();
                    }
                    if (elementScope.mintime && elementScope.maxtime && !_this.isValidDate(elementScope.bsTimeValue)) {
                        if (action === "arrowdown") {
                            elementScope.bsTimeValue = elementScope.maxTime;
                        } else if (action === "arrowup") {
                            elementScope.bsTimeValue = elementScope.minTime;
                        }
                    }
                    if (action === "tab") {
                        _this.invalidDateTimeFormat = false;
                        _this.invokeOnChange(_this.datavalue, undefined, false);
                        var pattern = _this.datepattern || _this.timepattern;
                        if (core$1.getFormattedDate(elementScope.datePipe, elementScope.bsTimeValue, pattern) === elementScope.displayValue) {
                            $(_this.nativeElement).find(".display-input").val(elementScope.displayValue);
                        }
                    }
                    if (action === "arrowdown" || action === "arrowup") {
                        _this.timeFormatValidation();
                    }
                } else if ($target.hasClass("btn-default")) {
                    if (action === "tab" || action === "escape") {
                        elementScope.setIsTimeOpen(false);
                        _this.focus();
                    }
                }
            });
            $el.find("a").on("click", function(evt) {
                var elementScope = _this.elementScope;
                var $target = $(evt.target);
                if (elementScope.mintime && elementScope.maxtime && !_this.isValidDate(elementScope.bsTimeValue)) {
                    if ($target.find("span").hasClass("bs-chevron-down")) {
                        elementScope.bsTimeValue = elementScope.maxTime;
                    } else if ($target.find("span").hasClass("bs-chevron-up")) {
                        elementScope.bsTimeValue = elementScope.minTime;
                    }
                }
                _this.timeFormatValidation();
            });
        };
        BaseDateTimeComponent.prototype.updateFormat = function(pattern) {
            if (pattern === "datepattern") {
                this._dateOptions.dateInputFormat = this.datepattern;
                this.showseconds = _.includes(this.datepattern, "s");
                this.ismeridian = _.includes(this.datepattern, "h");
            } else if (pattern === "timepattern") {
                this.showseconds = _.includes(this.timepattern, "s");
                this.ismeridian = _.includes(this.timepattern, "h");
            }
        };
        BaseDateTimeComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (this.useDatapicker && key === "datepattern") {
                this.updateFormat(key);
            } else if (key === "showweeks") {
                this._dateOptions.showWeekNumbers = nv;
            } else if (key === "mindate") {
                this._dateOptions.minDate = nv === CURRENT_DATE ? this.mindate = new Date() : core$1.getDateObj(nv);
                this.minDateMaxDateValidationOnInput(this.datavalue);
            } else if (key === "maxdate") {
                this._dateOptions.maxDate = nv === CURRENT_DATE ? this.maxdate = new Date() : core$1.getDateObj(nv);
                this.minDateMaxDateValidationOnInput(this.datavalue);
            } else if (key === "excludedates" || key === "excludedays") {
                this.minDateMaxDateValidationOnInput(this.datavalue);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        BaseDateTimeComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            this.isReadOnly = this.dataentrymode != "undefined" && !this.isDataEntryModeEnabledOnInput(this.dataentrymode);
            if (this.bsDatePickerDirective) {
                this.dateOnShowSubscription = this.bsDatePickerDirective.onShown.subscribe(function(cal) {
                    cal.daysCalendar.subscribe(function(data) {
                        var excludedDates;
                        if (_this.excludedates) {
                            if (core$1.isString(_this.excludedates)) {
                                excludedDates = _.split(_this.excludedates, ",");
                            } else {
                                excludedDates = _this.excludedates;
                            }
                            excludedDates = excludedDates.map(function(d) {
                                return moment(d);
                            });
                        }
                        data[0].weeks.forEach(function(week) {
                            week.days.forEach(function(day) {
                                if (!day.isDisabled && _this.excludedays) {
                                    day.isDisabled = _.includes(_this.excludedays, day.dayIndex);
                                }
                                if (!day.isDisabled && excludedDates) {
                                    var md_1 = moment(day.date);
                                    day.isDisabled = excludedDates.some(function(ed) {
                                        return md_1.isSame(ed, "day");
                                    });
                                }
                            });
                        });
                    });
                });
            }
        };
        BaseDateTimeComponent.prototype.ngOnDestroy = function() {
            if (this.dateOnShowSubscription) {
                this.dateOnShowSubscription.unsubscribe();
            }
            _super.prototype.ngOnDestroy.call(this);
        };
        BaseDateTimeComponent.propDecorators = {
            bsDropdown: [ {
                type: core.ViewChild,
                args: [ dropdown.BsDropdownDirective ]
            } ]
        };
        return BaseDateTimeComponent;
    }(input.BaseFormCustomComponent);
    var dateProps = new Map([ [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "dataentrymode", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "datepattern", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "excludedays", base.PROP_STRING ], [ "excludedates", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "maxdate", base.PROP_STRING ], [ "mindate", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "outputformat", __assign({
        value: "yyyy-MM-dd"
    }, base.PROP_STRING) ], [ "placeholder", __assign({
        value: "Select Date"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showdropdownon", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "showbuttonbar", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showindevice", __assign({
        displayType: "inline-block",
        value: "all"
    }, base.PROP_STRING) ], [ "showweeks", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ] ]);
    var registerProps = function() {
        if (core$1.isMobileApp()) {
            dateProps.set("datepattern", __assign({
                value: "yyyy-MM-dd"
            }, base.PROP_STRING));
        }
        base.register("wm-date", dateProps);
        base.registerFormWidget(core$1.FormWidgetType.DATE, new Map(dateProps));
    };
    var CURRENT_DATE$1 = "CURRENT_DATE";
    var DEFAULT_CLS = "app-date input-group";
    var WIDGET_CONFIG = {
        widgetType: "wm-date",
        hostClass: DEFAULT_CLS
    };
    var DateComponent = function(_super) {
        __extends(DateComponent, _super);
        function DateComponent(inj, cdRef, appDefaults, evtMngrPlugins) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.cdRef = cdRef;
            _this.appDefaults = appDefaults;
            _this.isEnterPressedOnDateInput = false;
            base.styler(_this.nativeElement, _this);
            _this.keyEventPlugin = evtMngrPlugins[1];
            _this.dateContainerCls = "app-date-" + _this.widgetId;
            _this._dateOptions.containerClass = "app-date " + _this.dateContainerCls;
            _this._dateOptions.showWeekNumbers = false;
            _this.datepattern = _this.appDefaults.dateFormat || core$1.getDisplayDateTimeFormat(core$1.FormWidgetType.DATE);
            _this.updateFormat("datepattern");
            return _this;
        }
        Object.defineProperty(DateComponent.prototype, "timestamp", {
            get: function() {
                return this.bsDataValue ? this.bsDataValue.valueOf() : undefined;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateComponent.prototype, "displayValue", {
            get: function() {
                return core$1.getFormattedDate(this.datePipe, this.bsDataValue, this._dateOptions.dateInputFormat) || "";
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateComponent.prototype, "datavalue", {
            get: function() {
                return core$1.getFormattedDate(this.datePipe, this.bsDataValue, this.outputformat) || "";
            },
            set: function(newVal) {
                if (newVal === CURRENT_DATE$1) {
                    this.bsDataValue = new Date();
                } else {
                    this.bsDataValue = newVal ? core$1.getDateObj(newVal) : undefined;
                }
                this.invokeOnChange(this.datavalue, undefined, true);
                this.cdRef.detectChanges();
            },
            enumerable: true,
            configurable: true
        });
        DateComponent.prototype.onDisplayDateChange = function($event, isNativePicker) {
            if (this.isEnterPressedOnDateInput) {
                this.isEnterPressedOnDateInput = false;
                return;
            }
            var newVal = core$1.getDateObj($event.target.value);
            if (!this.formatValidation(newVal, $event.target.value, isNativePicker)) {
                return;
            }
            if (isNativePicker && this.minDateMaxDateValidationOnInput(newVal, $event, this.displayValue, isNativePicker)) {
                return;
            }
            this.setDataValue(newVal);
        };
        DateComponent.prototype.setDataValue = function(newVal) {
            this.invalidDateTimeFormat = false;
            this.minDateMaxDateValidationOnInput(newVal);
            if (core$1.getFormattedDate(this.datePipe, newVal, this._dateOptions.dateInputFormat) === this.displayValue) {
                $(this.nativeElement).find(".app-dateinput").val(this.displayValue);
            }
            if (newVal) {
                this.bsDataValue = newVal;
            } else {
                this.bsDataValue = undefined;
            }
            this.invokeOnChange(this.datavalue, {}, true);
        };
        DateComponent.prototype.onDatePickerOpen = function() {
            this.isOpen = true;
            this.bsDataValue ? this.activeDate = this.bsDataValue : this.activeDate = new Date();
            if (!this.bsDataValue) {
                this.hightlightToday();
            }
            this.addDatepickerKeyboardEvents(this, false);
            core$1.adjustContainerPosition($("bs-datepicker-container"), this.nativeElement, this.bsDatePickerDirective._datepicker);
        };
        DateComponent.prototype.onInputBlur = function($event) {
            if (!$($event.relatedTarget).hasClass("current-date")) {
                this.invokeOnTouched();
                this.invokeEventCallback("blur", {
                    $event: $event
                });
            }
        };
        DateComponent.prototype.hideDatepickerDropdown = function() {
            this.invokeOnTouched();
            this.isOpen = false;
            this.isEnterPressedOnDateInput = false;
            if (this.deregisterEventListener) {
                this.deregisterEventListener();
            }
        };
        DateComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (!_.includes([ "blur", "focus", "change", "click" ], eventName)) {
                _super.prototype.handleEvent.call(this, node, eventName, callback, locals);
            }
        };
        DateComponent.prototype.toggleDpDropdown = function($event) {
            if ($event.type === "click") {
                this.invokeEventCallback("click", {
                    $event: $event
                });
            }
            if ($event.target && $($event.target).is("input") && !this.isDropDownDisplayEnabledOnInput(this.showdropdownon)) {
                $event.stopPropagation();
                return;
            }
            this.bsDatePickerDirective.toggle();
            this.addBodyClickListener(this.bsDatePickerDirective.isOpen);
        };
        DateComponent.prototype.addBodyClickListener = function(skipListener) {
            var _this = this;
            if (!skipListener) {
                return;
            }
            var bodyElement = document.querySelector("body");
            setTimeout(function() {
                var bsDateContainerElement = bodyElement.querySelector("." + _this.dateContainerCls);
                _this.deregisterEventListener = core$1.addEventListenerOnElement(bodyElement, bsDateContainerElement, _this.nativeElement, "click", _this.isDropDownDisplayEnabledOnInput(_this.showdropdownon), function() {
                    _this.isOpen = false;
                }, 0, true);
            }, 350);
        };
        DateComponent.prototype.onDisplayKeydown = function(event) {
            if (this.isDropDownDisplayEnabledOnInput(this.showdropdownon)) {
                event.stopPropagation();
                var newVal = core$1.getDateObj(event.target.value);
                var action = this.keyEventPlugin.constructor.getEventFullKey(event);
                if (action === "enter" || action === "arrowdown") {
                    event.preventDefault();
                    var formattedDate = core$1.getFormattedDate(this.datePipe, newVal, this._dateOptions.dateInputFormat);
                    var inputVal = event.target.value.trim();
                    if (inputVal && this.datepattern === "timestamp") {
                        if (!_.isNaN(inputVal) && _.parseInt(inputVal) !== formattedDate) {
                            this.invalidDateTimeFormat = true;
                            this.invokeOnChange(this.datavalue, event, false);
                        }
                    } else if (inputVal && inputVal !== formattedDate) {
                        this.invalidDateTimeFormat = true;
                        this.invokeOnChange(this.datavalue, event, false);
                    } else {
                        this.invalidDateTimeFormat = false;
                        this.isEnterPressedOnDateInput = true;
                        this.bsDatePickerDirective.bsValue = newVal;
                    }
                    this.toggleDpDropdown(event);
                } else {
                    this.hideDatepickerDropdown();
                }
            } else {
                this.hideDatepickerDropdown();
            }
        };
        DateComponent.prototype.onDateChange = function(newVal) {
            var displayInputElem = this.nativeElement.querySelector(".display-input");
            if (this.isOpen) {
                setTimeout(function() {
                    return displayInputElem.focus();
                });
            }
            this.setDataValue(newVal);
        };
        DateComponent.initializeProps = registerProps();
        DateComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmDate]",
                template: '<ng-container *ngIf="useDatapicker; then dataPickerTemplate else nativeDateTemplate"></ng-container>\n<ng-template #dataPickerTemplate>\n    <input class="form-control app-textbox app-dateinput display-input" aria-label="Select date"\n           focus-target\n           type="text"\n           [name]="name"\n           [tabindex]="tabindex"\n           [value]="displayValue"\n           (click)="toggleDpDropdown($event)"\n           (focus)="invokeOnFocus($event)"\n           (blur)="onInputBlur($event)"\n           [disabled]="disabled || readonly"\n           [autofocus]="autofocus"\n           [required]="required"\n           [readOnly]="isReadOnly"\n           [attr.placeholder]="placeholder"\n           [attr.accesskey]="shortcutkey"\n           (change)="onDisplayDateChange($event)"\n           (keydown)="onDisplayKeydown($event)">\n    <div style="width: 0;display: inline-block;" aria-label="datepicker dropdownmenu" aria-controls="date">\n        <input class="model-holder"\n               container="body"\n               [bsConfig]="_dateOptions"\n               [isOpen]="isOpen"\n               #datepicker="bsDatepicker"\n               bsDatepicker\n               [isDisabled]="disabled || readonly"\n               [bsValue]="bsDataValue"\n               (onShown)="onDatePickerOpen()"\n               (onHidden)="hideDatepickerDropdown()"\n               (bsValueChange)="onDateChange($event)">\n    </div>\n    <span class="input-group-btn">\n            <button type="button" class="btn btn-default btn-time" [tabindex]="tabindex" [disabled]="disabled || readonly"\n                    aria-label="Select date" aria-haspopup="true" aria-expanded="false"\n                    (click)="toggleDpDropdown($event)">\n                <i aria-hidden="true" class="app-icon wi wi-calendar"></i>\n            </button>\n    </span>\n</ng-template>\n<ng-template #nativeDateTemplate>\n    <input type="date" class="form-control app-textbox app-dateinput"\n           role="input"\n           step="any"\n           [value]="displayValue"\n           [required]="required"\n           [disabled]="disabled || readonly"\n           (change)="onDisplayDateChange($event, true)"\n           (focus)="invokeOnFocus($event)"\n           (blur)="invokeOnTouched($event)">\n</ng-template>\n',
                providers: [ base.provideAs(DateComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAs(DateComponent, forms.NG_VALIDATORS, true), base.provideAsWidgetRef(DateComponent) ]
            } ]
        } ];
        DateComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.ChangeDetectorRef
            }, {
                type: core$1.AppDefaults
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Inject,
                    args: [ platformBrowser.EVENT_MANAGER_PLUGINS ]
                } ]
            } ];
        };
        DateComponent.propDecorators = {
            bsDatePickerDirective: [ {
                type: core.ViewChild,
                args: [ datepicker.BsDatepickerDirective ]
            } ]
        };
        return DateComponent;
    }(BaseDateTimeComponent);
    var dateTimeProps = new Map([ [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "dataentrymode", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "datepattern", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "excludedays", base.PROP_STRING ], [ "excludedates", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "hourstep", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "maxdate", base.PROP_STRING ], [ "mindate", base.PROP_STRING ], [ "minutestep", __assign({
        value: 15
    }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "outputformat", __assign({
        value: "timestamp"
    }, base.PROP_STRING) ], [ "placeholder", __assign({
        value: "Select date time"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "secondsstep", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showdropdownon", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "showbuttonbar", base.PROP_BOOLEAN ], [ "showindevice", __assign({
        displayType: "inline-block",
        value: "all"
    }, base.PROP_STRING) ], [ "showweeks", base.PROP_BOOLEAN ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "timestamp", base.PROP_STRING ] ]);
    var registerProps$1 = function() {
        if (core$1.isMobileApp()) {
            dateTimeProps.set("datepattern", __assign({
                value: "yyyy-MM-ddTHH:mm:ss"
            }, base.PROP_STRING));
        }
        base.register("wm-datetime", dateTimeProps);
        base.registerFormWidget(core$1.FormWidgetType.DATETIME, new Map(dateTimeProps));
        base.registerFormWidget(core$1.FormWidgetType.TIMESTAMP, new Map(dateTimeProps));
    };
    var DEFAULT_CLS$1 = "app-datetime input-group";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-datetime",
        hostClass: DEFAULT_CLS$1
    };
    var CURRENT_DATE$2 = "CURRENT_DATE";
    var DatetimeComponent = function(_super) {
        __extends(DatetimeComponent, _super);
        function DatetimeComponent(inj, ngZone, cdRef, appDefaults, evtMngrPlugins) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            _this.ngZone = ngZone;
            _this.cdRef = cdRef;
            _this.appDefaults = appDefaults;
            _this.isEnterPressedOnDateInput = false;
            _this.isTimeOpen = false;
            _this.isDateOpen = false;
            _this.isCurrentDate = false;
            _this._debouncedOnChange = _.debounce(_this.invokeOnChange, 10);
            _this.registerDestroyListener(function() {
                return _this.clearTimeInterval();
            });
            base.styler(_this.nativeElement, _this);
            _this.keyEventPlugin = evtMngrPlugins[1];
            _this.dateContainerCls = "app-date-" + _this.widgetId;
            _this._dateOptions.containerClass = "app-date " + _this.dateContainerCls;
            _this._dateOptions.showWeekNumbers = false;
            _this.datepattern = _this.appDefaults.dateTimeFormat || core$1.getDisplayDateTimeFormat(core$1.FormWidgetType.DATETIME);
            _this.updateFormat("datepattern");
            return _this;
        }
        Object.defineProperty(DatetimeComponent.prototype, "timestamp", {
            get: function() {
                return this.proxyModel ? this.proxyModel.valueOf() : undefined;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DatetimeComponent.prototype, "displayValue", {
            get: function() {
                return core$1.getFormattedDate(this.datePipe, this.proxyModel, this._dateOptions.dateInputFormat) || "";
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DatetimeComponent.prototype, "datavalue", {
            get: function() {
                if (this.isCurrentDate && !this.proxyModel) {
                    return CURRENT_DATE$2;
                }
                return core$1.getFormattedDate(this.datePipe, this.proxyModel, this.outputformat);
            },
            set: function(newVal) {
                if (newVal === CURRENT_DATE$2) {
                    this.isCurrentDate = true;
                    this.setTimeInterval();
                } else {
                    this.proxyModel = newVal ? core$1.getDateObj(newVal) : undefined;
                    this.clearTimeInterval();
                    this.isCurrentDate = false;
                }
                this.bsTimeValue = this.bsDateValue = this.proxyModel;
                this.cdRef.detectChanges();
            },
            enumerable: true,
            configurable: true
        });
        DatetimeComponent.prototype.setTimeInterval = function() {
            var _this = this;
            if (this.timeinterval) {
                return;
            }
            this.timeinterval = setInterval(function() {
                var currentTime = new Date();
                _this.onModelUpdate(currentTime);
            }, 1e3);
        };
        DatetimeComponent.prototype.clearTimeInterval = function() {
            if (this.timeinterval) {
                clearInterval(this.timeinterval);
                this.timeinterval = null;
            }
        };
        DatetimeComponent.prototype.toggleTimePicker = function(newVal, $event) {
            this.isTimeOpen = newVal;
            if ($event && $event.type === "click") {
                this.invokeEventCallback("click", {
                    $event: $event
                });
            }
            this.addTimepickerClickListener(this.isTimeOpen);
        };
        DatetimeComponent.prototype.addTimepickerClickListener = function(skipListener) {
            var _this = this;
            if (!skipListener) {
                return;
            }
            var bodyElement = document.querySelector("body");
            setTimeout(function() {
                var dropdownElement = $(bodyElement).find(">bs-dropdown-container .dropdown-menu").get(0);
                _this.deregisterTimepickeEventListener = core$1.addEventListenerOnElement(bodyElement, dropdownElement, _this.nativeElement, "click", _this.isDropDownDisplayEnabledOnInput(_this.showdropdownon), function() {
                    _this.toggleTimePicker(false);
                }, 0, true);
            }, 350);
        };
        DatetimeComponent.prototype.setIsTimeOpen = function(val) {
            this.isTimeOpen = val;
        };
        DatetimeComponent.prototype.hideTimepickerDropdown = function() {
            this.invokeOnTouched();
            this.toggleTimePicker(false);
            if (this.deregisterTimepickeEventListener) {
                this.deregisterTimepickeEventListener();
            }
        };
        DatetimeComponent.prototype.onTimepickerOpen = function() {
            var tpElements = document.querySelectorAll("timepicker");
            _.forEach(tpElements, function(element) {
                core$1.addClass(element.parentElement, "app-datetime", true);
            });
            this.bsDatePickerDirective.hide();
            this.focusTimePickerPopover(this);
            this.bindTimePickerKeyboardEvents();
            core$1.adjustContainerPosition($("bs-dropdown-container"), this.nativeElement, this.bsDropdown._dropdown, $("bs-dropdown-container .dropdown-menu"));
        };
        DatetimeComponent.prototype.onDatePickerOpen = function() {
            this.isDateOpen = !this.isDateOpen;
            this.toggleTimePicker(false);
            this.bsDateValue ? this.activeDate = this.bsDateValue : this.activeDate = new Date();
            if (!this.bsDateValue) {
                this.hightlightToday();
            }
            this.addDatepickerKeyboardEvents(this, true);
            core$1.adjustContainerPosition($("bs-datepicker-container"), this.nativeElement, this.bsDatePickerDirective._datepicker);
        };
        DatetimeComponent.prototype.onModelUpdate = function(newVal, type) {
            if (type === "date") {
                this.invalidDateTimeFormat = false;
                if (core$1.getFormattedDate(this.datePipe, newVal, this._dateOptions.dateInputFormat) === this.displayValue) {
                    $(this.nativeElement).find(".display-input").val(this.displayValue);
                }
            }
            this.minDateMaxDateValidationOnInput(newVal);
            if (!newVal) {
                if (this.bsDateValue && this.bsTimePicker && (this.bsTimePicker.hours === "" || this.bsTimePicker.minutes === "" || this.bsTimePicker.seconds === "")) {
                    this.bsDateValue = this.bsTimeValue = this.proxyModel = moment(this.bsDateValue).startOf("day").toDate();
                } else {
                    this.bsDateValue = this.bsTimeValue = this.proxyModel = undefined;
                }
                this._debouncedOnChange(this.datavalue, {}, true);
                return;
            }
            if (type === "date") {
                if (this.isDateOpen) {
                    this.toggleTimePicker(true);
                }
            }
            this.proxyModel = newVal;
            if (this.proxyModel) {
                this.bsDateValue = this.bsTimeValue = this.proxyModel;
            }
            this._debouncedOnChange(this.datavalue, {}, true);
            this.cdRef.detectChanges();
        };
        DatetimeComponent.prototype.preventTpClose = function($event) {
            $event.stopImmediatePropagation();
        };
        DatetimeComponent.prototype.toggleDpDropdown = function($event) {
            if ($event.type === "click") {
                this.invokeEventCallback("click", {
                    $event: $event
                });
            }
            if ($event.target && $($event.target).is("input") && !this.isDropDownDisplayEnabledOnInput(this.showdropdownon)) {
                $event.stopPropagation();
                return;
            }
            this.bsDatePickerDirective.toggle();
            this.addBodyClickListener(this.bsDatePickerDirective.isOpen);
        };
        DatetimeComponent.prototype.addBodyClickListener = function(skipListener) {
            var _this = this;
            if (!skipListener) {
                return;
            }
            var bodyElement = document.querySelector("body");
            setTimeout(function() {
                var bsDateContainerElement = bodyElement.querySelector("." + _this.dateContainerCls);
                _this.deregisterDatepickerEventListener = core$1.addEventListenerOnElement(bodyElement, bsDateContainerElement, _this.nativeElement, "click", _this.isDropDownDisplayEnabledOnInput(_this.showdropdownon), function() {
                    _this.bsDatePickerDirective.hide();
                }, 0, true);
            }, 350);
        };
        DatetimeComponent.prototype.hideDatepickerDropdown = function() {
            this.isDateOpen = false;
            this.invokeOnTouched();
            this.bsDatePickerDirective.hide();
            this.isEnterPressedOnDateInput = false;
            if (this.deregisterDatepickerEventListener) {
                this.deregisterDatepickerEventListener();
            }
        };
        DatetimeComponent.prototype.onDateChange = function($event, isNativePicker) {
            if (this.isEnterPressedOnDateInput) {
                this.isEnterPressedOnDateInput = false;
                return;
            }
            var newVal = $event.target.value.trim();
            newVal = newVal ? core$1.getNativeDateObject(newVal) : undefined;
            if (!this.formatValidation(newVal, $event.target.value, isNativePicker)) {
                return;
            }
            if (isNativePicker && this.minDateMaxDateValidationOnInput(newVal, $event, this.displayValue, isNativePicker)) {
                return;
            }
            this.invalidDateTimeFormat = false;
            this.onModelUpdate(newVal);
        };
        DatetimeComponent.prototype.onDisplayKeydown = function(event) {
            if (this.isDropDownDisplayEnabledOnInput(this.showdropdownon)) {
                event.stopPropagation();
                var newVal = event.target.value.trim();
                newVal = newVal ? core$1.getNativeDateObject(newVal) : undefined;
                var action = this.keyEventPlugin.constructor.getEventFullKey(event);
                if (action === "enter" || action === "arrowdown") {
                    event.preventDefault();
                    var formattedDate = core$1.getFormattedDate(this.datePipe, newVal, this._dateOptions.dateInputFormat);
                    var inputVal = event.target.value.trim();
                    if (inputVal && this.datepattern === "timestamp") {
                        if (!_.isNaN(inputVal) && _.parseInt(inputVal) !== formattedDate) {
                            this.invalidDateTimeFormat = true;
                            this.invokeOnChange(this.datavalue, event, false);
                        }
                    } else if (inputVal && inputVal !== formattedDate) {
                        this.invalidDateTimeFormat = true;
                        this.invokeOnChange(this.datavalue, event, false);
                    } else {
                        this.invalidDateTimeFormat = false;
                        this.isEnterPressedOnDateInput = true;
                        this.bsDatePickerDirective.bsValue = newVal;
                    }
                    this.toggleDpDropdown(event);
                } else {
                    this.hideDatepickerDropdown();
                    this.hideTimepickerDropdown();
                }
            } else {
                this.hideDatepickerDropdown();
                this.hideTimepickerDropdown();
            }
        };
        DatetimeComponent.prototype.isValid = function(event) {
            if (!event) {
                var enteredDate = $(this.nativeElement).find("input").val();
                var newVal = core$1.getNativeDateObject(enteredDate);
                if (!this.formatValidation(newVal, enteredDate)) {
                    return;
                }
            }
        };
        DatetimeComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (!_.includes([ "blur", "focus", "change", "click" ], eventName)) {
                _super.prototype.handleEvent.call(this, node, eventName, callback, locals);
            }
        };
        DatetimeComponent.prototype.onInputBlur = function($event) {
            if (!$($event.relatedTarget).hasClass("current-date")) {
                this.invokeOnTouched();
                this.invokeEventCallback("blur", {
                    $event: $event
                });
            }
        };
        DatetimeComponent.initializeProps = registerProps$1();
        DatetimeComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmDateTime]",
                template: '<ng-container *ngIf="useDatapicker; then dataPickerTemplate else nativeDateTemplate"></ng-container>\n\n<ng-template #dataPickerTemplate>\n    <div dropdown [isOpen]="isTimeOpen" autoClose="false" [container]="\'body\'" (onShown)="onTimepickerOpen()"\n         style="display: inherit;">\n        <input class="form-control app-textbox display-input" aria-label="Set the date and time"\n               focus-target\n               [name]="name"\n               [tabindex]="tabindex"\n               type="text"\n               [value]="displayValue"\n               (click)="toggleDpDropdown($event)"\n               (focus)="invokeOnFocus($event)"\n               (blur)="onInputBlur($event)"\n               (change)="onDateChange($event)"\n               [autofocus]="autofocus"\n               [disabled]="disabled || readonly || isCurrentDate"\n               [required]="required"\n               [readOnly]="isReadOnly"\n               [attr.placeholder]="placeholder"\n               [attr.accesskey]="shortcutkey"\n               (keydown)="onDisplayKeydown($event)">\n        <div style="width: 0;display: inline-block;" aria-label="datepicker dropdownmenu" aria-controls="date">\n            <input class="model-holder"\n                   focus-target\n                   [container]="\'body\'"\n                   [bsConfig]="_dateOptions"\n                   [isOpen]="isDateOpen"\n                   (onShown)="onDatePickerOpen()"\n                   (onHidden)="hideDatepickerDropdown()"\n                   #datepicker=bsDatepicker\n                   bsDatepicker\n                   [isDisabled]="disabled || readonly || isCurrentDate"\n                   [bsValue]="bsDateValue"\n                   (bsValueChange)="onModelUpdate($event, \'date\')">\n        </div>\n        <span class="input-group-btn">\n            <button type="button" class="btn btn-default btn-date"\n                    [tabindex]="tabindex" [disabled]="disabled || readonly || isCurrentDate" aria-label="Select date" aria-haspopup="true"\n                    aria-expanded="false" (click)="toggleDpDropdown($event)">\n                <i aria-hidden="true" class="app-icon wi wi-calendar"></i>\n            </button>\n            <button type="button" class="btn btn-default btn-time"\n                    [tabindex]="tabindex" [disabled]="disabled || readonly || isCurrentDate" aria-label="Select time" aria-haspopup="true"\n                    aria-expanded="false" (click)="toggleTimePicker(!isTimeOpen, $event)">\n                <i aria-hidden="true" class="app-icon wi wi-access-time"></i>\n            </button>\n        </span>\n        <div *dropdownMenu class="dropdown-menu" aria-label="timepicker dropdown" aria-controls="time"\n             (click)="preventTpClose($event)">\n            <timepicker class="model-holder"\n                        [showMeridian]="ismeridian"\n                        [readonlyInput]="disabled || readonly || isCurrentDate"\n                        [(ngModel)]="bsTimeValue"\n                        [min]="minTime"\n                        [max]="maxTime"\n                        [hourStep]="hourstep"\n                        [minuteStep]="minutestep"\n                        [secondsStep]="secondsstep"\n                        [mousewheel]="true"\n                        [arrowkeys]="true"\n                        (isValid)="isValid($event)"\n                        [showSeconds]="showseconds" (ngModelChange)="onModelUpdate($event, \'time\')"></timepicker>\n        </div>\n    </div>\n</ng-template>\n<ng-template #nativeDateTemplate>\n    <input type="datetime-local" class="form-control app-textbox"\n           role="input"\n           step="any"\n           [value]="displayValue"\n           [required]="required"\n           [disabled]="disabled || readonly || isCurrentDate"\n           (change)="onDateChange($event, true)">\n</ng-template>\n',
                providers: [ base.provideAs(DatetimeComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAs(DatetimeComponent, forms.NG_VALIDATORS, true), base.provideAsWidgetRef(DatetimeComponent) ]
            } ]
        } ];
        DatetimeComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.NgZone
            }, {
                type: core.ChangeDetectorRef
            }, {
                type: core$1.AppDefaults
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Inject,
                    args: [ platformBrowser.EVENT_MANAGER_PLUGINS ]
                } ]
            } ];
        };
        DatetimeComponent.propDecorators = {
            bsDatePickerDirective: [ {
                type: core.ViewChild,
                args: [ datepicker.BsDatepickerDirective ]
            } ],
            bsTimePicker: [ {
                type: core.ViewChild,
                args: [ timepicker.TimepickerComponent ]
            } ]
        };
        return DatetimeComponent;
    }(BaseDateTimeComponent);
    var timeProps = new Map([ [ "autofocus", base.PROP_BOOLEAN ], [ "class", base.PROP_STRING ], [ "dataentrymode", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "hourstep", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "maxtime", base.PROP_STRING ], [ "mintime", base.PROP_STRING ], [ "minutestep", __assign({
        value: 15
    }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "outputformat", __assign({
        value: "HH:mm:ss"
    }, base.PROP_STRING) ], [ "placeholder", __assign({
        value: "Select time"
    }, base.PROP_STRING) ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showdropdownon", __assign({
        value: "default"
    }, base.PROP_STRING) ], [ "secondsstep", __assign({
        value: 1
    }, base.PROP_NUMBER) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "timepattern", base.PROP_STRING ], [ "timestamp", base.PROP_STRING ] ]);
    var registerProps$2 = function() {
        if (core$1.isMobileApp()) {
            timeProps.set("timepattern", __assign({
                value: "HH:mm"
            }, base.PROP_STRING));
        }
        base.register("wm-time", timeProps);
        base.registerFormWidget(core$1.FormWidgetType.TIME, new Map(timeProps));
    };
    var CURRENT_TIME = "CURRENT_TIME";
    var DEFAULT_CLS$2 = "input-group app-timeinput";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-time",
        hostClass: DEFAULT_CLS$2
    };
    var TimeComponent = function(_super) {
        __extends(TimeComponent, _super);
        function TimeComponent(inj, ngZone, appDefaults, evtMngrPlugins) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            _this.ngZone = ngZone;
            _this.appDefaults = appDefaults;
            _this.status = {
                isopen: false
            };
            _this.keyEventPlugin = evtMngrPlugins[1];
            base.styler(_this.nativeElement, _this);
            _this.registerDestroyListener(function() {
                return _this.clearTimeInterval();
            });
            _this.timepattern = _this.appDefaults.timeFormat || core$1.getDisplayDateTimeFormat(core$1.FormWidgetType.TIME);
            _this.updateFormat("timepattern");
            return _this;
        }
        Object.defineProperty(TimeComponent.prototype, "timestamp", {
            get: function() {
                return this.bsTimeValue ? this.bsTimeValue.valueOf() : undefined;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TimeComponent.prototype, "datavalue", {
            get: function() {
                if (this.isCurrentTime && !this.bsTimeValue) {
                    return CURRENT_TIME;
                }
                return core$1.getFormattedDate(this.datePipe, this.bsTimeValue, this.outputformat) || "";
            },
            set: function(newVal) {
                if (newVal) {
                    if (newVal === CURRENT_TIME) {
                        this.isCurrentTime = true;
                        this.setTimeInterval();
                    } else {
                        this.clearTimeInterval();
                        this.bsTimeValue = core$1.getNativeDateObject(newVal);
                        this.isCurrentTime = false;
                    }
                } else {
                    this.bsTimeValue = undefined;
                    this.clearTimeInterval();
                    this.isCurrentTime = false;
                }
                this.invokeOnChange(this.datavalue);
                core$1.$appDigest();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TimeComponent.prototype, "displayValue", {
            get: function() {
                return core$1.getFormattedDate(this.datePipe, this.bsTimeValue, this.timepattern) || "";
            },
            enumerable: true,
            configurable: true
        });
        TimeComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "timepattern") {
                this.updateFormat("timepattern");
            }
            if (key === "mintime") {
                this.minTime = core$1.getNativeDateObject(nv);
                this.mintimeMaxtimeValidation();
            } else if (key === "maxtime") {
                this.maxTime = core$1.getNativeDateObject(nv);
                this.mintimeMaxtimeValidation();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        TimeComponent.prototype.setValidateType = function(min, max, val) {
            if (this.timeNotInRange) {
                if (val < min) {
                    this.validateType = "mintime";
                } else if (val > max) {
                    this.validateType = "maxtime";
                }
            }
        };
        TimeComponent.prototype.mintimeMaxtimeValidation = function() {
            this.timeNotInRange = this.minTime && this.maxTime && (this.bsTimeValue < this.minTime || this.bsTimeValue > this.maxTime);
            this.setValidateType(this.minTime, this.maxTime, this.bsTimeValue);
            this.invokeOnChange(this.datavalue, undefined, false);
        };
        TimeComponent.prototype.toggleDropdown = function($event) {
            var _this = this;
            if ($event.type === "click") {
                this.invokeEventCallback("click", {
                    $event: $event
                });
            }
            if ($event.target && $($event.target).is("input") && !this.isDropDownDisplayEnabledOnInput(this.showdropdownon)) {
                return;
            }
            this.ngZone.run(function() {
                _this.status.isopen = !_this.status.isopen;
            });
            this.addBodyClickListener(this.status.isopen);
        };
        TimeComponent.prototype.preventTpClose = function($event) {
            $event.stopImmediatePropagation();
        };
        TimeComponent.prototype.addBodyClickListener = function(skipListener) {
            var _this = this;
            if (!skipListener) {
                return;
            }
            var bodyElement = document.querySelector("body");
            setTimeout(function() {
                var dropdownElement = $(bodyElement).find(">bs-dropdown-container .dropdown-menu").get(0);
                _this.deregisterEventListener = core$1.addEventListenerOnElement(bodyElement, dropdownElement, _this.nativeElement, "click", _this.isDropDownDisplayEnabledOnInput(_this.showdropdownon), function() {
                    _this.status.isopen = false;
                }, 0, true);
            }, 350);
        };
        TimeComponent.prototype.onDisplayKeydown = function(event) {
            if (this.isDropDownDisplayEnabledOnInput(this.showdropdownon)) {
                event.stopPropagation();
                var action = this.keyEventPlugin.constructor.getEventFullKey(event);
                if (action === "enter" || action === "arrowdown") {
                    event.preventDefault();
                    this.toggleDropdown(event);
                } else {
                    this.hideTimepickerDropdown();
                }
            } else {
                this.hideTimepickerDropdown();
            }
        };
        TimeComponent.prototype.onDisplayTimeChange = function($event) {
            var newVal = core$1.getNativeDateObject($event.target.value);
            if (!this.formatValidation(newVal, $event.target.value)) {
                return;
            }
            this.invalidDateTimeFormat = false;
            this.onTimeChange(newVal);
        };
        TimeComponent.prototype.onInputBlur = function($event) {
            if (!$($event.relatedTarget).hasClass("bs-timepicker-field")) {
                this.invokeOnTouched();
                this.invokeEventCallback("blur", {
                    $event: $event
                });
            }
        };
        TimeComponent.prototype.onTimeChange = function(newVal, isNativePicker) {
            var timeValue, timeInputValue, minTimeMeridian, maxTimeMeridian;
            if (isNativePicker) {
                newVal = core$1.getNativeDateObject(newVal.target.value);
            }
            if (newVal) {
                this.bsTimeValue = newVal;
                this.timeNotInRange = this.minTime && this.maxTime && (newVal < this.minTime || newVal > this.maxTime);
                this.setValidateType(this.minTime, this.maxTime, newVal);
            } else {
                if (this.bsTimePicker && this.bsTimePicker.min && this.bsTimePicker.max) {
                    minTimeMeridian = moment(new Date(this.bsTimePicker.min)).format("A");
                    maxTimeMeridian = moment(new Date(this.bsTimePicker.max)).format("A");
                    timeValue = this.bsTimePicker.hours + ":" + (this.bsTimePicker.minutes || 0) + ":" + (this.bsTimePicker.seconds || 0) + (this.bsTimePicker.showMeridian ? " " + minTimeMeridian : "");
                    timeInputValue = core$1.getNativeDateObject(timeValue);
                    this.bsTimePicker.meridian = minTimeMeridian;
                    this.timeNotInRange = this.bsTimePicker.min > timeInputValue || this.bsTimePicker.max < timeInputValue;
                    this.setValidateType(this.bsTimePicker.min, this.bsTimePicker.max, timeInputValue);
                }
                this.bsTimeValue = timeInputValue;
            }
            this.invokeOnTouched();
            this.invokeOnChange(this.datavalue, {}, true);
        };
        TimeComponent.prototype.setTimeInterval = function() {
            var _this = this;
            if (this.timeinterval) {
                return;
            }
            this.timeinterval = setInterval(function() {
                var now = new Date();
                now.setSeconds(now.getSeconds() + 1);
                _this.datavalue = CURRENT_TIME;
                _this.onTimeChange(now);
            }, 1e3);
        };
        TimeComponent.prototype.clearTimeInterval = function() {
            if (this.timeinterval) {
                clearInterval(this.timeinterval);
                this.timeinterval = null;
            }
        };
        TimeComponent.prototype.setIsTimeOpen = function(val) {
            this.status.isopen = val;
        };
        TimeComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            if (!_.includes([ "blur", "focus", "change", "click" ], eventName)) {
                _super.prototype.handleEvent.call(this, node, eventName, eventCallback, locals);
            }
        };
        TimeComponent.prototype.hideTimepickerDropdown = function() {
            this.invokeOnTouched();
            this.status.isopen = false;
            if (this.deregisterEventListener) {
                this.deregisterEventListener();
            }
        };
        TimeComponent.prototype.isValid = function(event) {
            if (!event) {
                var enteredDate = $(this.nativeElement).find("input").val();
                var newVal = core$1.getNativeDateObject(enteredDate);
                if (!this.formatValidation(newVal, enteredDate)) {
                    return;
                }
            }
        };
        TimeComponent.prototype.onShown = function() {
            var tpElements = document.querySelectorAll("timepicker");
            _.forEach(tpElements, function(element) {
                core$1.addClass(element.parentElement, "app-datetime", true);
            });
            this.focusTimePickerPopover(this);
            this.bindTimePickerKeyboardEvents();
            core$1.adjustContainerPosition($("bs-dropdown-container"), this.nativeElement, this.bsDropdown._dropdown, $("bs-dropdown-container .dropdown-menu"));
        };
        TimeComponent.initializeProps = registerProps$2();
        TimeComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmTime]",
                template: '<ng-container *ngIf="useDatapicker; then timePickerTemplate else nativeTimeTemplate">\n</ng-container>\n\n<ng-template #timePickerTemplate>\n    <div dropdown [isOpen]="status.isopen" (onShown)="onShown()" (onHidden)="hideTimepickerDropdown()" container="body" style="display: inherit">\n        <input class="form-control app-textbox display-input" aria-label="Set the time"\n               focus-target\n               [tabindex]="tabindex"\n               [name]="name"\n               type="text"\n               [value]="displayValue"\n               [disabled]="disabled || readonly || isCurrentTime"\n               [autofocus]="autofocus"\n               [required]="required"\n               [attr.placeholder]="placeholder"\n               [attr.accesskey]="shortcutkey"\n               [required]="required"\n               [readOnly]="isReadOnly"\n               (click)="toggleDropdown($event)"\n               (focus)="invokeOnFocus($event)"\n               (blur)="onInputBlur($event)"\n               (change)="onDisplayTimeChange($event)"\n               (keydown)="onDisplayKeydown($event)">\n        <span class="input-group-btn dropdown-toggle">\n          <button type="button" class="btn btn-default btn-date" [tabindex]="tabindex" [disabled]="disabled || readonly || isCurrentTime" aria-label="Select time" aria-haspopup="true" aria-expanded="false" (click)="toggleDropdown($event)"><i aria-hidden="true" class="app-icon wi wi-access-time"></i></button>\n        </span>\n        <div *dropdownMenu class="dropdown-menu" (click)="preventTpClose($event)">\n            <timepicker class="model-holder"\n                        [showMeridian]="ismeridian"\n                        [readonlyInput]="isDisabled"\n                        [(ngModel)]="bsTimeValue"\n                        [disabled]="disabled || readonly || isCurrentTime"\n                        [min]="minTime"\n                        [max]="maxTime"\n                        [hourStep]="hourstep"\n                        [minuteStep]="minutestep"\n                        [secondsStep]="secondsstep"\n                        [mousewheel]="true"\n                        [arrowkeys]="true"\n                        (isValid)="isValid($event)"\n                        [showSeconds]="showseconds" (ngModelChange)="onTimeChange($event)"></timepicker>\n        </div>\n    </div>\n</ng-template>\n<ng-template #nativeTimeTemplate>\n    <input type="time" class="form-control app-textbox"\n           role="input"\n           [value]="displayValue"\n           [required]="required"\n           [disabled]="disabled || readonly || isCurrentTime"\n           (change)="onTimeChange($event, true)"\n           (focus)="invokeOnFocus($event)"\n           (blur)="invokeOnTouched($event)">\n</ng-template>\n',
                providers: [ base.provideAs(TimeComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAs(TimeComponent, forms.NG_VALIDATORS, true), base.provideAsWidgetRef(TimeComponent) ]
            } ]
        } ];
        TimeComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.NgZone
            }, {
                type: core$1.AppDefaults
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Inject,
                    args: [ platformBrowser.EVENT_MANAGER_PLUGINS ]
                } ]
            } ];
        };
        TimeComponent.propDecorators = {
            bsTimePicker: [ {
                type: core.ViewChild,
                args: [ timepicker.TimepickerComponent ]
            } ]
        };
        return TimeComponent;
    }(BaseDateTimeComponent);
    var components = [ DateComponent, DatetimeComponent, TimeComponent ];
    var EpochModule = function() {
        function EpochModule() {}
        EpochModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, datepicker.BsDatepickerModule, dropdown.BsDropdownModule, forms.FormsModule, timepicker.TimepickerModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return EpochModule;
    }();
    exports.\u0275a = BaseDateTimeComponent;
    exports.\u0275c = registerProps$1;
    exports.\u0275b = registerProps;
    exports.\u0275d = registerProps$2;
    exports.EpochModule = EpochModule;
    exports.DateComponent = DateComponent;
    exports.DatetimeComponent = DatetimeComponent;
    exports.TimeComponent = TimeComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("rxjs"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input/file-upload", [ "exports", "@angular/common", "@angular/core", "rxjs", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.fileupload = {}), global.ng.common, global.ng.core, global.rxjs, global.wm.components.base, global.wm.core);
})(this, function(exports, common, core, rxjs, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-fileupload", new Map([ [ "caption", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "tabindex", base.PROP_NUMBER ], [ "multiple", base.PROP_BOOLEAN ], [ "fileuploadmessage", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "disabled", base.PROP_BOOLEAN ], [ "contenttype", base.PROP_STRING ], [ "maxfilesize", base.PROP_NUMBER ], [ "iconclass", __assign({
            value: "wi wi-file-upload"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "uploadpath", __assign({}, base.PROP_STRING) ], [ "datasource", base.PROP_STRING ], [ "selectedFiles", base.PROP_STRING ], [ "destination", base.PROP_STRING ], [ "filelistheight", base.PROP_NUMBER ] ]));
        base.registerFormWidget(core$1.FormWidgetType.UPLOAD, new Map([ [ "disabled", base.PROP_BOOLEAN ], [ "extensions", base.PROP_STRING ], [ "filetype", base.PROP_STRING ], [ "multiple", base.PROP_BOOLEAN ], [ "readonly", base.PROP_BOOLEAN ], [ "required", base.PROP_BOOLEAN ] ]));
    };
    var DEFAULT_CLS = "app-fileupload";
    var WIDGET_CONFIG = {
        widgetType: "wm-fileupload",
        hostClass: DEFAULT_CLS
    };
    var FileUploadComponent = function(_super) {
        __extends(FileUploadComponent, _super);
        function FileUploadComponent(inj, app, onSelectEvt) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.app = app;
            _this.onSelectEvt = onSelectEvt;
            _this.selectedFiles = [];
            _this.fileTransfers = {};
            _this.caption = "Upload";
            _this.formName = "";
            _this.DEFAULT_CAPTIONS = {
                MULTIPLE_SELECT: "Drop your files here.",
                SELECT: "Select"
            };
            _this.DEVICE_CONTENTTYPES = {
                IMAGE: "image",
                VIDEO: "video",
                AUDIO: "audio",
                FILES: "files"
            };
            _this.FILESIZE_MB = 1048576;
            _this.CONSTANT_FILE_SERVICE = "FileService";
            _this.uploadData = {
                file: undefined,
                uploadPath: undefined
            };
            _this.chooseFilter = "";
            _this.fileUploadMessage = "You can also browse for files";
            _this.uploadedFiles = {
                fileName: "",
                path: "",
                length: "",
                status: ""
            };
            _this.uploadUrl = "services";
            return _this;
        }
        FileUploadComponent.prototype.isValidFile = function(filename, contenttype, extensionName, isMobileType) {
            var isValid, contentTypes;
            if (!contenttype) {
                return true;
            }
            contentTypes = _.toLower(contenttype).split(",");
            if (_.includes(contentTypes, "image/*") || _.includes(contentTypes, "image") && isMobileType) {
                isValid = core$1.isImageFile(filename);
                if (isValid) {
                    return isValid;
                }
            }
            if (_.includes(contentTypes, "audio/*") || _.includes(contentTypes, "audio") && isMobileType) {
                isValid = core$1.isAudioFile(filename);
                if (isValid) {
                    return isValid;
                }
            }
            if (_.includes(contentTypes, "video/*") || _.includes(contentTypes, "video") && isMobileType) {
                isValid = core$1.isVideoFile(filename);
                if (isValid) {
                    return isValid;
                }
            }
            if (_.includes(contentTypes, "." + _.toLower(extensionName))) {
                isValid = true;
            }
            return isValid;
        };
        FileUploadComponent.prototype.getValidFiles = function($files) {
            var _this = this;
            var validFiles = [];
            var errorFiles = [];
            var MAXFILEUPLOAD_SIZE = parseFloat(this.maxfilesize) * this.FILESIZE_MB || this.FILESIZE_MB;
            var MAX_FILE_UPLOAD_FORMATTED_SIZE = (this.maxfilesize || "1") + "MB";
            if (this.chooseFilter === this.DEVICE_CONTENTTYPES.FILES) {
                this.chooseFilter = "";
            }
            _.forEach($files, function(file) {
                if (!_this.isValidFile(file.name, _this.chooseFilter, _this.getFileExtension(file.name), _this._isMobileType)) {
                    var msg = _this.appLocale.LABEL_FILE_EXTENTION_VALIDATION_MESSAGE + " " + _this.chooseFilter;
                    _this.handleErrorFiles("INVALID_FILE_EXTENSION", msg, file, errorFiles);
                    return;
                }
                if (file.size > MAXFILEUPLOAD_SIZE) {
                    var msg = _this.appLocale.LABEL_FILE_EXCEED_VALIDATION_MESSAGE + " " + MAX_FILE_UPLOAD_FORMATTED_SIZE;
                    _this.handleErrorFiles("INVALID_FILE_SIZE", msg, file, errorFiles);
                    return;
                }
                validFiles.push(file);
            });
            return {
                validFiles: validFiles,
                errorFiles: errorFiles
            };
        };
        FileUploadComponent.prototype.handleErrorFiles = function(key, msg, file, errorFiles) {
            if (!this.hasEventCallback("error")) {
                this.app.notifyApp(msg, "Error");
            }
            var error = {
                key: key,
                message: msg
            };
            file.error = error;
            errorFiles.push(file);
        };
        FileUploadComponent.prototype.getCaption = function(caption, isMultiple, isMobileType) {
            if (_.includes(this.DEFAULT_CAPTIONS, caption)) {
                return isMultiple && !isMobileType ? this.DEFAULT_CAPTIONS.MULTIPLE_SELECT : this.DEFAULT_CAPTIONS.SELECT;
            }
            return caption;
        };
        FileUploadComponent.prototype.changeServerUploadPath = function(path) {
            this.selectedUploadTypePath = path;
        };
        FileUploadComponent.prototype.getFileExtension = function(fileName) {
            if (fileName && _.includes(fileName, ".")) {
                return fileName.substring(fileName.lastIndexOf(".") + 1);
            }
            return "file";
        };
        FileUploadComponent.prototype.onSelectEventCall = function($event, $files) {
            var _this = this;
            this.selectedFiles = $files;
            setTimeout(function() {
                _this.invokeEventCallback("select", {
                    $event: $.extend($event.$files || {}, $files),
                    selectedFiles: $files
                });
            });
        };
        FileUploadComponent.prototype.onFileElemClick = function() {
            var fileInputElem = $(".file-input")[0];
            fileInputElem.value = null;
        };
        FileUploadComponent.prototype.onFileSelect = function($event, $files) {
            var _this = this;
            var beforeSelectVal;
            var files = this.getValidFiles($files);
            $files = files.validFiles;
            if (!_.isEmpty(files.errorFiles)) {
                this.invokeEventCallback("error", {
                    $event: $event,
                    files: files.errorFiles
                });
            }
            if ($files.length) {
                this.progressObservable = new rxjs.Subject();
                beforeSelectVal = this.invokeEventCallback("beforeselect", {
                    $event: $.extend($event.$files || {}, $files),
                    files: $files
                });
                if (this.datasource) {
                    this.datasource._progressObservable = this.progressObservable;
                    this.datasource._progressObservable.asObservable().subscribe(function(progressObj) {
                        _.forEach(_this.selectedFiles, function(file) {
                            if (file.name === progressObj.fileName) {
                                file.progress = progressObj.progress;
                                if (file.progress === 100) {
                                    file.status = "success";
                                } else {
                                    file.status = progressObj.status;
                                }
                            }
                        });
                    });
                } else {
                    this.selectedFiles = $files;
                }
                if (beforeSelectVal !== false) {
                    this.onSelectEventCall($event, $files);
                }
            }
        };
        FileUploadComponent.prototype.abortFileUpload = function($file) {
            this.datasource.execute(core$1.DataSource.Operation.CANCEL, $file);
        };
        FileUploadComponent.prototype.onPropertyChange = function(key, nv, ov) {
            switch (key) {
              case "uploadpath":
                this.changeServerUploadPath(nv);
                break;

              case "contenttype":
                this.chooseFilter = nv.split(" ").join(",");
                break;

              case "multiple":
                this.formName = this.name + (this.multiple ? "-multiple-fileupload" : "-single-fileupload");
                this.caption = this.getCaption(this.caption, this.multiple, this._isMobileType);
                break;

              case "fileuploadmessage":
                this.fileUploadMessage = nv;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        FileUploadComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
        };
        FileUploadComponent.prototype.ngAfterViewInit = function() {
            base.styler(this.nativeElement.querySelector(".app-button, .drop-box"), this);
        };
        FileUploadComponent.initializeProps = registerProps();
        FileUploadComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmFileUpload]",
                template: '<div class="app-fileupload" init-widget>\n    \x3c!-- drag and drop files UI in web --\x3e\n    <div class="app-multi-file-upload" *ngIf="!_isMobileType && multiple">\n        <div class="drop-box" drag-files="onFileSelect($event,$event.target.files)">\n            <i class="{{iconclass}}"></i>\n            <div class="message">\n                <label [innerHtml]="caption" class="caption"></label>\n                <form class="form-horizontal" name="{{formName}}">\n                    <input class="file-input" aria-label="Select File" type="file" name="files" *ngIf="multiple" [disabled]="disabled" [accept]="chooseFilter" (click)="onFileElemClick()" (change)="onFileSelect($event, $event.target.files)" multiple >\n                    <a href="javascript:void(0);" class="app-anchor">{{fileUploadMessage}}</a>\n                </form>\n            </div>\n        </div>\n    </div>\n    \x3c!-- single file upload in web and single , multiple file upload UI in mobile runmode --\x3e\n    <div class="app-single-file-upload" *ngIf="!_isCordova && (!multiple || _isMobileType)">\n        <div class="app-button-wrapper">\n            <form class="form-horizontal" name="{{formName}}">\n                \x3c!-- support for file upload in Mobileapp in its runmode (Web) --\x3e\n                <input class="file-input" aria-label="Select files" type="file" name="files" *ngIf="multiple" [disabled]="disabled" [accept]="chooseFilter" (click)="onFileElemClick()" (change)="onFileSelect($event, $event.target.files)" multiple>\n                <input class="file-input" aria-label="Select Files" type="file" name="files" *ngIf="!multiple" [disabled]="disabled" [accept]="chooseFilter" (click)="onFileElemClick()" (change)="onFileSelect($event, $event.target.files)" >\n                <button focus-target class="app-button btn btn-default">\n                    <i class="{{iconclass}}" aria-hidden="true"></i>\n                    <span class="caption">{{caption}}</span>\n                </button>\n            </form>\n        </div>\n        <div class="app-files-upload-status single"></div>\n    </div>\n    \x3c!-- support for file upload in Mobile Application (device) --\x3e\n    <button *ngIf="_isCordova" focus-target class="app-button btn btn-default" (click)="openFileSelector()" [disabled]="disabled">\n        <i class="{{iconclass}}"></i>\n        <span class="caption">{{caption}}</span>\n    </button>\n    \x3c!-- list of selectedfiles UI --\x3e\n    <ul class="list-group file-upload" [ngStyle]="{height: filelistheight, overflow: overflow}" *ngIf="selectedFiles.length > 0" >\n        <div *ngFor="let ft of selectedFiles">\n            <li class="list-group-item file-upload-status" *ngIf="ft.status !== \'abort\'">\n                <div class="media upload-file-list">\n                    <div class="media-left media-middle file-icon {{getFileExtension(ft.name) | fileIconClass}}" title="{{getFileExtension(ft.name)}}"></div>\n                    <div class="media-body media-middle file-details">\n                        <p class="uploaddetails">\n                            <label class="upload-title">{{ft.name}}</label><br/>\n                            <span class="filesize" *ngIf="ft.fileLength  !== 0">{{ft.size | filesize:0}}</span>\n                        </p>\n                        <div class="progress" *ngIf="ft.status === \'onProgress\'">\n                            <div class="progress-bar progress-bar-striped progress-bar-info" [ngStyle]="{width: (ft.progress +\'%\')}"></div>\n                        </div>\n                    </div>\n                    <div class="media-right media-middle" *ngIf="ft.status === \'onProgress\' || ft.status === \'queued\'">\n                        <a class="btn btn-transparent file-upload-stop" type="button" (click)="abortFileUpload(ft)">\n                            <i class="wi wi-close"></i>\n                        </a>\n                    </div>\n                    <div class="media-right media-middle"  *ngIf="ft.status === \'success\'">\n                        <span class="status-icon {{ft.status | stateClass }}"></span>\n                    </div>\n                </div>\n            </li>\n        </div>\n    </ul>\n</div>\n',
                providers: [ base.provideAsWidgetRef(FileUploadComponent) ]
            } ]
        } ];
        FileUploadComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.App
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "select.event" ]
                } ]
            } ];
        };
        return FileUploadComponent;
    }(base.StylableComponent);
    var components = [ FileUploadComponent ];
    var FileUploadModule = function() {
        function FileUploadModule() {}
        FileUploadModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return FileUploadModule;
    }();
    exports.\u0275a = registerProps;
    exports.FileUploadModule = FileUploadModule;
    exports.FileUploadComponent = FileUploadComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@angular/forms"), require("@wm/components/input"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input/rating", [ "exports", "@angular/common", "@angular/core", "@angular/forms", "@wm/components/input", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.rating = {}), global.ng.common, global.ng.core, global.ng.forms, global.wm.components.input, global.wm.components.base, global.wm.core);
})(this, function(exports, common, core, forms, input, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var ratingProps = new Map([ [ "caption", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "datavaluesource", base.PROP_ANY ], [ "datavalue", base.PROP_STRING ], [ "displayexpression", base.PROP_STRING ], [ "displayfield", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "iconcolor", base.PROP_STRING ], [ "iconsize", base.PROP_STRING ], [ "maxvalue", __assign({
        value: 5
    }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showcaptions", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "usekeys", base.PROP_BOOLEAN ] ]);
    var registerProps = function() {
        base.register("wm-rating", ratingProps);
        base.registerFormWidget(core$1.FormWidgetType.RATING, new Map(ratingProps));
    };
    var DEFAULT_CLS = "app-ratings";
    var WIDGET_CONFIG = {
        widgetType: "wm-rating",
        hostClass: DEFAULT_CLS
    };
    var MAX_RATING = 10;
    var DEFAULT_RATING = 5;
    var RatingComponent = function(_super) {
        __extends(RatingComponent, _super);
        function RatingComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this._id = core$1.generateGUId();
            base.styler(_this.nativeElement, _this);
            var datasetSubscription = _this.dataset$.subscribe(function() {
                _this.prepareRatingDataset();
            });
            _this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
            var datavalueSubscription = _this.datavalue$.subscribe(function() {
                return _this.onDatavalueChange(_this.datavalue);
            });
            _this.registerDestroyListener(function() {
                return datavalueSubscription.unsubscribe();
            });
            return _this;
        }
        Object.defineProperty(RatingComponent.prototype, "selectedRatingValue", {
            get: function() {
                return this._selectedRatingValue;
            },
            set: function(val) {
                this._selectedRatingValue = val;
                this.calculateRatingsWidth();
            },
            enumerable: true,
            configurable: true
        });
        RatingComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            if (eventName !== "change" && eventName !== "blur") {
                _super.prototype.handleEvent.call(this, this.ratingEl.nativeElement, eventName, eventCallback, locals);
            }
        };
        RatingComponent.prototype.prepareRatingDataset = function() {
            if (!this.datasetItems.length) {
                this.ratingItems = [];
                this.caption = "";
            }
            var ratingItems = [];
            var data = this.datasetItems;
            var maxvalue = parseInt(this.maxvalue || this.datasetItems.length, 10);
            var maxValue = (maxvalue > MAX_RATING ? MAX_RATING : maxvalue) || DEFAULT_RATING;
            if (data.length && data.length > maxValue) {
                data = _.slice(data, 0, maxValue);
            }
            for (var i = maxValue; i > 0; i--) {
                if (!data.length) {
                    ratingItems.push({
                        key: i,
                        value: i,
                        index: i,
                        label: i
                    });
                } else {
                    if (i > data.length) {
                        ratingItems.push({
                            key: i,
                            value: i,
                            index: i,
                            label: i
                        });
                    } else {
                        data = base.getOrderedDataset(data, "index:desc");
                        ratingItems = ratingItems.concat(data);
                        break;
                    }
                }
            }
            this.ratingItems = ratingItems;
            if (!data.length) {
                this.datasetItems = ratingItems;
            }
            this.onDatavalueChange(this.datavalue);
        };
        RatingComponent.prototype.onRatingClick = function($event, rate) {
            this.modelByKey = rate.key;
            this.selectedRatingValue = rate.index;
            if (!this.showcaptions) {
                this.caption = rate.label;
            }
            this.invokeOnTouched();
            this.invokeOnChange(this.datavalue, $event || {}, true);
        };
        RatingComponent.prototype.onDatavalueChange = function(dataVal) {
            if (!_.isEmpty(this.datasetItems)) {
                var selectedItem = _.find(this.datasetItems, {
                    selected: true
                });
                if (!selectedItem && !_.isUndefined(dataVal)) {
                    selectedItem = _.find(this.datasetItems, function(item) {
                        return _.toString(item.index) === dataVal;
                    });
                    if (selectedItem) {
                        selectedItem.selected = true;
                    }
                }
                if (!selectedItem) {
                    this.modelByKey = undefined;
                    this.caption = "";
                }
                this.selectedRatingValue = selectedItem ? selectedItem.index : 0;
                if (selectedItem) {
                    this.caption = selectedItem.label;
                }
            } else {
                this.selectedRatingValue = 0;
            }
            if (this.readonly) {
                if (!this.selectedRatingValue && !isNaN(dataVal)) {
                    this.selectedRatingValue = parseFloat(dataVal) <= this.maxvalue ? dataVal : this.maxvalue;
                }
                this.ratingsWidth = this.calculateRatingsWidth(dataVal);
            }
        };
        RatingComponent.prototype.calculateRatingsWidth = function(dataVal) {
            var selectedRating = parseFloat(this.selectedRatingValue), starWidth = .925, maxValue = parseInt(this.maxvalue || this.datasetItems.length, 10) || DEFAULT_RATING;
            core$1.setCSS(this.nativeElement.querySelector(".ratings-container"), "width", starWidth * maxValue + "em");
            dataVal = dataVal || this.datavalue;
            if (dataVal === undefined || dataVal === "" || dataVal === null) {
                this.caption = "";
                return 0;
            }
            if (selectedRating <= maxValue && selectedRating >= 0) {
                return selectedRating * starWidth + "em";
            }
            if (selectedRating > maxValue) {
                return maxValue * starWidth + "em";
            }
        };
        RatingComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "readonly") {
                if (nv) {
                    this.ratingsWidth = this.calculateRatingsWidth();
                }
            } else if (key === "maxvalue") {
                this.prepareRatingDataset();
                this.resetDatasetItems();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        RatingComponent.prototype.onTouchStart = function($event) {
            this.touchEnabled = true;
            this.onTouchStart = core$1.noop;
        };
        RatingComponent.prototype.onMouseleave = function() {
            this.caption = this.displayValue;
        };
        RatingComponent.prototype.onMouseOver = function($event, rate) {
            this.caption = rate.label;
            !this.touchEnabled && !$event.target.classList.contains("rating-label-hover") && $event.target.classList.add("rating-label-hover");
        };
        RatingComponent.initializeProps = registerProps();
        RatingComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmRating]",
                template: '<div [(ngModel)]="modelByKey" (focus)="onFocus($event)" ngDefaultControl role="radiogroup" class="ratings-wrapper">\n    <div *ngIf="!readonly" class="rating-style">\n        <label *ngFor="let rate of ratingItems;"\n               [ngClass]="{active : rate.index <= selectedRatingValue}"\n               [ngStyle]="{\'font-size\' :iconsize, color: rate.index <= selectedRatingValue && iconcolor}"\n               [title]="rate.label || rate.index"\n               (touchstart)="onTouchStart($event)"\n               (mouseleave)="onMouseleave($event, rate)"\n               (mouseover)="onMouseOver($event, rate)"\n               [for]="_id + \'-\' + rate.index">\n            <input #ratingInput type="radio" aria-label="rating radio buttons" aria-checked="false" aria-multiselectable="true"\n                   [id]="_id + \'-\' + rate.index" (click)="onRatingClick($event, rate)" name="ratings-id" [value]="rate.key || rate.index"/>\n        </label>\n    </div>\n    <div [class.hidden]="!readonly" [ngStyle]="{\'font-size\' :iconsize}" class="ratings-container disabled" >\n        <div class="ratings active" [ngStyle]="{width: ratingsWidth, color: iconcolor}"></div>\n    </div>\n    <label *ngIf="showcaptions" class="caption" [textContent]="caption"></label>\n</div>\n',
                providers: [ base.provideAs(RatingComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(RatingComponent) ]
            } ]
        } ];
        RatingComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        RatingComponent.propDecorators = {
            ratingEl: [ {
                type: core.ViewChild,
                args: [ "ratingInput", {
                    read: core.ElementRef
                } ]
            } ]
        };
        return RatingComponent;
    }(input.DatasetAwareFormComponent);
    var components = [ RatingComponent ];
    var RatingModule = function() {
        function RatingModule() {}
        RatingModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, forms.FormsModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return RatingModule;
    }();
    exports.\u0275a = RatingComponent;
    exports.\u0275b = registerProps;
    exports.RatingModule = RatingModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@angular/forms"), require("@wm/components/input"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/input/slider", [ "exports", "@angular/common", "@angular/core", "@angular/forms", "@wm/components/input", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.input = global.wm.components.input || {}, 
    global.wm.components.input.slider = {}), global.ng.common, global.ng.core, global.ng.forms, global.wm.components.input, global.wm.components.base, global.wm.core);
})(this, function(exports, common, core, forms, input, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var sliderProps = new Map([ [ "class", base.PROP_STRING ], [ "datavalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "maxvalue", base.PROP_NUMBER ], [ "minvalue", base.PROP_NUMBER ], [ "name", base.PROP_STRING ], [ "readonly", base.PROP_BOOLEAN ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "step", base.PROP_NUMBER ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ] ]);
    var registerProps = function() {
        base.register("wm-slider", sliderProps);
        base.registerFormWidget(core$1.FormWidgetType.SLIDER, new Map(sliderProps));
    };
    var DEFAULT_CLS = "app-slider slider";
    var WIDGET_CONFIG = {
        widgetType: "wm-slider",
        hostClass: DEFAULT_CLS
    };
    var SliderComponent = function(_super) {
        __extends(SliderComponent, _super);
        function SliderComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        SliderComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName !== "change" && eventName !== "blur") {
                _super.prototype.handleEvent.call(this, node, eventName, callback, locals);
            }
        };
        SliderComponent.prototype.handleChange = function(newVal) {
            this.invokeOnChange(this.datavalue, {
                type: "change"
            }, this.ngModel.valid);
        };
        SliderComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        SliderComponent.initializeProps = registerProps();
        SliderComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmSlider]",
                template: '<span class="app-slider-value pull-left" [attr.aria-valuemin]="minvalue" [textContent]="minvalue"></span>\n<span class="app-slider-value pull-right" [attr.aria-valuemax]="maxvalue" [textContent]="maxvalue"></span>\n<input class="range-input" aria-label="slider range" aria-orientation="horizontal"\n       focus-target\n       type="range" [title]="datavalue"\n       [attr.min]="minvalue"\n       [attr.max]="maxvalue"\n       [attr.step]="step"\n       [(ngModel)]="datavalue"\n       [disabled]="disabled"\n       [attr.accesskey]="shortcutkey"\n       [tabindex]="tabindex"\n       (blur)="invokeOnTouched($event)"\n       (ngModelChange)="handleChange($event)"\n       [attr.name]="name"\n       [tabindex]="tabindex"/>\n<div *ngIf="readonly || disabled" aria-readonly="true" class="readonly-wrapper"></div>',
                providers: [ base.provideAs(SliderComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(SliderComponent) ]
            } ]
        } ];
        SliderComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        SliderComponent.propDecorators = {
            ngModel: [ {
                type: core.ViewChild,
                args: [ forms.NgModel ]
            } ]
        };
        return SliderComponent;
    }(input.BaseFormCustomComponent);
    var components = [ SliderComponent ];
    var SliderModule = function() {
        function SliderModule() {}
        SliderModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, forms.FormsModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return SliderModule;
    }();
    exports.\u0275a = SliderComponent;
    exports.\u0275b = registerProps;
    exports.SliderModule = SliderModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/basic"), require("@angular/core"), require("@wm/components/base"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/chart", [ "exports", "@angular/common", "@wm/components/basic", "@angular/core", "@wm/components/base", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.chart = {}), global.ng.common, global.wm.components.basic, global.ng.core, global.wm.components.base, global.wm.core);
})(this, function(exports, common, basic, core, base, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-chart", new Map([ [ "aggregation", __assign({
            value: "none"
        }, base.PROP_STRING) ], [ "aggregationcolumn", base.PROP_STRING ], [ "areaviewtype", __assign({
            value: "stack"
        }, base.PROP_STRING) ], [ "barspacing", __assign({
            value: "medium"
        }, base.PROP_STRING) ], [ "bubblesize", base.PROP_STRING ], [ "centerlabel", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "customcolors", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "datasource", base.PROP_STRING ], [ "donutratio", __assign({
            value: "medium"
        }, base.PROP_STRING) ], [ "formattype", {
            value: "",
            PROP_STRING: base.PROP_STRING
        } ], [ "groupby", base.PROP_STRING ], [ "height", {
            value: "210px",
            PROP_STRING: base.PROP_STRING
        } ], [ "highlightpoints", base.PROP_BOOLEAN ], [ "iconclass", base.PROP_STRING ], [ "interpolation", __assign({
            value: "linear"
        }, base.PROP_STRING) ], [ "labelthreshold", __assign({
            value: .01
        }, base.PROP_NUMBER) ], [ "labeltype", __assign({
            value: "percent"
        }, base.PROP_STRING) ], [ "legendtype", __assign({
            value: "furious"
        }, base.PROP_STRING) ], [ "linethickness", base.PROP_STRING ], [ "loadingdatamsg", __assign({
            value: "Loading..."
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "nodatamessage", __assign({
            value: "No Data Available."
        }, base.PROP_STRING) ], [ "offset", base.PROP_STRING ], [ "offsetbottom", __assign({
            value: 55
        }, base.PROP_NUMBER) ], [ "offsetleft", __assign({
            value: 75
        }, base.PROP_NUMBER) ], [ "offsetright", __assign({
            value: 25
        }, base.PROP_NUMBER) ], [ "offsettop", __assign({
            value: 25
        }, base.PROP_NUMBER) ], [ "orderby", base.PROP_STRING ], [ "reducexticks", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "shape", __assign({
            value: "circle"
        }, base.PROP_STRING) ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showlabels", __assign({
            value: "outside"
        }, base.PROP_STRING) ], [ "showlabelsoutside", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showlegend", __assign({
            value: "top"
        }, base.PROP_STRING) ], [ "showvalues", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "showxaxis", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showxdistance", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "showyaxis", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showydistance", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "staggerlabels", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "subheading", base.PROP_STRING ], [ "theme", base.PROP_STRING ], [ "title", base.PROP_STRING ], [ "tooltips", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "type", base.PROP_STRING ], [ "viewtype", __assign({
            value: "Grouped"
        }, base.PROP_STRING) ], [ "xaxisdatakey", base.PROP_STRING ], [ "xaxislabel", base.PROP_STRING ], [ "xaxislabeldistance", __assign({
            value: 12
        }, base.PROP_NUMBER) ], [ "xdateformat", base.PROP_STRING ], [ "xdomain", __assign({
            value: "Default"
        }, base.PROP_STRING) ], [ "xnumberformat", base.PROP_STRING ], [ "xunits", base.PROP_STRING ], [ "yaxisdatakey", base.PROP_STRING ], [ "yaxislabel", base.PROP_STRING ], [ "yaxislabeldistance", __assign({
            value: 12
        }, base.PROP_NUMBER) ], [ "ydomain", __assign({
            value: "Default"
        }, base.PROP_STRING) ], [ "ynumberformat", base.PROP_STRING ], [ "yunits", base.PROP_STRING ] ]));
    };
    var chartTypes = [ "Column", "Line", "Area", "Cumulative Line", "Bar", "Pie", "Donut", "Bubble" ], allShapes = [ "circle", "square", "diamond", "cross", "triangle-up", "triangle-down" ];
    var dateList = [ "01/01/2001", "01/01/2002", "01/01/2003" ], themes = {
        Terrestrial: {
            colors: [ "#1f77b4", "#aec7e8", "#ff7f0e", "#ffbb78", "#2ca02c", "#98df8a", "#d62728", "#ff9896", "#9467bd", "#c5b0d5", "#8c564b", "#c49c94", "#e377c2", "#f7b6d2", "#7f7f7f", "#c7c7c7", "#bcbd22", "#dbdb8d", "#17becf", "#9edae5" ],
            tooltip: {
                backgroundColor: "#de7d28",
                textColor: "#FFFFFF"
            }
        },
        Annabelle: {
            colors: [ "#393b79", "#5254a3", "#6b6ecf", "#9c9ede", "#637939", "#8ca252", "#b5cf6b", "#cedb9c", "#8c6d31", "#bd9e39", "#e7ba52", "#e7cb94", "#843c39", "#ad494a", "#d6616b", "#e7969c", "#7b4173", "#a55194", "#ce6dbd", "#de9ed6" ],
            tooltip: {
                backgroundColor: "#2e306f",
                textColor: "#FFFFFF"
            }
        },
        Azure: {
            colors: [ "#3182bd", "#6baed6", "#9ecae1", "#c6dbef", "#e6550d", "#fd8d3c", "#fdae6b", "#fdd0a2", "#31a354", "#74c476", "#a1d99b", "#c7e9c0", "#756bb1", "#9e9ac8", "#bcbddc", "#dadaeb", "#636363", "#969696", "#bdbdbd", "#d9d9d9" ],
            tooltip: {
                backgroundColor: "#3182bd",
                textColor: "#FFFFFF"
            }
        },
        Retro: {
            colors: [ "#0ca7a1", "#ffa615", "#334957", "#acc5c2", "#988f90", "#8accc9", "#515151", "#f27861", "#36c9fd", "#794668", "#0f709d", "#0d2738", "#44be78", "#4a1839", "#6a393f", "#557d8b", "#6c331c", "#1c1c1c", "#861500", "#09562a" ],
            tooltip: {
                backgroundColor: "#80513a",
                textColor: "#FFFFFF"
            }
        },
        Mellow: {
            colors: [ "#f0dcbf", "#88c877", "#aeb918", "#2e2c23", "#ddddd2", "#dfe956", "#4c963b", "#5d3801", "#e1eec3", "#cd8472", "#fcfab3", "#9a4635", "#9295ad", "#2e3f12", "#565677", "#557d8b", "#4f4d02", "#0c0c1b", "#833324", "#24120e" ],
            tooltip: {
                backgroundColor: "#7c9e73",
                textColor: "#FFFFFF"
            }
        },
        Orient: {
            colors: [ "#a80000", "#cc6c3c", "#f0e400", "#000084", "#fccc6c", "#009c6c", "#cc309c", "#78cc00", "#fc84e4", "#48e4fc", "#4878d8", "#186c0c", "#606060", "#a8a8a8", "#000000", "#d7d7d7", "#75a06e", "#190d0b", "#888888", "#694b84" ],
            tooltip: {
                backgroundColor: "#c14242",
                textColor: "#FFFFFF"
            }
        },
        GrayScale: {
            colors: [ "#141414", "#353535", "#5b5b5b", "#848484", "#a8a8a8", "#c3c3c3", "#e0e0e0", "#c8c8c8", "#a5a5a5", "#878787", "#656565", "#4e4e4e", "#303030", "#1c1c1c", "#4f4f4f", "#3b3b3b", "#757575", "#606060", "#868686", "#c1c1c1" ],
            tooltip: {
                backgroundColor: "#575757",
                textColor: "#FFFFFF"
            }
        },
        Flyer: {
            colors: [ "#3f454c", "#5a646e", "#848778", "#cededf", "#74c4dd", "#0946ed", "#380bb1", "#000ff0", "#f54a23", "#1db262", "#bca3aa", "#ffa500", "#a86b32", "#63a18c", "#56795e", "#934343", "#b75f5f", "#752d2d", "#4e1111", "#920606" ],
            tooltip: {
                backgroundColor: "#47637c",
                textColor: "#FFFFFF"
            }
        },
        Luminosity: {
            colors: [ "#FFFFFF", "#e4e4e4", "#00bcd4", "#f0dd2f", "#00aabf", "#018376", "#e91e63", "#39e5d4", "#ff6d6d", "#00ff76", "#ff9800", "#969696", "#ff4200", "#e00000", "#95cbe5", "#5331ff", "#fff4a7", "#e7a800", "#0061e4", "#d5e7ff" ],
            tooltip: {
                backgroundColor: "#47637c",
                textColor: "#FFFFFF"
            }
        }
    }, basicProperties = [ "xaxislabel", "yaxislabel", "xunits", "yunits", "xnumberformat", "xdateformat", "ynumberformat", "showvalues", "showlabels", "viewtype", "areaviewtype", "staggerlabels", "reducexticks", "offsettop", "offsetbottom", "offsetright", "offsetleft", "barspacing", "xaxislabeldistance", "yaxislabeldistance", "theme", "labeltype", "donutratio", "showlabelsoutside", "showxdistance", "showydistance", "shape", "nodatamessage", "captions", "showxaxis", "showyaxis", "centerlabel", "customcolors", "showlegend", "legendtype", "xdomain", "ydomain", "tooltips", "linethickness", "highlightpoints", "interpolation", "labelthreshold" ], barSpacingMap = {
        small: .3,
        medium: .5,
        large: .8
    }, donutRatioMap = {
        small: .3,
        medium: .6,
        large: .7
    }, barSpacingMapInvert = _.invert(barSpacingMap), donutRatioMapInvert = _.invert(donutRatioMap), tickformats = {
        Thousand: {
            prefix: "K",
            divider: 1e3
        },
        Million: {
            prefix: "M",
            divider: 1e6
        },
        Billion: {
            prefix: "B",
            divider: 1e9
        }
    }, chartId = "#preview-chart", dataTypeJSON = [ "Column", "Line", "Pie", "Bar", "Donut", "Bubble" ], lineTypeCharts = [ "Line", "Area", "Cumulative Line" ], dataTypeArray = [ "Cumulative Line", "Area" ], SAMPLE_DATA = {
        group1: "Europe",
        group2: "Asia",
        group3: "America",
        group4: "Australia"
    };
    var isPieChart = function(type) {
        return type === "Pie";
    };
    var isLineChart = function(type) {
        return type === "Line";
    };
    var isBarChart = function(type) {
        return type === "Bar";
    };
    var isDonutChart = function(type) {
        return type === "Donut";
    };
    var isBubbleChart = function(type) {
        return type === "Bubble";
    };
    var isColumnChart = function(type) {
        return type === "Column";
    };
    var isAreaChart = function(type) {
        return type === "Area";
    };
    var isPieType = function(type) {
        return isPieChart(type) || isDonutChart(type);
    };
    var isChartDataJSON = function(type) {
        return _.includes(dataTypeJSON, type) || !_.includes(chartTypes, type);
    };
    var isChartDataArray = function(type) {
        return _.includes(dataTypeArray, type);
    };
    var isLineTypeChart = function(type) {
        return _.includes(lineTypeCharts, type);
    };
    var isAxisDomainSupported = function(type) {
        return isColumnChart(type) || isAreaChart(type);
    };
    var getBarSpacingValue = function(value, prop) {
        if (prop === "value") {
            return barSpacingMap[value];
        }
        if (prop === "key") {
            return barSpacingMapInvert[value];
        }
    };
    var getRadiusValue = function(value, prop) {
        if (prop === "value") {
            return donutRatioMap[value];
        }
        if (prop === "key") {
            return donutRatioMapInvert[value];
        }
    };
    var getLabelValues = function(showlabels, showlabelsoutside, prop) {
        var labelsConfig = {};
        switch (showlabels) {
          case "hide":
            labelsConfig.showlabels = false;
            break;

          case "inside":
            labelsConfig.showlabels = true;
            labelsConfig.showlabelsoutside = false;
            break;

          case "outside":
            labelsConfig.showlabels = true;
            labelsConfig.showlabelsoutside = true;
            break;
        }
        return labelsConfig;
    };
    var constructSampleData = function(dataType, yaxisLength, shape) {
        var first_series = [], second_series = [], third_series = [], first_series_array = [], second_series_array = [], third_series_array = [], first_series_bubble = [], second_series_bubble = [], third_series_bubble = [], data = [];
        switch (dataType) {
          case "jsonFormat":
            first_series = [ {
                x: "01/01/2001",
                y: 4e6
            }, {
                x: "01/01/2002",
                y: 1e6
            }, {
                x: "01/01/2003",
                y: 5e6
            } ];
            second_series = [ {
                x: "01/01/2001",
                y: 3e6
            }, {
                x: "01/01/2002",
                y: 4e6
            }, {
                x: "01/01/2003",
                y: 7e6
            } ];
            third_series = [ {
                x: "01/01/2001",
                y: 2e6
            }, {
                x: "01/01/2002",
                y: 8e6
            }, {
                x: "01/01/2003",
                y: 6e6
            } ];
            data[0] = {
                values: first_series,
                key: SAMPLE_DATA.group1
            };
            if (yaxisLength >= 2) {
                data[1] = {
                    values: second_series,
                    key: SAMPLE_DATA.group2
                };
            }
            if (yaxisLength >= 3) {
                data[2] = {
                    values: third_series,
                    key: SAMPLE_DATA.group3
                };
            }
            break;

          case "lineChartFormat":
            first_series = [ {
                x: 1,
                y: 4e6
            }, {
                x: 2,
                y: 1e6
            }, {
                x: 3,
                y: 5e6
            } ];
            second_series = [ {
                x: 1,
                y: 3e6
            }, {
                x: 2,
                y: 4e6
            }, {
                x: 3,
                y: 7e6
            } ];
            third_series = [ {
                x: 1,
                y: 2e6
            }, {
                x: 2,
                y: 8e6
            }, {
                x: 3,
                y: 6e6
            } ];
            data[0] = {
                values: first_series,
                key: SAMPLE_DATA.group1
            };
            if (yaxisLength >= 2) {
                data[1] = {
                    values: second_series,
                    key: SAMPLE_DATA.group2
                };
            }
            if (yaxisLength >= 3) {
                data[2] = {
                    values: third_series,
                    key: SAMPLE_DATA.group3
                };
            }
            break;

          case "arrayFormat":
            first_series_array = [ [ 1, 4e6 ], [ 2, 1e6 ], [ 3, 5e6 ] ];
            second_series_array = [ [ 1, 3e6 ], [ 2, 4e6 ], [ 3, 7e6 ] ];
            third_series_array = [ [ 1, 2e6 ], [ 2, 8e6 ], [ 3, 6e6 ] ];
            data[0] = {
                values: first_series_array,
                key: SAMPLE_DATA.group1
            };
            if (yaxisLength >= 2) {
                data[1] = {
                    values: second_series_array,
                    key: SAMPLE_DATA.group2
                };
            }
            if (yaxisLength >= 3) {
                data[2] = {
                    values: third_series_array,
                    key: SAMPLE_DATA.group3
                };
            }
            break;

          case "bubbleFormat":
            shape = shape === "random" ? allShapes[Math.floor(Math.random() * allShapes.length)] : shape;
            first_series_bubble = [ {
                x: 80.66,
                y: 33739900,
                size: 78,
                shape: shape
            }, {
                x: 79.84,
                y: 81902300,
                size: 90,
                shape: shape
            }, {
                x: 78.6,
                y: 5523100,
                size: 45,
                shape: shape
            } ];
            second_series_bubble = [ {
                x: 72.73,
                y: 79716200,
                size: 98,
                shape: shape
            }, {
                x: 80.05,
                y: 61801600,
                size: 20,
                shape: shape
            }, {
                x: 72.49,
                y: 73137200,
                size: 34,
                shape: shape
            } ];
            third_series_bubble = [ {
                x: 68.09,
                y: 33739900,
                size: 45,
                shape: shape
            }, {
                x: 81.55,
                y: 7485600,
                size: 78,
                shape: shape
            }, {
                x: 68.6,
                y: 14185e4,
                size: 56,
                shape: shape
            } ];
            data[0] = {
                values: first_series_bubble,
                key: SAMPLE_DATA.group1
            };
            if (yaxisLength >= 2) {
                data[1] = {
                    values: second_series_bubble,
                    key: SAMPLE_DATA.group2
                };
            }
            if (yaxisLength >= 3) {
                data[2] = {
                    values: third_series_bubble,
                    key: SAMPLE_DATA.group3
                };
            }
            break;

          case "pieChartFormat":
            data = [ {
                x: SAMPLE_DATA.group1,
                y: 1e6
            }, {
                x: SAMPLE_DATA.group2,
                y: 2e6
            }, {
                x: SAMPLE_DATA.group3,
                y: 3e6
            }, {
                x: SAMPLE_DATA.group4,
                y: 4e6
            } ];
            break;
        }
        return data;
    };
    var getDataType = function(widgetContext) {
        var type = widgetContext.type;
        if (isLineChart(type)) {
            return "lineChartFormat";
        }
        if (isPieType(type)) {
            return "pieChartFormat";
        }
        if (isBubbleChart(type)) {
            return "bubbleFormat";
        }
        return isChartDataJSON(type) ? "jsonFormat" : "arrayFormat";
    };
    var getSampleData = function(widgetContext) {
        return constructSampleData(getDataType(widgetContext), _.split(widgetContext.yaxisdatakey, ",").length, widgetContext.shape);
    };
    var isAxisDomainValid = function(widgetContext, axis) {
        if (widgetContext[axis + "domain"] === "Min" && isAxisDomainSupported(widgetContext.type)) {
            return true;
        }
        return false;
    };
    var areMinMaxValuesValid = function(values) {
        if (_.isFinite(values.min) && _.isFinite(values.max)) {
            return true;
        }
        return false;
    };
    var getYScaleMinValue = function(value) {
        var _min = Math.floor(value);
        return Math.abs(value) - _min > 0 ? value - .1 : _min - 1;
    };
    var highlightPoints = function(id, highlightpoints) {
        var chartSvg = id ? d3.select("#wmChart" + id + " svg") : d3.select(chartId + " svg");
        if (highlightpoints) {
            chartSvg.selectAll(".nv-point").style({
                "stroke-width": "6px",
                "fill-opacity": ".95",
                "stroke-opacity": ".95"
            });
        } else {
            chartSvg.selectAll(".nv-point").style({
                "stroke-width": "0px",
                "fill-opacity": "0"
            });
        }
    };
    var setLineThickness = function(id, thickness) {
        var chartSvg = id ? d3.select("#wmChart" + id + " svg") : d3.select(chartId + " svg");
        thickness = thickness || 1.5;
        chartSvg.selectAll(".nv-line").style({
            "stroke-width": thickness
        });
    };
    var initProperties = function(widgetContext, propertyValueMap) {
        if (!propertyValueMap || core$1.isEmptyObject(propertyValueMap)) {
            propertyValueMap = {};
        }
        _.forEach(basicProperties, function(prop) {
            if (_.isUndefined(propertyValueMap[prop])) {
                propertyValueMap[prop] = widgetContext[prop];
            }
        });
        return propertyValueMap;
    };
    var getNumberValue = function(value, callback) {
        return isNaN(parseInt(value, 10)) ? callback(value, "value") : value;
    };
    var getDateFormatedData = function(dateFormat, d) {
        dateFormat = dateFormat || "%x";
        return d3.time.format(dateFormat)(new Date(d));
    };
    var getNumberFormatedData = function(numberFormat, d) {
        var formattedData, divider, prefix;
        formattedData = d3.format(numberFormat)(d);
        if (numberFormat) {
            divider = tickformats[numberFormat] && tickformats[numberFormat].divider || 0;
            prefix = tickformats[numberFormat] && tickformats[numberFormat].prefix;
            if (prefix && divider !== 0) {
                formattedData = d3.format(".2f")(d / divider) + prefix;
            }
        } else {
            formattedData = d >= 1e3 ? d3.format(".1s")(d) : d;
        }
        return formattedData;
    };
    var modifyLegendPosition = function(widgetContext, position, id) {
        var showLegend = isShowLegend(widgetContext.showlegend), chart_Id = id ? "#wmChart" + id : chartId, legendWrap = d3.select(chart_Id + " .nv-legendWrap"), legendPadding = 5;
        if (!showLegend || !legendWrap[0][0]) {
            return;
        }
        if (position === "bottom") {
            var legendWrapHeight_1 = legendWrap[0][0].getBoundingClientRect().height, wrap = d3.select(chart_Id + " .nv-wrap"), wrapTransform = wrap && wrap.attr("transform") ? wrap.attr("transform").replace(/, /g, ",") : "", coordinates = /translate\(\s*([^\s,)]+)[ ,]([^\s,)]+)/.exec(wrapTransform), getChartHeight = function() {
                var chartHeight = $(chart_Id + " svg>.nvd3.nv-wrap")[0].getBoundingClientRect().height;
                if (chartHeight === 0) {
                    chartHeight = $(chart_Id + " svg")[0].getBoundingClientRect().height - (legendWrapHeight_1 + 15);
                }
                return chartHeight;
            };
            legendWrap.attr("transform", "translate(0 , " + (getChartHeight() - legendWrapHeight_1 - legendPadding) + ")");
            if (coordinates) {
                wrap.attr("transform", "translate(" + coordinates[1] + "," + legendPadding + ")");
            }
        }
    };
    var isShowLegend = function(value) {
        if (value === "false" || value === false) {
            return false;
        }
        if (value === "true" || value === true) {
            return true;
        }
        return value === "hide" ? false : true;
    };
    var customiseTooltip = function(chart, propertyValueMap, widgetContext, label) {
        chart.tooltip.contentGenerator(function(key) {
            var xValue = key.data.x, yValue;
            yValue = getNumberFormatedData(propertyValueMap.ynumberformat, key.data.y);
            if (isPieType(widgetContext.type)) {
                label = key.data.x;
                xValue = "";
            }
            return "<table>" + "<tbody>" + '<tr class="value"><b>' + xValue + "</b></tr>" + "<tr>" + '<td class="legend-color-guide"><div style="background-color:' + key.color + ';"></div></td>' + '<td class="key">' + label + "</td>" + '<td class="value">' + yValue + "</td>" + "</tr>" + "</tbody>" + "</table>";
        });
    };
    var initChart = function(widgetContext, xDomainValues, yDomainValues, propertyValueMap, isPreview) {
        propertyValueMap = initProperties(widgetContext, propertyValueMap);
        var chart, colors = [], xaxislabel, yaxislabel, labelConfig, radius, barSpacing, showLegend, xAxisValue, hasMultipleYValues;
        var xValue = {}, yValue = {};
        switch (widgetContext.type) {
          case "Column":
            barSpacing = getNumberValue(propertyValueMap.barspacing, getBarSpacingValue) || barSpacingMap.medium;
            chart = nv.models.multiBarChart().x(function(d) {
                return d.x;
            }).y(function(d) {
                return d.y;
            }).reduceXTicks(propertyValueMap.reducexticks).rotateLabels(0).showControls(false).stacked(propertyValueMap.viewtype === "Stacked" ? true : false).groupSpacing(barSpacing);
            break;

          case "Cumulative Line":
            chart = nv.models.cumulativeLineChart().x(function(d) {
                return d[0];
            }).y(function(d) {
                return d[1];
            }).showControls(false).useInteractiveGuideline(propertyValueMap.tooltips).interpolate(propertyValueMap.interpolation);
            break;

          case "Line":
            chart = nv.models.lineChart().useInteractiveGuideline(propertyValueMap.tooltips).interpolate(propertyValueMap.interpolation);
            break;

          case "Area":
            chart = nv.models.stackedAreaChart().x(function(d) {
                return d[0];
            }).y(function(d) {
                return d[1];
            }).clipEdge(true).showControls(false).style(propertyValueMap.areaviewtype).useInteractiveGuideline(propertyValueMap.tooltips).interpolate(propertyValueMap.interpolation);
            break;

          case "Bar":
            barSpacing = getNumberValue(propertyValueMap.barspacing, getBarSpacingValue) || barSpacingMap.medium;
            chart = nv.models.multiBarHorizontalChart().x(function(d) {
                return d.x;
            }).y(function(d) {
                return d.y;
            }).showControls(false).stacked(propertyValueMap.viewtype === "Stacked" ? true : false).showValues(propertyValueMap.showvalues).groupSpacing(barSpacing);
            break;

          case "Pie":
          case "Donut":
            labelConfig = getLabelValues(propertyValueMap.showlabels, propertyValueMap.showlabelsoutside, "value");
            radius = getNumberValue(propertyValueMap.donutratio, getRadiusValue) || donutRatioMap.medium;
            chart = nv.models.pieChart().x(function(d) {
                return d.x;
            }).y(function(d) {
                return d.y;
            }).showLabels(labelConfig.showlabels).labelType(propertyValueMap.labeltype).valueFormat(d3.format("%")).title(propertyValueMap.centerlabel).labelThreshold(propertyValueMap.labelthreshold || .01).labelsOutside(labelConfig.showlabelsoutside);
            if (isDonutChart(widgetContext.type)) {
                chart.donut(true).donutRatio(radius);
            }
            if (propertyValueMap.labeltype === "key-value") {
                chart.labelType(function(d) {
                    return d.data.x + " " + d.data.y;
                });
            }
            break;

          case "Bubble":
            chart = nv.models.scatterChart().x(function(d) {
                return d.x;
            }).y(function(d) {
                return d.y;
            }).showDistX(propertyValueMap.showxdistance).showDistY(propertyValueMap.showydistance);
            break;
        }
        if (xDomainValues) {
            xValue.min = xDomainValues.min.x || xDomainValues.min[0];
            xValue.max = xDomainValues.max.x || xDomainValues.max[0];
            if (areMinMaxValuesValid(xValue)) {
                xValue.min = getYScaleMinValue(xValue.min);
                chart.xDomain([ xValue.min, xValue.max ]);
            }
        }
        if (yDomainValues) {
            yValue.min = yDomainValues.min.y || yDomainValues.min[1];
            yValue.max = yDomainValues.max.y || yDomainValues.max[1];
            if (areMinMaxValuesValid(yValue)) {
                yValue.min = getYScaleMinValue(yValue.min);
                chart.yDomain([ yValue.min, yValue.max ]);
            }
        }
        chart.legend.vers(propertyValueMap.legendtype && propertyValueMap.legendtype.toLowerCase() || "furious");
        if (!_.includes(chartTypes, widgetContext.type)) {
            chart = nv.models.multiBarChart().x(function(d) {
                return d.x;
            }).y(function(d) {
                return d.y;
            });
        }
        if (isPieType(widgetContext.type)) {
            if (propertyValueMap.labeltype === "percent") {
                chart.valueFormat(d3.format("%"));
            } else {
                chart.valueFormat(function(d) {
                    return getNumberFormatedData(propertyValueMap.ynumberformat, d);
                });
            }
            customiseTooltip(chart, propertyValueMap, widgetContext);
        } else {
            chart.showXAxis(propertyValueMap.showxaxis).showYAxis(propertyValueMap.showyaxis);
            xaxislabel = propertyValueMap.xaxislabel || core$1.prettifyLabels(widgetContext.xaxisdatakey) || "x caption";
            yaxislabel = propertyValueMap.yaxislabel || core$1.prettifyLabels(widgetContext.yaxisdatakey) || "y caption";
            if (widgetContext.yaxisdatakey && widgetContext.yaxisdatakey.split(",").length > 1) {
                hasMultipleYValues = true;
            }
            if (!hasMultipleYValues && !isBubbleChart(widgetContext.type)) {
                customiseTooltip(chart, propertyValueMap, widgetContext, yaxislabel);
            }
            xaxislabel += propertyValueMap.xunits ? "(" + propertyValueMap.xunits + ")" : "";
            yaxislabel += propertyValueMap.yunits ? "(" + propertyValueMap.yunits + ")" : "";
            chart.xAxis.axisLabel(xaxislabel).axisLabelDistance(propertyValueMap.xaxislabeldistance).staggerLabels(propertyValueMap.staggerlabels);
            if (propertyValueMap.xdateformat || isPreview && !isBubbleChart(widgetContext.type)) {
                if (isLineTypeChart(widgetContext.type)) {
                    chart.xAxis.tickFormat(function(d) {
                        xAxisValue = isPreview ? dateList[d - 1] : widgetContext.xDataKeyArr[d];
                        return getDateFormatedData(propertyValueMap.xdateformat, xAxisValue);
                    });
                } else {
                    chart.xAxis.tickFormat(function(d) {
                        return getDateFormatedData(propertyValueMap.xdateformat, d);
                    });
                }
            } else if (propertyValueMap.xnumberformat) {
                chart.xAxis.tickFormat(function(d) {
                    return getNumberFormatedData(propertyValueMap.xnumberformat, d);
                });
            } else {
                if (isLineTypeChart(widgetContext.type)) {
                    chart.xAxis.tickFormat(function(d) {
                        return widgetContext.xDataKeyArr[d];
                    });
                }
            }
            chart.yAxis.axisLabel(yaxislabel).axisLabelDistance(propertyValueMap.yaxislabeldistance).staggerLabels(propertyValueMap.staggerlabels).tickFormat(function(d) {
                return getNumberFormatedData(propertyValueMap.ynumberformat, d);
            });
            if (isBarChart(widgetContext.type)) {
                chart.valueFormat(function(d) {
                    return getNumberFormatedData(propertyValueMap.ynumberformat, d);
                });
            }
        }
        if (_.isString(propertyValueMap.customcolors) && propertyValueMap.customcolors) {
            colors = _.split(propertyValueMap.customcolors, ",");
        }
        if (_.isArray(propertyValueMap.customcolors)) {
            colors = propertyValueMap.customcolors;
        }
        showLegend = isShowLegend(propertyValueMap.showlegend);
        chart.showLegend(showLegend).margin({
            top: propertyValueMap.offsettop,
            right: propertyValueMap.offsetright,
            bottom: propertyValueMap.offsetbottom,
            left: propertyValueMap.offsetleft
        }).color(colors.length ? colors : themes[propertyValueMap.theme].colors);
        chart.tooltip.enabled(propertyValueMap.tooltips);
        widgetContext.message = propertyValueMap.nodatamessage || "No data found";
        chart.noData(widgetContext.message);
        if (isLineTypeChart(widgetContext.type) && widgetContext.highlightpoints) {
            chart.dispatch.on("stateChange", function() {
                setTimeout(function() {
                    return postPlotChartProcess(widgetContext);
                }, 100);
            });
        }
        return chart;
    };
    var postPlotChartProcess = function(widgetContext, isPreview) {
        var id = isPreview ? null : widgetContext.$id;
        if (isLineTypeChart(widgetContext.type)) {
            setLineThickness(id, widgetContext.linethickness);
            highlightPoints(id, widgetContext.highlightpoints);
        }
        if (widgetContext.showlegend) {
            modifyLegendPosition(widgetContext, widgetContext.showlegend, id);
        }
    };
    var getDateList = function() {
        return dateList;
    };
    var WIDGET_CONFIG = {
        widgetType: "wm-chart",
        hostClass: "app-chart"
    };
    var NONE = "none", advanceDataProps = [ "aggregation", "aggregationcolumn", "groupby", "orderby" ], chartDataPointXpath = {
        Column: "rect.nv-bar",
        Bar: "g.nv-bar",
        Area: ".nv-stackedarea .nv-point",
        "Cumulative Line": ".nv-cumulativeLine .nv-scatterWrap path.nv-point",
        Line: ".nv-lineChart .nv-scatterWrap path.nv-point",
        Pie: ".nv-pieChart .nv-slice path",
        Donut: ".nv-pieChart .nv-slice path",
        Bubble: ".nv-scatterChart .nv-point-paths path"
    }, styleProps = {
        fontunit: "font-size",
        fontsize: "font-size",
        color: "fill",
        fontfamily: "font-family",
        fontweight: "font-weight",
        fontstyle: "font-style",
        textdecoration: "text-decoration"
    }, aggregationFnMap = {
        average: "AVG",
        count: "COUNT",
        maximum: "MAX",
        minimum: "MIN",
        sum: "SUM"
    };
    var getBooleanValue = function(val) {
        if (val === true || val === "true") {
            return true;
        }
        if (val === false || val === "false") {
            return false;
        }
        return val;
    };
    var getLodashOrderByFormat = function(orderby) {
        var columns;
        var orderByColumns = [], orders = [];
        _.forEach(_.split(orderby, ","), function(col) {
            columns = _.split(col, ":");
            orderByColumns.push(columns[0]);
            orders.push(columns[1]);
        });
        return {
            columns: orderByColumns,
            orders: orders
        };
    };
    var getValidAliasName = function(aliasName) {
        return aliasName ? aliasName.replace(/\./g, "$") : null;
    };
    var setTextStyle = function(properties, id) {
        var charttext = d3.select("#wmChart" + id + " svg").selectAll("text");
        charttext.style(properties);
    };
    var angle = function(d) {
        var a = (d.startAngle + d.endAngle) * 90 / Math.PI - 90;
        return a > 90 ? a - 180 : a;
    };
    var ChartComponent = function(_super) {
        __extends(ChartComponent, _super);
        function ChartComponent(inj, app) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.app = app;
            _this.iconclass = "";
            _this.nonPrimaryColumns = [];
            _this.xDataKeyArr = [];
            _this.chartData = [];
            _this._processedData = [];
            _this._plotChartProxy = _.debounce(_this.plotChartProxy.bind(_this), 100);
            _this.redraw = _this._plotChartProxy.bind(_this);
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER, [ "fontsize", "fontunit", "color", "fontfamily", "fontweight", "fontstyle", "textdecoration" ]);
            _this.$id = _this.widgetId || Math.random();
            core$1.removeAttr(_this.nativeElement, "title");
            _this.chartReady = false;
            _this.binddataset = _this.nativeElement.getAttribute("dataset.bind");
            _this.app.subscribe("toggle-variable-state", _this.handleLoading.bind(_this));
            return _this;
        }
        ChartComponent.prototype.isGroupByEnabled = function() {
            return !!(this.groupby && this.groupby !== NONE);
        };
        ChartComponent.prototype.isValidAxis = function() {
            return this.binddataset ? this.xaxisdatakey && this.yaxisdatakey : true;
        };
        ChartComponent.prototype.isAggregationEnabled = function() {
            return !!(this.isGroupByEnabled() && this.aggregation !== NONE && this.aggregationcolumn);
        };
        ChartComponent.prototype.isDataFilteringEnabled = function() {
            return this.isAggregationEnabled() || !this.isVisuallyGrouped && this.orderby;
        };
        ChartComponent.prototype.getxAxisVal = function(dataObj, xKey, index) {
            var value = _.get(dataObj, xKey);
            if (isLineTypeChart(this.type) && !core$1.isNumberType(this.xAxisDataType)) {
                this.xDataKeyArr.push(value);
                return index;
            }
            return value;
        };
        ChartComponent.prototype.getXMinMaxValues = function(datum) {
            if (!datum) {
                return;
            }
            var xValues = {};
            xValues.min = _.minBy(datum.values, function(dataObject) {
                return dataObject.x || dataObject[0];
            });
            xValues.max = _.maxBy(datum.values, function(dataObject) {
                return dataObject.x || dataObject[0];
            });
            return xValues;
        };
        ChartComponent.prototype.getYMinMaxValues = function(datum) {
            var yValues = {}, minValues = [], maxValues = [];
            if (!datum) {
                return;
            }
            _.forEach(datum, function(data) {
                minValues.push(_.minBy(data.values, function(dataObject) {
                    return dataObject.y || dataObject[1];
                }));
                maxValues.push(_.maxBy(data.values, function(dataObject) {
                    return dataObject.y || dataObject[1];
                }));
            });
            yValues.min = _.minBy(minValues, function(dataObject) {
                return dataObject.y || dataObject[1];
            });
            yValues.max = _.maxBy(maxValues, function(dataObject) {
                return dataObject.y || dataObject[1];
            });
            return yValues;
        };
        ChartComponent.prototype.getValidData = function(values) {
            return values.length === 1 && values[0] === undefined ? [] : values;
        };
        ChartComponent.prototype.valueFinder = function(dataObj, xKey, yKey, index, shape) {
            var xVal = this.getxAxisVal(dataObj, xKey, index), value = _.get(dataObj, yKey), yVal = parseFloat(value) || value, size = parseFloat(dataObj[this.bubblesize]) || 2;
            var dataPoint = {};
            if (isChartDataJSON(this.type)) {
                dataPoint.x = xVal;
                dataPoint.y = yVal;
                if (isBubbleChart(this.type)) {
                    dataPoint.size = size;
                    dataPoint.shape = shape || "circle";
                }
            } else if (isChartDataArray(this.type)) {
                dataPoint = [ xVal, yVal ];
            }
            dataPoint._dataObj = dataObj;
            return dataPoint;
        };
        ChartComponent.prototype.setErrMsg = function(message) {
            if (this.showNoDataMsg) {
                this.showContentLoadError = true;
                this.invalidConfig = true;
                this.errMsg = "";
            }
        };
        ChartComponent.prototype.processChartData = function() {
            var _this = this;
            this.sampleData = getSampleData(this);
            this.xDataKeyArr = [];
            if (!this.binddataset) {
                this.xDataKeyArr = getDateList();
                return this.sampleData;
            }
            if (!this.chartData || !this.chartData.length) {
                return [];
            }
            var datum = [], yAxisKey, shapes = [], values = [];
            var xAxisKey = this.xaxisdatakey, yAxisKeys = this.yaxisdatakey ? this.yaxisdatakey.split(",") : [], dataSet = this.chartData;
            if (_.isArray(dataSet)) {
                if (isPieType(this.type)) {
                    yAxisKey = yAxisKeys[0];
                    datum = _.map(dataSet, function(dataObj, index) {
                        if (!core$1.isEmptyObject(dataSet[index])) {
                            return _this.valueFinder(dataSet[index], xAxisKey, yAxisKey);
                        }
                    });
                    datum = this.getValidData(datum);
                } else {
                    if (isBubbleChart(this.type)) {
                        shapes = this.shape === "random" ? allShapes : this.shape;
                    }
                    yAxisKeys.forEach(function(yAxisKey, series) {
                        values = _.map(dataSet, function(dataObj, index) {
                            if (!core$1.isEmptyObject(dataSet[index])) {
                                return _this.valueFinder(dataSet[index], xAxisKey, yAxisKey, index, _.isArray(shapes) && shapes[series] || _this.shape);
                            }
                        });
                        values = _this.getValidData(values);
                        datum.push({
                            values: values,
                            key: core$1.prettifyLabels(yAxisKey)
                        });
                    });
                }
            }
            return datum;
        };
        ChartComponent.prototype.setChartData = function(data) {
            if (data) {
                this._processedData = data;
            }
        };
        ChartComponent.prototype.getChartData = function() {
            return this._processedData;
        };
        ChartComponent.prototype.getVisuallyGroupedData = function(queryResponse, groupingColumn) {
            var _this = this;
            var groupData = {}, groupValues = [], orderByDetails, maxLength;
            var chartData = [], _isAreaChart = isAreaChart(this.type), yAxisKey = _.first(_.split(this.yaxisdatakey, ","));
            this.xDataKeyArr = [];
            queryResponse = _.orderBy(queryResponse, _.split(this.groupby, ","));
            if (this.orderby) {
                orderByDetails = getLodashOrderByFormat(this.orderby);
                queryResponse = _.orderBy(queryResponse, orderByDetails.columns, orderByDetails.orders);
            }
            queryResponse = _.groupBy(queryResponse, groupingColumn);
            if (_isAreaChart) {
                maxLength = _.max(_.map(queryResponse, function(obj) {
                    return obj.length;
                }));
            }
            _.forEach(queryResponse, function(values, groupKey) {
                groupValues = isAreaChart ? _.fill(new Array(maxLength), [ 0, 0 ]) : [];
                _.forEachRight(values, function(value, index) {
                    groupValues[index] = _this.valueFinder(value, _this.xaxisdatakey, yAxisKey, index);
                });
                groupData = {
                    key: groupKey,
                    values: groupValues
                };
                chartData.push(groupData);
            });
            return chartData;
        };
        ChartComponent.prototype.getGroupingDetails = function() {
            var _this = this;
            if (this.isGroupByEnabled() && !this.isAggregationEnabled()) {
                var isVisuallyGrouped_1 = false, visualGroupingColumn_1, groupingExpression = void 0, columns_1 = [], groupingColumnIndex_1;
                var groupbyColumns_1 = this.groupby && this.groupby !== NONE ? this.groupby.split(",") : [], yAxisKeys_1 = this.yaxisdatakey ? this.yaxisdatakey.split(",") : [];
                if (groupbyColumns_1.length > 1) {
                    groupbyColumns_1.every(function(column, index) {
                        if (_this.xaxisdatakey !== column && $.inArray(column, yAxisKeys_1) === -1) {
                            isVisuallyGrouped_1 = true;
                            visualGroupingColumn_1 = column;
                            groupingColumnIndex_1 = index;
                            groupbyColumns_1.splice(groupingColumnIndex_1, 1);
                            return false;
                        }
                        return true;
                    });
                    if (visualGroupingColumn_1) {
                        columns_1.push(visualGroupingColumn_1);
                    }
                    if (groupbyColumns_1.length) {
                        columns_1 = _.concat(columns_1, groupbyColumns_1);
                    }
                }
                if (this.xaxisdatakey !== this.aggregationcolumn) {
                    columns_1.push(this.xaxisdatakey);
                }
                _.forEach(yAxisKeys_1, function(key) {
                    if (key !== _this.aggregationcolumn) {
                        columns_1.push(key);
                    }
                });
                groupingExpression = columns_1.join(",");
                this.isVisuallyGrouped = isVisuallyGrouped_1;
                return {
                    expression: groupingExpression,
                    isVisuallyGrouped: isVisuallyGrouped_1,
                    visualGroupingColumn: visualGroupingColumn_1
                };
            }
            return {
                expression: "",
                isVisuallyGrouped: false,
                visualGroupingColumn: ""
            };
        };
        ChartComponent.prototype.getAggregatedData = function(callback) {
            var _this = this;
            var variable = this.datasource, yAxisKeys = this.yaxisdatakey ? this.yaxisdatakey.split(",") : [], data = {};
            var sortExpr, columns = [], colAlias, orderByColumns, groupByFields = [];
            if (!variable) {
                return;
            }
            if (this.isGroupByEnabled()) {
                groupByFields = _.split(this.groupby, ",");
            }
            if (this.orderby) {
                sortExpr = _.replace(this.orderby, /:/g, " ");
                columns = _.uniq(_.concat(columns, groupByFields, [ this.aggregationcolumn ]));
                orderByColumns = getLodashOrderByFormat(this.orderby).columns;
                _.forEach(_.intersection(columns, orderByColumns), function(col) {
                    colAlias = getValidAliasName(col);
                    sortExpr = _.replace(sortExpr, col, colAlias);
                });
            }
            if (this.isAggregationEnabled()) {
                data.groupByFields = groupByFields;
                data.aggregations = [ {
                    field: this.aggregationcolumn,
                    type: aggregationFnMap[this.aggregation],
                    alias: getValidAliasName(this.aggregationcolumn)
                } ];
            }
            variable.execute("getAggregatedData", {
                aggregations: data,
                sort: sortExpr
            }).then(function(response) {
                var chartData = [], aggregationAlias = getValidAliasName(_this.aggregationcolumn), xAxisAliasKey = getValidAliasName(_this.xaxisdatakey), yAxisAliasKeys = [];
                yAxisKeys.forEach(function(yAxisKey) {
                    return yAxisAliasKeys.push(getValidAliasName(yAxisKey));
                });
                _.forEach(response.body.content, function(responseContent) {
                    var obj = {};
                    if (_this.isAggregationEnabled()) {
                        obj[_this.aggregationcolumn] = responseContent[aggregationAlias];
                        obj[_this.aggregationcolumn] = _.get(responseContent, aggregationAlias) || _.get(responseContent, _this.aggregationcolumn);
                    }
                    obj[_this.xaxisdatakey] = _.get(responseContent, xAxisAliasKey) || _.get(responseContent, _this.xaxisdatakey);
                    yAxisKeys.forEach(function(yAxisKey, index) {
                        obj[yAxisKey] = responseContent[yAxisAliasKeys[index]];
                        obj[yAxisKey] = _.get(responseContent, yAxisAliasKeys[index]) || _.get(responseContent, yAxisKey);
                    });
                    chartData.push(obj);
                });
                _this.chartData = chartData;
                core$1.triggerFn(callback);
            }, function() {
                _this.chartData = [];
                _this.setErrMsg("MESSAGE_ERROR_FETCH_DATA");
                core$1.triggerFn(callback);
            });
        };
        ChartComponent.prototype.setLabelsMaxWidth = function() {
            var xTicks, tickWidth, maxLength, xDist, yDist, totalHeight, maxNoLabels, nthElement, labelsAvailableWidth, barWrapper, yAxisWrapper, svgWrapper;
            var fontsize = parseInt(this.fontsize, 10) || 12, isBarchart = isBarChart(this.type);
            xTicks = $("#wmChart" + this.$id + " svg").find("g.nv-x").find("g.tick").find("text");
            xTicks.each(function() {
                var xTick = $(this);
                var xTransform, tickDist;
                if (xTick.text() && xTick.css("opacity") === "1") {
                    xTransform = xTick.parent().attr("transform").split(",");
                    xDist = parseFloat(xTransform[0].substr(10));
                    yDist = parseFloat(xTransform[1] || "0");
                    if (!isBarchart && xDist > 0) {
                        tickDist = xDist;
                    } else if (yDist > 0) {
                        tickDist = yDist;
                    }
                    if (tickWidth) {
                        tickWidth = tickDist - tickWidth;
                        return false;
                    }
                    tickWidth = tickDist;
                    return true;
                }
            });
            if (isBarchart) {
                barWrapper = $("#wmChart" + this.$id + " svg>g.nv-wrap>g>g.nv-barsWrap")[0];
                yAxisWrapper = $("#wmChart" + this.$id + " svg>g.nv-wrap>g>g.nv-y")[0];
                svgWrapper = $("#wmChart" + this.$id + " svg")[0];
                totalHeight = barWrapper ? barWrapper.getBoundingClientRect().height : 0;
                labelsAvailableWidth = yAxisWrapper ? svgWrapper.getBoundingClientRect().width - yAxisWrapper.getBoundingClientRect().width : svgWrapper.getBoundingClientRect().width;
                maxLength = Math.round(labelsAvailableWidth / fontsize);
                if (tickWidth < fontsize) {
                    maxNoLabels = totalHeight / fontsize;
                    nthElement = Math.ceil(this.chartData.length / maxNoLabels);
                    d3.select("#wmChart" + this.$id + " svg").select("g.nv-x").selectAll("g.tick").select("text").each(function(text, i) {
                        if (i % nthElement !== 0) {
                            d3.select(this).attr("opacity", 0);
                        }
                    });
                }
            } else {
                maxLength = Math.round(tickWidth / fontsize);
            }
            maxLength = Math.abs(maxLength);
            xTicks.each(function() {
                if (this.textContent.length > maxLength) {
                    this.textContent = this.textContent.substr(0, maxLength) + "...";
                }
            });
        };
        ChartComponent.prototype.getDefaultColumns = function() {
            var type, stringColumn, i, temp;
            var defaultColumns = [], columns = this.datasource.execute(core$1.DataSource.Operation.GET_PROPERTIES_MAP) || [];
            for (i = 0; i < columns.length && defaultColumns.length <= 2; i += 1) {
                type = columns[i].type;
                if (!columns[i].isRelated && core$1.isNumberType(type)) {
                    defaultColumns.push(columns[i].fieldName);
                } else if (type === "string" && !stringColumn) {
                    stringColumn = columns[i].fieldName;
                }
            }
            if (stringColumn && defaultColumns.length > 0 && !isBubbleChart(this.type)) {
                temp = defaultColumns[0];
                defaultColumns[0] = stringColumn;
                defaultColumns[1] = temp;
            }
            return defaultColumns;
        };
        ChartComponent.prototype.attachClickEvent = function() {
            var _this = this;
            var dataObj;
            d3.select("#wmChart" + this.$id + " svg").selectAll(chartDataPointXpath[this.type]).style("pointer-events", "all").on("click", function(data, index) {
                switch (_this.type) {
                  case "Column":
                  case "Bar":
                    dataObj = data._dataObj;
                    break;

                  case "Pie":
                  case "Donut":
                    dataObj = data.data._dataObj;
                    break;

                  case "Area":
                  case "Cumulative Line":
                  case "Line":
                    dataObj = data[0]._dataObj;
                    break;

                  case "Bubble":
                    dataObj = data.data.point[4]._dataObj;
                    break;
                }
                _this.selecteditem = dataObj;
                _this.invokeEventCallback("select", {
                    $event: d3.event,
                    selectedChartItem: data,
                    selectedItem: _this.selecteditem
                });
            });
        };
        ChartComponent.prototype.postPlotProcess = function(chart) {
            var _this = this;
            var chartSvg, pieLabels, pieGroups, angleArray;
            var styleObj = {};
            var element = this.$element;
            postPlotChartProcess(this);
            if (!isPieType(this.type)) {
                this.setLabelsMaxWidth();
            } else if (!this.showlabelsoutside) {
                chartSvg = d3.select("#wmChart" + this.$id + " svg");
                pieLabels = chartSvg.select(".nv-pieLabels").selectAll(".nv-label");
                pieGroups = chartSvg.select(".nv-pie").selectAll(".nv-slice");
                angleArray = [];
                if (pieGroups && pieGroups.length) {
                    pieGroups.each(function() {
                        d3.select(this).attr("transform", function(d) {
                            angleArray.push(angle(d));
                        });
                    });
                    pieLabels.each(function(d, i) {
                        var group = d3.select(this);
                        $(group[0][0]).find("text").attr("transform", "rotate(" + angleArray[i] + ")");
                    });
                }
            }
            _.forEach(styleProps, function(value, key) {
                if (key === "fontsize" || key === "fontunit") {
                    styleObj[value] = _this.fontsize + _this.fontunit;
                } else {
                    styleObj[value] = _this[key];
                }
            });
            setTextStyle(styleObj, this.$id);
            core$1.triggerFn(this._resizeFn && this._resizeFn.clear);
            this._resizeFn = nv.utils.windowResize(function() {
                if (element[0].getBoundingClientRect().height) {
                    chart.update();
                    postPlotChartProcess(_this);
                    if (!isPieType(_this.type)) {
                        _this.setLabelsMaxWidth();
                    }
                }
            });
        };
        ChartComponent.prototype.configureChart = function() {
            var xDomainValues;
            var yDomainValues;
            var chart;
            var beforeRenderVal;
            if (this._processedData.length > 0) {
                if (isAxisDomainValid(this, "x")) {
                    xDomainValues = this.binddataset ? this.getXMinMaxValues(this._processedData[0]) : {
                        min: {
                            x: 1
                        },
                        max: {
                            x: 5
                        }
                    };
                }
                if (isAxisDomainValid(this, "y")) {
                    yDomainValues = this.binddataset ? this.getYMinMaxValues(this._processedData) : {
                        min: {
                            y: 1
                        },
                        max: {
                            y: 5
                        }
                    };
                }
            }
            if (isPieType(this.type) && (!this.binddataset || !this.scopedataset)) {
                this._processedData = core$1.getClonedObject(this.scopedataset || this._processedData);
            }
            chart = initChart(this, xDomainValues, yDomainValues, null, !this.binddataset);
            if (_.isArray(this._processedData)) {
                beforeRenderVal = this.invokeEventCallback("beforerender", {
                    chartInstance: chart
                });
                if (beforeRenderVal) {
                    chart = beforeRenderVal;
                }
                this.chart = chart;
                d3.select("#wmChart" + this.$id + " svg").datum(this._processedData).call(this.chart);
                this.postPlotProcess(chart);
                return chart;
            }
        };
        ChartComponent.prototype.plotChart = function() {
            var _this = this;
            var element = this.$element;
            this.chartData = this.invokeEventCallback("transform") || this.chartData;
            if (this.isVisuallyGrouped && !isPieType(this.type)) {
                this._processedData = this.chartData;
            } else {
                this._processedData = this.processChartData();
            }
            if (!element[0].getBoundingClientRect().height) {
                return;
            }
            if (this.clearCanvas) {
                element.find("svg").replaceWith("<svg></svg>");
                this.clearCanvas = false;
            }
            if (!this.isValidAxis()) {
                this._processedData = [];
            }
            nv.addGraph(function() {
                return _this.configureChart();
            }, function() {
                setTimeout(function() {
                    _this.attachClickEvent();
                }, 600);
            });
            this.isLoadInProgress = false;
        };
        Object.defineProperty(ChartComponent.prototype, "isLiveVariable", {
            get: function() {
                var variableObj = this.datasource;
                return variableObj && variableObj.category === "wm.LiveVariable";
            },
            enumerable: true,
            configurable: true
        });
        ChartComponent.prototype.plotChartProxy = function() {
            var _this = this;
            this.showContentLoadError = false;
            this.invalidConfig = false;
            this.isLoadInProgress = true;
            var groupingDetails = this.getGroupingDetails();
            if (this.binddataset && this.isLiveVariable && (this.filterFields || this.isDataFilteringEnabled())) {
                this.getAggregatedData(function() {
                    return _this.plotChart();
                });
            } else {
                if (this.dataset && this.isLiveVariable) {
                    this.chartData = this.dataset;
                    if (this.isGroupByEnabled() && groupingDetails.isVisuallyGrouped) {
                        this.chartData = this.getVisuallyGroupedData(this.chartData, groupingDetails.visualGroupingColumn);
                    }
                }
                this.plotChart();
            }
        };
        ChartComponent.prototype.setDefaultAxisOptions = function() {
            var defaultColumns = this.getDefaultColumns();
            this.xaxisdatakey = defaultColumns[0] || null;
            this.yaxisdatakey = defaultColumns[1] || null;
        };
        ChartComponent.prototype.getCutomizedOptions = function(prop, fields) {
            var groupByColumns = _.split(this.groupby, ","), aggColumns = _.split(this.aggregationcolumn, ",");
            if (!this.binddataset) {
                return fields;
            }
            if (!this.axisoptions) {
                this.axisoptions = fields;
            }
            var newOptions;
            switch (prop) {
              case "xaxisdatakey":
                if (this.isGroupByEnabled()) {
                    newOptions = groupByColumns;
                }
                break;

              case "yaxisdatakey":
                if (this.isAggregationEnabled()) {
                    newOptions = aggColumns;
                } else if (this.isLiveVariable) {
                    newOptions = this.numericColumns;
                }
                break;

              case "groupby":
                if (this.isLiveVariable && this.nonPrimaryColumns && this.nonPrimaryColumns.length) {
                    newOptions = this.nonPrimaryColumns;
                }
                break;

              case "aggregationcolumn":
                if (this.isLiveVariable && this.isAggregationEnabled() && this.aggregation !== "count") {
                    newOptions = this.numericColumns;
                }
                break;

              case "orderby":
                if (this.isLiveVariable && this.isAggregationEnabled()) {
                    newOptions = _.uniq(_.concat(groupByColumns, aggColumns));
                }
                break;

              case "bubblesize":
                if (this.numericColumns && this.numericColumns.length) {
                    newOptions = this.numericColumns;
                }
                break;
            }
            return newOptions || fields || this.axisoptions;
        };
        ChartComponent.prototype.setNumericandNonPrimaryColumns = function() {
            var _this = this;
            var columns, type;
            var propertiesMap = this.datasource.execute(core$1.DataSource.Operation.GET_PROPERTIES_MAP);
            this.numericColumns = [];
            this.nonPrimaryColumns = [];
            if (this.dataset && !_.isEmpty(propertiesMap)) {
                columns = [];
            }
            if (columns) {
                _.forEach(Object.keys(columns), function(key) {
                    type = columns[key].type;
                    if (core$1.isNumberType(type)) {
                        _this.numericColumns.push(key);
                    }
                    if (columns[key].isRelatedPk === "true" || !columns[key].isPrimaryKey) {
                        _this.nonPrimaryColumns.push(key);
                    }
                });
                this.numericColumns = this.numericColumns.sort();
                this.nonPrimaryColumns = this.nonPrimaryColumns.sort();
            }
        };
        ChartComponent.prototype.handleDataSet = function(newVal) {
            this.errMsg = "";
            if (!newVal && !this.binddataset) {
                this.isVisuallyGrouped = false;
                this.axisoptions = null;
            }
            this.chartData = this.isLiveVariable ? newVal || "" : newVal && newVal.dataValue === "" && _.keys(newVal).length === 1 ? "" : newVal;
            if (!_.isArray(this.chartData) && _.isObject(this.chartData)) {
                this.chartData = [ this.chartData ];
            }
            if (newVal && newVal.filterFields) {
                this.filterFields = newVal.filterFields;
            }
            if (this.chartData) {
                this._plotChartProxy();
            }
        };
        ChartComponent.prototype.onPropertyChange = function(key, newVal, oldVal) {
            _super.prototype.onPropertyChange.call(this, key, newVal, oldVal);
            switch (key) {
              case "dataset":
                this.handleDataSet(newVal);
                break;

              case "type":
                if (isPieType(this.type)) {
                    this.offsettop = 20;
                    this.offsetright = 0;
                    this.offsetbottom = 0;
                    this.offsetleft = 0;
                } else if (oldVal === "Pie" || oldVal === "Donut") {
                    this.offsettop = 25;
                    this.offsetright = 25;
                    this.offsetbottom = 55;
                    this.offsetleft = 75;
                }
                if (oldVal !== newVal) {
                    this.clearCanvas = true;
                }
                this._plotChartProxy();
                break;

              default:
                this._plotChartProxy();
                break;
            }
            if (_.includes(advanceDataProps, key)) {
                this._plotChartProxy();
            }
        };
        ChartComponent.prototype.handleLoading = function(data) {
            var dataSource = this.datasource;
            if (dataSource && dataSource.execute(core$1.DataSource.Operation.IS_API_AWARE) && core$1.isDataSourceEqual(data.variable, dataSource)) {
                this.variableInflight = data.active;
                this.isLoadInProgress = data.active;
            }
        };
        ChartComponent.prototype.onStyleChange = function(key, newVal, oldVal) {
            var styleObj = {};
            _super.prototype.onStyleChange.call(this, key, newVal, oldVal);
            switch (key) {
              case "fontsize":
              case "fontunit":
              case "color":
              case "fontfamily":
              case "fontweight":
              case "fontstyle":
              case "textdecoration":
                styleObj[styleProps[key]] = key === "fontsize" || key === "fontunit" ? this.fontsize + this.fontunit : newVal;
                setTextStyle(styleObj, this.$id);
                break;
            }
        };
        ChartComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            if (!_.includes([ "outside", "inside", "hide" ], this.showlabels)) {
                this.showlabels = getBooleanValue(this.showlabels);
                this.showlabelsoutside = getBooleanValue(this.showlabelsoutside);
                this.showlabels = this.showlabels ? this.showlabelsoutside ? "outside" : "inside" : "hide";
            }
            if (!this.theme) {
                this.theme = isPieType(this.type) ? "Azure" : "Terrestrial";
            }
            this.nativeElement.setAttribute("id", "wmChart" + this.$id);
            if (!this.binddataset && !this.nativeElement.getAttribute("scopedataset")) {
                this._plotChartProxy();
            }
        };
        ChartComponent.initializeProps = registerProps();
        ChartComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmChart]",
                template: '<div class="panel-heading" *ngIf="title">\n    <h3 class="panel-title">\n        <div class="pull-left"><i class="app-icon panel-icon {{iconclass}}" [class.ng-hide]="!iconclass"></i></div>\n        <div class="heading" [innerHTML]="title | trustAs: \'html\'"></div>\n        <div class="description" *ngIf="subheading" [innerHTML]="subheading | trustAs: \'html\'"></div>\n    </h3>\n</div>\n<div class="app-chart-inner" [ngClass]="{\'loading\':isLoadInProgress, \'panel-body\': title}">\n    <svg></svg>\n    <div class="wm-content-info readonly-wrapper" *ngIf="showContentLoadError && showNoDataMsg">\n        <p class="wm-message" [title]="hintMsg" [ngClass]="{\'error\': invalidConfig}" [innerText]="errMsg"></p>\n    </div>\n    <div wmSpinner show.bind="isLoadInProgress" caption.bind="loadingdatamsg"></div>\n</div>',
                providers: [ base.provideAsWidgetRef(ChartComponent) ],
                encapsulation: core.ViewEncapsulation.None,
                styles: [ ".nvd3 .nv-axis{pointer-events:none;opacity:1}.nvd3 .nv-axis path{fill:none;stroke:#000;stroke-opacity:.75;shape-rendering:crispEdges}.nvd3 .nv-axis path.domain{stroke-opacity:.75}.nvd3 .nv-axis.nv-x path.domain{stroke-opacity:0}.nvd3 .nv-axis line{fill:none;stroke:#e5e5e5;shape-rendering:crispEdges}.nvd3 .nv-axis .zero line,.nvd3 .nv-axis line.zero{stroke-opacity:.75}.nvd3 .nv-axis .nv-axisMaxMin text{font-weight:700}.nvd3 .x .nv-axis .nv-axisMaxMin text,.nvd3 .x2 .nv-axis .nv-axisMaxMin text,.nvd3 .x3 .nv-axis .nv-axisMaxMin text{text-anchor:middle}.nvd3 .nv-axis.nv-disabled{opacity:0}.nvd3 .nv-bars rect{fill-opacity:.75;-webkit-transition:fill-opacity 250ms linear;transition:fill-opacity 250ms linear}.nvd3 .nv-bars rect.hover{fill-opacity:1}.nvd3 .nv-bars .hover rect{fill:#add8e6}.nvd3 .nv-bars text{fill:transparent}.nvd3 .nv-bars .hover text{fill:rgba(0,0,0,1)}.nvd3 .nv-discretebar .nv-groups rect,.nvd3 .nv-multibar .nv-groups rect,.nvd3 .nv-multibarHorizontal .nv-groups rect{stroke-opacity:0;-webkit-transition:fill-opacity 250ms linear;transition:fill-opacity 250ms linear}.nvd3 .nv-candlestickBar .nv-ticks rect:hover,.nvd3 .nv-discretebar .nv-groups rect:hover,.nvd3 .nv-multibar .nv-groups rect:hover,.nvd3 .nv-multibarHorizontal .nv-groups rect:hover{fill-opacity:1}.nvd3 .nv-discretebar .nv-groups text,.nvd3 .nv-multibarHorizontal .nv-groups text{font-weight:700;fill:rgba(0,0,0,1);stroke:transparent}.nvd3 .nv-boxplot circle{fill-opacity:.5}.nvd3 .nv-boxplot circle:hover,.nvd3 .nv-boxplot rect:hover{fill-opacity:1}.nvd3 line.nv-boxplot-median{stroke:#000}.nv-boxplot-tick:hover{stroke-width:2.5px}.nvd3.nv-bullet{font:10px sans-serif}.nvd3.nv-bullet .nv-measure{fill-opacity:.8}.nvd3.nv-bullet .nv-measure:hover{fill-opacity:1}.nvd3.nv-bullet .nv-marker{stroke:#000;stroke-width:2px}.nvd3.nv-bullet .nv-markerTriangle{stroke:#000;fill:#fff;stroke-width:1.5px}.nvd3.nv-bullet .nv-markerLine{stroke:#000;stroke-width:1.5px}.nvd3.nv-bullet .nv-tick line{stroke:#666;stroke-width:.5px}.nvd3.nv-bullet .nv-range.nv-s0{fill:#eee}.nvd3.nv-bullet .nv-range.nv-s1{fill:#ddd}.nvd3.nv-bullet .nv-range.nv-s2{fill:#ccc}.nvd3.nv-bullet .nv-title{font-size:14px;font-weight:700}.nvd3.nv-bullet .nv-subtitle{fill:#999}.nvd3.nv-bullet .nv-range{fill:#bababa;fill-opacity:.4}.nvd3.nv-bullet .nv-range:hover{fill-opacity:.7}.nvd3.nv-candlestickBar .nv-ticks .nv-tick{stroke-width:1px}.nvd3.nv-candlestickBar .nv-ticks .nv-tick.hover{stroke-width:2px}.nvd3.nv-candlestickBar .nv-ticks .nv-tick.positive rect{stroke:#2ca02c;fill:#2ca02c}.nvd3.nv-candlestickBar .nv-ticks .nv-tick.negative rect{stroke:#d62728;fill:#d62728}.with-transitions .nv-candlestickBar .nv-ticks .nv-tick{-webkit-transition:stroke-width 250ms linear,stroke-opacity 250ms linear;transition:stroke-width 250ms linear,stroke-opacity 250ms linear}.nvd3.nv-candlestickBar .nv-ticks line{stroke:#333}.nv-force-node{stroke:#fff;stroke-width:1.5px}.nv-force-link{stroke:#999;stroke-opacity:.6}.nv-force-node text{stroke-width:0}.nvd3 .nv-check-box .nv-box{fill-opacity:0;stroke-width:2}.nvd3 .nv-check-box .nv-check{fill-opacity:0;stroke-width:4}.nvd3 .nv-series.nv-disabled .nv-check-box .nv-check{fill-opacity:0;stroke-opacity:0}.nvd3 .nv-controlsWrap .nv-legend .nv-check-box .nv-check{opacity:0}.nvd3.nv-linePlusBar .nv-bar rect{fill-opacity:.75}.nvd3.nv-linePlusBar .nv-bar rect:hover{fill-opacity:1}.nvd3 .nv-groups path.nv-line{fill:none}.nvd3 .nv-groups path.nv-area{stroke:none}.nvd3.nv-line .nvd3.nv-scatter .nv-groups .nv-point{fill-opacity:0;stroke-opacity:0}.nvd3.nv-scatter.nv-single-point .nv-groups .nv-point{fill-opacity:.5!important;stroke-opacity:.5!important}.with-transitions .nvd3 .nv-groups .nv-point{-webkit-transition:stroke-width 250ms linear,stroke-opacity 250ms linear;transition:stroke-width 250ms linear,stroke-opacity 250ms linear}.nvd3 .nv-groups .nv-point.hover,.nvd3.nv-scatter .nv-groups .nv-point.hover{stroke-width:7px;fill-opacity:.95!important;stroke-opacity:.95!important}.nvd3 .nv-point-paths path{stroke:#aaa;stroke-opacity:0;fill:#eee;fill-opacity:0}.nvd3 .nv-indexLine{cursor:ew-resize}svg.nvd3-svg{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:block;width:100%;height:100%}.nvtooltip.with-3d-shadow,.with-3d-shadow .nvtooltip{box-shadow:0 5px 10px rgba(0,0,0,.2);border-radius:5px}.nvd3 text{font:12px Arial,sans-serif}.nvd3 .title{font:bold 14px Arial,sans-serif}.nvd3 .nv-background{fill:#fff;fill-opacity:0}.nvd3.nv-noData{font-size:18px;font-weight:700}.nv-brush .extent{fill-opacity:.125;shape-rendering:crispEdges}.nv-brush .resize path{fill:#eee;stroke:#666}.nvd3 .nv-legend .nv-series{cursor:pointer}.nvd3 .nv-legend .nv-disabled circle{fill-opacity:0}.nvd3 .nv-brush .extent{fill-opacity:0!important}.nvd3 .nv-brushBackground rect{stroke:#000;stroke-width:.4;fill:#fff;fill-opacity:.7}@media print{.nvd3 text{stroke-width:0;fill-opacity:1}}.nvd3.nv-ohlcBar .nv-ticks .nv-tick{stroke-width:1px}.nvd3.nv-ohlcBar .nv-ticks .nv-tick.hover{stroke-width:2px}.nvd3.nv-ohlcBar .nv-ticks .nv-tick.positive{stroke:#2ca02c}.nvd3.nv-ohlcBar .nv-ticks .nv-tick.negative{stroke:#d62728}.nvd3 .background path{fill:none;stroke:#eee;stroke-opacity:.4;shape-rendering:crispEdges}.nvd3 .foreground path{fill:none;stroke-opacity:.7}.nvd3 .nv-parallelCoordinates-brush .extent{fill:#fff;fill-opacity:.6;stroke:gray;shape-rendering:crispEdges}.nvd3 .nv-parallelCoordinates .hover{fill-opacity:1;stroke-width:3px}.nvd3 .missingValuesline line{fill:none;stroke:#000;stroke-width:1;stroke-opacity:1;stroke-dasharray:5,5}.nvd3.nv-pie path{stroke-opacity:0;-webkit-transition:fill-opacity 250ms linear,stroke-width 250ms linear,stroke-opacity 250ms linear;transition:fill-opacity 250ms linear,stroke-width 250ms linear,stroke-opacity 250ms linear;stroke:#fff;stroke-width:1px;stroke-opacity:1;fill-opacity:.7}.nvd3.nv-pie .nv-pie-title{font-size:24px;fill:rgba(19,196,249,.59)}.nvd3.nv-pie .nv-slice text{stroke:#000;stroke-width:0}.nvd3.nv-pie .hover path{fill-opacity:1}.nvd3.nv-pie .nv-label{pointer-events:none}.nvd3.nv-pie .nv-label rect{fill-opacity:0;stroke-opacity:0}.nvd3 .nv-groups .nv-point.hover{stroke-width:20px;stroke-opacity:.5}.nvd3 .nv-scatter .nv-point.hover{fill-opacity:1}.nv-distx,.nv-disty,.nv-noninteractive{pointer-events:none}.nvd3.nv-sparkline path{fill:none}.nvd3.nv-sparklineplus g.nv-hoverValue{pointer-events:none}.nvd3.nv-sparklineplus .nv-hoverValue line{stroke:#333;stroke-width:1.5px}.nvd3.nv-sparklineplus,.nvd3.nv-sparklineplus g{pointer-events:all}.nvd3 .nv-hoverArea{fill-opacity:0;stroke-opacity:0}.nvd3.nv-sparklineplus .nv-xValue,.nvd3.nv-sparklineplus .nv-yValue{stroke-width:0;font-size:.9em;font-weight:400}.nvd3.nv-sparklineplus .nv-yValue{stroke:#f66}.nvd3.nv-sparklineplus .nv-maxValue{stroke:#2ca02c;fill:#2ca02c}.nvd3.nv-sparklineplus .nv-minValue{stroke:#d62728;fill:#d62728}.nvd3.nv-sparklineplus .nv-currentValue{font-weight:700;font-size:1.1em}.nvd3.nv-stackedarea path.nv-area{fill-opacity:.7;stroke-opacity:0;-webkit-transition:fill-opacity 250ms linear,stroke-opacity 250ms linear;transition:fill-opacity 250ms linear,stroke-opacity 250ms linear}.nvd3.nv-stackedarea path.nv-area.hover{fill-opacity:.9}.nvd3.nv-stackedarea .nv-groups .nv-point{stroke-opacity:0;fill-opacity:0}.nvtooltip{position:absolute;color:rgba(0,0,0,1);padding:1px;border:1px solid rgba(0,0,0,.5);z-index:10000;display:block;font-family:Arial,sans-serif;font-size:13px;text-align:left;pointer-events:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:rgba(255,255,255,.8);border-radius:4px}.nvtooltip.with-transitions,.with-transitions .nvtooltip{-webkit-transition:opacity 50ms linear .2s;transition:opacity 50ms linear .2s}.nvtooltip.x-nvtooltip,.nvtooltip.y-nvtooltip{padding:8px}.nvtooltip h3{margin:0;padding:4px 14px;line-height:18px;font-weight:400;background-color:rgba(247,247,247,.75);color:rgba(0,0,0,1);text-align:center;border-bottom:1px solid #ebebeb;border-radius:5px 5px 0 0}.nvtooltip p{margin:0;padding:5px 14px;text-align:center}.nvtooltip span{display:inline-block;margin:2px 0}.nvtooltip table{margin:6px;border-spacing:0}.nvtooltip table td{padding:2px 9px 2px 0;vertical-align:middle}.nvtooltip table td.key{font-weight:400}.nvtooltip table td.key.total{font-weight:700}.nvtooltip table td.value{text-align:right;font-weight:700}.nvtooltip table td.percent{color:#a9a9a9}.nvtooltip table tr.highlight td{padding:1px 9px 1px 0;border-bottom-style:solid;border-bottom-width:1px;border-top-style:solid;border-top-width:1px}.nvtooltip table td.legend-color-guide div{vertical-align:middle;width:12px;height:12px;border:1px solid #999}.nvtooltip .footer{padding:3px;text-align:center}.nvtooltip-pending-removal{pointer-events:none;display:none}.nvd3 .nv-interactiveGuideLine{pointer-events:none}.nvd3 line.nv-guideline{stroke:#ccc}" ]
            } ]
        } ];
        ChartComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.App
            } ];
        };
        ChartComponent.propDecorators = {
            title: [ {
                type: core.HostBinding,
                args: [ "class.panel" ]
            } ]
        };
        return ChartComponent;
    }(base.StylableComponent);
    var components = [ ChartComponent ];
    var ChartModule = function() {
        function ChartModule() {}
        ChartModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ basic.BasicModule, common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return ChartModule;
    }();
    exports.\u0275a = ChartComponent;
    exports.\u0275b = registerProps;
    exports.ChartModule = ChartModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/input"), require("ngx-bootstrap/dropdown"), require("@angular/router"), require("@wm/components/basic"), require("@wm/core"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/navigation/menu", [ "exports", "@angular/common", "@wm/components/input", "ngx-bootstrap/dropdown", "@angular/router", "@wm/components/basic", "@wm/core", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.navigation = global.wm.components.navigation || {}, 
    global.wm.components.navigation.menu = {}), global.ng.common, global.wm.components.input, global.ngxBootstrap, global.ng.router, global.wm.components.basic, global.wm.core, global.ng.core, global.wm.components.base);
})(this, function(exports, common, input, dropdown, router, basic, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-nav", new Map([ [ "autoclose", __assign({
            value: "always"
        }, base.PROP_STRING) ], [ "autoopen", __assign({
            value: "never"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "iconposition", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "isactive", base.PROP_STRING ], [ "itemlabel", base.PROP_STRING ], [ "itemlink", base.PROP_STRING ], [ "itemicon", base.PROP_STRING ], [ "itemclass", base.PROP_STRING ], [ "itemchildren", base.PROP_STRING ], [ "itemaction", base.PROP_STRING ], [ "itembadge", base.PROP_STRING ], [ "itemtarget", base.PROP_STRING ], [ "layout", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "type", base.PROP_STRING ], [ "userrole", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "nav app-nav";
    var WIDGET_CONFIG = {
        widgetType: "wm-nav",
        hostClass: DEFAULT_CLS
    };
    var NavClassMap = {
        pills: "nav-pills",
        tabs: "nav-tabs",
        navbar: "navbar-nav"
    };
    var NavComponent = function(_super) {
        __extends(NavComponent, _super);
        function NavComponent(inj, cdRef, route, userDefinedExecutionContext, app, selectEventCB) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.cdRef = cdRef;
            _this.route = route;
            _this.userDefinedExecutionContext = userDefinedExecutionContext;
            _this.app = app;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            _this.disableMenuContext = !!selectEventCB;
            _this.pageScope = _this.viewParent;
            var datasetSubscription = _this.nodes$.subscribe(function() {
                if (!_.isEmpty(_this.nodes)) {
                    var itemFound_1 = false;
                    var getItem_1 = function(nodes, isMenuWidget) {
                        _.forEach(nodes, function(item) {
                            if (itemFound_1) {
                                return;
                            }
                            if (item.isactive) {
                                itemFound_1 = true;
                                _this.selecteditem = isMenuWidget ? _.omit(item, [ "children", "value" ]) : item.value;
                                _this.invokeEventCallback("select", {
                                    $event: {},
                                    $item: item.value
                                });
                                core.triggerItemAction(_this, item);
                                if (!isMenuWidget) {
                                    item._selected = true;
                                }
                                return false;
                            }
                            if (!_.isEmpty(item.children)) {
                                getItem_1(item.children, "menu");
                            }
                        });
                    };
                    getItem_1(_this.nodes);
                }
            });
            _this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
            return _this;
        }
        Object.defineProperty(NavComponent.prototype, "activePageName", {
            get: function() {
                return this.app.activePageName;
            },
            enumerable: true,
            configurable: true
        });
        NavComponent.prototype.setNavType = function(type) {
            core.addClass(this.nativeElement, NavClassMap[type]);
        };
        NavComponent.prototype.setNavLayout = function(layout) {
            core.addClass(this.nativeElement, "nav-" + layout);
        };
        NavComponent.prototype.onNavSelect = function($event, item, liRef) {
            $event.preventDefault();
            var selectedItem = _.find(this.nodes, "_selected");
            if (selectedItem) {
                delete selectedItem._selected;
            }
            if (this.activeNavLINode) {
                core.removeClass(this.activeNavLINode, "active");
            }
            this.activeNavLINode = liRef;
            core.addClass(liRef, "active");
            this.selecteditem = item.value;
            this.invokeEventCallback("select", {
                $event: $event,
                $item: item.value
            });
            core.triggerItemAction(this, item);
        };
        NavComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.setNavType(this.type);
            this.setNavLayout(this.layout);
        };
        NavComponent.prototype.onMenuItemSelect = function($event, widget, $item) {
            this.selecteditem = _.omit($item, [ "children", "value" ]);
            this.invokeEventCallback("select", {
                $event: $event,
                $item: this.selecteditem
            });
        };
        NavComponent.initializeProps = registerProps();
        NavComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "[wmNav]",
                template: '<ng-template #menuRef let-item="item" let-index="index">\n    <div wmMenu dropdown\n         type="anchor"\n         autoclose.bind="autoclose"\n         iconclass.bind="item.icon"\n         autoopen.bind="autoopen"\n         caption.bind="item.label"\n         dataset.bind="item.children"\n         iconposition.bind="iconposition"\n         select.event="onMenuItemSelect($event, widget, $item)"></div>\n</ng-template>\n\n<ng-template #anchorRef let-item="item" let-index="index" let-liRef="liRef">\n    <a wmAnchor\n       [disableMenuContext]="disableMenuContext || !!item.action"\n       [wmNavigationControl]="item.link"\n       caption.bind="item.label"\n       iconclass.bind="item.icon"\n       badgevalue.bind="item.badge"\n       iconposition.bind="iconposition"\n       click.event="onNavSelect($event, item, liRef)"></a>\n</ng-template>\n\n<li class="app-nav-item {{item.class}}" *ngFor="let item of nodes; let index = index;" #liRef [ngClass]="{active: item._selected || (!isactive && item.link === \'#/\' + activePageName)}">\n    <ng-container [ngTemplateOutlet]="anchorRef" [ngTemplateOutletContext]="{item: item, index:index, liRef: liRef}" *ngIf="!item.children.length"></ng-container>\n    <ng-container [ngTemplateOutlet]="menuRef" [ngTemplateOutletContext]="{item: item, index:index}"  *ngIf="item.children.length"></ng-container>\n</li>\n\n<ng-content *ngIf="!nodes.length" select="[wmNavItem]"></ng-content>\n',
                providers: [ base.provideAsWidgetRef(NavComponent) ]
            } ]
        } ];
        NavComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: core$1.ChangeDetectorRef
            }, {
                type: router.Router
            }, {
                type: core.UserDefinedExecutionContext
            }, {
                type: core.App
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "select.event" ]
                } ]
            } ];
        };
        return NavComponent;
    }(base.DatasetAwareNavComponent);
    var registerProps$1 = function() {
        base.register("wm-menu", new Map([ [ "accessroles", __assign({
            value: "Everyone"
        }, base.PROP_STRING) ], [ "animateitems", base.PROP_STRING ], [ "autoclose", __assign({
            value: "always"
        }, base.PROP_STRING) ], [ "autoopen", __assign({
            value: "never"
        }, base.PROP_STRING) ], [ "caption", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "dataset", __assign({
            value: "Menu Item 1, Menu Item 2, Menu Item 3"
        }, base.PROP_ANY) ], [ "hint", __assign({
            value: ""
        }, base.PROP_STRING) ], [ "isactive", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "iconposition", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "itemaction", base.PROP_STRING ], [ "itemchildren", base.PROP_STRING ], [ "itemclass", base.PROP_STRING ], [ "itemicon", base.PROP_STRING ], [ "itemlabel", base.PROP_STRING ], [ "itemlink", base.PROP_STRING ], [ "itemtarget", base.PROP_STRING ], [ "linktarget", __assign({
            value: "_self"
        }, base.PROP_STRING) ], [ "menuclass", base.PROP_STRING ], [ "menulayout", base.PROP_STRING ], [ "menuposition", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "orderby", base.PROP_STRING ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "type", __assign({
            value: "menu"
        }, base.PROP_STRING) ], [ "userrole", base.PROP_STRING ] ]));
    };
    var KEYBOARD_MOVEMENTS = {
        MOVE_UP: "UP-ARROW",
        MOVE_LEFT: "LEFT-ARROW",
        MOVE_RIGHT: "RIGHT-ARROW",
        MOVE_DOWN: "DOWN-ARROW",
        ON_ENTER: "ENTER",
        ON_TAB: "TAB",
        ON_ESCAPE: "ESC"
    };
    var MENU_POSITION = {
        UP_LEFT: "up,left",
        UP_RIGHT: "up,right",
        DOWN_LEFT: "down,left",
        DOWN_RIGHT: "down,right",
        INLINE: "inline"
    };
    var POSITION = {
        DOWN_RIGHT: "down,right",
        DOWN_LEFT: "down,left",
        UP_RIGHT: "up,right",
        UP_LEFT: "up,left",
        INLINE: "inline"
    };
    var CARET_CLS = {
        UP: "fa-caret-up",
        DOWN: "fa-caret-down"
    };
    var PULL_CLS = {
        LEFT: "pull-left",
        RIGHT: "pull-right"
    };
    var AUTO_OPEN = {
        NEVER: "never",
        ACTIVE_PAGE: "activepage",
        ALWAYS: "always"
    };
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-menu",
        hostClass: "dropdown app-menu"
    };
    var MenuComponent = function(_super) {
        __extends(MenuComponent, _super);
        function MenuComponent(inj, route, userDefinedExecutionContext, bsDropdown, parentNav, selectEventCB) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            _this.route = route;
            _this.userDefinedExecutionContext = userDefinedExecutionContext;
            _this.bsDropdown = bsDropdown;
            _this.parentNav = parentNav;
            _this.selectEventCB = selectEventCB;
            _this.menuCaret = "fa-caret-down";
            _this._selectFirstItem = false;
            if (parentNav) {
                _this.disableMenuContext = !!parentNav.disableMenuContext;
            } else {
                _this.disableMenuContext = !!selectEventCB;
            }
            var datasetSubscription = _this.nodes$.subscribe(function() {
                if (!_.isEmpty(_this.nodes)) {
                    if (_this.parentNav) {
                        return;
                    }
                    var itemFound_1 = false;
                    var getItem_1 = function(nodes) {
                        _.forEach(nodes, function(item) {
                            if (itemFound_1) {
                                return;
                            }
                            if (item.isactive) {
                                itemFound_1 = true;
                                _this.onMenuItemSelect({
                                    $event: {},
                                    $item: item
                                });
                                core.triggerItemAction(_this, item);
                                return false;
                            }
                            if (!_.isEmpty(item.children)) {
                                getItem_1(item.children);
                            }
                        });
                    };
                    getItem_1(_this.nodes);
                }
            });
            _this.registerDestroyListener(function() {
                return datasetSubscription.unsubscribe();
            });
            return _this;
        }
        MenuComponent.prototype.onShow = function() {
            var _this = this;
            if (this._selectFirstItem) {
                setTimeout(function() {
                    _this.$element.find("> ul[wmmenudropdown] li.app-menu-item:first > a").focus();
                });
            }
            core.$appDigest();
        };
        MenuComponent.prototype.onHide = function() {
            this.$element.find(">.dropdown-toggle").focus();
            this.$element.find("li").removeClass("open");
            this._selectFirstItem = false;
            core.$appDigest();
        };
        MenuComponent.prototype.onKeyDown = function($event, eventAction) {
            var KEY_MOVEMENTS = _.clone(KEYBOARD_MOVEMENTS);
            if (this.menuposition === MENU_POSITION.UP_RIGHT) {
                KEY_MOVEMENTS.MOVE_UP = "DOWN-ARROW";
                KEY_MOVEMENTS.MOVE_DOWN = "UP-ARROW";
            } else if (this.menuposition === MENU_POSITION.UP_LEFT) {
                KEY_MOVEMENTS.MOVE_UP = "DOWN-ARROW";
                KEY_MOVEMENTS.MOVE_DOWN = "UP-ARROW";
                KEY_MOVEMENTS.MOVE_LEFT = "RIGHT-ARROW";
                KEY_MOVEMENTS.MOVE_RIGHT = "LEFT-ARROW";
            } else if (this.menuposition === MENU_POSITION.DOWN_LEFT) {
                KEY_MOVEMENTS.MOVE_LEFT = "RIGHT-ARROW";
                KEY_MOVEMENTS.MOVE_RIGHT = "LEFT-ARROW";
            }
            if (_.includes([ KEY_MOVEMENTS.MOVE_DOWN, KEY_MOVEMENTS.MOVE_RIGHT ], eventAction)) {
                if (!this.bsDropdown.isOpen) {
                    this._selectFirstItem = true;
                    this.bsDropdown.show();
                } else {
                    this.$element.find("> ul[wmmenudropdown] li.app-menu-item:first > a").focus();
                }
            } else if (eventAction === KEY_MOVEMENTS.ON_ENTER) {
                this.bsDropdown.toggle(true);
            } else if (_.includes([ KEY_MOVEMENTS.MOVE_UP, KEY_MOVEMENTS.MOVE_LEFT ], eventAction)) {
                this.bsDropdown.hide();
            }
            $event.preventDefault();
        };
        MenuComponent.prototype.hasLinkToCurrentPage = function(nodes) {
            var _this = this;
            return nodes.some(function(node) {
                if (base.isActiveNavItem(node.link, _this.route.url)) {
                    return true;
                }
                if (node.children) {
                    return _this.hasLinkToCurrentPage(node.children);
                }
            });
        };
        MenuComponent.prototype.resetNodes = function() {
            _super.prototype.resetNodes.call(this);
            if (this.autoopen === AUTO_OPEN.ACTIVE_PAGE && this.hasLinkToCurrentPage(this.nodes) || this.autoopen === AUTO_OPEN.ALWAYS) {
                this.bsDropdown.show();
            }
        };
        MenuComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.setMenuPosition();
        };
        MenuComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "tabindex") {
                return;
            }
            if (key === "autoclose") {
                this.bsDropdown.autoClose = nv !== "disabled";
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        MenuComponent.prototype.setMenuPosition = function() {
            switch (this.menuposition) {
              case POSITION.DOWN_RIGHT:
                core.removeClass(this.nativeElement, "dropup");
                this.menualign = PULL_CLS.LEFT;
                this.menuCaret = CARET_CLS.DOWN;
                break;

              case POSITION.DOWN_LEFT:
                core.removeClass(this.nativeElement, "dropup");
                this.menualign = PULL_CLS.RIGHT;
                this.menuCaret = CARET_CLS.DOWN;
                break;

              case POSITION.UP_LEFT:
                core.addClass(this.nativeElement, "dropup");
                this.menualign = PULL_CLS.RIGHT;
                this.menuCaret = CARET_CLS.UP;
                break;

              case POSITION.UP_RIGHT:
                core.addClass(this.nativeElement, "dropup");
                this.menualign = PULL_CLS.LEFT;
                this.menuCaret = CARET_CLS.UP;
                break;

              case POSITION.INLINE:
                this.menualign = "dropinline-menu";
                break;
            }
        };
        MenuComponent.prototype.onMenuItemSelect = function(args) {
            var $event = args.$event;
            var $item = args.$item.value;
            this.invokeEventCallback("select", {
                $event: $event,
                $item: $item
            });
        };
        MenuComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.nativeElement.querySelector(".dropdown-toggle"), this);
        };
        MenuComponent.initializeProps = registerProps$1();
        MenuComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "[wmMenu]",
                template: '<ng-template #menuTemplate>\n    <button wmButton\n            dropdownToggle\n            aria-haspopup="true"\n            aria-expanded="false"\n\n            class="btn app-button dropdown-toggle {{menuclass}}"\n            hint.bind="hint"\n            shortcutkey.bind="shortcutkey"\n            tabindex.bind="tabindex"\n            caption.bind="caption"\n            iconclass.bind="iconclass"\n            iconposition.bind="iconposition">\n        <span class="pull-right caret fa {{menuCaret}}"></span>\n    </button>\n</ng-template>\n\n<ng-template #innerTemplate>\n    <i class="app-icon {{iconclass}}"></i>\n    <span class="caption" [textContent]="caption"></span>\n    <span class="pull-right caret fa {{menuCaret}}"></span>\n</ng-template>\n\n<ng-container *ngIf="type === \'anchor\'; else menuTemplate">\n    <a wmAnchor\n       dropdownToggle\n\n       href="javascript:void(0);"\n       role="button"\n       aria-haspopup="true"\n       aria-expanded="false"\n\n       hint.bind="hint"\n       class="dropdown-toggle {{menuclass}}"\n       shortcutkey.bind="shortcutkey"\n       tabindex.bind="tabindex"\n       caption.bind="caption"\n       iconclass.bind="iconclass"\n       iconposition.bind="iconposition"\n    >\n        <span class="pull-right caret fa {{menuCaret}}"></span>\n    </a>\n</ng-container>\n\n<ul wmMenuDropdown [items]="nodes" [ngClass]="menulayout" class="icon-position-{{iconposition}}" *dropdownMenu aria-labelledby="dropdownmenu"></ul>\n',
                providers: [ base.provideAsWidgetRef(MenuComponent) ]
            } ]
        } ];
        MenuComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: router.Router
            }, {
                type: core.UserDefinedExecutionContext
            }, {
                type: dropdown.BsDropdownDirective,
                decorators: [ {
                    type: core$1.Self
                }, {
                    type: core$1.Optional
                } ]
            }, {
                type: NavComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "select.event" ]
                } ]
            } ];
        };
        MenuComponent.propDecorators = {
            onShow: [ {
                type: core$1.HostListener,
                args: [ "onShown" ]
            } ],
            onHide: [ {
                type: core$1.HostListener,
                args: [ "onHidden" ]
            } ],
            onKeyDown: [ {
                type: core$1.HostListener,
                args: [ "keydown.arrowup", [ "$event", '"UP-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowdown", [ "$event", '"DOWN-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowright", [ "$event", '"RIGHT-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowleft", [ "$event", '"LEFT-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.enter", [ "$event", '"ENTER"' ] ]
            } ]
        };
        return MenuComponent;
    }(base.DatasetAwareNavComponent);
    var animationClasses = {
        scale: {
            name: "wmScaleInLeft",
            "down,right": "wmScaleInLeft",
            "down,left": "wmScaleInRight",
            "up,right": "wmScaleInTopLeft",
            "up,left": "wmScaleInTopRight"
        },
        fade: {
            name: "fadeIn",
            "down,right": "fadeIn",
            "down,left": "fadeIn",
            "up,right": "fadeIn",
            "up,left": "fadeIn"
        },
        slide: {
            name: "wmSlideInDown",
            "down,right": "wmSlideInDown",
            "down,left": "wmSlideInDown",
            "up,right": "wmSlideInUp",
            "up,left": "wmSlideInUp"
        }
    };
    var DEFAULT_CLS$1 = "dropdown-menu";
    var MenuDropdownComponent = function() {
        function MenuDropdownComponent(elRef, menuRef) {
            this.menuRef = menuRef;
            this.nativeElement = elRef.nativeElement;
            core.addClass(this.nativeElement, DEFAULT_CLS$1);
        }
        MenuDropdownComponent.prototype.ngAfterViewInit = function() {
            var animateItems = this.menuRef.animateitems;
            var animationClass = "";
            if (animateItems) {
                animationClass = "animated " + (animationClasses[animateItems][this.menuRef.menuposition] || animationClasses[animateItems].name);
            }
            core.addClass(this.nativeElement, "dropdown-menu " + this.menuRef.menualign + " " + animationClass, true);
        };
        MenuDropdownComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "ul[wmMenuDropdown]",
                template: '<li wmMenuDropdownItem *ngFor="let item of items"\n    [item]="item"\n    [ngClass]="{disabled: item.disabled, \'dropdown-submenu\': item.children.length > 0}"\n    class="{{item.class}}">\n</li>'
            } ]
        } ];
        MenuDropdownComponent.ctorParameters = function() {
            return [ {
                type: core$1.ElementRef
            }, {
                type: MenuComponent
            } ];
        };
        MenuDropdownComponent.propDecorators = {
            items: [ {
                type: core$1.Input
            } ]
        };
        return MenuDropdownComponent;
    }();
    var menuAlignClass = {
        "pull-right": "fa-caret-left",
        "dropinline-menu": "fa-caret-down",
        "pull-left": "fa-caret-right"
    };
    var MENU_LAYOUT_TYPE = {
        HORIZONTAL: "horizontal",
        VERTICAL: "vertical"
    };
    var MenuDropdownItemComponent = function() {
        function MenuDropdownItemComponent(menuRef, userDefinedExecutionContext, parentNav, elRef) {
            var _this = this;
            this.menuRef = menuRef;
            this.userDefinedExecutionContext = userDefinedExecutionContext;
            this.parentNav = parentNav;
            this.onSelect = function($event, item) {
                if (_this.nativeElement !== $($event.target).closest(".app-menu-item").get(0)) {
                    return;
                }
                if (_this.menuRef.autoclose === "outsideClick") {
                    $event.stopPropagation();
                }
                $event.preventDefault();
                var args = {
                    $event: $event,
                    $item: item
                };
                _this.menuRef.onMenuItemSelect(args);
                var selectedItem = _.clone(item);
                selectedItem.target = selectedItem.target || _this.menuRef.linktarget;
                core.triggerItemAction(_this, selectedItem);
            };
            this.nativeElement = elRef.nativeElement;
            core.addClass(this.nativeElement, "app-menu-item");
            this.menualign = menuAlignClass[this.menuRef.menualign] || menuAlignClass["pull-left"];
        }
        MenuDropdownItemComponent.prototype.ngOnInit = function() {
            if (this.parentNav) {
                if (base.isActiveNavItem(this.item.link, this.menuRef.route.url)) {
                    core.addClass(this.nativeElement, "active");
                }
            }
        };
        MenuDropdownItemComponent.prototype.getInitialKeyMovements = function() {
            var KEY_MOVEMENTS = _.clone(KEYBOARD_MOVEMENTS);
            if (this.menuRef.menulayout === MENU_LAYOUT_TYPE.HORIZONTAL) {
                KEY_MOVEMENTS.MOVE_UP = "LEFT-ARROW";
                KEY_MOVEMENTS.MOVE_LEFT = "UP-ARROW";
                KEY_MOVEMENTS.MOVE_RIGHT = "DOWN-ARROW";
                KEY_MOVEMENTS.MOVE_DOWN = "RIGHT-ARROW";
            } else {
                if (this.menuRef.menuposition === MENU_POSITION.DOWN_LEFT || this.menuRef.menuposition === MENU_POSITION.UP_LEFT) {
                    KEY_MOVEMENTS.MOVE_LEFT = "RIGHT-ARROW";
                    KEY_MOVEMENTS.MOVE_RIGHT = "LEFT-ARROW";
                } else if (this.menuRef.menuposition === "inline") {
                    KEY_MOVEMENTS.MOVE_UP = "LEFT-ARROW";
                    KEY_MOVEMENTS.MOVE_LEFT = "UP-ARROW";
                    KEY_MOVEMENTS.MOVE_RIGHT = "DOWN-ARROW";
                    KEY_MOVEMENTS.MOVE_DOWN = "RIGHT-ARROW";
                }
            }
            return KEY_MOVEMENTS;
        };
        MenuDropdownItemComponent.prototype.onKeyDown = function($event, eventAction) {
            var $li = $(this.nativeElement);
            var $ul = $(this.nativeElement).closest("ul.dropdown-menu");
            var $parentUl = this.menuRef.$element.find("> ul.dropdown-menu");
            var ARROW_KEYS = [ "LEFT-ARROW", "RIGHT-ARROW", "UP-ARROW", "DOWN-ARROW" ];
            var KEY_MOVEMENTS = this.getInitialKeyMovements();
            if (_.includes(ARROW_KEYS, eventAction)) {
                $event.preventDefault();
            }
            if (eventAction === KEY_MOVEMENTS.ON_TAB && $parentUl.children().last()[0] === this.nativeElement || eventAction === KEY_MOVEMENTS.ON_ESCAPE) {
                $event.preventDefault();
                this.menuRef.bsDropdown.hide();
            } else if (eventAction === KEY_MOVEMENTS.ON_ENTER && !this.item.link || eventAction === KEY_MOVEMENTS.MOVE_RIGHT) {
                $event.stopPropagation();
                if (this.item.children.length) {
                    $li.toggleClass("open");
                    $li.find("li:first > a").focus();
                } else {
                    $li.find("> a").focus();
                }
            } else if (eventAction === KEY_MOVEMENTS.MOVE_LEFT || eventAction === KEY_MOVEMENTS.ON_TAB && $ul.children().last()[0] === this.nativeElement) {
                if ($parentUl[0] !== $ul[0]) {
                    var $parentItem = $ul.parent();
                    $parentItem.toggleClass("open").find("li.open").removeClass("open");
                    $parentItem.find("> a").focus();
                    $event.preventDefault();
                    $event.stopPropagation();
                }
            } else if (eventAction === KEY_MOVEMENTS.MOVE_UP) {
                if ($parentUl[0] !== $ul[0] || $parentUl.find("> li:first")[0] !== this.nativeElement) {
                    $event.stopPropagation();
                    $li.prev().find("> a").focus();
                }
            } else if (eventAction === KEY_MOVEMENTS.MOVE_DOWN) {
                $event.stopPropagation();
                if ($parentUl.find("> li:last")[0] === this.nativeElement && (this.menuRef.menulayout !== MENU_LAYOUT_TYPE.HORIZONTAL && this.menuRef.menuposition === MENU_POSITION.UP_RIGHT || this.menuRef.menuposition === MENU_POSITION.UP_LEFT)) {
                    this.menuRef.bsDropdown.hide();
                } else {
                    $li.next().find("> a").focus();
                }
            } else if (eventAction === KEY_MOVEMENTS.ON_ENTER) {
                this.onSelect($event, this.item);
            } else {
                $event.stopPropagation();
            }
        };
        MenuDropdownItemComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "li[wmMenuDropdownItem]",
                template: '<a href="javascript:void(0);" [title]="item.label" [wmNavigationControl]="item.link" [disableMenuContext]="menuRef.disableMenuContext || !!item.action">\n    <span *ngIf="item.children.length" class="pull-right fa caret {{menualign}}"></span>\n    <i class="app-icon {{item.icon}}"></i>\n    <span class="anchor-caption">{{item.label}}</span>\n\n</a>\n<ng-container [ngTemplateOutlet]="nestedMenuDropdown" *ngIf="item.children.length" [ngTemplateOutletContext]="{item: item}"></ng-container>\n\n<ng-template #nestedMenuDropdown let-item="item">\n    <ul wmMenuDropdown [items]="item.children"></ul>\n</ng-template>\n'
            } ]
        } ];
        MenuDropdownItemComponent.ctorParameters = function() {
            return [ {
                type: MenuComponent
            }, {
                type: core.UserDefinedExecutionContext
            }, {
                type: NavComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            }, {
                type: core$1.ElementRef
            } ];
        };
        MenuDropdownItemComponent.propDecorators = {
            item: [ {
                type: core$1.Input
            } ],
            onKeyDown: [ {
                type: core$1.HostListener,
                args: [ "keydown.tab", [ "$event", '"TAB"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.escape", [ "$event", '"ESC"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.enter", [ "$event", '"ENTER"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowup", [ "$event", '"UP-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowdown", [ "$event", '"DOWN-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowright", [ "$event", '"RIGHT-ARROW"' ] ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.arrowleft", [ "$event", '"LEFT-ARROW"' ] ]
            } ],
            onSelect: [ {
                type: core$1.HostListener,
                args: [ "click", [ "$event", "item" ] ]
            } ]
        };
        return MenuDropdownItemComponent;
    }();
    var registerProps$2 = function() {
        base.register("wm-nav-item", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$2 = "app-nav-item";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-nav-item",
        hostClass: DEFAULT_CLS$2
    };
    var NavItemDirective = function(_super) {
        __extends(NavItemDirective, _super);
        function NavItemDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        NavItemDirective.prototype.makeActive = function() {
            var parentNode = this.nativeElement.parentNode;
            $(parentNode).find("> li.active").removeClass("active");
            core.addClass(this.nativeElement, "active");
        };
        NavItemDirective.prototype.ngAfterViewInit = function() {
            var _this = this;
            if (this.innerLink) {
                this.innerLink.onActive(function() {
                    return _this.makeActive();
                });
            }
        };
        NavItemDirective.initializeProps = registerProps$2();
        NavItemDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmNavItem]",
                providers: [ base.provideAsWidgetRef(NavItemDirective) ]
            } ]
        } ];
        NavItemDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            } ];
        };
        NavItemDirective.propDecorators = {
            innerLink: [ {
                type: core$1.ContentChild,
                args: [ basic.AnchorComponent ]
            } ],
            makeActive: [ {
                type: core$1.HostListener,
                args: [ "click" ]
            }, {
                type: core$1.HostListener,
                args: [ "keydown.enter" ]
            } ]
        };
        return NavItemDirective;
    }(base.StylableComponent);
    var disableContextMenu = function($event) {
        $event.preventDefault();
    };
    var NavigationControlDirective = function() {
        function NavigationControlDirective(eleRef) {
            this.nativeElement = eleRef.nativeElement;
        }
        Object.defineProperty(NavigationControlDirective.prototype, "wmNavigationControl", {
            set: function(val) {
                this._link = val;
                if (val && !this.disableMenuContext) {
                    core.setAttr(this.nativeElement, "href", val);
                    this.nativeElement.removeEventListener("contextmenu", disableContextMenu);
                } else {
                    core.setAttr(this.nativeElement, "href", "javascript:void(0)");
                    this.nativeElement.addEventListener("contextmenu", disableContextMenu);
                }
            },
            enumerable: true,
            configurable: true
        });
        NavigationControlDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmNavigationControl]"
            } ]
        } ];
        NavigationControlDirective.ctorParameters = function() {
            return [ {
                type: core$1.ElementRef
            } ];
        };
        NavigationControlDirective.propDecorators = {
            disableMenuContext: [ {
                type: core$1.Input
            } ],
            wmNavigationControl: [ {
                type: core$1.Input
            } ]
        };
        return NavigationControlDirective;
    }();
    var components = [ MenuComponent, MenuDropdownComponent, MenuDropdownItemComponent, NavigationControlDirective, NavComponent, NavItemDirective ];
    var MenuModule = function() {
        function MenuModule() {}
        MenuModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ basic.BasicModule, dropdown.BsDropdownModule, common.CommonModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: [ MenuComponent, MenuDropdownComponent ]
            } ]
        } ];
        return MenuModule;
    }();
    var menuProps = [ "itemlabel", "itemicon", "itemlink", "itemaction", "itemchildren", "userrole" ];
    var MenuAdapterComponent = function(_super) {
        __extends(MenuAdapterComponent, _super);
        function MenuAdapterComponent(inj, WIDGET_CONFIG) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.pageScope = _this.viewParent;
            _this.binditemlabel = _this.nativeElement.getAttribute("itemlabel.bind");
            _this.binditemicon = _this.nativeElement.getAttribute("itemicon.bind");
            _this.binditemaction = _this.nativeElement.getAttribute("itemaction.bind");
            _this.binditemlink = _this.nativeElement.getAttribute("itemlink.bind");
            _this.binduserrole = _this.nativeElement.getAttribute("userrole.bind");
            _this.binditemchildren = _this.nativeElement.getAttribute("itemchildren.bind");
            return _this;
        }
        MenuAdapterComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (_.includes(menuProps, key) && this.menuRef) {
                this.menuRef.itemlabel = nv;
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        MenuAdapterComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            var subscriber = this.menuRefQL.changes.subscribe(function(menuRefQL) {
                if (menuRefQL.first) {
                    _this.menuRef = menuRefQL.first;
                    menuProps.forEach(function(prop) {
                        var bindProp = "bind" + prop;
                        if (_this[bindProp]) {
                            _this.menuRef[bindProp] = _this[bindProp];
                        }
                        _this.menuRef[prop] = _this[prop];
                    });
                    subscriber.unsubscribe();
                }
            });
        };
        MenuAdapterComponent.propDecorators = {
            menuRefQL: [ {
                type: core$1.ViewChildren,
                args: [ MenuComponent ]
            } ]
        };
        return MenuAdapterComponent;
    }(base.StylableComponent);
    exports.\u0275e = MenuDropdownItemComponent;
    exports.\u0275d = MenuDropdownComponent;
    exports.\u0275a = MenuComponent;
    exports.\u0275c = registerProps$1;
    exports.\u0275g = registerProps$2;
    exports.\u0275b = registerProps;
    exports.\u0275f = NavigationControlDirective;
    exports.MenuModule = MenuModule;
    exports.MenuAdapterComponent = MenuAdapterComponent;
    exports.NavItemDirective = NavItemDirective;
    exports.NavComponent = NavComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/navigation/navbar", [ "exports", "@angular/common", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.navigation = global.wm.components.navigation || {}, 
    global.wm.components.navigation.navbar = {}), global.ng.common, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-navbar", new Map([ [ "class", __assign({
            value: ""
        }, base.PROP_STRING) ], [ "homelink", base.PROP_STRING ], [ "imgsrc", base.PROP_STRING ], [ "menuiconclass", __assign({
            value: "wi wi-more-vert"
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "title", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "navbar navbar-default app-navbar";
    var WIDGET_CONFIG = {
        widgetType: "wm-navbar",
        hostClass: DEFAULT_CLS
    };
    var NavbarComponent = function(_super) {
        __extends(NavbarComponent, _super);
        function NavbarComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        NavbarComponent.prototype.toggleCollapse = function() {
            var _this = this;
            var $navContent = $(this.navContent.nativeElement);
            $navContent.animate({
                height: "toggle"
            });
            if ($navContent.hasClass("in")) {
                setTimeout(function() {
                    return _this.toggleNavCollapse();
                }, 500);
            } else {
                this.toggleNavCollapse();
            }
        };
        NavbarComponent.prototype.toggleNavCollapse = function() {
            this.navContent.nativeElement.classList.toggle("in");
        };
        NavbarComponent.initializeProps = registerProps();
        NavbarComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmNavbar]",
                template: '<div class="container-fluid">\n    <div class="navbar-header">\n        <button type="button" class="btn-transparent navbar-toggle collapsed" data-toggle="collapse" (click)="toggleCollapse()" aria-expanded="false">\n            <span class="sr-only">Toggle navigation</span>\n            <i [ngClass]="menuiconclass"></i>\n        </button>\n        <a class="navbar-brand" [href]="(homelink | trustAs: \'resource\') || \'#/\'" *ngIf="title || imgsrc">\n            <img data-identifier="img" class="brand-image" [alt]="Brand" height="20" *ngIf="imgsrc" [src]="imgsrc | image"/>\n            <span class="title" [textContent]="title"></span>\n        </a>\n    </div>\n    <div class="collapse navbar-collapse" #navContent>\n        <ng-content></ng-content>\n    </div>\n</div>',
                providers: [ base.provideAsWidgetRef(NavbarComponent) ]
            } ]
        } ];
        NavbarComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        NavbarComponent.propDecorators = {
            navContent: [ {
                type: core.ViewChild,
                args: [ "navContent" ]
            } ]
        };
        return NavbarComponent;
    }(base.StylableComponent);
    var components = [ NavbarComponent ];
    var NavbarModule = function() {
        function NavbarModule() {}
        NavbarModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return NavbarModule;
    }();
    exports.\u0275a = NavbarComponent;
    exports.\u0275b = registerProps;
    exports.NavbarModule = NavbarModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@wm/components/navigation/menu"), require("@angular/core"), require("@angular/router"), require("@angular/common"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/navigation/breadcrumb", [ "exports", "@wm/components/navigation/menu", "@angular/core", "@angular/router", "@angular/common", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.navigation = global.wm.components.navigation || {}, 
    global.wm.components.navigation.breadcrumb = {}), global.wm.components.navigation.menu, global.ng.core, global.ng.router, global.ng.common, global.wm.core, global.wm.components.base);
})(this, function(exports, menu, core, router, common, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-breadcrumb", new Map([ [ "class", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "itemlabel", base.PROP_STRING ], [ "itemid", base.PROP_STRING ], [ "itemlink", base.PROP_STRING ], [ "itemicon", base.PROP_STRING ], [ "itemchildren", base.PROP_STRING ], [ "itemclass", base.PROP_STRING ], [ "itemtarget", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS = "breadcrumb app-breadcrumb";
    var WIDGET_CONFIG = {
        widgetType: "wm-breadcrumb",
        hostClass: DEFAULT_CLS
    };
    var BreadcrumbComponent = function(_super) {
        __extends(BreadcrumbComponent, _super);
        function BreadcrumbComponent(inj, route, location, beforeNavigateCB) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.route = route;
            _this.location = location;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            _this.disableMenuContext = !!beforeNavigateCB;
            return _this;
        }
        BreadcrumbComponent.prototype.getPath = function(info, children, path) {
            var _this = this;
            if (path === void 0) {
                path = [];
            }
            children.forEach(function(child) {
                if (info.isPathFound) {
                    return path;
                }
                if (child.id === info.key) {
                    info.isPathFound = true;
                    path.push(child);
                    return path;
                }
                if (child.children.length) {
                    path.push(child);
                    _this.getPath(info, child.children, path);
                    if (!info.isPathFound) {
                        path.pop();
                    }
                }
            });
            return path;
        };
        BreadcrumbComponent.prototype.getCurrentRoute = function() {
            return this.location.path().substr(1).split("?")[0];
        };
        BreadcrumbComponent.prototype.resetNodes = function() {
            _super.prototype.resetNodes.call(this);
            if (this.itemid || this.binditemid) {
                this.nodes = this.getPath({
                    key: this.getCurrentRoute(),
                    isPathFound: false
                }, this.nodes);
            }
        };
        BreadcrumbComponent.prototype.onItemClick = function($event, $item) {
            $event.preventDefault();
            var locals = {
                $item: $item.value,
                $event: $event
            };
            var canNavigate = !(this.invokeEventCallback("beforenavigate", locals) === false);
            var linkTarget = $item.target;
            var itemLink = $item.link;
            if (itemLink && canNavigate) {
                if (itemLink.startsWith("#/") && (!linkTarget || linkTarget === "_self")) {
                    var queryParams = core$1.getUrlParams(itemLink);
                    itemLink = core$1.getRouteNameFromLink(itemLink);
                    this.route.navigate([ itemLink ], {
                        queryParams: queryParams
                    });
                } else {
                    core$1.openLink(itemLink, linkTarget);
                }
            }
        };
        BreadcrumbComponent.initializeProps = registerProps();
        BreadcrumbComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmBreadcrumb]",
                template: '<li *ngFor="let item of nodes; let last = last; let index = index" [ngClass]="{active: last}" class="{{item.class}}">\n    <i class="{{item.icon}}"></i>\n    <a [title]="item.label" href="javascript:void(0)" [wmNavigationControl]="item.link" [disableMenuContext]="disableMenuContext || !!item.action" (click)="onItemClick($event, item)" *ngIf="!last" [textContent]="item.label"></a>\n    <label *ngIf="last" [textContent]="item.label"></label>\n</li>\n',
                providers: [ base.provideAsWidgetRef(BreadcrumbComponent) ]
            } ]
        } ];
        BreadcrumbComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: router.Router
            }, {
                type: common.Location
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "beforenavigate.event" ]
                } ]
            } ];
        };
        return BreadcrumbComponent;
    }(base.DatasetAwareNavComponent);
    var components = [ BreadcrumbComponent ];
    var BreadcrumbModule = function() {
        function BreadcrumbModule() {}
        BreadcrumbModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, menu.MenuModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return BreadcrumbModule;
    }();
    exports.\u0275a = BreadcrumbComponent;
    exports.\u0275b = registerProps;
    exports.BreadcrumbModule = BreadcrumbModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/basic"), require("@angular/core"), require("@angular/platform-browser"), require("ngx-bootstrap/popover"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/navigation/popover", [ "exports", "@angular/common", "@wm/components/basic", "@angular/core", "@angular/platform-browser", "ngx-bootstrap/popover", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.navigation = global.wm.components.navigation || {}, 
    global.wm.components.navigation.popover = {}), global.ng.common, global.wm.components.basic, global.ng.core, global.ng.platformBrowser, global.ngxBootstrap, global.wm.core, global.wm.components.base);
})(this, function(exports, common, basic, core, platformBrowser, popover, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-popover", new Map([ [ "badgevalue", base.PROP_STRING ], [ "caption", __assign({
            value: "Link"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "content", base.PROP_STRING ], [ "contentanimation", base.PROP_STRING ], [ "contentsource", __assign({
            value: "partial"
        }, base.PROP_STRING) ], [ "encodeurl", base.PROP_BOOLEAN ], [ "hint", base.PROP_STRING ], [ "hyperlink", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconposition", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "interaction", __assign({
            value: "click"
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "popoverarrow", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "popoverheight", base.PROP_STRING ], [ "popoverplacement", __assign({
            value: "bottom"
        }, base.PROP_STRING) ], [ "popoverwidth", base.PROP_STRING ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-popover-wrapper";
    var WIDGET_CONFIG = {
        widgetType: "wm-popover",
        hostClass: DEFAULT_CLS
    };
    var eventsMap = {
        click: "click",
        hover: "mouseenter:click",
        default: "click mouseenter"
    };
    var activePopover;
    var PopoverComponent = function(_super) {
        __extends(PopoverComponent, _super);
        function PopoverComponent(inj, app, evtMngrPlugins) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.app = app;
            _this.isOpen = false;
            _this.canPopoverOpen = true;
            _this.keyEventPlugin = evtMngrPlugins[1];
            _this.popoverContainerCls = "app-popover-" + _this.widgetId;
            return _this;
        }
        PopoverComponent.prototype.open = function() {
            this.showPopover();
        };
        PopoverComponent.prototype.close = function() {
            this.isOpen = false;
        };
        PopoverComponent.prototype.onHidden = function() {
            this.invokeEventCallback("hide", {
                $event: {
                    type: "hide"
                }
            });
        };
        PopoverComponent.prototype.setFocusToPopoverLink = function() {
            var _this = this;
            setTimeout(function() {
                return _this.anchorRef.nativeElement.focus();
            }, 10);
        };
        PopoverComponent.prototype.adjustPopoverPosition = function(popoverElem, parentDimesion, popoverLeftShift) {
            var arrowLeftShift = parentDimesion.left + parentDimesion.width / 2 - popoverLeftShift;
            this.bsPopoverDirective._popover._ngZone.onStable.subscribe(function() {
                popoverElem.css("left", popoverLeftShift + "px");
                popoverElem.find(".popover-arrow").css("left", arrowLeftShift + "px");
            });
        };
        PopoverComponent.prototype.calculatePopoverPostion = function(element) {
            var popoverElem = $(element);
            var popoverLeft = _.parseInt(popoverElem.css("left"));
            var popoverWidth = _.parseInt(popoverElem.css("width"));
            var viewPortWidth = $(window).width();
            var parentDimesion = this.anchorRef.nativeElement.getBoundingClientRect();
            if (popoverLeft < 0) {
                var popoverLeftShift = 4;
                this.adjustPopoverPosition(popoverElem, parentDimesion, popoverLeftShift);
            }
            if (popoverLeft + popoverWidth > viewPortWidth) {
                var popoverLeftAdjust = popoverLeft + popoverWidth - viewPortWidth;
                var popoverLeftShift = popoverLeft - popoverLeftAdjust - 50;
                this.adjustPopoverPosition(popoverElem, parentDimesion, popoverLeftShift);
            }
        };
        PopoverComponent.prototype.onShown = function() {
            var _this = this;
            var root = core$1.findRootContainer(this.$element);
            if (root) {
                $("body:first > popover-container").wrap("<" + root + "/>");
            }
            if (activePopover && activePopover.isOpen) {
                activePopover.isOpen = false;
            }
            activePopover = this;
            activePopover.isOpen = true;
            var popoverContainer = document.querySelector("." + this.popoverContainerCls);
            core$1.setCSSFromObj(popoverContainer, {
                height: this.popoverheight,
                minWidth: this.popoverwidth
            });
            if (!this.popoverarrow) {
                core$1.addClass(popoverContainer.querySelector(".arrow"), "hidden");
            }
            if (this.interaction === "hover" || this.interaction === "default") {
                popoverContainer.onmouseenter = function() {
                    return clearTimeout(_this.closePopoverTimeout);
                };
                popoverContainer.onmouseleave = function() {
                    return _this.hidePopover();
                };
                this.anchorRef.nativeElement.onmouseenter = function() {
                    return clearTimeout(_this.closePopoverTimeout);
                };
                this.anchorRef.nativeElement.onmouseleave = function() {
                    return _this.hidePopover();
                };
            }
            var deRegister = this.eventManager.addEventListener(popoverContainer, "keydown.esc", function() {
                _this.isOpen = false;
                _this.setFocusToPopoverLink();
                deRegister();
            });
            var popoverStartBtn = popoverContainer.querySelector(".popover-start");
            var popoverEndBtn = popoverContainer.querySelector(".popover-end");
            popoverStartBtn.onkeydown = function(event) {
                var action = _this.keyEventPlugin.constructor.getEventFullKey(event);
                if (action === "shift.tab") {
                    _this.bsPopoverDirective.hide();
                    _this.setFocusToPopoverLink();
                }
            };
            popoverEndBtn.onkeydown = function(event) {
                var action = _this.keyEventPlugin.constructor.getEventFullKey(event);
                if (action === "tab") {
                    _this.bsPopoverDirective.hide();
                    _this.setFocusToPopoverLink();
                }
            };
            core$1.setAttr(popoverContainer, "tabindex", 0);
            setTimeout(function() {
                return popoverStartBtn.focus();
            }, 50);
            setTimeout(function() {
                if (_this.popoverplacement === "bottom" || _this.popoverplacement === "top") {
                    _this.calculatePopoverPostion(popoverContainer);
                }
                _this.triggerPopoverEvents();
            });
        };
        PopoverComponent.prototype.triggerPopoverEvents = function() {
            var _this = this;
            if (this.contentsource === "partial") {
                var cancelSubscription_1 = this.app.subscribe("partialLoaded", function(data) {
                    var parEle = _this.partialRef.nativeElement;
                    var partialScope;
                    if (parEle) {
                        partialScope = parEle.widget;
                        _this.Widgets = partialScope.Widgets;
                        _this.Variables = partialScope.Variables;
                        _this.Actions = partialScope.Actions;
                        _this.invokeEventCallback("load");
                        _this.invokeEventCallback("show", {
                            $event: {
                                type: "show"
                            }
                        });
                    }
                    cancelSubscription_1();
                });
            } else {
                this.Widgets = this.viewParent.Widgets;
                this.Variables = this.viewParent.Variables;
                this.Actions = this.viewParent.Actions;
                this.invokeEventCallback("show", {
                    $event: {
                        type: "show"
                    }
                });
            }
        };
        PopoverComponent.prototype.hidePopover = function() {
            var _this = this;
            this.closePopoverTimeout = setTimeout(function() {
                return _this.isOpen = false;
            }, 500);
        };
        PopoverComponent.prototype.showPopover = function() {
            this.bsPopoverDirective.show();
        };
        PopoverComponent.prototype.onPopoverAnchorKeydown = function($event) {
            if (!this.canPopoverOpen) {
                return;
            }
            var action = this.keyEventPlugin.constructor.getEventFullKey(event);
            if (action === "enter") {
                $event.stopPropagation();
                this.showPopover();
            }
        };
        PopoverComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "class" || key === "tabindex") {
                return;
            }
            if (key === "contentsource") {
                if (this.contentsource === "partial" && !this.content) {
                    this.canPopoverOpen = false;
                }
            }
            if (key === "content" && nv) {
                this.canPopoverOpen = true;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        PopoverComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.event = eventsMap[this.interaction];
        };
        PopoverComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.anchorRef.nativeElement, this);
        };
        PopoverComponent.initializeProps = registerProps();
        PopoverComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "wm-popover",
                template: '<a [popover]="popoverTemplate"\n   [popoverContext]="context"\n   [popoverTitle]="title"\n   [placement]="popoverplacement"\n   [outsideClick]="true"\n   [triggers]="event"\n   (onShown)="onShown()"\n   (onHidden)="onHidden()"\n   containerClass="app-popover animated {{contentanimation}} {{popoverContainerCls}}"\n   container="body"\n   [isOpen]="isOpen"\n   [tabindex]="tabindex"\n   [name]="name"\n   [class] = "class"\n   [ngClass]="{\'disable-popover\': !canPopoverOpen}"\n\n   #anchor\n   name.bind="name"\n   wmAnchor\n   animation.bind="animation"\n   badgevalue.bind="badgevalue"\n   caption.bind="caption"\n   encodeurl.bind="encodeurl"\n   hint.bind="hint"\n   hyperlink.bind="hyperlink"\n   iconurl.bind="iconurl"\n   iconwidth.bind="iconwidth"\n   iconheight.bind="iconheight"\n   iconmargin.bind="iconmargin"\n   iconclass.bind="iconclass"\n   iconposition.bind="iconposition"\n   shortcutkey.bind="shortcutkey"\n   tabindex.bind="tabindex"\n   (keydown)="onPopoverAnchorKeydown($event)">\n</a>',
                providers: [ base.provideAsWidgetRef(PopoverComponent) ]
            } ]
        } ];
        PopoverComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.App
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Inject,
                    args: [ platformBrowser.EVENT_MANAGER_PLUGINS ]
                } ]
            } ];
        };
        PopoverComponent.propDecorators = {
            bsPopoverDirective: [ {
                type: core.ViewChild,
                args: [ popover.PopoverDirective ]
            } ],
            anchorRef: [ {
                type: core.ViewChild,
                args: [ "anchor" ]
            } ],
            popoverTemplate: [ {
                type: core.ContentChild,
                args: [ core.TemplateRef ]
            } ],
            partialRef: [ {
                type: core.ContentChild,
                args: [ "partial" ]
            } ]
        };
        return PopoverComponent;
    }(base.StylableComponent);
    var components = [ PopoverComponent ];
    var PopoverModule = function() {
        function PopoverModule() {}
        PopoverModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, basic.BasicModule, popover.PopoverModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return PopoverModule;
    }();
    exports.\u0275a = PopoverComponent;
    exports.\u0275b = registerProps;
    exports.PopoverModule = PopoverModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@wm/core"), require("@angular/core"), require("@angular/common"), require("ngx-bootstrap/modal"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs", [ "exports", "@wm/core", "@angular/core", "@angular/common", "ngx-bootstrap/modal", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = {}), global.wm.core, global.ng.core, global.ng.common, global.ngxBootstrap, global.wm.components.base);
})(this, function(exports, core, core$1, common, modal, base) {
    "use strict";
    var DEFAULT_CLS = "app-dialog-body modal-body";
    var DialogBodyDirective = function() {
        function DialogBodyDirective(elRef, dialogRef, bsModal) {
            var _this = this;
            this.dialogRef = dialogRef;
            core.addClass(elRef.nativeElement, DEFAULT_CLS);
            var subscription = bsModal.onShown.subscribe(function() {
                var dialogRoot = $(elRef.nativeElement).closest(".app-dialog")[0];
                var width = _this.dialogRef.width;
                if (dialogRoot) {
                    if (width) {
                        core.setCSS(dialogRoot, "width", width);
                    }
                    core.setAttr(dialogRoot, "tabindex", _this.dialogRef.tabindex);
                    core.setAttr(dialogRoot, "name", _this.dialogRef.name);
                }
                subscription.unsubscribe();
            });
        }
        DialogBodyDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "div[wmDialogBody]"
            } ]
        } ];
        DialogBodyDirective.ctorParameters = function() {
            return [ {
                type: core$1.ElementRef
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Inject,
                    args: [ base.DialogRef ]
                } ]
            }, {
                type: modal.BsModalService
            } ];
        };
        DialogBodyDirective.propDecorators = {
            height: [ {
                type: core$1.HostBinding,
                args: [ "style.height" ]
            } ]
        };
        return DialogBodyDirective;
    }();
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-dialogfooter", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var WIDGET_INFO = {
        widgetType: "wm-dialogfooter",
        hostClass: "app-dialog-footer modal-footer"
    };
    var DialogFooterDirective = function(_super) {
        __extends(DialogFooterDirective, _super);
        function DialogFooterDirective(inj) {
            return _super.call(this, inj, WIDGET_INFO) || this;
        }
        DialogFooterDirective.initializeProps = registerProps();
        DialogFooterDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "div[wmDialogFooter]",
                providers: [ base.provideAsWidgetRef(DialogFooterDirective) ]
            } ]
        } ];
        DialogFooterDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            } ];
        };
        return DialogFooterDirective;
    }(base.BaseComponent);
    var invokeOpenedCallback = function(ref) {
        if (ref) {
            setTimeout(function() {
                var root = core.findRootContainer(ref.$element);
                if (root) {
                    $("body:first > modal-container > div").wrap("<" + root + "/>");
                }
                ref.invokeEventCallback("opened", {
                    $event: {
                        type: "opened"
                    }
                });
            });
        }
    };
    var \u02750 = invokeOpenedCallback;
    var invokeClosedCallback = function(ref) {
        if (ref) {
            ref.invokeEventCallback("close");
            ref.dialogRef = undefined;
        }
    };
    var \u02751 = invokeClosedCallback;
    var BaseDialog = function(_super) {
        __extends(BaseDialog, _super);
        function BaseDialog(inj, widgetConfig, modalOptions) {
            var _this = _super.call(this, inj, widgetConfig) || this;
            _this.modalOptions = modalOptions;
            _this.dialogService = inj.get(core.AbstractDialogService);
            _this.bsModal = inj.get(modal.BsModalService);
            var subscriptions = [ _this.bsModal.onShown.subscribe(function() {
                var ref = _this.dialogService.getLastOpenedDialog();
                if (ref === _this) {
                    invokeOpenedCallback(ref);
                }
            }), _this.bsModal.onHidden.subscribe(function(closeReason) {
                var ref = closeReason === "esc" || closeReason === "backdrop-click" ? _this.dialogService.getLastOpenedDialog() : _this.dialogService.getDialogRefFromClosedDialogs();
                if (ref === _this) {
                    _this.dialogService.removeFromOpenedDialogs(ref);
                    _this.dialogService.removeFromClosedDialogs(ref);
                    invokeClosedCallback(ref);
                }
            }) ];
            _this.registerDestroyListener(function() {
                _this.dialogService.removeFromOpenedDialogs(_this);
                _this.dialogService.removeFromClosedDialogs(_this);
                subscriptions.forEach(function(s) {
                    return s.unsubscribe();
                });
            });
            return _this;
        }
        BaseDialog.prototype.open = function(initState) {
            var _this = this;
            var duplicateDialogCheck = function(openedDialog) {
                return openedDialog === _this;
            };
            if (this.dialogService.getOpenedDialogs().some(duplicateDialogCheck)) {
                return;
            }
            this.dialogService.addToOpenedDialogs(this);
            Object.assign(this.context, initState);
            this.dialogRef = this.bsModal.show(this.getTemplateRef(), this.modalOptions);
        };
        BaseDialog.prototype.close = function() {
            if (this.dialogRef) {
                this.dialogService.addToClosedDialogs(this);
                this.dialogRef.hide();
            }
        };
        BaseDialog.prototype.register = function(scope) {
            this.dialogService.register(this.name, this, scope);
        };
        BaseDialog.prototype.deRegister = function(scope) {
            this.dialogService.deRegister(this.name, scope);
        };
        BaseDialog.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "class" || key === "name" || key === "tabindex") {
                return;
            } else if (key === "animation") {
                this.modalOptions.class = this.modalOptions.class.replace("animated " + ov, "");
                if (nv) {
                    this.modalOptions.class = this.modalOptions.class + "animated " + nv;
                }
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        BaseDialog.prototype.ngOnDestroy = function() {
            this.close();
            this.deRegister(this.viewParent);
            _super.prototype.ngOnDestroy.call(this);
        };
        return BaseDialog;
    }(base.BaseComponent);
    var DEFAULT_CLS$1 = "app-dialog-header modal-header";
    var DEFAULT_ICON_DIMENSIONS = "21px";
    var DialogHeaderComponent = function() {
        function DialogHeaderComponent(elRef, dialogRef) {
            this.dialogRef = dialogRef;
            this.iconwidth = DEFAULT_ICON_DIMENSIONS;
            this.iconheight = DEFAULT_ICON_DIMENSIONS;
            this.closable = true;
            core.addClass(elRef.nativeElement, DEFAULT_CLS$1);
        }
        Object.defineProperty(DialogHeaderComponent.prototype, "isClosable", {
            get: function() {
                return core.toBoolean(this.closable);
            },
            enumerable: true,
            configurable: true
        });
        DialogHeaderComponent.prototype.closeDialog = function() {
            this.dialogRef.close();
        };
        DialogHeaderComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "div[wmDialogHeader]",
                template: '<button *ngIf="isClosable" aria-label="Close" class="app-dialog-close close" (click)="closeDialog();" title="Close">\n    <span aria-hidden="true">&times;</span>\n</button>\n<h4 class="app-dialog-title modal-title">\n    <i [ngClass]="iconclass" [ngStyle]="{width: iconwidth, height: iconheight, margin: iconmargin}"  *ngIf="iconclass && !iconurl"></i>\n    <img data-identifier="img" [src]="iconurl | image" *ngIf="iconurl" [ngStyle]="{width:iconwidth, height:iconheight, margin:iconmargin}"/>\n    <span class="dialog-heading" [textContent]="heading"></span>\n    <span class="dialog-sub-heading" *ngIf="subheading" [title]="subheading" [textContent]="subheading"></span>\n</h4>'
            } ]
        } ];
        DialogHeaderComponent.ctorParameters = function() {
            return [ {
                type: core$1.ElementRef
            }, {
                type: BaseDialog,
                decorators: [ {
                    type: core$1.Inject,
                    args: [ base.DialogRef ]
                } ]
            } ];
        };
        DialogHeaderComponent.propDecorators = {
            iconwidth: [ {
                type: core$1.Input
            } ],
            iconheight: [ {
                type: core$1.Input
            } ],
            iconmargin: [ {
                type: core$1.Input
            } ],
            iconclass: [ {
                type: core$1.Input
            } ],
            iconurl: [ {
                type: core$1.Input
            } ],
            closable: [ {
                type: core$1.Input
            } ],
            heading: [ {
                type: core$1.Input
            } ],
            subheading: [ {
                type: core$1.Input
            } ]
        };
        return DialogHeaderComponent;
    }();
    var components = [ DialogBodyDirective, DialogFooterDirective, DialogHeaderComponent ];
    var DialogModule = function() {
        function DialogModule() {}
        DialogModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ common.CommonModule, modal.ModalModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return DialogModule;
    }();
    exports.\u0275a = registerProps;
    exports.DialogBodyDirective = DialogBodyDirective;
    exports.DialogFooterDirective = DialogFooterDirective;
    exports.DialogHeaderComponent = DialogHeaderComponent;
    exports.BaseDialog = BaseDialog;
    exports.\u02750 = \u02750;
    exports.\u02751 = \u02751;
    exports.DialogModule = DialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/input"), require("@angular/core"), require("@wm/core"), require("@wm/components/dialogs"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs/alert-dialog", [ "exports", "@angular/common", "@wm/components/input", "@angular/core", "@wm/core", "@wm/components/dialogs", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = global.wm.components.dialogs || {}, 
    global.wm.components.dialogs.alertdialog = {}), global.ng.common, global.wm.components.input, global.ng.core, global.wm.core, global.wm.components.dialogs, global.wm.components.base);
})(this, function(exports, common, input, core, core$1, dialogs, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-alertdialog", new Map([ [ "alerttype", __assign({
            value: "error"
        }, base.PROP_STRING) ], [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "closable", {
            value: true,
            PROP_BOOLEAN: base.PROP_BOOLEAN
        } ], [ "iconclass", {
            value: "wi wi-warning",
            PROP_STRING: base.PROP_STRING
        } ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "message", __assign({
            value: "Am an alert box!"
        }, base.PROP_STRING) ], [ "modal", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "name", base.PROP_STRING ], [ "oktext", __assign({
            value: "OK"
        }, base.PROP_STRING) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "Alert"
        }, base.PROP_STRING) ] ]));
    };
    var DIALOG_CLS = "app-dialog modal-dialog app-alert-dialog";
    var WIDGET_INFO = {
        widgetType: "wm-alertdialog"
    };
    var AlertDialogComponent = function(_super) {
        __extends(AlertDialogComponent, _super);
        function AlertDialogComponent(inj, dialogClass, modal, closable) {
            var _this = this;
            if (modal === null || modal === undefined) {
                modal = false;
            }
            if (closable === null || closable === undefined) {
                closable = true;
            }
            var backdrop = core$1.toBoolean(modal) ? "static" : true;
            _this = _super.call(this, inj, WIDGET_INFO, {
                class: DIALOG_CLS + " " + (dialogClass || ""),
                backdrop: backdrop,
                keyboard: !core$1.toBoolean(modal)
            }) || this;
            return _this;
        }
        AlertDialogComponent.prototype.getTemplateRef = function() {
            return this.dialogTemplate;
        };
        AlertDialogComponent.prototype.onOk = function($event) {
            this.invokeEventCallback("ok", {
                $event: $event
            });
        };
        AlertDialogComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.register(this.viewParent);
        };
        AlertDialogComponent.initializeProps = registerProps();
        AlertDialogComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmAlertDialog]",
                template: '<ng-template #dialogTemplate>\n    <div wmDialogHeader [closable]="closable"\n         [iconclass]="iconclass"\n         [iconurl]="iconurl"\n         [iconwidth]="iconwidth"\n         [iconheight]="iconheight"\n         [iconmargin]="iconmargin"\n         [heading]="title"></div>\n    <div wmDialogBody>\n        <p class="app-dialog-message text-{{alerttype}}" [attr.aria-describedby]="message" [textContent]="message"></p>\n    </div>\n    <div wmDialogFooter>\n        <button wmButton class="btn-primary ok-action" caption.bind="oktext" aria-label="Submit button" (click)="onOk($event)"></button>\n    </div>\n</ng-template>\n',
                providers: [ base.provideAsWidgetRef(AlertDialogComponent), base.provideAsDialogRef(AlertDialogComponent) ]
            } ]
        } ];
        AlertDialogComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "class" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "modal" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "closable" ]
                } ]
            } ];
        };
        AlertDialogComponent.propDecorators = {
            dialogTemplate: [ {
                type: core.ViewChild,
                args: [ "dialogTemplate" ]
            } ]
        };
        return AlertDialogComponent;
    }(dialogs.BaseDialog);
    var components = [ AlertDialogComponent ];
    var AlertDialogModule = function() {
        function AlertDialogModule() {}
        AlertDialogModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, dialogs.DialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return AlertDialogModule;
    }();
    exports.\u0275a = AlertDialogComponent;
    exports.\u0275b = registerProps;
    exports.AlertDialogModule = AlertDialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/input"), require("@angular/core"), require("@wm/core"), require("@wm/components/dialogs"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs/confirm-dialog", [ "exports", "@angular/common", "@wm/components/input", "@angular/core", "@wm/core", "@wm/components/dialogs", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = global.wm.components.dialogs || {}, 
    global.wm.components.dialogs.confirmdialog = {}), global.ng.common, global.wm.components.input, global.ng.core, global.wm.core, global.wm.components.dialogs, global.wm.components.base);
})(this, function(exports, common, input, core, core$1, dialogs, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-confirmdialog", new Map([ [ "animation", base.PROP_STRING ], [ "canceltext", __assign({
            value: "CANCEL"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "closable", {
            value: true,
            PROP_BOOLEAN: base.PROP_BOOLEAN
        } ], [ "iconclass", {
            value: "wi wi-done",
            PROP_STRING: base.PROP_STRING
        } ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "message", __assign({
            value: "I am confirm box!"
        }, base.PROP_STRING) ], [ "modal", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "name", base.PROP_STRING ], [ "oktext", __assign({
            value: "OK"
        }, base.PROP_STRING) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "Confirm"
        }, base.PROP_STRING) ] ]));
    };
    var DIALOG_CLS = "app-dialog modal-dialog app-confirm-dialog";
    var WIDGET_INFO = {
        widgetType: "wm-confirmdialog"
    };
    var ConfirmDialogComponent = function(_super) {
        __extends(ConfirmDialogComponent, _super);
        function ConfirmDialogComponent(inj, dialogClass, modal, closable) {
            var _this = this;
            if (modal === null || modal === undefined) {
                modal = false;
            }
            if (closable === null || closable === undefined) {
                closable = true;
            }
            var backdrop = "static";
            _this = _super.call(this, inj, WIDGET_INFO, {
                class: DIALOG_CLS + " " + (dialogClass || ""),
                backdrop: backdrop,
                keyboard: !core$1.toBoolean(modal)
            }) || this;
            return _this;
        }
        ConfirmDialogComponent.prototype.getTemplateRef = function() {
            return this.dialogTemplate;
        };
        ConfirmDialogComponent.prototype.onOk = function($event) {
            this.invokeEventCallback("ok", {
                $event: $event
            });
        };
        ConfirmDialogComponent.prototype.onCancel = function($event) {
            this.invokeEventCallback("cancel", {
                $event: $event
            });
        };
        ConfirmDialogComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.register(this.viewParent);
        };
        ConfirmDialogComponent.initializeProps = registerProps();
        ConfirmDialogComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmConfirmDialog]",
                template: '<ng-template #dialogTemplate>\n    <div wmDialogHeader [closable]="closable"\n         [iconclass]="iconclass"\n         [iconurl]="iconurl"\n         [iconwidth]="iconwidth"\n         [iconheight]="iconheight"\n         [iconmargin]="iconmargin"\n         [heading]="title"></div>\n    <div wmDialogBody>\n        <p class="app-dialog-message {{messageclass}}" [attr.aria-describedby]="message">{{message}}</p>\n    </div>\n    <div wmDialogFooter>\n        <button wmButton class="btn-default btn-secondary cancel-action" caption.bind="canceltext" aria-label="Cancel button" (click)="onCancel($event)"></button>\n        <button wmButton class="btn-primary ok-action" caption.bind="oktext" aria-label="Submit button" (click)="onOk($event)"></button>\n    </div>\n</ng-template>\n',
                providers: [ base.provideAsWidgetRef(ConfirmDialogComponent), base.provideAsDialogRef(ConfirmDialogComponent) ]
            } ]
        } ];
        ConfirmDialogComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "class" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "modal" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "closable" ]
                } ]
            } ];
        };
        ConfirmDialogComponent.propDecorators = {
            dialogTemplate: [ {
                type: core.ViewChild,
                args: [ "dialogTemplate" ]
            } ]
        };
        return ConfirmDialogComponent;
    }(dialogs.BaseDialog);
    var components = [ ConfirmDialogComponent ];
    var ConfirmDialogModule = function() {
        function ConfirmDialogModule() {}
        ConfirmDialogModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, dialogs.DialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return ConfirmDialogModule;
    }();
    exports.\u0275a = ConfirmDialogComponent;
    exports.\u0275b = registerProps;
    exports.ConfirmDialogModule = ConfirmDialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/input"), require("@angular/core"), require("@wm/core"), require("@wm/components/dialogs"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs/design-dialog", [ "exports", "@angular/common", "@wm/components/input", "@angular/core", "@wm/core", "@wm/components/dialogs", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = global.wm.components.dialogs || {}, 
    global.wm.components.dialogs.designdialog = {}), global.ng.common, global.wm.components.input, global.ng.core, global.wm.core, global.wm.components.dialogs, global.wm.components.base);
})(this, function(exports, common, input, core, core$1, dialogs, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-dialog", new Map([ [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "closable", {
            value: true,
            PROP_BOOLEAN: base.PROP_BOOLEAN
        } ], [ "iconclass", {
            value: "wi wi-file-text",
            PROP_STRING: base.PROP_STRING
        } ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "modal", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "name", base.PROP_STRING ], [ "showheader", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "Information"
        }, base.PROP_STRING) ], [ "eventsource", base.PROP_ANY ] ]));
    };
    var DIALOG_CLS = "app-dialog modal-dialog";
    var WIDGET_INFO = {
        widgetType: "wm-dialog"
    };
    var \u02750 = {};
    var DialogComponent = function(_super) {
        __extends(DialogComponent, _super);
        function DialogComponent(inj, dialogClass, modal, closable, contexts) {
            var _this = this;
            if (modal === null || modal === undefined) {
                modal = true;
            }
            if (closable === null || closable === undefined) {
                closable = true;
            }
            contexts[0].closeDialog = function() {
                return _this.close();
            };
            var backdrop = core$1.toBoolean(modal) ? "static" : true;
            _this = _super.call(this, inj, WIDGET_INFO, {
                class: DIALOG_CLS + " " + (dialogClass || ""),
                backdrop: backdrop,
                keyboard: !core$1.toBoolean(modal)
            }) || this;
            return _this;
        }
        DialogComponent.prototype.getTemplateRef = function() {
            return this.dialogTemplate;
        };
        DialogComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.register(this.viewParent);
        };
        DialogComponent.initializeProps = registerProps();
        DialogComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmDialog]",
                template: '<ng-template #dialogTemplate>\n    <div wmDialogHeader [closable]="closable"\n         [iconclass]="iconclass"\n         [iconurl]="iconurl"\n         [iconwidth]="iconwidth"\n         [iconheight]="iconheight"\n         [iconmargin]="iconmargin"\n         [heading]="title"\n         *ngIf="showheader"\n    ></div>\n    <div wmDialogBody>\n        <ng-container *ngTemplateOutlet="dialogBody"></ng-container>\n    </div>\n    <ng-container *ngTemplateOutlet="dialogFooter"></ng-container>\n</ng-template>',
                providers: [ base.provideAsWidgetRef(DialogComponent), base.provideAsDialogRef(DialogComponent), {
                    provide: base.Context,
                    useValue: \u02750,
                    multi: true
                } ]
            } ]
        } ];
        DialogComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "class" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "modal" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "closable" ]
                } ]
            }, {
                type: Array,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ base.Context ]
                } ]
            } ];
        };
        DialogComponent.propDecorators = {
            dialogTemplate: [ {
                type: core.ViewChild,
                args: [ "dialogTemplate", {
                    read: core.TemplateRef
                } ]
            } ],
            dialogBody: [ {
                type: core.ContentChild,
                args: [ "dialogBody", {
                    read: core.TemplateRef
                } ]
            } ],
            dialogFooter: [ {
                type: core.ContentChild,
                args: [ "dialogFooter", {
                    read: core.TemplateRef
                } ]
            } ]
        };
        return DialogComponent;
    }(dialogs.BaseDialog);
    var components = [ DialogComponent ];
    var DesignDialogModule = function() {
        function DesignDialogModule() {}
        DesignDialogModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, dialogs.DialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return DesignDialogModule;
    }();
    exports.\u0275a = DialogComponent;
    exports.\u0275b = registerProps;
    exports.DesignDialogModule = DesignDialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/platform-browser"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/page", [ "exports", "@angular/common", "@angular/platform-browser", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.page = {}), global.ng.common, global.ng.platformBrowser, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, platformBrowser, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-page", new Map([ [ "pagetitle", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-page container";
    var WIDGET_CONFIG = {
        widgetType: "wm-page",
        hostClass: DEFAULT_CLS
    };
    var PageDirective = function(_super) {
        __extends(PageDirective, _super);
        function PageDirective(inj, titleService) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.titleService = titleService;
            _this._eventNotifier = new core$1.EventNotifier(false);
            return _this;
        }
        PageDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "pagetitle") {
                this.titleService.setTitle(nv);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        PageDirective.prototype.notify = function(eventName) {
            var data = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                data[_i - 1] = arguments[_i];
            }
            this._eventNotifier.notify.apply(this._eventNotifier, arguments);
        };
        PageDirective.prototype.subscribe = function(eventName, callback) {
            return this._eventNotifier.subscribe(eventName, callback);
        };
        PageDirective.prototype.ngAfterViewInit = function() {
            var _this = this;
            setTimeout(function() {
                _this._eventNotifier.start();
                base.updateDeviceView(_this.nativeElement, _this.getAppInstance().isTabletApplicationType);
            }, 1);
        };
        PageDirective.prototype.ngOnDestroy = function() {
            this._eventNotifier.destroy();
        };
        PageDirective.initializeProps = registerProps();
        PageDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmPage]",
                providers: [ base.provideAsWidgetRef(PageDirective) ]
            } ]
        } ];
        PageDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: platformBrowser.Title
            } ];
        };
        return PageDirective;
    }(base.StylableComponent);
    var registerProps$1 = function() {
        base.register("wm-content", new Map([ [ "name", base.PROP_STRING ], [ "class", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS$1 = "app-content clearfix";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-content",
        hostClass: DEFAULT_CLS$1
    };
    var ContentComponent = function(_super) {
        __extends(ContentComponent, _super);
        function ContentComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        ContentComponent.initializeProps = registerProps$1();
        ContentComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmContent]",
                template: '<div class="row app-content-row clearfix">\n    <ng-content></ng-content>\n</div>',
                providers: [ base.provideAsWidgetRef(ContentComponent) ]
            } ]
        } ];
        ContentComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return ContentComponent;
    }(base.StylableComponent);
    var registerProps$2 = function() {
        base.register("wm-page-content", new Map([ [ "class", base.PROP_STRING ], [ "columnwidth", base.PROP_NUMBER ], [ "content", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "pulltorefresh", __assign({
            value: core$1.isMobileApp()
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$2 = "app-page-content app-content-column";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-page-content",
        hostClass: DEFAULT_CLS$2
    };
    var PageContentComponent = function(_super) {
        __extends(PageContentComponent, _super);
        function PageContentComponent(inj, app) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            _this.app = app;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            _this.registerDestroyListener(_this.app.subscribe("pullToRefresh:enable", function() {
                _this.childPullToRefresh = true;
                _this.initPullToRefresh();
            }));
            return _this;
        }
        PageContentComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "columnwidth") {
                core$1.switchClass(this.nativeElement, "col-md-" + nv + " col-sm-" + nv, "col-md-" + ov + " col-sm-" + ov);
            } else if (key === "pulltorefresh" && nv) {
                setTimeout(function() {
                    _this.initPullToRefresh();
                });
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        PageContentComponent.prototype.initPullToRefresh = function() {
            var _this = this;
            var hasPullToRefreshEvent = this.hasEventCallback("pulltorefresh");
            if (!this.pullToRefreshIns && (this.childPullToRefresh || hasPullToRefreshEvent) && this.pulltorefresh) {
                this.pullToRefreshIns = new base.PullToRefresh($(this.nativeElement), this.app, function() {
                    if (hasPullToRefreshEvent) {
                        _this.invokeEventCallback("pulltorefresh");
                    } else {
                        _this.app.notify("pulltorefresh");
                    }
                });
                this.registerDestroyListener(function() {
                    if (_this.pullToRefreshIns.cancelSubscription) {
                        _this.pullToRefreshIns.cancelSubscription();
                    }
                });
            }
        };
        PageContentComponent.initializeProps = registerProps$2();
        PageContentComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmPageContent]",
                template: "<ng-content></ng-content>",
                providers: [ base.provideAsWidgetRef(PageContentComponent) ]
            } ]
        } ];
        PageContentComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core$1.App
            } ];
        };
        return PageContentComponent;
    }(base.StylableComponent);
    var components = [ PageDirective, ContentComponent, PageContentComponent ];
    var PageModule = function() {
        function PageModule() {}
        PageModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return PageModule;
    }();
    exports.\u0275b = ContentComponent;
    exports.\u0275c = registerProps$1;
    exports.\u0275d = PageContentComponent;
    exports.\u0275e = registerProps$2;
    exports.\u0275a = registerProps;
    exports.PageModule = PageModule;
    exports.PageDirective = PageDirective;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/page/footer", [ "exports", "@angular/common", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.page = global.wm.components.page || {}, 
    global.wm.components.page.footer = {}), global.ng.common, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-footer", new Map([ [ "name", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "content", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-footer clearfix";
    var WIDGET_CONFIG = {
        widgetType: "wm-footer",
        hostClass: DEFAULT_CLS
    };
    var FooterDirective = function(_super) {
        __extends(FooterDirective, _super);
        function FooterDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        FooterDirective.initializeProps = registerProps();
        FooterDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmFooter]",
                providers: [ base.provideAsWidgetRef(FooterDirective) ]
            } ]
        } ];
        FooterDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return FooterDirective;
    }(base.StylableComponent);
    var components = [ FooterDirective ];
    var FooterModule = function() {
        function FooterModule() {}
        FooterModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return FooterModule;
    }();
    exports.\u0275a = FooterDirective;
    exports.\u0275b = registerProps;
    exports.FooterModule = FooterModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/page/header", [ "exports", "@angular/common", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.page = global.wm.components.page || {}, 
    global.wm.components.page.header = {}), global.ng.common, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-header", new Map([ [ "name", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "content", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-header clearfix";
    var WIDGET_CONFIG = {
        widgetType: "wm-header",
        hostClass: DEFAULT_CLS
    };
    var HeaderComponent = function(_super) {
        __extends(HeaderComponent, _super);
        function HeaderComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        HeaderComponent.initializeProps = registerProps();
        HeaderComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmHeader]",
                template: '<div class="app-header-menu" data-role="page-left-panel-icon">\n    <a class="app-header-action">\n        <i class="wi wi-menu"></i>\n    </a>\n</div>\n<div class="app-header-container" partial-container-target></div>',
                providers: [ base.provideAsWidgetRef(HeaderComponent) ]
            } ]
        } ];
        HeaderComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return HeaderComponent;
    }(base.StylableComponent);
    var components = [ HeaderComponent ];
    var HeaderModule = function() {
        function HeaderModule() {}
        HeaderModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return HeaderModule;
    }();
    exports.\u0275a = HeaderComponent;
    exports.\u0275b = registerProps;
    exports.HeaderModule = HeaderModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/page"), require("@wm/components/base"), require("@swipey"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/components/page/left-panel", [ "exports", "@angular/common", "@angular/core", "@wm/components/page", "@wm/components/base", "@swipey", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.page = global.wm.components.page || {}, 
    global.wm.components.page.leftpanel = {}), global.ng.common, global.ng.core, global.wm.components.page, global.wm.components.base, global.swipey, global.wm.core);
})(this, function(exports, common, core, page, base, _swipey, core$1) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-left-panel", new Map([ [ "animation", __assign({
            value: "slide-in"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "columnwidth", __assign({
            value: 3
        }, base.PROP_NUMBER) ], [ "content", base.PROP_STRING ], [ "gestures", __assign({
            value: "on"
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "xscolumnwidth", __assign({
            value: 10
        }, base.PROP_NUMBER) ] ]));
    };
    var LeftPanelAnimator = function(_super) {
        __extends(LeftPanelAnimator, _super);
        function LeftPanelAnimator(leftPanel) {
            var _this = _super.call(this) || this;
            _this.leftPanel = leftPanel;
            _this.init(_this.leftPanel.$ele, _this.leftPanel.$page);
            return _this;
        }
        LeftPanelAnimator.prototype.bounds = function() {
            var offset = 0;
            this.setGesturesEnabled(this.leftPanel.isGesturesEnabled());
            if (!this._width) {
                this._pageContainerWidth = this.leftPanel.$page.width();
                this._leftPanelWidth = this.leftPanel.$ele.width();
                this._maxX = this._leftPanelWidth / this._pageContainerWidth * 100;
                this._width = this.leftPanel.animation === exports.AnimationType.SLIDE_IN ? this._pageContainerWidth : this._leftPanelWidth;
            }
            this._expanded = this.leftPanel.expanded;
            if (this._expanded) {
                return {
                    center: this._leftPanelWidth,
                    lower: -(this._leftPanelWidth - offset)
                };
            }
            if (this.leftPanel.app.isTabletApplicationType) {
                offset = 53.32;
            }
            return {
                center: 0,
                upper: this._leftPanelWidth - offset
            };
        };
        LeftPanelAnimator.prototype.context = function() {
            return {
                w: this._width,
                pageW: this._pageContainerWidth,
                leftW: this._leftPanelWidth,
                maxX: this._maxX,
                limit: function(min, v, max) {
                    if (v < min) {
                        return min;
                    }
                    if (v > max) {
                        return max;
                    }
                    return v;
                }
            };
        };
        LeftPanelAnimator.prototype.animation = function() {
            this._$animatedElements = this.leftPanel.$ele;
            if (this.leftPanel.animation === exports.AnimationType.SLIDE_IN) {
                this._$animatedElements = this._$animatedElements.add(this.leftPanel.$page);
                if (this.leftPanel.app.isTabletApplicationType) {
                    return [ {
                        target: this.leftPanel.$ele,
                        css: {
                            transform: "translate3d(${{ limit(-100, -($d * 100 / leftW), 0) + '%' }}, 0, 0)"
                        }
                    }, {
                        target: this.leftPanel.$page,
                        css: {
                            transform: "translate3d(${{ (($d) * 100 / pageW) + '%' }}, 0, 0)",
                            width: "${{ (pageW - $d) + 'px' }}",
                            "z-index": 101
                        }
                    } ];
                }
                return [ {
                    target: this.leftPanel.$ele,
                    css: {
                        transform: "translate3d(-100%, 0, 0)",
                        opacity: 1,
                        "z-index": 101
                    }
                }, {
                    target: this.leftPanel.$page,
                    css: {
                        transform: "translate3d(${{ limit( 0, ((($D + $d) * 100 / w)), maxX ) + '%' }}, 0, 0)",
                        opacity: 1,
                        "z-index": 101
                    }
                } ];
            } else {
                return {
                    transform: "translate3d(${{ limit( -100, ((($D + $d) * 100 / w) - 100), 0 ) + '%'}}, 0, 0)",
                    opacity: 1,
                    "z-index": 101
                };
            }
        };
        LeftPanelAnimator.prototype.onLower = function() {
            this._expanded = false;
            this.leftPanel.collapse();
            this.resetTransition();
            core$1.$appDigest();
        };
        LeftPanelAnimator.prototype.onUpper = function() {
            this._expanded = true;
            this.leftPanel.expand();
            this.resetTransition();
            core$1.$appDigest();
        };
        LeftPanelAnimator.prototype.resetTransition = function() {
            var _this = this;
            if (this._$animatedElements) {
                setTimeout(function() {
                    _this._$animatedElements.css({
                        transform: "",
                        opacity: "",
                        "z-index": "",
                        width: ""
                    });
                }, 100);
            }
        };
        return LeftPanelAnimator;
    }(_swipey.SwipeAnimation);
    var DEFAULT_CLS = "app-left-panel left-panel-collapsed";
    var WIDGET_CONFIG = {
        widgetType: "wm-left-panel",
        hostClass: DEFAULT_CLS
    };
    (function(AnimationType) {
        AnimationType["SLIDE_IN"] = "slide-in";
        AnimationType["SLIDE_OVER"] = "slide-over";
    })(exports.AnimationType || (exports.AnimationType = {}));
    var LeftPanelDirective = function(_super) {
        __extends(LeftPanelDirective, _super);
        function LeftPanelDirective(app, page$$1, inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.app = app;
            _this.page = page$$1;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            _this.$ele = _this.$element;
            _this.$page = page$$1.$element;
            core$1.addClass(_this.$page[0], "left-panel-collapsed-container");
            if (_this.columnwidth) {
                _this.setLeftPanelWidth([ "md", "sm" ], _this.columnwidth);
            }
            if (_this.app.isTabletApplicationType) {
                core$1.addClass(_this.nativeElement, "wm-tablet-app-left-panel");
            }
            return _this;
        }
        LeftPanelDirective.prototype.collapse = function() {
            core$1.addClass(this.nativeElement, "swipee-transition");
            core$1.switchClass(this.nativeElement, "left-panel-collapsed", "left-panel-expanded");
            this.expanded = false;
            core$1.switchClass(this.$page[0], "left-panel-collapsed-container", "left-panel-expanded-container");
            if (this.animation === exports.AnimationType.SLIDE_IN) {
                this.setPageWidthAndPosition([ "md", "sm" ], null, this.columnwidth);
                this.setPageWidthAndPosition([ "xs" ], null, this.xscolumnwidth);
            }
            if (this._destroyCollapseActionListener) {
                this._destroyCollapseActionListener();
            }
            this.page.notify("wmLeftPanel:collapse");
        };
        LeftPanelDirective.prototype.expand = function() {
            core$1.removeClass(this.nativeElement, "swipee-transition");
            core$1.switchClass(this.nativeElement, "left-panel-expanded", "left-panel-collapsed");
            this.expanded = true;
            if (!(this.app.isTabletApplicationType && this.animation === exports.AnimationType.SLIDE_IN)) {
                this._destroyCollapseActionListener = this.listenForCollapseAction();
            }
            core$1.switchClass(this.$page[0], "left-panel-expanded-container", "left-panel-collapsed-container");
            if (this.animation === exports.AnimationType.SLIDE_IN) {
                this.setPageWidthAndPosition([ "md", "sm" ], this.columnwidth);
                this.setPageWidthAndPosition([ "xs" ], this.xscolumnwidth);
            }
            this.page.notify("wmLeftPanel:expand");
        };
        LeftPanelDirective.prototype.isGesturesEnabled = function() {
            return this.gestures === "on";
        };
        LeftPanelDirective.prototype.isVisible = function() {
            return this.expanded;
        };
        LeftPanelDirective.prototype.onPropertyChange = function(key, nv, ov) {
            switch (key) {
              case "animation":
                if (nv === exports.AnimationType.SLIDE_IN) {
                    core$1.removeClass(this.$page[0], "slide-over-left-panel-container");
                    core$1.addClass(this.$page[0], "slide-in-left-panel-container");
                    this.setPageWidthAndPosition([ "md", "sm" ], this.columnwidth);
                    this.setPageWidthAndPosition([ "xs" ], this.xscolumnwidth);
                } else if (nv === exports.AnimationType.SLIDE_OVER) {
                    core$1.removeClass(this.$page[0], "slide-in-left-panel-container");
                    core$1.addClass(this.$page[0], "slide-over-left-panel-container");
                }
                this._leftPanelAnimator = new LeftPanelAnimator(this);
                core$1.switchClass(this.nativeElement, nv, ov);
                break;

              case "columnwidth":
                this.setLeftPanelWidth([ "md", "sm" ], nv, ov);
                if (this.animation === exports.AnimationType.SLIDE_IN) {
                    this.setPageWidthAndPosition([ "md", "sm" ], nv, ov);
                }
                break;

              case "expanded":
                core$1.toggleClass(this.nativeElement, "left-panel-expanded", nv);
                core$1.toggleClass(this.nativeElement, "left-panel-collapsed", !nv);
                break;

              case "xscolumnwidth":
                this.setLeftPanelWidth([ "xs" ], nv, ov);
                if (this.animation === exports.AnimationType.SLIDE_IN) {
                    this.setPageWidthAndPosition([ "xs" ], nv, ov);
                }
                break;

              default:
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        LeftPanelDirective.prototype.toggle = function() {
            var _this = this;
            if (this.app.isTabletApplicationType) {
                setTimeout(function() {
                    _this.expanded ? _this.collapse() : _this.expand();
                }, 50);
            } else {
                this.$ele.swipeAnimation(this.expanded ? "gotoLower" : "gotoUpper");
            }
        };
        LeftPanelDirective.prototype.listenForCollapseAction = function() {
            var _this = this;
            var eventName = "click.leftNavToggle";
            var skipEvent = false;
            this.$ele.on(eventName, function() {
                skipEvent = true;
            });
            this.$page.on(eventName, function() {
                if (!skipEvent) {
                    _this.toggle();
                }
                skipEvent = false;
            });
            return function() {
                _this.$ele.off(eventName);
                _this.$page.off(eventName);
            };
        };
        LeftPanelDirective.prototype.setLeftPanelWidth = function(devices, newVal, oldVal) {
            var _this = this;
            devices.forEach(function(device) {
                if (newVal) {
                    core$1.addClass(_this.nativeElement, "col-" + device + "-" + newVal);
                }
                if (oldVal) {
                    core$1.removeClass(_this.nativeElement, "col-" + device + "-" + oldVal);
                }
            });
        };
        LeftPanelDirective.prototype.setPageWidthAndPosition = function(devices, newVal, oldVal) {
            var _this = this;
            devices.forEach(function(device) {
                if (newVal) {
                    core$1.addClass(_this.$page[0], "left-panel-container-" + device + "-" + (12 - newVal));
                }
                if (oldVal) {
                    core$1.removeClass(_this.$page[0], "left-panel-container-" + device + "-" + (12 - oldVal));
                }
            });
        };
        LeftPanelDirective.initializeProps = registerProps();
        LeftPanelDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLeftPanel]",
                providers: [ base.provideAsWidgetRef(LeftPanelDirective) ]
            } ]
        } ];
        LeftPanelDirective.ctorParameters = function() {
            return [ {
                type: core$1.App
            }, {
                type: page.PageDirective
            }, {
                type: core.Injector
            } ];
        };
        return LeftPanelDirective;
    }(base.StylableComponent);
    var components = [ LeftPanelDirective ];
    var LeftPanelModule = function() {
        function LeftPanelModule() {}
        LeftPanelModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return LeftPanelModule;
    }();
    exports.\u0275a = registerProps;
    exports.LeftPanelModule = LeftPanelModule;
    exports.LeftPanelDirective = LeftPanelDirective;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/page/right-panel", [ "exports", "@angular/common", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.page = global.wm.components.page || {}, 
    global.wm.components.page.rightpanel = {}), global.ng.common, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-right-panel", new Map([ [ "class", base.PROP_STRING ], [ "columnwidth", base.PROP_NUMBER ], [ "content", base.PROP_STRING ], [ "name", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-right-panel";
    var WIDGET_CONFIG = {
        widgetType: "wm-right-panel",
        hostClass: DEFAULT_CLS
    };
    var RightPanelDirective = function(_super) {
        __extends(RightPanelDirective, _super);
        function RightPanelDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        RightPanelDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "columnwidth") {
                core$1.switchClass(this.nativeElement, "col-sm-" + nv, ov ? " col-sm-" + ov : "");
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        RightPanelDirective.initializeProps = registerProps();
        RightPanelDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmRightPanel]",
                providers: [ base.provideAsWidgetRef(RightPanelDirective) ]
            } ]
        } ];
        RightPanelDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return RightPanelDirective;
    }(base.StylableComponent);
    var components = [ RightPanelDirective ];
    var RightPanelModule = function() {
        function RightPanelModule() {}
        RightPanelModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return RightPanelModule;
    }();
    exports.\u0275a = RightPanelDirective;
    exports.\u0275b = registerProps;
    exports.RightPanelModule = RightPanelModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/page/top-nav", [ "exports", "@angular/common", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.page = global.wm.components.page || {}, 
    global.wm.components.page.topnav = {}), global.ng.common, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-top-nav", new Map([ [ "name", base.PROP_STRING ], [ "content", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-top-nav";
    var WIDGET_CONFIG = {
        widgetType: "wm-top-nav",
        hostClass: DEFAULT_CLS
    };
    var TopNavDirective = function(_super) {
        __extends(TopNavDirective, _super);
        function TopNavDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        TopNavDirective.initializeProps = registerProps();
        TopNavDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmTopNav]",
                providers: [ base.provideAsWidgetRef(TopNavDirective) ]
            } ]
        } ];
        TopNavDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return TopNavDirective;
    }(base.StylableComponent);
    var components = [ TopNavDirective ];
    var TopNavModule = function() {
        function TopNavModule() {}
        TopNavModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return TopNavModule;
    }();
    exports.\u0275a = TopNavDirective;
    exports.\u0275b = registerProps;
    exports.TopNavModule = TopNavModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/core"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/prefab", [ "exports", "@angular/common", "@wm/core", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.prefab = {}), global.ng.common, global.wm.core, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var prefabProps = new Map([ [ "animation", base.PROP_STRING ], [ "class", __assign({
        value: ""
    }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ] ]);
    var DEFAULT_CLS = "app-prefab";
    var registeredPropsSet = new Set();
    var PrefabDirective = function(_super) {
        __extends(PrefabDirective, _super);
        function PrefabDirective(inj, elRef, cdr, prefabName) {
            var _this = this;
            var widgetType = "wm-prefab-" + prefabName;
            var WIDGET_CONFIG = {
                widgetType: widgetType,
                hostClass: DEFAULT_CLS
            };
            _this = _super.call(this, inj, WIDGET_CONFIG, new Promise(function(res) {
                return _this.propsReady = res;
            })) || this;
            _this.prefabName = prefabName;
            _this.widgetType = widgetType;
            _this.name = elRef.nativeElement.getAttribute("name");
            base.styler(_this.nativeElement, _this);
            _this.registerReadyStateListener(function() {
                _super.prototype.onPropertyChange.call(_this, "name", _this.name);
            });
            return _this;
        }
        PrefabDirective.prototype.onStyleChange = function(key, nv, ov) {
            if (key === "height") {
                core.setCSS(this.nativeElement, "overflow", "auto");
            }
        };
        PrefabDirective.prototype.setProps = function(config) {
            if (!config || !config.properties) {
                return;
            }
            if (!registeredPropsSet.has(this.widgetType)) {
                base.register(this.widgetType, this.prepareProps(config.properties));
            }
            this.propsReady();
        };
        PrefabDirective.prototype.handleEvent = function() {};
        PrefabDirective.prototype.prepareProps = function(props) {
            if (props === void 0) {
                props = {};
            }
            var propsMap = new Map(prefabProps);
            Object.entries(props).forEach(function(_a) {
                var _b = __read(_a, 2), k = _b[0], v = _b[1];
                var type = base.PROP_TYPE.STRING;
                if (v.type === "boolean") {
                    type = base.PROP_TYPE.BOOLEAN;
                } else if (v.type === "number") {
                    type = base.PROP_TYPE.NUMBER;
                } else if (v.type !== "string") {
                    type = v.type;
                }
                propsMap.set(k, {
                    type: type,
                    value: _.startsWith(v.value, "bind:") ? undefined : v.value
                });
            });
            registeredPropsSet.add(this.widgetType);
            return propsMap;
        };
        PrefabDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "section[wmPrefab]",
                providers: [ base.provideAsWidgetRef(PrefabDirective) ]
            } ]
        } ];
        PrefabDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: core$1.ElementRef
            }, {
                type: core$1.ChangeDetectorRef
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "prefabname" ]
                } ]
            } ];
        };
        return PrefabDirective;
    }(base.StylableComponent);
    var registerProps = function() {
        base.register("wm-prefab-container", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$1 = "app-prefab-container full-height";
    var WIDGET_CONFIG = {
        widgetType: "wm-prefab-container",
        hostClass: DEFAULT_CLS$1
    };
    var PrefabContainerDirective = function(_super) {
        __extends(PrefabContainerDirective, _super);
        function PrefabContainerDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        PrefabContainerDirective.initializeProps = registerProps();
        PrefabContainerDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmPrefabContainer]",
                providers: [ base.provideAsWidgetRef(PrefabContainerDirective) ]
            } ]
        } ];
        PrefabContainerDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            } ];
        };
        return PrefabContainerDirective;
    }(base.StylableComponent);
    var components = [ PrefabDirective, PrefabContainerDirective ];
    var PrefabModule = function() {
        function PrefabModule() {}
        PrefabModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return PrefabModule;
    }();
    exports.\u0275a = registerProps;
    exports.PrefabModule = PrefabModule;
    exports.PrefabDirective = PrefabDirective;
    exports.PrefabContainerDirective = PrefabContainerDirective;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/forms"), require("ngx-bootstrap/pagination"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/data/pagination", [ "exports", "@angular/common", "@angular/forms", "ngx-bootstrap/pagination", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.data = global.wm.components.data || {}, 
    global.wm.components.data.pagination = {}), global.ng.common, global.ng.forms, global.ngxBootstrap, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, forms, pagination, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-pagination", new Map([ [ "boundarylinks", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "class", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "directionlinks", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "forceellipses", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "maxResults", base.PROP_NUMBER ], [ "maxsize", __assign({
            value: 5
        }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "navigation", __assign({
            value: "Basic"
        }, base.PROP_STRING) ], [ "navigationalign", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "navigationsize", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showrecordcount", base.PROP_BOOLEAN ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ] ]));
    };
    var DEFAULT_CLS = "app-datanavigator clearfix";
    var WIDGET_CONFIG = {
        widgetType: "wm-pagination",
        hostClass: DEFAULT_CLS
    };
    var sizeClasses = {
        Pager: {
            small: "pager-sm",
            large: "pager-lg"
        },
        Basic: {
            small: "pagination-sm",
            large: "pagination-lg"
        },
        Classic: {
            small: "pagination-sm",
            large: "pagination-lg"
        }
    };
    var PaginationComponent = function(_super) {
        __extends(PaginationComponent, _super);
        function PaginationComponent(inj, parent) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.parent = parent;
            _this.resultEmitter = new core.EventEmitter();
            _this.maxResultsEmitter = new core.EventEmitter();
            _this.dn = {
                currentPage: 1
            };
            _this.pageCount = 0;
            _this.isDisableNext = true;
            _this.isDisablePrevious = true;
            _this.isDisableFirst = true;
            _this.isDisableLast = true;
            _this._debouncedApplyDataset = core$1.debounce(function() {
                return _this.widget.dataset = _this.dataset;
            }, base.DEBOUNCE_TIMES.PAGINATION_DEBOUNCE_TIME);
            _this._debouncedPageChanged = core$1.debounce(function(event) {
                var currentPage = event && event.page;
                if (currentPage !== _this.dn.currentPage) {
                    var inst = _this.parent || _this;
                    _this.dn.currentPage = currentPage;
                    inst.invokeEventCallback("paginationchange", {
                        $event: undefined,
                        $index: _this.dn.currentPage
                    });
                    _this.goToPage();
                }
            }, base.DEBOUNCE_TIMES.PAGINATION_DEBOUNCE_TIME);
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        PaginationComponent.prototype.setResult = function(result) {
            this.result = result;
            this.resultEmitter.emit(this.result);
        };
        PaginationComponent.prototype.updateNavSize = function() {
            var sizeCls = sizeClasses[this.navcontrols];
            if (sizeCls && this.navigationsize) {
                this.navigationClass = sizeCls[this.navigationsize];
            } else {
                this.navigationClass = "";
            }
        };
        PaginationComponent.prototype.resetPageNavigation = function() {
            this.pageCount = 0;
            this.dn.currentPage = 1;
            this.dataSize = 0;
        };
        PaginationComponent.prototype.calculatePagingValues = function() {
            this.pageCount = this.dataSize > this.maxResults ? Math.ceil(this.dataSize / this.maxResults) : this.dataSize < 0 ? 0 : 1;
            this.dn.currentPage = this.dn.currentPage || 1;
        };
        PaginationComponent.prototype.setDefaultPagingValues = function(dataSize, maxResults, currentPage) {
            if (!dataSize && !maxResults) {
                this.pageCount = 1;
                this.dn.currentPage = 1;
                this.maxResults = dataSize;
                this.dataSize = dataSize;
            } else {
                this.maxResults = maxResults || this.maxResults;
                this.dataSize = core$1.isDefined(dataSize) ? dataSize : this.dataSize;
                this.dn.currentPage = currentPage || this.dn.currentPage;
                this.calculatePagingValues();
            }
            this.maxResultsEmitter.emit(this.maxResults);
        };
        PaginationComponent.prototype.checkDataSize = function(dataSize, numberOfElements, size) {
            if (dataSize === -1 || dataSize === core$1.AppConstants.INT_MAX_VALUE) {
                this.prevshowrecordcount = this.showrecordcount;
                this.isDisableLast = true;
                this.isDisableCount = true;
                this.showrecordcount = false;
                if (numberOfElements < size) {
                    this.isDisableNext = true;
                }
            } else {
                this.isDisableCount = false;
                this.showrecordcount = this.prevshowrecordcount || this.showrecordcount;
            }
        };
        PaginationComponent.prototype.disableNavigation = function() {
            var isCurrentPageFirst = this.dn.currentPage === 1, isCurrentPageLast = this.dn.currentPage === this.pageCount;
            this.isDisableFirst = this.isDisablePrevious = isCurrentPageFirst;
            this.isDisableNext = this.isDisableLast = isCurrentPageLast;
            this.isDisableCurrent = isCurrentPageFirst && isCurrentPageLast;
        };
        PaginationComponent.prototype.isDataSourceHasPaging = function() {
            return this.datasource && this.datasource.execute(core$1.DataSource.Operation.IS_PAGEABLE);
        };
        PaginationComponent.prototype.setNonPageableData = function(newVal) {
            var dataSize, maxResults, currentPage, startIndex;
            dataSize = _.isArray(newVal) ? newVal.length : _.isEmpty(newVal) ? 0 : 1;
            maxResults = this.options && this.options.maxResults || dataSize;
            if (this.datasource && this.datasource.execute(core$1.DataSource.Operation.IS_API_AWARE)) {
                currentPage = 1;
            } else {
                currentPage = this.dn.currentPage || 1;
            }
            this.setDefaultPagingValues(dataSize, maxResults, currentPage);
            this.disableNavigation();
            startIndex = (this.dn.currentPage - 1) * this.maxResults;
            this.setResult(_.isArray(newVal) ? newVal.slice(startIndex, startIndex + this.maxResults) : newVal);
        };
        PaginationComponent.prototype.setPagingValues = function(newVal) {
            var dataSize, maxResults, currentPage, dataSource;
            var variableOptions = {};
            this.__fullData = newVal;
            if (this.binddataset) {
                dataSource = this.datasource || {};
                variableOptions = dataSource._options || {};
                if (newVal) {
                    if (this.isDataSourceHasPaging()) {
                        this.pagination = this.datasource.execute(core$1.DataSource.Operation.GET_PAGING_OPTIONS) || {};
                        this.filterFields = variableOptions.filterFields || {};
                        this.sortOptions = variableOptions.orderBy || (_.isArray(this.pagination.sort) ? base.getOrderByExpr(this.pagination.sort) : "");
                        dataSize = this.pagination.totalElements;
                        maxResults = this.pagination.size;
                        if (this.pagination.numberOfElements > 0) {
                            if (core$1.isDefined(this.pagination.number)) {
                                this.dn.currentPage = this.pagination.number + 1;
                            }
                            currentPage = this.dn.currentPage || 1;
                        } else {
                            currentPage = 1;
                        }
                        this.setDefaultPagingValues(dataSize, maxResults, currentPage);
                        this.disableNavigation();
                        this.checkDataSize(dataSize, this.pagination.numberOfElements, this.pagination.size);
                        this.setResult(newVal);
                    } else if (!_.isString(newVal)) {
                        this.setNonPageableData(newVal);
                    }
                } else {
                    this.setResult(newVal);
                    this.resetPageNavigation();
                }
            } else {
                if (newVal && !_.isString(newVal)) {
                    this.setNonPageableData(newVal);
                }
            }
        };
        PaginationComponent.prototype.isFirstPage = function() {
            return this.dn.currentPage === 1 || !this.dn.currentPage;
        };
        PaginationComponent.prototype.isLastPage = function() {
            return this.dn.currentPage === this.pageCount;
        };
        PaginationComponent.prototype.goToLastPage = function(isRefresh, event, callback) {
            if (!this.isLastPage()) {
                this.dn.currentPage = this.pageCount;
                this.goToPage(event, callback);
            } else if (isRefresh) {
                this.goToPage(event, callback);
            }
        };
        PaginationComponent.prototype.goToFirstPage = function(isRefresh, event, callback) {
            if (!this.isFirstPage()) {
                this.dn.currentPage = 1;
                this.goToPage(event, callback);
            } else if (isRefresh) {
                this.goToPage(event, callback);
            }
        };
        PaginationComponent.prototype.goToPage = function(event, callback) {
            this.firstRow = (this.dn.currentPage - 1) * this.maxResults;
            this.getPageData(event, callback);
        };
        PaginationComponent.prototype.onPageDataReady = function(event, data, callback) {
            this.disableNavigation();
            this.invokeSetRecord(event, data);
            core$1.triggerFn(callback);
        };
        PaginationComponent.prototype.getPageData = function(event, callback) {
            var _this = this;
            var data, startIndex;
            if (this.isDataSourceHasPaging()) {
                this.datasource.execute(core$1.DataSource.Operation.LIST_RECORDS, {
                    page: this.dn.currentPage,
                    filterFields: this.filterFields,
                    orderBy: this.sortOptions,
                    matchMode: "anywhereignorecase"
                }).then(function(response) {
                    _this.onPageDataReady(event, response && response.data, callback);
                    core$1.$appDigest();
                }, function(error) {});
            } else {
                startIndex = (this.dn.currentPage - 1) * this.maxResults;
                data = _.isArray(this.__fullData) ? this.__fullData.slice(startIndex, startIndex + this.maxResults) : this.__fullData;
                this.setResult(data);
                this.onPageDataReady(event, data, callback);
            }
        };
        PaginationComponent.prototype.invokeSetRecord = function(event, data) {
            var pageInfo = {
                currentPage: this.dn.currentPage,
                size: this.maxResults,
                totalElements: this.dataSize,
                totalPages: this.pageCount
            };
            if (this.parent) {
                this.parent.invokeEventCallback("setrecord", {
                    $event: event,
                    $data: data,
                    $index: this.dn.currentPage,
                    pageInfo: pageInfo,
                    data: data
                });
            } else {
                this.invokeEventCallback("setrecord", {
                    $event: event,
                    $data: data,
                    $index: this.dn.currentPage,
                    pageInfo: pageInfo,
                    data: data
                });
            }
        };
        PaginationComponent.prototype.validateCurrentPage = function(event, callback) {
            if (event && (isNaN(this.dn.currentPage) || this.dn.currentPage <= 0 || this.pageCount && (this.dn.currentPage > this.pageCount || _.isNull(this.dn.currentPage)))) {
                $(event.target).closest("a").addClass("ng-invalid");
                return false;
            }
            return true;
        };
        PaginationComponent.prototype.onModelChange = function(event) {
            if (!this.validateCurrentPage(event)) {
                return;
            }
            this.goToPage(event);
        };
        PaginationComponent.prototype.onKeyDown = function(event) {
            var targetEle = $(event.target).closest("a");
            if (event.code === "KeyE") {
                targetEle.addClass("ng-invalid");
                return false;
            }
            targetEle.removeClass("ng-invalid");
            return true;
        };
        PaginationComponent.prototype.pageChanged = function(event) {
            this._debouncedPageChanged(event);
        };
        PaginationComponent.prototype.navigatePage = function(index, event, isRefresh, callback) {
            this.invokeEventCallback("paginationchange", {
                $event: undefined,
                $index: this.dn.currentPage
            });
            this.dn.currentPage = +this.dn.currentPage;
            switch (index) {
              case "first":
                this.goToFirstPage(isRefresh, event, callback);
                return;

              case "prev":
                if (this.isFirstPage() || !this.validateCurrentPage(event, callback)) {
                    return;
                }
                this.dn.currentPage -= 1;
                break;

              case "next":
                if (this.isLastPage() || !this.validateCurrentPage(event, callback)) {
                    return;
                }
                this.dn.currentPage += 1;
                break;

              case "last":
                this.goToLastPage(isRefresh, event, callback);
                return;

              default:
                break;
            }
            this.goToPage(event, callback);
        };
        PaginationComponent.prototype.setBindDataSet = function(binddataset, parent, dataSource, dataset, binddatasource, datasetBoundExpr) {
            var _this = this;
            var parts = binddataset.split(".");
            var bindPagingOptions;
            if (parts[0] === "Variables" || parts[0] === "Widgets") {
                bindPagingOptions = parts[0] + "." + parts[1] + ".pagination";
            }
            if (!binddatasource && dataset && !datasetBoundExpr) {
                this.dataset = dataset;
                this._debouncedApplyDataset();
                return;
            }
            this.binddataset = binddataset;
            setTimeout(function() {
                _this.registerDestroyListener(core$1.$watch(binddataset, parent, datasetBoundExpr ? dataSource : {}, function(nv) {
                    _this.dataset = nv;
                    _this._debouncedApplyDataset();
                }));
                if (!bindPagingOptions) {
                    return;
                }
                _this.registerDestroyListener(core$1.$watch(bindPagingOptions, parent, {}, function() {
                    return _this._debouncedApplyDataset();
                }));
            });
            if (!datasetBoundExpr) {
                this.datasource = dataSource;
            }
        };
        PaginationComponent.prototype.setDataSource = function(dataSource) {
            this.datasource = dataSource;
        };
        PaginationComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "dataset") {
                var data = void 0;
                if (this.parent && this.parent.onDataNavigatorDataSetChange) {
                    data = this.parent.onDataNavigatorDataSetChange(nv);
                } else {
                    data = nv;
                }
                this.setPagingValues(data);
            } else if (key === "navigation") {
                if (nv === "Advanced") {
                    this.navigation = "Classic";
                }
                this.updateNavSize();
                this.navcontrols = nv;
            } else if (key === "navigationsize") {
                this.updateNavSize();
            } else if (key === "navigationalign") {
                core$1.switchClass(this.nativeElement, "text-" + nv, "text-" + ov);
            } else if (key === "maxResults") {
                this.setPagingValues(this.dataset);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        PaginationComponent.prototype.ngAfterViewInit = function() {
            var paginationElem = this.nativeElement;
            paginationElem.onclick = function(event) {
                event.stopPropagation();
            };
        };
        PaginationComponent.initializeProps = registerProps();
        PaginationComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmPagination]",
                template: '\n<ul class="pagination advanced {{navigationClass}}" *ngIf="navcontrols === \'Classic\'">\n    <li [ngClass]="{\'disabled\':isDisableFirst}">\n        <a [title]="appLocale.LABEL_FIRST" name="first" href="javascript:void(0);" aria-label="First"\n           (click)="navigatePage(\'first\', $event)">\n            <span aria-hidden="true"><i class="wi wi-first-page"></i></span>\n            <span class="sr-only">{{appLocale.LABEL_FIRST}}</span>\n        </a>\n    </li>\n    <li [ngClass]="{\'disabled\':isDisablePrevious}">\n        <a [title]="appLocale.LABEL_PREVIOUS" name="prev" href="javascript:void(0);" aria-label="Previous"\n           (click)="navigatePage(\'prev\', $event)">\n            <span aria-hidden="true"><i class="wi wi-chevron-left"></i></span>\n            <span class="sr-only">{{appLocale.LABEL_PREVIOUS}}</span>\n        </a>\n    </li>\n    <li class="pagecount disabled">\n        <a><input type="number" [disabled]="isDisableCurrent" [(ngModel)]="dn.currentPage"\n                  (keydown)="onKeyDown($event)" (change)="onModelChange($event)" class="form-control"/></a>\n    </li>\n    <li class="disabled">\n        <a [hidden]="isDisableCount"> / {{pageCount}}</a>\n    </li>\n    <li [ngClass]="{\'disabled\':isDisableNext}">\n        <a [title]="appLocale.LABEL_NEXT" name="next" href="javascript:void(0);" aria-label="Next"\n           (click)="navigatePage(\'next\', $event)">\n            <span aria-hidden="true"><i class="wi wi-chevron-right"></i></span>\n            <span class="sr-only">{{appLocale.LABEL_NEXT}}</span>\n        </a>\n    </li>\n    <li [ngClass]="{\'disabled\':isDisableLast}">\n        <a [title]="appLocale.LABEL_LAST" name="last" href="javascript:void(0);" aria-label="Last"\n           (click)="navigatePage(\'last\', $event)">\n            <span aria-hidden="true"><i class="wi wi-last-page"></i></span>\n            <span class="sr-only">{{appLocale.LABEL_LAST}}</span>\n        </a>\n    </li>\n    <li *ngIf="showrecordcount" class="totalcount disabled">\n        <a>{{appLocale.LABEL_TOTAL_RECORDS}}: {{dataSize}}</a>\n    </li>\n</ul>\n<ul class="pager {{navigationClass}}" *ngIf="navcontrols === \'Pager\'">\n    <li class="previous" [ngClass]="{\'disabled\':isDisablePrevious}">\n        <a href="javascript:void(0);" (click)="navigatePage(\'prev\', $event)" aria-label="Previous">\n            <span aria-hidden="true"><i class="wi wi-chevron-left"></i></span>\n            {{appLocale.LABEL_PREVIOUS}}\n            <span class="sr-only">{{appLocale.LABEL_PREVIOUS}}</span>\n        </a>\n    </li>\n    <li class="next" [ngClass]="{\'disabled\':isDisableNext}">\n        <a href="javascript:void(0);" (click)="navigatePage(\'next\', $event)" aria-label="Next">\n            {{appLocale.LABEL_NEXT}}\n            <span aria-hidden="true"><i class="wi wi-chevron-right"></i></span>\n            <span class="sr-only">{{appLocale.LABEL_NEXT}}</span>\n        </a>\n    </li>\n</ul>\n\n<pagination class="pagination basic" [ngClass]="navigationClass" *ngIf="navcontrols === \'Basic\'"\n            [itemsPerPage]="maxResults" [totalItems]="dataSize"\n            [ngModel]="dn.currentPage" (pageChanged)="pageChanged($event)"\n            [boundaryLinks]="boundarylinks" [maxSize]="maxsize"\n            [directionLinks]="directionlinks" previousText="." nextText="." firstText="." lastText="."></pagination>\n\n<ul *ngIf="navcontrols === \'Basic\' && showrecordcount" class="pagination">\n    <li class="totalcount disabled basiccount"><a>{{appLocale.LABEL_TOTAL_RECORDS}}: {{dataSize}}</a></li>\n</ul>',
                providers: [ base.provideAsWidgetRef(PaginationComponent) ]
            } ]
        } ];
        PaginationComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: undefined,
                decorators: [ {
                    type: core.SkipSelf
                }, {
                    type: core.Inject,
                    args: [ base.WidgetRef ]
                } ]
            } ];
        };
        PaginationComponent.propDecorators = {
            resultEmitter: [ {
                type: core.Output
            } ],
            maxResultsEmitter: [ {
                type: core.Output
            } ]
        };
        return PaginationComponent;
    }(base.StylableComponent);
    var components = [ PaginationComponent ];
    var PaginationModule = function() {
        function PaginationModule() {}
        PaginationModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, forms.FormsModule, pagination.PaginationModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return PaginationModule;
    }();
    exports.\u0275a = registerProps;
    exports.PaginationModule = PaginationModule;
    exports.PaginationComponent = PaginationComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("ngx-bootstrap/dropdown"), require("@wm/components/basic"), require("@wm/components/navigation/menu"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/data/card", [ "exports", "@angular/common", "ngx-bootstrap/dropdown", "@wm/components/basic", "@wm/components/navigation/menu", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.data = global.wm.components.data || {}, 
    global.wm.components.data.card = {}), global.ng.common, global.ngxBootstrap, global.wm.components.basic, global.wm.components.navigation.menu, global.ng.core, global.wm.components.base);
})(this, function(exports, common, dropdown, basic, menu, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-card", new Map([ [ "actions", base.PROP_STRING ], [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "imageheight", __assign({
            value: "200px"
        }, base.PROP_STRING) ], [ "itemaction", base.PROP_STRING ], [ "itemchildren", base.PROP_STRING ], [ "itemicon", base.PROP_STRING ], [ "itemlabel", base.PROP_STRING ], [ "itemlink", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "picturesource", base.PROP_STRING ], [ "picturetitle", __assign({
            value: ""
        }, base.PROP_STRING) ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "subheading", base.PROP_STRING ], [ "title", base.PROP_STRING ], [ "userrole", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-card card app-panel";
    var WIDGET_CONFIG = {
        widgetType: "wm-card",
        hostClass: DEFAULT_CLS
    };
    var CardComponent = function(_super) {
        __extends(CardComponent, _super);
        function CardComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.SHELL);
            return _this;
        }
        CardComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.cardContainerElRef.nativeElement, this, base.APPLY_STYLES_TYPE.INNER_SHELL);
        };
        CardComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "title" || key === "subheading" || key === "iconclass" || key === "iconurl" || key === "actions") {
                this.showHeader = !!(this.title || this.subheading || this.iconclass || this.iconurl || this.actions);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        CardComponent.initializeProps = registerProps();
        CardComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmCard]",
                template: '<div class="app-card-header panel-heading" *ngIf="showHeader">\n    <div class="app-card-avatar" *ngIf="iconclass || iconurl">\n        <i class="app-icon" [ngClass]="iconclass" *ngIf="iconclass && !iconurl"></i>\n        <img class="img-circle" [src]="iconurl" *ngIf="iconurl" />\n    </div>\n    <div class="app-card-header-text">\n        <h4 class="card-heading" [textContent]="title"></h4>\n        <h5 class="card-subheading text-muted" [textContent]="subheading"></h5>\n    </div>\n    <div class="panel-actions" *ngIf="actions">\n        \x3c!-- TODO(punith) need to bind autoclose--\x3e\n        <div wmMenu dropdown\n             [autoClose]="autoclose !== \'disabled\'"\n             class="panel-action"\n             type="anchor"\n             iconclass="wi wi-more-vert"\n             menuposition="down,left"\n             hint="Actions"\n             caption=""\n             dataset.bind="actions">\n        </div>\n    </div>\n</div>\n<div class="app-card-image" *ngIf="picturesource"  [ngStyle]="{\'max-height\':imageheight}">\n   <img wmPicture class="card-image" picturesource.bind="picturesource" hint.bind="picturetitle" />\n</div>\n<div #cardContainerWrapper>\n    <ng-content select="[wmCardContent]"></ng-content>\n</div>\n<div>\n    <ng-content select="[wmCardActions]"></ng-content>\n</div>\n<div>\n    <ng-content select="[wmCardFooter]"></ng-content>\n</div>',
                providers: [ base.provideAsWidgetRef(CardComponent) ]
            } ]
        } ];
        CardComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        CardComponent.propDecorators = {
            cardContainerElRef: [ {
                type: core.ViewChild,
                args: [ "cardContainerWrapper" ]
            } ]
        };
        return CardComponent;
    }(menu.MenuAdapterComponent);
    var registerProps$1 = function() {
        base.register("wm-card-actions", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$1 = "app-card-actions";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-card-actions",
        hostClass: DEFAULT_CLS$1
    };
    var CardActionsDirective = function(_super) {
        __extends(CardActionsDirective, _super);
        function CardActionsDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        CardActionsDirective.initializeProps = registerProps$1();
        CardActionsDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmCardActions]"
            } ]
        } ];
        CardActionsDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return CardActionsDirective;
    }(base.StylableComponent);
    var registerProps$2 = function() {
        base.register("wm-card-content", new Map([ [ "class", base.PROP_STRING ], [ "content", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$2 = "app-card-content card-body card-block";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-card-content",
        hostClass: DEFAULT_CLS$2
    };
    var CardContentComponent = function(_super) {
        __extends(CardContentComponent, _super);
        function CardContentComponent(inj) {
            return _super.call(this, inj, WIDGET_CONFIG$2) || this;
        }
        CardContentComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.cardContentContainerElRef.nativeElement, this, base.APPLY_STYLES_TYPE.CONTAINER);
        };
        CardContentComponent.initializeProps = registerProps$2();
        CardContentComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmCardContent]",
                template: "<div partial-container-target #cardContentContainer>\n    <ng-content></ng-content>\n</div>",
                providers: [ base.provideAsWidgetRef(CardContentComponent) ]
            } ]
        } ];
        CardContentComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        CardContentComponent.propDecorators = {
            cardContentContainerElRef: [ {
                type: core.ViewChild,
                args: [ "cardContentContainer" ]
            } ]
        };
        return CardContentComponent;
    }(base.StylableComponent);
    var registerProps$3 = function() {
        base.register("wm-card-footer", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$3 = "app-card-footer text-muted card-footer";
    var WIDGET_CONFIG$3 = {
        widgetType: "wm-card-footer",
        hostClass: DEFAULT_CLS$3
    };
    var CardFooterDirective = function(_super) {
        __extends(CardFooterDirective, _super);
        function CardFooterDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$3) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        CardFooterDirective.initializeProps = registerProps$3();
        CardFooterDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmCardFooter]"
            } ]
        } ];
        CardFooterDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return CardFooterDirective;
    }(base.StylableComponent);
    var components = [ CardComponent, CardActionsDirective, CardContentComponent, CardFooterDirective ];
    var CardModule = function() {
        function CardModule() {}
        CardModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ basic.BasicModule, dropdown.BsDropdownModule, common.CommonModule, menu.MenuModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return CardModule;
    }();
    exports.\u0275c = CardActionsDirective;
    exports.\u0275d = registerProps$1;
    exports.\u0275e = CardContentComponent;
    exports.\u0275f = registerProps$2;
    exports.\u0275g = CardFooterDirective;
    exports.\u0275h = registerProps$3;
    exports.\u0275a = CardComponent;
    exports.\u0275b = registerProps;
    exports.CardModule = CardModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/data/pagination"), require("@wm/components/input"), require("@wm/components/base"), require("@angular/core"), require("rxjs"), require("@wm/core"), require("@swipey")) : typeof define === "function" && define.amd ? define("@wm/components/data/list", [ "exports", "@angular/common", "@wm/components/data/pagination", "@wm/components/input", "@wm/components/base", "@angular/core", "rxjs", "@wm/core", "@swipey" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.data = global.wm.components.data || {}, 
    global.wm.components.data.list = {}), global.ng.common, global.wm.components.data.pagination, global.wm.components.input, global.wm.components.base, global.ng.core, global.rxjs, global.wm.core, global.swipey);
})(this, function(exports, common, pagination, input, base, core, rxjs, core$1, _swipey) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-list", new Map([ [ "boundarylinks", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "class", base.PROP_STRING ], [ "collapsible", base.PROP_BOOLEAN ], [ "dateformat", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "datasource", base.PROP_ANY ], [ "directionlinks", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "disableitem", base.PROP_BOOLEAN ], [ "enablereorder", base.PROP_BOOLEAN ], [ "forceellipses", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "groupby", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "itemclass", __assign({
            value: ""
        }, base.PROP_STRING) ], [ "itemsperrow", base.PROP_STRING ], [ "listclass", __assign({
            value: "list-group"
        }, base.PROP_STRING) ], [ "multiselect", base.PROP_BOOLEAN ], [ "loadingdatamsg", __assign({
            value: "Loading..."
        }, base.PROP_STRING) ], [ "loadingicon", __assign({
            value: "fa fa-circle-o-notch"
        }, base.PROP_STRING) ], [ "match", base.PROP_STRING ], [ "maxsize", __assign({
            value: 5
        }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "navigation", base.PROP_STRING ], [ "navigationalign", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "nodatamessage", __assign({
            value: "No data found"
        }, base.PROP_STRING) ], [ "ondemandmessage", __assign({
            value: "Load More"
        }, base.PROP_STRING) ], [ "orderby", base.PROP_STRING ], [ "paginationclass", base.PROP_STRING ], [ "pagesize", base.PROP_NUMBER ], [ "pulltorefresh", __assign({
            value: core$1.isMobileApp()
        }, base.PROP_BOOLEAN) ], [ "selectfirstitem", base.PROP_BOOLEAN ], [ "selectionlimit", base.PROP_NUMBER ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showcount", base.PROP_BOOLEAN ], [ "showrecordcount", base.PROP_BOOLEAN ], [ "subheading", base.PROP_STRING ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", base.PROP_STRING ] ]));
    };
    var ListItemDirective = function() {
        function ListItemDirective(inj, elRef, app) {
            this.inj = inj;
            this.app = app;
            this.destroy = new rxjs.Subject();
            this.destroy$ = this.destroy.asObservable();
            this.itemClass = "";
            this._currentItemWidgets = {};
            this.isActive = false;
            this.disableItem = false;
            this.nativeElement = elRef.nativeElement;
            this.listComponent = inj.view.component;
            this.context = inj.view.context;
            this.itemClassWatcher(this.listComponent);
            this.disableItemWatcher(this.listComponent);
            $(this.nativeElement).data("listItemContext", this);
        }
        ListItemDirective.prototype.onFocus = function() {
            this.listComponent.lastSelectedItem = this;
        };
        Object.defineProperty(ListItemDirective.prototype, "$index", {
            get: function() {
                return this.context.index;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListItemDirective.prototype, "$even", {
            get: function() {
                return this.context.even;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListItemDirective.prototype, "$odd", {
            get: function() {
                return this.context.odd;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListItemDirective.prototype, "$first", {
            get: function() {
                return this.context.first;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListItemDirective.prototype, "$last", {
            get: function() {
                return this.context.last;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListItemDirective.prototype, "currentItemWidgets", {
            get: function() {
                var componentElements = Array.from(this.nativeElement.querySelectorAll("[widget-id]"));
                return Object.assign(this._currentItemWidgets, componentElements.reduce(function(result, comp) {
                    result[comp.widget.name] = comp.widget;
                    return result;
                }, {}));
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListItemDirective.prototype, "wmListItem", {
            set: function(val) {
                this.item = val;
            },
            enumerable: true,
            configurable: true
        });
        ListItemDirective.prototype.registerWatch = function(expression, callback) {
            this.destroy$.subscribe(core$1.$watch(expression, this.listComponent.viewParent, this, callback));
        };
        ListItemDirective.prototype.itemClassWatcher = function(listComponent) {
            var _this = this;
            if (listComponent.binditemclass) {
                this.registerWatch(listComponent.binditemclass, function(nv) {
                    return _this.itemClass = nv || "";
                });
            } else {
                this.itemClass = listComponent.itemclass;
            }
        };
        ListItemDirective.prototype.disableItemWatcher = function($list) {
            var _this = this;
            if ($list.binddisableitem) {
                this.registerWatch($list.binddisableitem, function(nv) {
                    return _this.disableItem = nv || false;
                });
            } else {
                this.disableItem = $list.disableitem || false;
            }
        };
        ListItemDirective.prototype.triggerWMEvent = function(eventName) {
            core$1.$invokeWatchers(true);
            var row = this.listComponent.multiselect ? _.last(this.listComponent.selecteditem) : this.listComponent.selecteditem;
            this.app.notify("wm-event", {
                eventName: eventName,
                widgetName: this.listComponent.name,
                row: row
            });
        };
        ListItemDirective.prototype.setUpCUDHandlers = function() {
            var _this = this;
            var $editItem = this.nativeElement.querySelector(".edit-list-item");
            var $deleteItem = this.nativeElement.querySelector(".delete-list-item");
            if ($editItem) {
                $editItem.addEventListener("click", function(evt) {
                    _this.triggerWMEvent("update");
                });
            }
            if ($deleteItem) {
                $deleteItem.addEventListener("click", function(evt) {
                    _this.triggerWMEvent("delete");
                });
            }
        };
        ListItemDirective.prototype.ngOnInit = function() {
            var _this = this;
            if (this.listComponent.mouseEnterCB) {
                this.nativeElement.addEventListener("mouseenter", function($event) {
                    _this.listComponent.invokeEventCallback("mouseenter", {
                        widget: _this,
                        $event: $event
                    });
                });
            }
            if (this.listComponent.mouseLeaveCB) {
                this.nativeElement.addEventListener("mouseleave", function($event) {
                    _this.listComponent.invokeEventCallback("mouseleave", {
                        widget: _this,
                        $event: $event
                    });
                });
            }
            $(this.nativeElement).attr("listitemindex", this.$index);
        };
        ListItemDirective.prototype.ngAfterViewInit = function() {
            this.setUpCUDHandlers();
        };
        ListItemDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmListItem]",
                exportAs: "listItemRef"
            } ]
        } ];
        ListItemDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.ElementRef
            }, {
                type: core$1.App
            } ];
        };
        ListItemDirective.propDecorators = {
            isActive: [ {
                type: core.HostBinding,
                args: [ "class.active" ]
            } ],
            disableItem: [ {
                type: core.HostBinding,
                args: [ "class.disable-item" ]
            } ],
            onFocus: [ {
                type: core.HostListener,
                args: [ "focus" ]
            } ],
            wmListItem: [ {
                type: core.Input
            } ]
        };
        return ListItemDirective;
    }();
    var ListAnimator = function(_super) {
        __extends(ListAnimator, _super);
        function ListAnimator(list) {
            var _this = _super.call(this) || this;
            _this.list = list;
            _this.$el = $(_this.list.getNativeElement()).find("ul.app-livelist-container:first");
            _this.leftChildrenCount = _this.$el.find(">.app-list-item-left-action-panel > button:visible").length;
            _this.rightChildrenCount = _this.$el.find(">.app-list-item-right-action-panel > button:visible").length;
            if (!_this.leftChildrenCount && !_this.rightChildrenCount) {
                return _this;
            }
            _this.init(_this.$el);
            _this.$btnSubscription = _this.list.btnComponents.changes.subscribe(function(items) {
                return _this.actionItems = items;
            });
            return _this;
        }
        ListAnimator.prototype.createActionPanel = function(li, actionPanelTemplate) {
            actionPanelTemplate.css({
                width: li.outerWidth() + "px",
                height: li.outerHeight() + "px",
                marginBottom: -1 * li.outerHeight() + "px",
                float: "left",
                padding: 0
            });
            return actionPanelTemplate.insertBefore(li);
        };
        ListAnimator.prototype.computeTotalChildrenWidth = function($ele) {
            return _.reduce($ele.children(), function(totalWidth, el) {
                return totalWidth + $(el).outerWidth();
            }, 0);
        };
        ListAnimator.prototype.computeTransitionProportions = function($ele) {
            var totalWidth = this.computeTotalChildrenWidth($ele);
            var reverse = this.position === "right";
            var d = 0;
            return _.map($ele.children(), function(e) {
                var f = (totalWidth - d) / totalWidth;
                d += $(e).outerWidth();
                return reverse ? f : d / totalWidth;
            });
        };
        ListAnimator.prototype.resetElement = function(el) {
            if (el) {
                el.css({
                    transform: "none",
                    transition: "none"
                });
            }
        };
        ListAnimator.prototype.resetState = function() {
            this.resetElement(this.li);
            this.resetElement(this.actionPanel);
            if (this.actionPanel) {
                this.actionPanel = null;
            }
        };
        ListAnimator.prototype.getChildActionElement = function(actionTemplate) {
            if (actionTemplate.children().length) {
                if (this.position === "left") {
                    return actionTemplate.children().first();
                }
                return actionTemplate.children().last();
            }
        };
        ListAnimator.prototype.initActionPanel = function(actionTemplate) {
            this.actionPanel = this.createActionPanel(this.li, actionTemplate);
            this.actionPanel.css({
                backgroundColor: this.getChildActionElement(this.actionPanel).css("background-color")
            });
            this.limit = this.computeTotalChildrenWidth(this.actionPanel);
            this.transitionProportions = this.computeTransitionProportions(this.actionPanel);
        };
        ListAnimator.prototype.bounds = function(e, $d) {
            var target = $(e.target).closest("li");
            var bounds = {
                strictUpper: true,
                strictLower: true,
                lower: 0,
                center: 0,
                upper: 0
            };
            if (!target.hasClass("app-list-item")) {
                return bounds;
            }
            if (!this.li || this.li[0] !== target[0]) {
                var selector = $d > 0 ? ".app-list-item-left-action-panel" : ".app-list-item-right-action-panel";
                var actionTemplate = this.$el.find(">" + selector);
                if (!actionTemplate.length && this.list.groupby) {
                    selector = "li > ul.list-group >" + selector;
                    actionTemplate = this.$el.find(">" + selector);
                }
                if (!actionTemplate.length || !actionTemplate.find("button:visible").length) {
                    return bounds;
                }
                this.resetState();
                this.li = target;
                this.position = actionTemplate.attr("position");
                this.initActionPanel(actionTemplate);
                if ($d > 0) {
                    bounds = {
                        strictUpper: false,
                        lower: 0,
                        center: 0,
                        upper: this.limit
                    };
                } else {
                    bounds = {
                        strictLower: false,
                        lower: -this.limit,
                        center: 0,
                        upper: 0
                    };
                }
            } else if (this.position === "left") {
                bounds = {
                    strictUpper: false,
                    lower: -this.limit,
                    center: this.limit
                };
            } else if (this.position === "right") {
                bounds = {
                    center: -this.limit,
                    upper: this.limit,
                    strictLower: false
                };
            }
            return bounds;
        };
        ListAnimator.prototype.context = function() {
            var _this = this;
            return {
                computeActionTransition: function(index, $d) {
                    var sign = $d > 0 ? 1 : -1;
                    if (sign * $d > _this.limit) {
                        return $d - sign * _this.limit + _this.transitionProportions[index] * sign * _this.limit;
                    }
                    return _this.transitionProportions[index] * $d;
                }
            };
        };
        ListAnimator.prototype.animation = function() {
            var _this = this;
            return [ {
                target: function() {
                    return _this.li;
                },
                css: {
                    transform: "translate3d(${{$D + $d}}px, 0, 0)"
                }
            }, {
                target: function() {
                    return _this.actionPanel && _this.actionPanel.children();
                },
                css: {
                    transform: "translate3d(${{computeActionTransition($i, $D + $d)}}px, 0, 0)"
                }
            } ];
        };
        ListAnimator.prototype.invokeFullSwipeEvt = function($event) {
            var target, actions, index;
            if (this.position === "left") {
                actions = this.actionItems.filter(function(btn) {
                    return btn.getAttr("swipe-position") === "left" && btn.$element.is(":visible");
                });
                index = 0;
            } else {
                actions = this.actionItems.filter(function(btn) {
                    return btn.getAttr("swipe-position") === "right" && btn.$element.is(":visible");
                });
                index = actions.length - 1;
            }
            target = actions[index];
            if (target && target.hasEventCallback("tap")) {
                target.invokeEventCallback("tap", {
                    $event: $event
                });
            }
            this.resetState();
            this.li = null;
        };
        ListAnimator.prototype.onAnimation = function($event, d) {
            this.list.triggerListItemSelection(this.li, $event);
            if (this.actionPanel && this.actionPanel.attr("enablefullswipe") === "true") {
                var sign = d > 0 ? 1 : -1;
                var $el = this.getChildActionElement(this.actionPanel);
                if ($el) {
                    var index = this.position === "right" ? this.rightChildrenCount - 1 : 0;
                    var distPercentage = this.transitionProportions[index] * sign * d * 100 / (this.li.outerWidth() - this.limit + $el.width());
                    if (distPercentage > 50) {
                        this.invokeFullSwipeEvt($event);
                    }
                }
            }
        };
        ListAnimator.prototype.onLower = function() {
            if (this.position === "left") {
                this.resetState();
                this.li = null;
            }
        };
        ListAnimator.prototype.onUpper = function() {
            if (this.position === "right") {
                this.resetState();
                this.li = null;
            }
        };
        ListAnimator.prototype.threshold = function() {
            return 10;
        };
        return ListAnimator;
    }(_swipey.SwipeAnimation);
    var DEFAULT_CLS = "app-livelist app-panel";
    var WIDGET_CONFIG = {
        widgetType: "wm-list",
        hostClass: DEFAULT_CLS
    };
    var ListComponent = function(_super) {
        __extends(ListComponent, _super);
        function ListComponent(inj, cdRef, datePipe, app, appDefaults, ngZone, binditemclass, binddisableitem, binddataset, binddatasource, mouseEnterCB, mouseLeaveCB) {
            var _this = this;
            var resolveFn = core$1.noop;
            var propsInitPromise = new Promise(function(res) {
                return resolveFn = res;
            });
            _this = _super.call(this, inj, WIDGET_CONFIG, propsInitPromise) || this;
            _this.propsInitPromise = propsInitPromise;
            _this.promiseResolverFn = resolveFn;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.SHELL);
            _this.cdRef = cdRef;
            _this.ngZone = ngZone;
            _this.datePipe = datePipe;
            _this.binditemclass = binditemclass;
            _this.binddisableitem = binddisableitem;
            _this.binddataset = binddataset;
            _this.mouseEnterCB = mouseEnterCB;
            _this.mouseLeaveCB = mouseLeaveCB;
            _this.binddatasource = binddatasource;
            _this.app = app;
            _this.appDefaults = appDefaults;
            _this.variableInflight = false;
            _this.noDataFound = !binddataset;
            _this.app.subscribe("toggle-variable-state", _this.handleLoading.bind(_this));
            return _this;
        }
        Object.defineProperty(ListComponent.prototype, "selecteditem", {
            get: function() {
                if (this.multiselect) {
                    return core$1.getClonedObject(this._items);
                }
                if (_.isEmpty(this._items)) {
                    return {};
                }
                return core$1.getClonedObject(this._items[0]);
            },
            set: function(items) {
                var _this = this;
                this._items.length = 0;
                this.deselectListItems();
                if (_.isArray(items)) {
                    items.forEach(function(item) {
                        return _this.selectItem(item);
                    });
                } else {
                    this.selectItem(items);
                }
                core$1.$appDigest();
            },
            enumerable: true,
            configurable: true
        });
        ListComponent.prototype.getWidgets = function(widgteName, index) {
            var $target;
            var retVal = [];
            if (!widgteName) {
                return;
            }
            if (!core$1.isDefined(index)) {
                _.forEach(this.listItems.toArray(), function(el) {
                    $target = _.get(el.currentItemWidgets, widgteName);
                    if ($target) {
                        retVal.push($target);
                    }
                });
                return retVal;
            }
            index = +index || 0;
            $target = _.get(this.listItems.toArray(), index);
            if ($target) {
                return [ _.get($target.currentItemWidgets, widgteName) ];
            }
        };
        ListComponent.prototype.getItem = function(index) {
            return this.getListItemByIndex(index);
        };
        ListComponent.prototype.getIndex = function(item) {
            return this.getListItemIndex(item);
        };
        ListComponent.prototype.handleLoading = function(data) {
            var _this = this;
            var dataSource = this.datasource;
            if (dataSource && dataSource.execute(core$1.DataSource.Operation.IS_API_AWARE) && core$1.isDataSourceEqual(data.variable, dataSource)) {
                this.ngZone.run(function() {
                    _this.variableInflight = data.active;
                });
            }
        };
        ListComponent.prototype.resetNavigation = function() {
            this.showNavigation = false;
            this.navControls = undefined;
            this.infScroll = false;
            this.onDemandLoad = false;
        };
        ListComponent.prototype.enableBasicNavigation = function() {
            this.navControls = base.NAVIGATION_TYPE.BASIC;
            this.showNavigation = true;
        };
        ListComponent.prototype.enableInlineNavigation = function() {
            this.navControls = base.NAVIGATION_TYPE.INLINE;
        };
        ListComponent.prototype.enableClassicNavigation = function() {
            this.navControls = base.NAVIGATION_TYPE.CLASSIC;
            this.showNavigation = true;
        };
        ListComponent.prototype.enablePagerNavigation = function() {
            this.navControls = base.NAVIGATION_TYPE.PAGER;
            this.showNavigation = true;
        };
        ListComponent.prototype.setNavigationTypeNone = function() {
            this.navControls = base.NAVIGATION_TYPE.NONE;
            this.showNavigation = false;
        };
        ListComponent.prototype.enableInfiniteScroll = function() {
            this.infScroll = true;
        };
        ListComponent.prototype.enableOnDemandLoad = function() {
            this.onDemandLoad = true;
            this.showNavigation = true;
        };
        ListComponent.prototype.setListClass = function() {
            var temp = "";
            if (this.itemsperrow) {
                if (isNaN(parseInt(this.itemsperrow, 10))) {
                    _.split(this.itemsperrow, " ").forEach(function(cls) {
                        var keys = _.split(cls, "-");
                        cls = keys[0] + "-" + 12 / parseInt(keys[1], 10);
                        temp += " col-" + cls;
                    });
                    this.itemsPerRowClass = temp.trim();
                } else {
                    this.itemsPerRowClass = "col-xs-" + 12 / parseInt(this.itemsperrow, 10);
                }
            } else {
                this.itemsPerRowClass = "col-xs-12";
            }
        };
        ListComponent.prototype.onNavigationTypeChange = function(type) {
            this.resetNavigation();
            switch (type) {
              case base.NAVIGATION_TYPE.BASIC:
                this.enableBasicNavigation();
                break;

              case base.NAVIGATION_TYPE.INLINE:
                this.enableInlineNavigation();
                break;

              case base.NAVIGATION_TYPE.ADVANCED:
              case base.NAVIGATION_TYPE.CLASSIC:
                this.enableClassicNavigation();
                break;

              case base.NAVIGATION_TYPE.PAGER:
                this.enablePagerNavigation();
                break;

              case base.NAVIGATION_TYPE.NONE:
                this.setNavigationTypeNone();
                break;

              case base.NAVIGATION_TYPE.SCROLL:
                this.enableInfiniteScroll();
                break;

              case base.NAVIGATION_TYPE.ONDEMAND:
                this.enableOnDemandLoad();
                break;
            }
        };
        ListComponent.prototype.fetchNextDatasetOnScroll = function() {
            this.dataNavigator.navigatePage("next");
        };
        ListComponent.prototype.setIscrollHandlers = function(el) {
            var _this = this;
            var lastScrollTop = 0;
            var wrapper = _.get(el.iscroll, "wrapper");
            var self = el.iscroll;
            el.iscroll.on("scrollEnd", function() {
                var clientHeight = wrapper.clientHeight, totalHeight = wrapper.scrollHeight, scrollTop = Math.abs(el.iscroll.y);
                if (lastScrollTop < scrollTop && totalHeight * .9 < scrollTop + clientHeight) {
                    _this.debouncedFetchNextDatasetOnScroll();
                    if (self.indicatorRefresh) {
                        self.indicatorRefresh();
                    }
                }
                lastScrollTop = scrollTop;
            });
        };
        ListComponent.prototype.bindIScrollEvt = function() {
            var _this = this;
            var $scrollParent = this.$element.closest('[wmsmoothscroll="true"]');
            var iScroll = _.get($scrollParent[0], "iscroll");
            if (!iScroll) {
                var iScrollSubscription_1 = this.app.subscribe("iscroll-update", function(_el) {
                    if (!_.isEmpty(_el) && _el.isSameNode($scrollParent[0])) {
                        _this.setIscrollHandlers($scrollParent[0]);
                        iScrollSubscription_1();
                    }
                });
                this.app.notify("no-iscroll", $scrollParent[0]);
                return;
            }
            this.setIscrollHandlers($scrollParent[0]);
        };
        ListComponent.prototype.bindScrollEvt = function() {
            var _this = this;
            var $el = this.$element;
            var $ul = $el.find("> ul");
            var $firstChild = $ul.children().first();
            var self = this;
            var $scrollParent;
            var scrollNode;
            var lastScrollTop = 0;
            if (!$firstChild.length) {
                return;
            }
            $scrollParent = $firstChild.scrollParent(false);
            if ($scrollParent[0] === document) {
                scrollNode = document.body;
            } else {
                scrollNode = $scrollParent[0];
            }
            if (scrollNode.scrollHeight > scrollNode.clientHeight) {
                $scrollParent.each(function(index, node) {
                    lastScrollTop = node === document ? node.body.scrollTop || $(window).scrollTop() : node.scrollTop;
                }).off("scroll.scroll_evt").on("scroll.scroll_evt", function(evt) {
                    var target = evt.target;
                    var clientHeight;
                    var totalHeight;
                    var scrollTop;
                    target = target === document ? target.scrollingElement || document.body : target;
                    clientHeight = target.clientHeight;
                    totalHeight = target.scrollHeight;
                    scrollTop = target === document.body ? $(window).scrollTop() : target.scrollTop;
                    if (lastScrollTop < scrollTop && totalHeight * .9 < scrollTop + clientHeight) {
                        $(this).off("scroll.scroll_evt");
                        self.debouncedFetchNextDatasetOnScroll();
                    }
                    lastScrollTop = scrollTop;
                });
                $ul.off("wheel.scroll_evt");
            } else {
                $ul.on("wheel.scroll_evt", function(e) {
                    if (e.originalEvent.deltaY > 0) {
                        $ul.off("wheel.scroll_evt");
                        _this.debouncedFetchNextDatasetOnScroll();
                    }
                });
            }
        };
        ListComponent.prototype.updateFieldDefs = function(newVal) {
            if (this.infScroll || this.onDemandLoad) {
                if (!core$1.isDefined(this.fieldDefs) || this.dataNavigator.isFirstPage()) {
                    this.fieldDefs = [];
                    this.currentPage = 1;
                } else if (this.fieldDefs.length / this.pagesize <= this.dataNavigator.pageCount) {
                    var itemsLength = void 0, itemsToPush = [];
                    if (this.fieldDefs.length === this.currentPage * this.pagesize && this.currentPage + 1 === this.dataNavigator.dn.currentPage) {
                        itemsToPush = newVal;
                        this.currentPage++;
                    } else if (this.fieldDefs.length < this.currentPage * this.pagesize) {
                        if (this.fieldDefs.length === (this.currentPage - 1) * this.pagesize && this.currentPage - 1 === this.dataNavigator.dn.currentPage) {
                            newVal = [];
                        } else if (this.dataNavigator.dataSize < this.currentPage * this.pagesize) {
                            itemsLength = this.dataNavigator.dataSize - this.fieldDefs.length;
                        } else {
                            itemsLength = this.currentPage * this.pagesize - this.fieldDefs.length;
                            this.currentPage++;
                        }
                        var startIndex = newVal.length - itemsLength;
                        itemsToPush = newVal.slice(startIndex);
                    } else if (this.fieldDefs.length === this.currentPage * this.pagesize && this.currentPage === this.dataNavigator.dn.currentPage) {
                        itemsToPush = [];
                    }
                    newVal = itemsToPush;
                }
                this.fieldDefs = __spread(this.fieldDefs, newVal);
            } else {
                this.fieldDefs = newVal;
            }
            if (this.orderby) {
                this.fieldDefs = base.getOrderedDataset(this.fieldDefs, this.orderby);
            }
            if (this.groupby) {
                this.groupedData = base.groupData(this, this.fieldDefs, this.groupby, this.match, this.orderby, this.dateformat, this.datePipe, undefined, this.appDefaults);
            }
            if (!this.fieldDefs.length) {
                this.noDataFound = true;
                this.selecteditem = undefined;
            }
            core$1.$appDigest();
            this.listItems.setDirty();
        };
        ListComponent.prototype.onDataChange = function(newVal) {
            if (!_.isEmpty(newVal)) {
                this.noDataFound = false;
                this.isDataChanged = true;
                if (this.datasource && this.datasource.execute(core$1.DataSource.Operation.IS_API_AWARE)) {
                    newVal = _.cloneDeep(newVal);
                }
                if (core$1.isObject(newVal) && !_.isArray(newVal)) {
                    newVal = _.isEmpty(newVal) ? [] : [ newVal ];
                }
                if (_.isString(newVal)) {
                    newVal = newVal.split(",");
                }
                if (this.datasource && this.datasource.owner === "App" && (this.infScroll || this.onDemandLoad) && !this.currentPage && this.datasource.execute(core$1.DataSource.Operation.GET_PAGING_OPTIONS).number > 0) {
                    newVal = this.datasource.execute(core$1.DataSource.Operation.LIST_RECORDS, {
                        page: 1
                    });
                }
                if (_.isArray(newVal)) {
                    if (newVal.length) {
                        this.invokeEventCallback("beforedatarender", {
                            $data: newVal
                        });
                    }
                    this.updateFieldDefs(newVal);
                }
            } else {
                this.updateFieldDefs([]);
            }
        };
        ListComponent.prototype.setupDataSource = function() {
            var _this = this;
            var dataNavigator = this.dataNavigator;
            dataNavigator.options = {
                maxResults: this.pagesize || 5
            };
            this.dataNavigatorWatched = true;
            if (this.navigatorResultWatch) {
                this.navigatorResultWatch.unsubscribe();
            }
            this.navigatorResultWatch = dataNavigator.resultEmitter.subscribe(function(newVal) {
                _this.onDataChange(newVal);
            }, true);
            if (this.navigatorMaxResultWatch) {
                this.navigatorMaxResultWatch.unsubscribe();
            }
            this.navigatorMaxResultWatch = dataNavigator.maxResultsEmitter.subscribe(function(val) {
                _this.pagesize = val;
            });
            dataNavigator.maxResults = this.pagesize || 5;
            this.removePropertyBinding("dataset");
            var datasetBoundExpr = this.getAttr("datasetboundexpr");
            this.dataNavigator.setBindDataSet(this.binddataset, this.viewParent, datasetBoundExpr ? this.context : this.datasource, this.dataset, this.binddatasource, datasetBoundExpr);
        };
        ListComponent.prototype.onDataSetChange = function(newVal) {
            if (!this.dataNavigatorWatched) {
                if (this.navigation && this.navigation !== base.NAVIGATION_TYPE.NONE) {
                    this.setupDataSource();
                } else {
                    this.onDataChange(newVal);
                }
            } else if (this.navigation && this.navigation !== base.NAVIGATION_TYPE.NONE) {
                this.dataNavigator.setDataSource(this.datasource);
            }
        };
        ListComponent.prototype.deselectListItems = function() {
            this.listItems.forEach(function(item) {
                return item.isActive = false;
            });
        };
        ListComponent.prototype.clearSelectedItems = function() {
            this.deselectListItems();
            this._items.length = 0;
            core$1.$appDigest();
        };
        ListComponent.prototype.getListItemByModel = function(listModel) {
            var _this = this;
            return this.listItems.find(function(listItem) {
                var itemObj = listItem.item;
                if (_this.groupby && !_.has(listModel, "_groupIndex")) {
                    itemObj = _.clone(itemObj);
                    delete itemObj._groupIndex;
                }
                if (_.isEqual(itemObj, listModel)) {
                    return true;
                }
            }) || null;
        };
        ListComponent.prototype.updateSelectedItemsWidgets = function() {
            var _this = this;
            if (this.multiselect) {
                this.selectedItemWidgets.length = 0;
            }
            this.listItems.forEach(function(item) {
                if (item.isActive) {
                    if (_this.multiselect) {
                        _this.selectedItemWidgets.push(item.currentItemWidgets);
                    } else {
                        _this.selectedItemWidgets = item.currentItemWidgets;
                    }
                }
            });
        };
        ListComponent.prototype.toggleListItemSelection = function($listItem) {
            if ($listItem && !$listItem.disableItem) {
                var item = $listItem.item;
                if (this.groupby && _.has(item, "_groupIndex")) {
                    item = _.clone(item);
                    delete item._groupIndex;
                }
                if ($listItem.isActive) {
                    this._items = _.pullAllWith(this._items, [ item ], _.isEqual);
                    $listItem.isActive = false;
                } else {
                    if (!this.multiselect) {
                        this.clearSelectedItems();
                    }
                    this._items.push(item);
                    this.invokeEventCallback("select", {
                        widget: $listItem,
                        $data: item
                    });
                    $listItem.isActive = true;
                }
                this.updateSelectedItemsWidgets();
            }
        };
        ListComponent.prototype.onListRender = function(listItems) {
            var _this = this;
            if (this.isDataChanged) {
                core$1.$invokeWatchers(true);
                this.invokeEventCallback("render", {
                    $data: this.fieldDefs
                });
            }
            var selectedItems = _.isArray(this.selecteditem) ? this.selecteditem : [ this.selecteditem ];
            this.firstSelectedItem = this.lastSelectedItem = null;
            if (listItems.length && this.selectfirstitem && !(this._items.length && this.multiselect)) {
                var $firstItem = listItems.first;
                if (!$firstItem.disableItem && this.isDataChanged && !((this.infScroll || this.onDemandLoad) && this._items.length)) {
                    this.clearSelectedItems();
                    this.firstSelectedItem = this.lastSelectedItem = $firstItem;
                    this.selectItem(0);
                }
            } else {
                this.deselectListItems();
                selectedItems.forEach(function(selecteditem) {
                    var listItem = _this.getListItemByModel(selecteditem);
                    if (listItem) {
                        listItem.isActive = true;
                        _this.lastSelectedItem = listItem;
                        listItem.nativeElement.focus();
                    }
                });
            }
            if (this.fieldDefs.length && this.infScroll) {
                var smoothScrollEl = this.$element.closest("[wmsmoothscroll]");
                if (core$1.isMobileApp() && smoothScrollEl.length && smoothScrollEl.attr("wmsmoothscroll") === "true") {
                    this.bindIScrollEvt();
                } else {
                    this.bindScrollEvt();
                }
            }
            this.isDataChanged = false;
        };
        ListComponent.prototype.triggerListItemSelection = function($el, $event) {
            if ($el && $el[0]) {
                var listItemContext = $el.data("listItemContext");
                if (listItemContext.listComponent === this) {
                    this.onItemClick($event, listItemContext);
                }
            }
        };
        ListComponent.prototype.setupHandlers = function() {
            var _this = this;
            this.listItems.changes.subscribe(function(listItems) {
                _this.onListRender(listItems);
                _this.cdRef.detectChanges();
            });
            this.nativeElement.querySelector("ul.app-livelist-container").addEventListener("click", function($event) {
                var target = $($event.target).closest(".app-list-item");
                while (target.get(0) && target.closest("ul.app-livelist-container").get(0) !== $event.currentTarget) {
                    target = target.parent().closest(".app-list-item");
                }
                _this.triggerListItemSelection(target, $event);
            }, true);
        };
        ListComponent.prototype.onReorderStart = function(evt, ui) {
            ui.placeholder.height(ui.item.height());
            this.$ulEle.data("oldIndex", ui.item.index());
        };
        ListComponent.prototype.onUpdate = function(evt, ui) {
            var data = this.fieldDefs;
            var newIndex = ui.item.index();
            var oldIndex = this.$ulEle.data("oldIndex");
            var minIndex = _.min([ newIndex, oldIndex ]);
            var maxIndex = _.max([ newIndex, oldIndex ]);
            var draggedItem = _.pullAt(data, oldIndex)[0];
            this.reorderProps.minIndex = _.min([ minIndex, this.reorderProps.minIndex ]);
            this.reorderProps.maxIndex = _.max([ maxIndex, this.reorderProps.maxIndex ]);
            data.splice(newIndex, 0, draggedItem);
            this.cdRef.markForCheck();
            this.cdRef.detectChanges();
            var $changedItem = {
                oldIndex: oldIndex,
                newIndex: newIndex,
                item: data[newIndex]
            };
            this.invokeEventCallback("reorder", {
                $event: evt,
                $data: data,
                $changedItem: $changedItem
            });
            this.$ulEle.removeData("oldIndex");
        };
        ListComponent.prototype.configureDnD = function() {
            var options = {
                appendTo: "body"
            };
            var $el = $(this.nativeElement);
            this.$ulEle = $el.find(".app-livelist-container");
            base.configureDnD(this.$ulEle, options, this.onReorderStart.bind(this), this.onUpdate.bind(this));
            this.$ulEle.droppable({
                accept: ".app-list-item"
            });
        };
        ListComponent.prototype.checkSelectionLimit = function(count) {
            return !this.selectionlimit || count < this.selectionlimit;
        };
        ListComponent.prototype.getListItemByIndex = function(index) {
            return this.listItems.toArray()[index];
        };
        ListComponent.prototype.getListItemIndex = function(item) {
            return this.listItems.toArray().indexOf(item);
        };
        ListComponent.prototype.execute = function(operation, options) {
            if ([ core$1.DataSource.Operation.IS_API_AWARE, core$1.DataSource.Operation.IS_PAGEABLE, core$1.DataSource.Operation.SUPPORTS_SERVER_FILTER ].includes(operation)) {
                return false;
            }
            return this.datasource.execute(operation, options);
        };
        ListComponent.prototype.handleKeyDown = function($event, action) {
            $event.stopPropagation();
            var listItems = this.listItems;
            var presentIndex = this.getListItemIndex(this.lastSelectedItem);
            if (this.multiselect) {
                var firstIndex = this.getListItemIndex(this.firstSelectedItem);
                var selectCount = _.isArray(this.selecteditem) ? this.selecteditem.length : _.isObject(this.selecteditem) ? 1 : 0;
                if (action === "selectPrev") {
                    if (presentIndex > 0) {
                        if (presentIndex <= firstIndex && this.checkSelectionLimit(selectCount)) {
                            this.lastSelectedItem = this.getListItemByIndex(presentIndex - 1);
                            this.toggleListItemSelection(this.lastSelectedItem);
                        } else if (presentIndex > firstIndex) {
                            this.toggleListItemSelection(this.getListItemByIndex(presentIndex));
                            this.lastSelectedItem = this.getListItemByIndex(presentIndex - 1);
                        } else {
                            this.invokeEventCallback("selectionlimitexceed", {
                                $event: $event
                            });
                        }
                    }
                } else if (action === "selectNext") {
                    if (presentIndex < listItems.length - 1) {
                        if (presentIndex >= firstIndex && this.checkSelectionLimit(selectCount)) {
                            this.lastSelectedItem = this.getListItemByIndex(presentIndex + 1);
                            this.toggleListItemSelection(this.lastSelectedItem);
                        } else if (presentIndex < firstIndex) {
                            this.toggleListItemSelection(this.getListItemByIndex(presentIndex));
                            this.lastSelectedItem = this.getListItemByIndex(presentIndex + 1);
                        } else {
                            this.invokeEventCallback("selectionlimitexceed", {
                                $event: $event
                            });
                        }
                    }
                }
            }
            if (action === "focusPrev") {
                presentIndex = presentIndex <= 0 ? 0 : presentIndex - 1;
                this.lastSelectedItem = this.getListItemByIndex(presentIndex);
                this.lastSelectedItem.nativeElement.focus();
            } else if (action === "focusNext") {
                presentIndex = presentIndex < listItems.length - 1 ? presentIndex + 1 : listItems.length - 1;
                this.lastSelectedItem = this.getListItemByIndex(presentIndex);
                this.lastSelectedItem.nativeElement.focus();
            } else if (action === "select") {
                if (presentIndex === -1 || !$($event.target).closest(this.lastSelectedItem.nativeElement)) {
                    var $li = $($event.target).closest("li.app-list-item");
                    var $ul = $li.closest("ul.app-livelist-container");
                    presentIndex = $ul.find("li.app-list-item").index($li);
                }
                this.onItemClick($event, this.getListItemByIndex(presentIndex));
            }
        };
        ListComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "dataset") {
                if (!nv && this.binddatasource && !this.datasource) {
                    return;
                }
                this.onDataSetChange(nv);
            } else if (key === "datasource") {
                if (this.dataset) {
                    this.onDataSetChange(this.dataset);
                }
            } else if (key === "navigation") {
                if (nv === "Advanced") {
                    this.navigation = "Classic";
                    return;
                }
                core$1.switchClass(this.nativeElement, nv, ov);
                this.onNavigationTypeChange(nv);
                if (this.dataNavigator) {
                    this.dataNavigator.navigationClass = this.paginationclass;
                }
            } else if (key === "itemsperrow") {
                this.setListClass();
            } else if (key === "tabindex") {
                return;
            } else if (key === "pulltorefresh" && nv) {
                this.app.notify("pullToRefresh:enable");
                this.subscribeToPullToRefresh();
            } else if (key === "paginationclass") {
                if (this.dataNavigator) {
                    setTimeout(function() {
                        return _this.dataNavigator.navigationClass = nv;
                    });
                }
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        ListComponent.prototype.onItemClick = function(evt, $listItem) {
            var _this = this;
            var selectCount;
            if (!$listItem.disableItem) {
                this.firstSelectedItem = this.firstSelectedItem || $listItem;
                selectCount = _.isArray(this.selecteditem) ? this.selecteditem.length : _.isObject(this.selecteditem) ? 1 : 0;
                if (this.multiselect && core$1.isMobileApp()) {
                    if (this.checkSelectionLimit(selectCount) || $listItem.isActive) {
                        this.toggleListItemSelection($listItem);
                    } else {
                        this.invokeEventCallback("selectionlimitexceed", {
                            $event: evt
                        });
                    }
                } else if ((evt.ctrlKey || evt.metaKey) && this.multiselect) {
                    if (this.checkSelectionLimit(selectCount) || $listItem.isActive) {
                        this.firstSelectedItem = this.lastSelectedItem = $listItem;
                        this.toggleListItemSelection($listItem);
                    } else {
                        this.invokeEventCallback("selectionlimitexceed", {
                            $event: evt
                        });
                    }
                } else if (evt.shiftKey && this.multiselect) {
                    var first_1 = $listItem.context.index;
                    var last_1 = this.firstSelectedItem.context.index;
                    if (first_1 > last_1) {
                        last_1 = [ first_1, first_1 = last_1 ][0];
                    }
                    if (this.checkSelectionLimit(last_1 - first_1)) {
                        this.clearSelectedItems();
                        this.listItems.forEach(function($liItem) {
                            var index = $liItem.context.index;
                            if (index >= first_1 && index <= last_1) {
                                _this.toggleListItemSelection($liItem);
                            }
                        });
                        this.lastSelectedItem = $listItem;
                    } else {
                        this.invokeEventCallback("selectionlimitexceed", {
                            $event: evt
                        });
                    }
                } else {
                    if (!$listItem.isActive || selectCount > 1) {
                        this.clearSelectedItems();
                        this.toggleListItemSelection($listItem);
                        this.firstSelectedItem = this.lastSelectedItem = $listItem;
                    }
                }
                core$1.$appDigest();
            }
        };
        ListComponent.prototype.clear = function() {
            this.updateFieldDefs([]);
        };
        ListComponent.prototype.getItemRefByIndexOrModel = function(val) {
            var listItem;
            if (core$1.isNumber(val)) {
                listItem = this.getListItemByIndex(val);
            } else {
                listItem = this.getListItemByModel(val);
            }
            return listItem;
        };
        ListComponent.prototype.deselectItem = function(val) {
            var listItem = this.getItemRefByIndexOrModel(val);
            if (listItem && listItem.isActive) {
                this.toggleListItemSelection(listItem);
            }
        };
        ListComponent.prototype.selectItem = function(val) {
            var listItem = this.getItemRefByIndexOrModel(val);
            if (!listItem) {
                return;
            }
            if (!listItem.isActive) {
                this.toggleListItemSelection(listItem);
            }
            listItem.nativeElement.focus();
        };
        ListComponent.prototype.beforePaginationChange = function($event, $index) {
            this.invokeEventCallback("paginationchange", {
                $event: $event,
                $index: $index
            });
        };
        ListComponent.prototype.handleEvent = function(node, eventName, eventCallback, locals) {
            var _this = this;
            var touchToMouse = {
                tap: "click",
                doubletap: "dblclick"
            };
            if (_.includes([ "click", "tap", "dblclick", "doubletap" ], eventName)) {
                this.eventManager.addEventListener(this.nativeElement, touchToMouse[eventName] || eventName, function(evt) {
                    var target = $(evt.target).closest(".app-list-item");
                    if (target.length) {
                        var listItemContext = target.data("listItemContext");
                        if (!listItemContext.disableItem) {
                            _this.invokeEventCallback(eventName, {
                                widget: listItemContext,
                                $event: evt,
                                item: listItemContext.item
                            });
                        }
                    }
                });
            }
        };
        ListComponent.prototype.subscribeToPullToRefresh = function() {
            var _this = this;
            this.cancelSubscription = this.app.subscribe("pulltorefresh", function() {
                if (_this.datasource && _this.datasource.listRecords) {
                    _this.datasource.listRecords();
                }
            });
        };
        ListComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.handleHeaderClick = core$1.noop;
            this._items = [];
            this.fieldDefs = [];
            this.debouncedFetchNextDatasetOnScroll = _.debounce(this.fetchNextDatasetOnScroll, base.DEBOUNCE_TIMES.PAGINATION_DEBOUNCE_TIME);
            this.reorderProps = {
                minIndex: null,
                maxIndex: null
            };
        };
        ListComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            this.promiseResolverFn();
            this.propsInitPromise.then(function() {
                _super.prototype.ngAfterViewInit.call(_this);
                _this.selectedItemWidgets = _this.multiselect ? [] : {};
                if (_this.enablereorder && !_this.groupby) {
                    _this.configureDnD();
                }
                if (_this.groupby && _this.collapsible) {
                    _this.handleHeaderClick = base.handleHeaderClick;
                    _this.toggleAllHeaders = base.toggleAllHeaders.bind(undefined, _this);
                }
                _this.setListClass();
            });
            this.setupHandlers();
            var $ul = this.nativeElement.querySelector("ul.app-livelist-container");
            base.styler($ul, this, base.APPLY_STYLES_TYPE.SCROLLABLE_CONTAINER);
            if (core$1.isMobileApp() && $ul.querySelector(".app-list-item-action-panel")) {
                this._listAnimator = new ListAnimator(this);
            }
        };
        ListComponent.prototype.ngOnDestroy = function() {
            if (this._listAnimator && this._listAnimator.$btnSubscription) {
                this._listAnimator.$btnSubscription.unsubscribe();
            }
            if (this.cancelSubscription) {
                this.cancelSubscription();
            }
        };
        ListComponent.initializeProps = registerProps();
        ListComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmList]",
                template: '<div class="panel-heading" *ngIf="title || subheading || iconclass">\n    <h3 class="panel-title">\n        <div class="pull-left">\n            <i class="app-icon panel-icon {{iconclass}}" aria-hidden="true" [hidden]="!iconclass"></i>\n        </div>\n        <div class="pull-left">\n            <div class="heading" [innerHTML]="title | trustAs: \'html\'"></div>\n            <div class="description" [innerHTML]="subheading | trustAs: \'html\'"></div>\n        </div>\n    </h3>\n</div>\n\n<nav class="app-datanavigator" aria-label="Page navigation" *ngIf="navigation === \'Inline\' && !noDataFound">\n    <ul class="pager">\n        <li class="previous" [ngClass]="{\'disabled\': (dataNavigator ? dataNavigator.isDisablePrevious : true)}">\n            <a href="javascript:void(0);" (click)="dataNavigator.navigatePage(\'prev\', $event)">\n                <i class="wi wi-chevron-left" aria-hidden="true"></i>\n                <span class="sr-only">Previous</span>\n            </a>\n        </li>\n    </ul>\n</nav>\n\n<ul tabindex="0" class="app-livelist-container clearfix {{listclass}}"\n    (keydown.enter)="handleKeyDown($event, \'select\')"\n\n    (keydown.arrowup)="handleKeyDown($event, \'focusPrev\')"\n    (keydown.arrowdown)="handleKeyDown($event, \'focusNext\')"\n    (keydown.arrowleft)="handleKeyDown($event, \'focusPrev\')"\n    (keydown.arrowright)="handleKeyDown($event, \'focusNext\')"\n\n    (keydown.shift.arrowup)="handleKeyDown($event, \'selectPrev\')"\n    (keydown.shift.arrowdown)="handleKeyDown($event, \'selectNext\')"\n    (keydown.shift.arrowleft)="handleKeyDown($event, \'selectPrev\')"\n    (keydown.shift.arrowright)="handleKeyDown($event, \'selectNext\')"\n>\n    <ng-template [ngIf]="!groupby" [ngIfElse]="groupedListTemplate">\n        <li *ngFor="let item of fieldDefs; index as $index; first as $first; last as $last;" class="app-list-item {{itemsPerRowClass}}" [ngClass]="listItemRef.itemClass"\n            [wmListItem]="item"\n            #listItemRef="listItemRef"\n            tabindex="0">\n            <ng-container [ngTemplateOutlet]="listTemplate" [ngTemplateOutletContext]="{item: item, $index: $index, itemRef: listItemRef, $first: $first, $last: $last, currentItemWidgets: listItemRef.currentItemWidgets}"></ng-container>\n        </li>\n    </ng-template>\n    <ng-container [ngTemplateOutlet]="listLeftActionTemplate"></ng-container>\n    <ng-container [ngTemplateOutlet]="listRightActionTemplate"></ng-container>\n</ul>\n\n<div class="no-data-msg" *ngIf="noDataFound && !variableInflight" [textContent]="nodatamessage"></div>\n\n<div class="loading-data-msg" *ngIf="variableInflight && !pulltorefresh">\n    <span>\n        <i class="app-icon panel-icon fa-spin" aria-hidden="true" [ngClass]="loadingicon"></i>\n        <span class="sr-only">Loading</span>\n        <span class="loading-text" [textContent]="loadingdatamsg"></span>\n    </span>\n</div>\n\n<nav class="app-datanavigator" *ngIf="navigation === \'Inline\' && !noDataFound">\n    <ul class="pager">\n        <li class="next" [ngClass]="{\'disabled\': (dataNavigator ? dataNavigator.isDisableNext  : true)}">\n            <a href="javascript:void(0);" (click)="dataNavigator.navigatePage(\'next\', $event)">\n                <i class="wi wi-chevron-right" aria-hidden="true"></i>\n                <span class="sr-only">Next</span>\n            </a>\n        </li>\n    </ul>\n</nav>\n\n<div class="panel-footer" *ngIf="navigation !== \'None\'" [hidden]="!showNavigation || (onDemandLoad && dataNavigator.isDisableNext) || (dataNavigator.dataSize <= pagesize) || !dataNavigator.dataSize">\n    <nav wmPagination\n         navigationalign.bind="navigationalign"\n         navigation.bind="navControls"\n         showrecordcount.bind="showrecordcount"\n         maxsize.bind="maxsize"\n         boundarylinks.bind="boundarylinks"\n         forceellipses.bind="forceellipses"\n         directionlinks.bind="directionlinks"\n         show.bind="!onDemandLoad"\n         paginationchange.event="beforePaginationChange($event, $index)"\n    ></nav>\n    <a *ngIf="onDemandLoad" href="javascript:void(0);"\n       (click)="dataNavigator.navigatePage(\'next\', $event)"\n       class="app-button btn btn-block"\n       [ngClass]="paginationclass"\n       [textContent]="ondemandmessage"\n    ></a>\n</div>\n\n\x3c!--This template will be displayed when groupby is specified--\x3e\n<ng-template #groupedListTemplate>\n    <li *ngFor="let groupObj of groupedData" class="app-list-item-group clearfix">\n        <ul class="list-group item-group" [ngClass]="listclass">\n            <li class="app-list-item-header list-item list-group-header" (click)="handleHeaderClick($event)" [ngClass]="{\'collapsible-content\': collapsible}">\n            <h4>{{groupObj.key}}\n                <div class="header-action">\n                    <i class="app-icon wi action wi-chevron-up" *ngIf="collapsible"></i>\n                    <span *ngIf="showcount" class="label label-default">{{groupObj.data.length}}</span>\n                    </div>\n                </h4>\n            </li>\n            <li *ngFor="let item of groupObj.data; index as $index; first as $first; last as $last;" tabindex="0"\n                class="app-list-item group-list-item {{itemsPerRowClass}}"\n                [ngClass]="listItemRef.itemClass"\n                [wmListItem]="item" #listItemRef="listItemRef">\n                <ng-container [ngTemplateOutlet]="listTemplate" [ngTemplateOutletContext]="{item: item, $index: $index, itemRef: listItemRef, $first: $first, $last: $last, currentItemWidgets: listItemRef.currentItemWidgets}"></ng-container>\n            </li>\n        </ul>\n    </li>\n</ng-template>\n',
                providers: [ base.provideAsWidgetRef(ListComponent) ]
            } ]
        } ];
        ListComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.ChangeDetectorRef
            }, {
                type: base.ToDatePipe
            }, {
                type: core$1.App
            }, {
                type: core$1.AppDefaults
            }, {
                type: core.NgZone
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "itemclass.bind" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "disableitem.bind" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "datasource.bind" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "mouseenter.event" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "mouseleave.event" ]
                } ]
            } ];
        };
        ListComponent.propDecorators = {
            listTemplate: [ {
                type: core.ContentChild,
                args: [ "listTemplate" ]
            } ],
            listLeftActionTemplate: [ {
                type: core.ContentChild,
                args: [ "listLeftActionTemplate" ]
            } ],
            listRightActionTemplate: [ {
                type: core.ContentChild,
                args: [ "listRightActionTemplate" ]
            } ],
            btnComponents: [ {
                type: core.ContentChildren,
                args: [ input.ButtonComponent ]
            } ],
            dataNavigator: [ {
                type: core.ViewChild,
                args: [ pagination.PaginationComponent ]
            } ],
            listItems: [ {
                type: core.ViewChildren,
                args: [ ListItemDirective ]
            } ]
        };
        return ListComponent;
    }(base.StylableComponent);
    var components = [ ListComponent, ListItemDirective ];
    var ListModule = function() {
        function ListModule() {}
        ListModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, pagination.PaginationModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return ListModule;
    }();
    exports.\u0275a = ListItemDirective;
    exports.\u0275b = registerProps;
    exports.ListModule = ListModule;
    exports.ListComponent = ListComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("ngx-bootstrap/tooltip"), require("ngx-bootstrap/dropdown"), require("@wm/components/basic"), require("@wm/components/input"), require("@wm/components/navigation/menu"), require("rxjs"), require("@wm/components/data/pagination"), require("@wm/components/data/list"), require("@angular/forms"), require("@wm/core"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/data/table", [ "exports", "@angular/common", "ngx-bootstrap/tooltip", "ngx-bootstrap/dropdown", "@wm/components/basic", "@wm/components/input", "@wm/components/navigation/menu", "rxjs", "@wm/components/data/pagination", "@wm/components/data/list", "@angular/forms", "@wm/core", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.data = global.wm.components.data || {}, 
    global.wm.components.data.table = {}), global.ng.common, global.ngxBootstrap, global.ngxBootstrap, global.wm.components.basic, global.wm.components.input, global.wm.components.navigation.menu, global.rxjs, global.wm.components.data.pagination, global.wm.components.data.list, global.ng.forms, global.wm.core, global.ng.core, global.wm.components.base);
})(this, function(exports, common, tooltip, dropdown, basic, input, menu, rxjs, pagination, list, forms, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function(resolve, reject) {
            function fulfilled(value) {
                try {
                    step(generator.next(value));
                } catch (e) {
                    reject(e);
                }
            }
            function rejected(value) {
                try {
                    step(generator["throw"](value));
                } catch (e) {
                    reject(e);
                }
            }
            function step(result) {
                result.done ? resolve(result.value) : new P(function(resolve) {
                    resolve(result.value);
                }).then(fulfilled, rejected);
            }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = {
            label: 0,
            sent: function() {
                if (t[0] & 1) throw t[1];
                return t[1];
            },
            trys: [],
            ops: []
        }, f, y, t, g;
        return g = {
            next: verb(0),
            throw: verb(1),
            return: verb(2)
        }, typeof Symbol === "function" && (g[Symbol.iterator] = function() {
            return this;
        }), g;
        function verb(n) {
            return function(v) {
                return step([ n, v ]);
            };
        }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 
                0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [ op[0] & 2, t.value ];
                switch (op[0]) {
                  case 0:
                  case 1:
                    t = op;
                    break;

                  case 4:
                    _.label++;
                    return {
                        value: op[1],
                        done: false
                    };

                  case 5:
                    _.label++;
                    y = op[1];
                    op = [ 0 ];
                    continue;

                  case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;

                  default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue;
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break;
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break;
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break;
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue;
                }
                op = body.call(thisArg, _);
            } catch (e) {
                op = [ 6, e ];
                y = 0;
            } finally {
                f = t = 0;
            }
            if (op[0] & 5) throw op[1];
            return {
                value: op[0] ? op[1] : void 0,
                done: true
            };
        }
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-table", new Map([ [ "boundarylinks", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "class", base.PROP_STRING ], [ "confirmdelete", __assign({
            value: "Are you sure you want to delete this?"
        }, base.PROP_STRING) ], [ "datasource", base.PROP_STRING ], [ "dataset", base.PROP_ANY ], [ "deletecanceltext", base.PROP_STRING ], [ "deleteoktext", base.PROP_STRING ], [ "deletemessage", __assign({
            value: "Record deleted successfully"
        }, base.PROP_STRING) ], [ "directionlinks", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "editmode", base.PROP_STRING ], [ "enablecolumnselection", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "enablesort", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "errormessage", base.PROP_STRING ], [ "exportformat", base.PROP_STRING ], [ "exportdatasize", __assign({
            value: 100
        }, base.PROP_NUMBER) ], [ "filtermode", base.PROP_STRING ], [ "filternullrecords", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "forceellipses", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "formposition", base.PROP_STRING ], [ "gridclass", __assign({
            value: "table-bordered table-striped table-hover"
        }, base.PROP_STRING) ], [ "gridfirstrowselect", base.PROP_BOOLEAN ], [ "iconclass", base.PROP_STRING ], [ "insertmessage", __assign({
            value: "Record added successfully"
        }, base.PROP_STRING) ], [ "isdynamictable", base.PROP_BOOLEAN ], [ "loadingdatamsg", __assign({
            value: "Loading..."
        }, base.PROP_STRING) ], [ "loadingicon", __assign({
            value: "fa fa-circle-o-notch fa-spin"
        }, base.PROP_STRING) ], [ "maxsize", __assign({
            value: 5
        }, base.PROP_NUMBER) ], [ "multiselect", base.PROP_BOOLEAN ], [ "name", base.PROP_STRING ], [ "navigation", __assign({
            value: "Basic"
        }, base.PROP_STRING) ], [ "navigationalign", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "nodatamessage", __assign({
            value: "No data found."
        }, base.PROP_STRING) ], [ "pagesize", base.PROP_NUMBER ], [ "radioselect", base.PROP_BOOLEAN ], [ "rowclass", base.PROP_STRING ], [ "rowngclass", base.PROP_STRING ], [ "searchlabel", __assign({
            value: "Search"
        }, base.PROP_STRING) ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showheader", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "shownewrow", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showrecordcount", base.PROP_BOOLEAN ], [ "showrowindex", base.PROP_BOOLEAN ], [ "spacing", __assign({
            value: "normal"
        }, base.PROP_STRING) ], [ "subheading", base.PROP_STRING ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", base.PROP_STRING ], [ "updatemessage", __assign({
            value: "Record updated successfully"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS = "app-grid app-panel panel";
    var WIDGET_CONFIG = {
        widgetType: "wm-table",
        hostClass: DEFAULT_CLS
    };
    var exportIconMapping = {
        EXCEL: "fa fa-file-excel-o",
        CSV: "fa fa-file-text-o"
    };
    var ROW_OPS_FIELD = "rowOperations";
    var noop = function() {};
    var \u02750 = noop;
    var isInputBodyWrapper = function(target) {
        var classes = [ ".dropdown-menu", ".uib-typeahead-match", ".modal-dialog", ".toast" ];
        var isInput = false;
        classes.forEach(function(cls) {
            if (target.closest(cls).length) {
                isInput = true;
                return false;
            }
        });
        var attrs = [ "bsdatepickerdaydecorator" ];
        if (!isInput) {
            attrs.forEach(function(attr) {
                if (target[0].hasAttribute(attr)) {
                    isInput = true;
                    return false;
                }
            });
        }
        return isInput;
    };
    var \u02751 = isInputBodyWrapper;
    var TableComponent = function(_super) {
        __extends(TableComponent, _super);
        function TableComponent(inj, fb, app, dynamicComponentProvider, parentList, binddataset, binddatasource, readonlygrid, ngZone) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.inj = inj;
            _this.fb = fb;
            _this.app = app;
            _this.dynamicComponentProvider = dynamicComponentProvider;
            _this.parentList = parentList;
            _this.binddataset = binddataset;
            _this.binddatasource = binddatasource;
            _this.readonlygrid = readonlygrid;
            _this.ngZone = ngZone;
            _this.rowActionsCompiledTl = {};
            _this.rowFilterCompliedTl = {};
            _this.inlineCompliedTl = {};
            _this.inlineNewCompliedTl = {};
            _this.customExprCompiledTl = {};
            _this.rowDefInstances = {};
            _this.rowDefMap = {};
            _this.rowExpansionActionTl = {};
            _this.columns = {};
            _this.formfields = {};
            _this.enablesort = true;
            _this.selectedItems = [];
            _this.selectedItemChange = new rxjs.Subject();
            _this.selectedItemChange$ = _this.selectedItemChange.asObservable();
            _this.actions = [];
            _this._actions = {
                header: [],
                footer: []
            };
            _this.exportOptions = [];
            _this.headerConfig = [];
            _this.items = [];
            _this.rowActions = [];
            _this.shownavigation = false;
            _this.documentClickBind = noop;
            _this.fieldDefs = [];
            _this.rowDef = {};
            _this.rowInstance = {};
            _this.fullFieldDefs = [];
            _this.applyProps = new Map();
            _this.redraw = _.debounce(_this._redraw, 150);
            _this.debouncedHandleLoading = _.debounce(_this.handleLoading, 350);
            _this.rowFilter = {};
            _this._searchSortHandler = noop;
            _this.searchSortHandler = function() {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                _this._searchSortHandler.apply(_this, args);
            };
            _this.onRowFilterChange = noop;
            _this.onFilterConditionSelect = noop;
            _this.showClearIcon = noop;
            _this.clearRowFilter = noop;
            _this.gridOptions = {
                data: [],
                colDefs: [],
                startRowIndex: 1,
                sortInfo: {
                    field: "",
                    direction: ""
                },
                filtermode: "",
                searchLabel: "",
                rowActions: [],
                headerConfig: [],
                rowClass: "",
                editmode: "",
                formPosition: "",
                isMobile: false,
                rowExpansionEnabled: false,
                rowDef: {
                    position: "0"
                },
                name: "",
                messages: {
                    selectField: "Select Field"
                },
                onDataRender: function() {
                    _this.ngZone.run(function() {
                        if (_this.gridData.length) {
                            _this.invokeEventCallback("datarender", {
                                $data: _this.gridData,
                                data: _this.gridData
                            });
                        }
                        if (!_this.multiselect) {
                            _this.items.length = 0;
                        }
                        _this.callDataGridMethod("selectRows", _this.items);
                        _this.selectedItems = _this.callDataGridMethod("getSelectedRows");
                        _this.selectedItemChange.next(_this.selectedItems);
                        if (_this._isPageSearch && _this.filterInfo) {
                            _this.searchSortHandler(_this.filterInfo, undefined, "search");
                        }
                    });
                },
                onRowSelect: function(row, e) {
                    _this.ngZone.run(function() {
                        _this.selectedItems = _this.callDataGridMethod("getSelectedRows");
                        _this.selectedItemChange.next(_this.selectedItems);
                        var rowData = _this.addRowIndex(row);
                        _this.invokeEventCallback("rowselect", {
                            $data: rowData,
                            $event: e,
                            row: rowData
                        });
                    });
                },
                assignSelectedItems: function(row, e) {
                    _this.ngZone.run(function() {
                        if (_this.multiselect) {
                            if (_.findIndex(_this.items, row) === -1) {
                                _this.items.push(row);
                            }
                        } else {
                            _this.items.length = 0;
                            _this.items.push(row);
                        }
                    });
                },
                onRowDblClick: function(row, e) {
                    var rowData = _this.addRowIndex(row);
                    _this.invokeEventCallback("rowdblclick", {
                        $data: rowData,
                        $event: e,
                        row: rowData
                    });
                },
                onRowDeselect: function(row, e) {
                    if (_this.multiselect) {
                        _this.ngZone.run(function() {
                            _this.items = _.pullAllWith(_this.items, [ row ], _.isEqual);
                            _this.selectedItems = _this.callDataGridMethod("getSelectedRows");
                            _this.invokeEventCallback("rowdeselect", {
                                $data: row,
                                $event: e,
                                row: row
                            });
                        });
                    }
                },
                callOnRowDeselectEvent: function(row, e) {
                    _this.items = _this.selectedItems = _this.callDataGridMethod("getSelectedRows");
                    _this.invokeEventCallback("rowdeselect", {
                        $data: row,
                        $event: e,
                        row: row
                    });
                },
                callOnRowClickEvent: function(row, e) {
                    if (e && e.hasOwnProperty("originalEvent")) {
                        var rowData = _this.addRowIndex(row);
                        _this.invokeEventCallback("rowclick", {
                            $data: rowData,
                            $event: e,
                            row: rowData
                        });
                    }
                },
                closePopover: core.closePopover,
                onColumnSelect: function(col, e) {
                    _this.selectedColumns = _this.callDataGridMethod("getSelectedColumns");
                    _this.invokeEventCallback("columnselect", {
                        $data: col,
                        $event: e
                    });
                },
                onColumnDeselect: function(col, e) {
                    _this.selectedColumns = _this.callDataGridMethod("getSelectedColumns");
                    _this.invokeEventCallback("columndeselect", {
                        $data: col,
                        $event: e
                    });
                },
                onHeaderClick: function(col, e) {
                    _this.invokeEventCallback("headerclick", {
                        $event: e,
                        $data: col,
                        column: col
                    });
                },
                onRowDelete: function(row, cancelRowDeleteCallback, e, callBack, options) {
                    _this.ngZone.run(function() {
                        _this.deleteRecord(_.extend({}, options, {
                            row: row,
                            cancelRowDeleteCallback: cancelRowDeleteCallback,
                            evt: e,
                            callBack: callBack
                        }));
                    });
                },
                onRowInsert: function(row, e, callBack, options) {
                    _this.insertRecord(_.extend({}, options, {
                        row: row,
                        event: e,
                        callBack: callBack
                    }));
                },
                beforeRowUpdate: function(row, eventName) {
                    if (_this._liveTableParent) {
                        _this._liveTableParent.updateRow(row, eventName);
                    }
                    _this.prevData = core.getClonedObject(row);
                },
                afterRowUpdate: function(row, e, callBack, options) {
                    _this.updateRecord(_.extend({}, options, {
                        row: row,
                        prevData: _this.prevData,
                        event: e,
                        callBack: callBack
                    }));
                },
                onBeforeRowUpdate: function(row, e, options) {
                    return _this.invokeEventCallback("beforerowupdate", {
                        $event: e,
                        $data: row,
                        row: row,
                        options: options
                    });
                },
                onBeforeRowInsert: function(row, e, options) {
                    return _this.invokeEventCallback("beforerowinsert", {
                        $event: e,
                        $data: row,
                        row: row,
                        options: options
                    });
                },
                onBeforeRowDelete: function(row, e, options) {
                    var rowData = _this.addRowIndex(row);
                    return _this.invokeEventCallback("beforerowdelete", {
                        $event: e,
                        row: rowData,
                        options: options
                    });
                },
                onFormRender: function($row, e, operation, alwaysNewRow) {
                    var widget = alwaysNewRow ? "inlineInstanceNew" : "inlineInstance";
                    setTimeout(function() {
                        _this.formWidgets = {};
                        _this.fieldDefs.forEach(function(col) {
                            if (col[widget]) {
                                _this.formWidgets[col.field] = col[widget];
                                _this.setDisabledOnField(operation, col, widget);
                            }
                        });
                        _this.invokeEventCallback("formrender", {
                            $event: e,
                            formWidgets: _this.formWidgets,
                            $operation: operation
                        });
                    }, 250);
                },
                onBeforeFormRender: function(row, e, operation) {
                    return _this.invokeEventCallback("beforeformrender", {
                        $event: e,
                        row: row,
                        $operation: operation
                    });
                },
                registerRowNgClassWatcher: function(rowData, index) {
                    if (!_this.rowngclass) {
                        return;
                    }
                    var row = _this.getClonedRowObject(rowData);
                    var watchName = _this.widgetId + "_rowNgClass_" + index;
                    core.$unwatch(watchName);
                    _this.registerDestroyListener(core.$watch(_this.rowngclass, _this.viewParent, {
                        row: row
                    }, function(nv, ov) {
                        _this.callDataGridMethod("applyRowNgClass", base.getConditionalClasses(nv, ov), index);
                    }, watchName));
                },
                registerColNgClassWatcher: function(rowData, colDef, rowIndex, colIndex) {
                    if (!colDef["col-ng-class"]) {
                        return;
                    }
                    var row = _this.getClonedRowObject(rowData);
                    var watchName = _this.widgetId + "_colNgClass_" + rowIndex + "_" + colIndex;
                    core.$unwatch(watchName);
                    _this.registerDestroyListener(core.$watch(colDef["col-ng-class"], _this.viewParent, {
                        row: row
                    }, function(nv, ov) {
                        _this.callDataGridMethod("applyColNgClass", base.getConditionalClasses(nv, ov), rowIndex, colIndex);
                    }, watchName));
                },
                clearCustomExpression: function() {
                    _this.customExprViewRef.clear();
                    _this.customExprCompiledTl = {};
                },
                clearRowDetailExpression: function() {
                    _this.rowDetailViewRef.clear();
                    _this.rowDefMap = {};
                    _this.rowDefInstances = {};
                },
                generateCustomExpressions: function(rowData, index) {
                    var row = _this.getClonedRowObject(rowData);
                    var compileTemplate = function(tmpl) {
                        if (!tmpl) {
                            return;
                        }
                        var colDef = {};
                        var context = {
                            row: row,
                            colDef: colDef
                        };
                        _this.addEventsToContext(context);
                        var customExprView = _this.customExprViewRef.createEmbeddedView(tmpl, context);
                        var rootNode = customExprView.rootNodes[0];
                        var fieldName = rootNode.getAttribute("data-col-identifier");
                        _.extend(colDef, _this.columns[fieldName]);
                        _this.customExprCompiledTl[fieldName + index] = rootNode;
                    };
                    if (_this.isdynamictable) {
                        _this.fieldDefs.forEach(function(col) {
                            compileTemplate(col.customExprTmpl);
                        });
                        return;
                    }
                    _this.customExprTmpl.forEach(compileTemplate.bind(_this));
                },
                generateRowExpansionCell: function(rowData, index) {
                    var row = _this.getClonedRowObject(rowData);
                    _this.rowExpansionActionTmpl.forEach(function(tmpl) {
                        _this.rowExpansionActionTl[index] = _this.rowExpansionActionViewRef.createEmbeddedView(tmpl, {
                            row: row
                        }).rootNodes;
                    });
                },
                getRowExpansionAction: function(index) {
                    return _this.rowExpansionActionTl[index];
                },
                generateRowDetailView: function($event, rowData, rowId, $target, $overlay, callback) {
                    var row = _this.getClonedRowObject(rowData);
                    var rowDef = core.getClonedObject(_this.rowDef);
                    if (_this.rowInstance.invokeEventCallback("beforerowexpand", {
                        $event: $event,
                        $data: rowDef,
                        row: row
                    }) === false) {
                        return;
                    }
                    if (!rowDef.content) {
                        return;
                    }
                    callback();
                    if (_this.rowDefMap[rowId] && _this.rowDefMap[rowId].content === rowDef.content) {
                        _this.rowInstance.invokeEventCallback("rowexpand", {
                            $event: $event,
                            row: row,
                            $data: _this.rowDefInstances[rowId]
                        });
                        return;
                    }
                    _this.rowDefMap[rowId] = rowDef;
                    $target.empty();
                    $target.hide();
                    $overlay.show();
                    var context = {
                        row: row,
                        rowDef: rowDef,
                        containerLoad: function(widget) {
                            setTimeout(function() {
                                $overlay.hide();
                                $target.show();
                                _this.rowDefInstances[rowId] = widget;
                                _this.rowInstance.invokeEventCallback("rowexpand", {
                                    $event: $event,
                                    row: row,
                                    $data: widget
                                });
                            }, 500);
                        }
                    };
                    var rootNode = _this.rowDetailViewRef.createEmbeddedView(_this.rowExpansionTmpl, context).rootNodes[0];
                    $target[0].appendChild(rootNode);
                    core.$appDigest();
                },
                onBeforeRowCollapse: function($event, row, rowId) {
                    return _this.rowInstance.invokeEventCallback("beforerowcollapse", {
                        $event: $event,
                        row: row,
                        $data: _this.rowDefInstances[rowId]
                    });
                },
                onRowCollapse: function($event, row) {
                    _this.rowInstance.invokeEventCallback("rowcollapse", {
                        $event: $event,
                        row: row
                    });
                },
                getCustomExpression: function(fieldName, index) {
                    return _this.customExprCompiledTl[fieldName + index] || "";
                },
                clearRowActions: function() {
                    _this.rowActionsViewRef.clear();
                    _this.rowActionsCompiledTl = {};
                    _this.rowExpansionActionViewRef.clear();
                    _this.rowExpansionActionTl = {};
                },
                generateRowActions: function(rowData, index) {
                    var row = _this.getClonedRowObject(rowData);
                    _this.rowActionsCompiledTl[index] = [];
                    _this.rowActionTmpl.forEach(function(tmpl) {
                        var _a;
                        (_a = _this.rowActionsCompiledTl[index]).push.apply(_a, __spread(_this.rowActionsViewRef.createEmbeddedView(tmpl, {
                            row: row
                        }).rootNodes));
                    });
                },
                getRowAction: function(index) {
                    return _this.rowActionsCompiledTl[index];
                },
                generateInlineEditRow: function(rowData, alwaysNewRow) {
                    var row = _this.getClonedRowObject(rowData);
                    if (alwaysNewRow) {
                        _this.inlineEditNewViewRef.clear();
                        _this.inlineNewCompliedTl = {};
                        _this.inlineWidgetNewTmpl.forEach(function(tmpl) {
                            var fieldName;
                            var context = {
                                row: row,
                                getControl: function() {
                                    return _this.ngform.controls[fieldName + "_new"] || {};
                                },
                                getValidationMessage: function() {
                                    return _this.columns[fieldName] && _this.columns[fieldName].validationmessage;
                                }
                            };
                            var rootNode = _this.inlineEditNewViewRef.createEmbeddedView(tmpl, context).rootNodes[0];
                            fieldName = rootNode.getAttribute("data-col-identifier");
                            _this.inlineNewCompliedTl[fieldName] = rootNode;
                        });
                        _this.clearForm(true);
                        return;
                    }
                    _this.inlineEditViewRef.clear();
                    _this.inlineCompliedTl = {};
                    _this.clearForm();
                    _this.inlineWidgetTmpl.forEach(function(tmpl) {
                        var fieldName;
                        var context = {
                            row: row,
                            getControl: function() {
                                return _this.ngform.controls[fieldName] || {};
                            },
                            getValidationMessage: function() {
                                return _this.columns[fieldName] && _this.columns[fieldName].validationmessage;
                            }
                        };
                        var rootNode = _this.inlineEditViewRef.createEmbeddedView(tmpl, context).rootNodes[0];
                        fieldName = rootNode.getAttribute("data-col-identifier");
                        _this.inlineCompliedTl[fieldName] = rootNode;
                    });
                },
                getInlineEditWidget: function(fieldName, value, alwaysNewRow) {
                    if (alwaysNewRow) {
                        _this.gridOptions.setFieldValue(fieldName + "_new", value);
                        return _this.inlineNewCompliedTl[fieldName];
                    }
                    _this.gridOptions.setFieldValue(fieldName, value);
                    return _this.inlineCompliedTl[fieldName];
                },
                setFieldValue: function(fieldName, value) {
                    var control = _this.ngform.controls && _this.ngform.controls[fieldName];
                    if (control) {
                        control.setValue(value);
                    }
                },
                getFieldValue: function(fieldName) {
                    var control = _this.ngform.controls && _this.ngform.controls[fieldName];
                    return control && control.value;
                },
                generateFilterRow: function() {
                    _this.filterViewRef.clear();
                    _this.rowFilterCompliedTl = {};
                    _this.filterTmpl.forEach(function(tmpl) {
                        var rootNode = _this.filterViewRef.createEmbeddedView(tmpl, {
                            changeFn: _this.onRowFilterChange.bind(_this),
                            isDisabled: function(fieldName) {
                                return _this.emptyMatchModes.indexOf(_this.rowFilter[fieldName] && _this.rowFilter[fieldName].matchMode) > -1;
                            }
                        }).rootNodes[0];
                        _this.rowFilterCompliedTl[rootNode.getAttribute("data-col-identifier")] = rootNode;
                    });
                },
                getFilterWidget: function(fieldName) {
                    return _this.rowFilterCompliedTl[fieldName];
                },
                setGridEditMode: function(val) {
                    _this.ngZone.run(function() {
                        _this.isGridEditMode = val;
                        core.$appDigest();
                    });
                },
                setGridState: function(val) {
                    _this.isLoading = val === "loading";
                },
                noChangesDetected: function() {
                    _this.toggleMessage(true, "info", "No Changes Detected");
                },
                redrawWidgets: function() {
                    _this.fieldDefs.forEach(function(col) {
                        core.triggerFn(col.inlineInstance && col.inlineInstance.redraw);
                        core.triggerFn(col.inlineInstanceNew && col.inlineInstanceNew.redraw);
                        core.triggerFn(col.filterInstance && col.filterInstance.redraw);
                    });
                },
                searchHandler: _this.searchSortHandler.bind(_this),
                sortHandler: _this.searchSortHandler.bind(_this),
                timeoutCall: function(fn, delay) {
                    setTimeout(fn, delay);
                },
                runInNgZone: function(fn) {
                    _this.ngZone.run(fn);
                },
                safeApply: function() {
                    core.$appDigest();
                },
                setTouched: function(name) {
                    var ctrl = _this.ngform.controls[name];
                    if (ctrl) {
                        ctrl.markAsTouched();
                    }
                },
                clearForm: _this.clearForm.bind(_this)
            };
            _this._onChange = function() {};
            _this._onTouched = function() {};
            base.styler(_this.nativeElement, _this);
            _this.ngform = fb.group({});
            _this.addEventsToContext(_this.context);
            _this.app.subscribe("toggle-variable-state", function(options) {
                if (_this.datasource && _this.datasource.execute(core.DataSource.Operation.IS_API_AWARE) && core.isDataSourceEqual(options.variable, _this.datasource)) {
                    core.isDefined(_this.variableInflight) ? _this.debouncedHandleLoading(options) : _this.handleLoading(options);
                }
            });
            _this.deleteoktext = _this.appLocale.LABEL_OK;
            _this.deletecanceltext = _this.appLocale.LABEL_CANCEL;
            return _this;
        }
        Object.defineProperty(TableComponent.prototype, "gridData", {
            get: function() {
                return this._gridData || [];
            },
            set: function(newValue) {
                this._gridData = newValue;
                var startRowIndex = 0;
                var gridOptions;
                this._onChange(newValue);
                this._onTouched();
                if (core.isDefined(newValue)) {
                    if (this.isNavigationEnabled() && this.dataNavigator.dn.currentPage) {
                        startRowIndex = (this.dataNavigator.dn.currentPage - 1) * (this.dataNavigator.maxResults || 1) + 1;
                        this.setDataGridOption("startRowIndex", startRowIndex);
                    }
                    gridOptions = this.callDataGridMethod("getOptions");
                    if (!gridOptions) {
                        return;
                    }
                    if (!gridOptions.colDefs.length && this.fieldDefs.length) {
                        this.setDataGridOption("colDefs", core.getClonedObject(this.fieldDefs));
                    }
                    if (!this.isdynamictable && !_.isEmpty(newValue) && gridOptions.colDefs.length) {
                        this.invokeEventCallback("beforedatarender", {
                            $data: newValue,
                            $columns: this.columns,
                            data: newValue,
                            columns: this.columns
                        });
                    }
                    this.setDataGridOption("data", core.getClonedObject(newValue));
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TableComponent.prototype, "selecteditem", {
            get: function() {
                if (this.multiselect) {
                    return core.getClonedObject(this.items);
                }
                if (_.isEmpty(this.items)) {
                    return {};
                }
                return core.getClonedObject(this.items[0]);
            },
            set: function(val) {
                this.items.length = 0;
                this.callDataGridMethod("selectRows", val);
            },
            enumerable: true,
            configurable: true
        });
        TableComponent.prototype.onKeyPress = function($event) {
            if ($event.which === 13) {
                this.invokeEventCallback("enterkeypress", {
                    $event: $event,
                    $data: this.gridData
                });
            }
        };
        TableComponent.prototype.ngAfterContentInit = function() {
            var _this = this;
            _super.prototype.ngAfterContentInit.call(this);
            var runModeInitialProperties = {
                showrowindex: "showRowIndex",
                multiselect: "multiselect",
                radioselect: "showRadioColumn",
                filternullrecords: "filterNullRecords",
                enablesort: "enableSort",
                showheader: "showHeader",
                enablecolumnselection: "enableColumnSelection",
                shownewrow: "showNewRow",
                gridfirstrowselect: "selectFirstRow"
            };
            if (this._liveTableParent) {
                this.isPartOfLiveGrid = true;
            }
            if (this.readonlygrid || !this.editmode) {
                if (this.readonlygrid === "true") {
                    this.editmode = "";
                } else {
                    if (this.isPartOfLiveGrid) {
                        this.editmode = this.isPartOfLiveGrid.formlayout === "inline" ? base.EDIT_MODE.FORM : base.EDIT_MODE.DIALOG;
                    } else {
                        this.editmode = this.readonlygrid ? base.EDIT_MODE.INLINE : "";
                    }
                }
            }
            this.gridOptions.colDefs = this.fullFieldDefs;
            this.gridOptions.rowActions = this.rowActions;
            this.gridOptions.headerConfig = this.headerConfig;
            this.gridOptions.rowClass = this.rowclass;
            this.gridOptions.editmode = this.editmode;
            this.gridOptions.formPosition = this.formposition;
            this.gridOptions.filtermode = this.filtermode;
            this.gridOptions.searchLabel = this.searchlabel;
            this.gridOptions.isMobile = core.isMobile();
            this.gridOptions.name = this.name;
            if (!_.isEmpty(this.gridData)) {
                this.gridOptions.data = core.getClonedObject(this.gridData);
            }
            this.gridOptions.messages = {
                selectField: "Select Field"
            };
            this.datagridElement = $(this._tableElement.nativeElement);
            this.gridElement = this.$element;
            this.$element.css({
                position: "relative"
            });
            _.forEach(runModeInitialProperties, function(value, key) {
                if (core.isDefined(_this[key])) {
                    _this.gridOptions[value] = _this[key] === "true" || _this[key] === true;
                }
            });
            this.renderOperationColumns();
            this.gridOptions.colDefs = this.fieldDefs;
            this.datagridElement.datatable(this.gridOptions);
            this.callDataGridMethod("setStatus", "loading", this.loadingdatamsg);
            this.applyProps.forEach(function(args) {
                return _this.callDataGridMethod.apply(_this, __spread(args));
            });
            if (this.editmode === base.EDIT_MODE.QUICK_EDIT) {
                this.documentClickBind = this._documentClickBind.bind(this);
                document.addEventListener("click", this.documentClickBind);
            }
        };
        TableComponent.prototype.ngOnDestroy = function() {
            document.removeEventListener("click", this.documentClickBind);
            if (this.navigatorResultWatch) {
                this.navigatorResultWatch.unsubscribe();
            }
            if (this.navigatorMaxResultWatch) {
                this.navigatorMaxResultWatch.unsubscribe();
            }
            _super.prototype.ngOnDestroy.call(this);
        };
        TableComponent.prototype.addRowIndex = function(row) {
            var rowData = core.getClonedObject(row);
            var rowIndex = _.indexOf(this.gridOptions.data, row);
            if (rowIndex < 0) {
                return row;
            }
            rowData.$index = rowIndex + 1;
            rowData.$isFirst = rowData.$index === 1;
            rowData.$isLast = this.gridData.length === rowData.$index;
            return rowData;
        };
        TableComponent.prototype.addEventsToContext = function(context) {
            var _this = this;
            context.addNewRow = function() {
                return _this.addNewRow();
            };
            context.deleteRow = function() {
                return _this.deleteRow();
            };
            context.editRow = function() {
                return _this.editRow();
            };
        };
        TableComponent.prototype.execute = function(operation, options) {
            if ([ core.DataSource.Operation.IS_API_AWARE, core.DataSource.Operation.IS_PAGEABLE, core.DataSource.Operation.SUPPORTS_SERVER_FILTER ].includes(operation)) {
                return false;
            }
            return this.datasource ? this.datasource.execute(operation, options) : {};
        };
        TableComponent.prototype.isNavigationEnabled = function() {
            return this.shownavigation && this.dataNavigator && this.dataNavigatorWatched;
        };
        TableComponent.prototype.getClonedRowObject = function(rowData) {
            var row = core.getClonedObject(rowData);
            row.getProperty = function(field) {
                return _.get(row, field);
            };
            row.$isFirst = row.$index === 1;
            row.$isLast = this.gridData.length === row.$index;
            delete row.$$index;
            delete row.$$pk;
            return row;
        };
        TableComponent.prototype.handleLoading = function(data) {
            this.variableInflight = data.active;
            if (data.active) {
                this.callDataGridMethod("setStatus", "loading", this.loadingdatamsg);
            } else {
                if (!this.isGridEditMode && _.isEmpty(this.dataset)) {
                    this.callDataGridMethod("setStatus", "nodata", this.nodatamessage);
                } else {
                    this.callDataGridMethod("setStatus", "ready");
                }
            }
        };
        TableComponent.prototype.setDisabledOnField = function(operation, colDef, widgetType) {
            if (operation !== "new" && colDef["primary-key"] && colDef.generator === "assigned" && !colDef["related-entity-name"] && !colDef.period) {
                colDef[widgetType].disabled = true;
            }
        };
        TableComponent.prototype.resetFormControl = function(ctrl) {
            ctrl.markAsUntouched();
            ctrl.markAsPristine();
        };
        TableComponent.prototype.clearForm = function(newRow) {
            var _this = this;
            var ctrls = this.ngform.controls;
            _.keys(this.ngform.controls).forEach(function(key) {
                if (!key.endsWith("_filter") && (key.endsWith("_new") && newRow || !key.endsWith("_new") && !newRow)) {
                    ctrls[key].setValue("");
                    _this.resetFormControl(ctrls[key]);
                }
            });
        };
        TableComponent.prototype.isEmptyRecord = function(record) {
            var _this = this;
            var properties = Object.keys(record);
            var data, isDisplayed;
            return properties.every(function(prop, index) {
                data = record[prop];
                isDisplayed = _this.fieldDefs.length && core.isDefined(_this.fieldDefs[index]) && (core.isMobile() ? _this.fieldDefs[index].mobileDisplay : _this.fieldDefs[index].pcDisplay) || true;
                if (isDisplayed) {
                    return data === null || data === undefined || data === "";
                }
                return true;
            });
        };
        TableComponent.prototype.removeEmptyRecords = function(serviceData) {
            var _this = this;
            var allRecords = serviceData;
            var filteredData = [];
            if (allRecords && allRecords.length) {
                filteredData = allRecords.filter(function(record) {
                    return record && !_this.isEmptyRecord(record);
                });
            }
            return filteredData;
        };
        TableComponent.prototype.setGridData = function(serverData) {
            var data = this.filternullrecords ? this.removeEmptyRecords(serverData) : serverData;
            if (!this.variableInflight) {
                if (data && data.length === 0) {
                    this.callDataGridMethod("setStatus", "nodata", this.nodatamessage);
                } else {
                    this.callDataGridMethod("setStatus", "ready");
                }
            }
            this.gridData = data;
        };
        TableComponent.prototype.setDataGridOption = function(optionName, newVal, forceSet) {
            if (forceSet === void 0) {
                forceSet = false;
            }
            if (!this.datagridElement || !this.datagridElement.datatable || !this.datagridElement.datatable("instance")) {
                return;
            }
            var option = {};
            if (core.isDefined && (!_.isEqual(newVal, this.gridOptions[optionName]) || forceSet)) {
                option[optionName] = newVal;
                this.datagridElement.datatable("option", option);
                this.gridOptions[optionName] = newVal;
            }
        };
        TableComponent.prototype.callDataGridMethod = function() {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (!this.datagridElement || !this.datagridElement.datatable("instance")) {
                this.applyProps.set(args[1], args);
                return;
            }
            return this.datagridElement.datatable.apply(this.datagridElement, args);
        };
        TableComponent.prototype.renderOperationColumns = function() {
            var rowActionCol, insertPosition;
            var rowOperationsColumn = base.getRowOperationsColumn(), config = {
                name: rowOperationsColumn.field,
                field: rowOperationsColumn.field,
                isPredefined: true
            };
            if (!this.fieldDefs.length) {
                return;
            }
            rowActionCol = _.find(this.fullFieldDefs, {
                field: ROW_OPS_FIELD,
                type: "custom"
            });
            _.remove(this.fieldDefs, {
                type: "custom",
                field: ROW_OPS_FIELD
            });
            _.remove(this.headerConfig, {
                field: rowOperationsColumn.field
            });
            if (this.rowActions.length) {
                if (rowActionCol) {
                    insertPosition = rowActionCol.rowactionsposition ? _.toNumber(rowActionCol.rowactionsposition) : this.fieldDefs.length;
                    this.fieldDefs.splice(insertPosition, 0, rowActionCol);
                    if (insertPosition === 0) {
                        this.headerConfig.unshift(config);
                    } else {
                        this.headerConfig.push(config);
                    }
                } else {
                    this.fieldDefs.push(rowOperationsColumn);
                    this.headerConfig.push(config);
                }
            }
            this.setDataGridOption("headerConfig", this.headerConfig);
        };
        TableComponent.prototype.enablePageNavigation = function() {
            var _this = this;
            if (this.dataset && this.binddataset && this.dataNavigator) {
                this.dataNavigatorWatched = true;
                if (this.navigatorResultWatch) {
                    this.navigatorResultWatch.unsubscribe();
                }
                this.navigatorResultWatch = this.dataNavigator.resultEmitter.subscribe(function(newVal) {
                    if (core.isDefined(newVal)) {
                        if (_.isEqual(_this.dataset, newVal)) {
                            _this.watchVariableDataSet(newVal);
                        } else {
                            if (_.isArray(newVal)) {
                                _this.widget.dataset = [].concat(newVal);
                            } else if (_.isObject(newVal)) {
                                _this.widget.dataset = _.extend({}, newVal);
                            } else {
                                _this.widget.dataset = newVal;
                            }
                        }
                    } else {
                        _this.widget.dataset = undefined;
                    }
                }, true);
                if (this.navigatorMaxResultWatch) {
                    this.navigatorMaxResultWatch.unsubscribe();
                }
                this.navigatorMaxResultWatch = this.dataNavigator.maxResultsEmitter.subscribe(function(newVal) {
                    _this.pagesize = newVal;
                });
                this.__fullData = this.dataset;
                this.dataNavigator.widget.maxResults = this.pagesize || 5;
                this.dataNavigator.options = {
                    maxResults: this.pagesize || 5
                };
                this.removePropertyBinding("dataset");
                this.dataNavigator.setBindDataSet(this.binddataset, this.viewParent, this.datasource, this.dataset, this.binddatasource);
            }
        };
        TableComponent.prototype.resetPageNavigation = function() {
            if (this.dataNavigator) {
                this.dataNavigator.resetPageNavigation();
            }
        };
        TableComponent.prototype.isDataValid = function() {
            var error;
            var dataset = this.dataset || {};
            if (dataset.error) {
                error = dataset.error;
            }
            if (dataset.data && dataset.data.error) {
                if (dataset.data.errorMessage) {
                    error = dataset.data.errorMessage;
                }
            }
            if (error) {
                this.setGridData([]);
                this.callDataGridMethod("setStatus", "error", error);
                return false;
            }
            return true;
        };
        TableComponent.prototype.populateGridData = function(serviceData) {
            var data;
            serviceData = base.transformData(serviceData, this.name);
            if (!this.isNavigationEnabled() && this._isClientSearch) {
                data = core.getClonedObject(serviceData);
                data = this.getSearchResult(data, this.filterInfo);
                data = this.getSortResult(data, this.sortInfo);
                this.serverData = data;
            } else {
                this.serverData = serviceData;
            }
            if (this.isdynamictable) {
                this.createGridColumns(this.serverData);
            } else {
                this.setGridData(this.serverData);
            }
        };
        TableComponent.prototype.generateDynamicColumns = function(columns) {
            return __awaiter(this, void 0, void 0, function() {
                var tmpl, componentFactoryRef, component;
                var _this = this;
                return __generator(this, function(_a) {
                    switch (_a.label) {
                      case 0:
                        this.fieldDefs = [];
                        this.filterTmpl._results = [];
                        if (_.isEmpty(columns)) {
                            return [ 2 ];
                        }
                        tmpl = "";
                        columns.forEach(function(col) {
                            var attrsTmpl = "";
                            var customTmpl = "";
                            _.forEach(col, function(val, key) {
                                if (val) {
                                    if (key === "customExpression") {
                                        customTmpl = val;
                                    } else {
                                        attrsTmpl += " " + key + '="' + val + '"';
                                    }
                                }
                            });
                            tmpl += "<wm-table-column " + attrsTmpl + ' tableName="' + _this.name + '">' + customTmpl + "</wm-table-column>";
                        });
                        this.dynamicTableRef.clear();
                        if (!this._dynamicContext) {
                            this._dynamicContext = Object.create(this.viewParent);
                            this._dynamicContext[this.getAttr("wmTable")] = this;
                        }
                        this.noOfColumns = columns.length;
                        return [ 4, this.dynamicComponentProvider.getComponentFactoryRef("app-table-dynamic-" + this.widgetId, tmpl, {
                            noCache: true,
                            transpile: true
                        }) ];

                      case 1:
                        componentFactoryRef = _a.sent();
                        component = this.dynamicTableRef.createComponent(componentFactoryRef, 0, this.inj);
                        core.extendProto(component.instance, this._dynamicContext);
                        this.$element.find(".dynamic-table-container")[0].appendChild(component.location.nativeElement);
                        return [ 2 ];
                    }
                });
            });
        };
        TableComponent.prototype.prepareColDefs = function(data) {
            var _this = this;
            var defaultFieldDefs;
            var properties;
            this.fieldDefs = [];
            this.headerConfig = [];
            this.columns = {};
            properties = data;
            defaultFieldDefs = base.prepareFieldDefs(properties);
            _.forEach(defaultFieldDefs, function(columnDef) {
                columnDef.binding = columnDef.field;
                columnDef.caption = columnDef.displayName;
                columnDef.pcDisplay = true;
                columnDef.mobileDisplay = true;
                columnDef.searchable = true;
                columnDef.type = "string";
            });
            defaultFieldDefs.forEach(function(col) {
                _this.columns[col.field] = col;
            });
            this.invokeEventCallback("beforedatarender", {
                $data: data,
                $columns: this.columns,
                data: data,
                columns: this.columns
            });
            defaultFieldDefs = [];
            _.forEach(this.columns, function(val) {
                defaultFieldDefs.push(val);
            });
            this.generateDynamicColumns(defaultFieldDefs);
        };
        TableComponent.prototype.createGridColumns = function(data) {
            var dataValid = data && !data.error;
            if (dataValid && !_.isArray(data)) {
                data = [ data ];
            }
            if (_.isEmpty(data)) {
                this.setGridData(data);
                return;
            }
            if (!dataValid) {
                return;
            }
            this.prepareColDefs(data);
            this.serverData = data;
            this.setGridData(this.serverData);
        };
        TableComponent.prototype.getSortExpr = function() {
            var sortExp;
            var pagingOptions;
            if (this.datasource && this.datasource.execute(core.DataSource.Operation.IS_PAGEABLE)) {
                pagingOptions = this.datasource.execute(core.DataSource.Operation.GET_PAGING_OPTIONS);
                sortExp = _.isEmpty(pagingOptions) ? "" : base.getOrderByExpr(pagingOptions.sort);
            }
            return sortExp || "";
        };
        TableComponent.prototype.watchVariableDataSet = function(newVal) {
            var result;
            if (this.dataNavigatorWatched && _.isUndefined(newVal) && this.__fullData) {
                return;
            }
            if (this.variableInflight) {
                this.callDataGridMethod("setStatus", "loading", this.loadingdatamsg);
            }
            result = core.getValidJSON(newVal);
            if (result) {
                newVal = result;
            }
            if (!this.isDataValid()) {
                return;
            }
            if (newVal) {
                if (this.shownavigation && !this.dataNavigatorWatched) {
                    this.enablePageNavigation();
                    return;
                }
            } else {
                this.resetPageNavigation();
                if (!this.variableInflight) {
                    this.callDataGridMethod("setStatus", "nodata", this.nodatamessage);
                }
                this.setDataGridOption("selectFirstRow", this.gridfirstrowselect);
            }
            if (!this.isNavigationEnabled() && newVal) {
                this.checkFiltersApplied(this.getSortExpr());
            }
            if (!_.isObject(newVal) || newVal === "" || newVal && newVal.dataValue === "") {
                if (!this.variableInflight) {
                    this.setGridData([]);
                }
                return;
            }
            if (newVal) {
                this.populateGridData(newVal);
            }
        };
        TableComponent.prototype.onDataSourceChange = function() {
            this.fieldDefs.forEach(function(col) {
                core.triggerFn(col.onDataSourceChange && col.onDataSourceChange.bind(col));
            });
        };
        TableComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            var enableNewRow;
            switch (key) {
              case "datasource":
                this.watchVariableDataSet(this.dataset);
                this.onDataSourceChange();
                break;

              case "dataset":
                if (this.binddatasource && !this.datasource) {
                    return;
                }
                if (this.parentList && !this.datasource && _.startsWith(this.binddataset, "item")) {
                    this.datasource = core.getDatasourceFromExpr(this.widget.$attrs.get("datasetboundexpr"), this);
                }
                this.watchVariableDataSet(nv);
                break;

              case "filtermode":
                this.setDataGridOption("filtermode", nv);
                break;

              case "searchlabel":
                this.setDataGridOption("searchLabel", nv);
                break;

              case "navigation":
                if (nv === "Advanced") {
                    this.navigation = "Classic";
                    return;
                }
                if (nv !== "None") {
                    this.shownavigation = true;
                }
                this.navControls = nv;
                break;

              case "gridfirstrowselect":
                this.setDataGridOption("selectFirstRow", nv);
                break;

              case "gridclass":
                this.callDataGridMethod("option", "cssClassNames.grid", nv);
                break;

              case "nodatamessage":
                this.callDataGridMethod("option", "dataStates.nodata", nv);
                break;

              case "loadingdatamsg":
                this.callDataGridMethod("option", "dataStates.loading", nv);
                break;

              case "loadingicon":
                this.callDataGridMethod("option", "loadingicon", nv);
                break;

              case "spacing":
                this.callDataGridMethod("option", "spacing", nv);
                if (nv === "condensed") {
                    this.navigationSize = "small";
                } else {
                    this.navigationSize = "";
                }
                break;

              case "exportformat":
                this.exportOptions = [];
                if (nv) {
                    _.forEach(_.split(nv, ","), function(type) {
                        _this.exportOptions.push({
                            label: type,
                            icon: exportIconMapping[type]
                        });
                    });
                }
                break;

              case "shownewrow":
                enableNewRow = nv || _.some(this.actions, function(act) {
                    return _.includes(act.action, "addNewRow()");
                });
                this.callDataGridMethod("option", "actionsEnabled.new", enableNewRow);
                break;

              case "show":
                if (nv) {
                    this.invokeEventCallback("show");
                } else {
                    this.invokeEventCallback("hide");
                }

              default:
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        TableComponent.prototype.onStyleChange = function(key, nv, ov) {
            switch (key) {
              case "width":
                this.callDataGridMethod("setGridDimensions", "width", nv);
                break;

              case "height":
                this.callDataGridMethod("setGridDimensions", "height", nv);
                break;
            }
            _super.prototype.onStyleChange.call(this, key, nv, ov);
        };
        TableComponent.prototype.populateActions = function() {
            var _this = this;
            this._actions.header = [];
            this._actions.footer = [];
            _.forEach(this.actions, function(action) {
                if (_.includes(action.position, "header")) {
                    _this._actions.header.push(action);
                }
                if (_.includes(action.position, "footer")) {
                    _this._actions.footer.push(action);
                }
            });
        };
        TableComponent.prototype.renderDynamicFilterColumn = function(filteTemRef) {
            if (this.isdynamictable) {
                this.filterTmpl._results.push(filteTemRef);
            }
        };
        TableComponent.prototype.registerColumns = function(tableColumn) {
            var _this = this;
            if (core.isMobile()) {
                if (!tableColumn.mobileDisplay) {
                    return;
                }
            } else {
                if (!tableColumn.pcDisplay) {
                    return;
                }
            }
            var colCount = this.fieldDefs.push(tableColumn);
            this.fullFieldDefs.push(tableColumn);
            this.rowFilter[tableColumn.field] = {
                value: undefined
            };
            this.fieldDefs.forEach(function(col) {
                _this.columns[col.field] = col;
            });
            if (this.isdynamictable && colCount === this.noOfColumns) {
                this.renderOperationColumns();
                this.setDataGridOption("colDefs", this.fieldDefs);
            }
        };
        TableComponent.prototype.registerFormField = function(name, formField) {
            this.formfields[name] = formField;
        };
        TableComponent.prototype.registerActions = function(tableAction) {
            this.actions.push(tableAction);
            this.populateActions();
        };
        TableComponent.prototype.registerRow = function(tableRow, rowInstance) {
            this.rowDef = tableRow;
            this.rowInstance = rowInstance;
            this.callDataGridMethod("option", "cssClassNames.rowExpandIcon", this.rowDef.expandicon);
            this.callDataGridMethod("option", "cssClassNames.rowCollapseIcon", this.rowDef.collapseicon);
            this.gridOptions.rowExpansionEnabled = true;
            this.gridOptions.rowDef = this.rowDef;
        };
        TableComponent.prototype.registerRowActions = function(tableRowAction) {
            this.rowActions.push(tableRowAction);
        };
        TableComponent.prototype.selectItem = function(item, data) {
            if (data) {
                this.serverData = data;
            }
            if (_.isObject(item)) {
                item = _.omitBy(item, function(value) {
                    return _.isArray(value) && _.isEmpty(value);
                });
            }
            this.callDataGridMethod("selectRow", item, true);
        };
        TableComponent.prototype.deselectItem = function(item) {
            this.callDataGridMethod("deselectRow", item);
        };
        TableComponent.prototype.onDataNavigatorDataSetChange = function(nv) {
            var data;
            this.__fullData = nv;
            this.checkFiltersApplied(this.getSortExpr());
            if (this._isClientSearch) {
                data = core.getClonedObject(this.__fullData);
                if (_.isObject(data) && !_.isArray(data)) {
                    data = [ data ];
                }
                data = this.getSearchResult(data, this.filterInfo);
                data = this.getSortResult(data, this.sortInfo);
                return data;
            }
            return nv;
        };
        TableComponent.prototype.toggleMessage = function(show, type, msg, header) {
            if (show && msg) {
                this.app.notifyApp(msg, type, header);
            }
        };
        TableComponent.prototype.export = function($item) {
            var filterFields;
            var sortOptions = _.isEmpty(this.sortInfo) ? "" : this.sortInfo.field + " " + this.sortInfo.direction;
            var columns = {};
            var isValid;
            var requestData;
            this.fieldDefs.forEach(function(fieldDef) {
                if (fieldDef.field === ROW_OPS_FIELD || !fieldDef.show) {
                    return;
                }
                var option = {
                    header: fieldDef.displayName
                };
                if (fieldDef.exportexpression) {
                    option.expression = fieldDef.exportexpression;
                } else {
                    option.field = fieldDef.field;
                }
                columns[fieldDef.field] = option;
            });
            filterFields = this.getFilterFields(this.filterInfo);
            requestData = {
                matchMode: "anywhereignorecase",
                filterFields: filterFields,
                orderBy: sortOptions,
                exportType: $item.label,
                logicalOp: "AND",
                exportSize: this.exportdatasize,
                columns: columns
            };
            isValid = this.invokeEventCallback("beforeexport", {
                $data: requestData
            });
            if (isValid === false) {
                return;
            }
            requestData.fields = _.values(requestData.columns);
            this.datasource.execute(core.DataSource.Operation.DOWNLOAD, {
                data: requestData
            });
        };
        TableComponent.prototype.expandRow = function(rowId) {
            this.callDataGridMethod("expandRow", rowId);
        };
        TableComponent.prototype.collapseRow = function(rowId) {
            this.callDataGridMethod("collapseRow", rowId);
        };
        TableComponent.prototype._documentClickBind = function(event) {
            var $target = event.target;
            if (this.$element[0].contains($target) || event.target.doctype || isInputBodyWrapper($($target))) {
                return;
            }
            this.callDataGridMethod("saveRow");
        };
        TableComponent.prototype._redraw = function(forceRender) {
            var _this = this;
            if (forceRender) {
                this.datagridElement.datatable(this.gridOptions);
            } else {
                setTimeout(function() {
                    _this.callDataGridMethod("setColGroupWidths");
                    _this.callDataGridMethod("addOrRemoveScroll");
                });
            }
        };
        TableComponent.prototype.invokeActionEvent = function($event, expression) {
            var fn = core.$parseEvent(expression);
            fn(this.viewParent, Object.assign(this.context, {
                $event: $event
            }));
        };
        TableComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName !== "select") {
                _super.prototype.handleEvent.call(this, this.nativeElement, eventName, callback, locals);
            }
        };
        TableComponent.prototype.triggerUploadEvent = function($event, eventName, fieldName, row) {
            var params = {
                $event: $event,
                row: row
            };
            if (!this.columns[fieldName]) {
                return;
            }
            if (eventName === "change") {
                params.newVal = $event.target.files;
                params.oldVal = this.columns[fieldName]._oldUploadVal;
                this.columns[fieldName]._oldUploadVal = params.newVal;
            }
            this.columns[fieldName].invokeEventCallback(eventName, params);
        };
        TableComponent.prototype.registerFormWidget = function() {};
        TableComponent.prototype.writeValue = function() {};
        TableComponent.prototype.registerOnChange = function(fn) {
            this._onChange = fn;
        };
        TableComponent.prototype.registerOnTouched = function(fn) {
            this._onTouched = fn;
        };
        TableComponent.initializeProps = registerProps();
        TableComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "[wmTable]",
                template: '<div class="panel-heading" *ngIf="title || subheading || iconclass || exportOptions.length || _actions.header.length">\n    <h3 class="panel-title">\n        <div class="pull-left">\n            <i class="app-icon panel-icon {{iconclass}}" *ngIf="iconclass"></i>\n        </div>\n        <div class="pull-left">\n            <div class="heading" [innerHTML]="title | trustAs: \'html\'"></div>\n            <div class="description" [innerHTML]="subheading | trustAs: \'html\'"></div>\n        </div>\n        <div class="panel-actions app-datagrid-actions" *ngIf="exportOptions.length || _actions.header.length">\n            <ng-container *ngFor="let btn of _actions.header"\n                          [ngTemplateOutlet]="btn.widgetType === \'button\' ? buttonRef : anchorRef" [ngTemplateOutletContext]="{btn:btn}">\n            </ng-container>\n            <div wmMenu dropdown caption.bind="appLocale.LABEL_EXPORT" *ngIf="exportOptions.length"  autoclose="always" attr.name="{{name}}-export"\n                dataset.bind="exportOptions" select.event="export($item)" menuposition="down,left"></div>\n        </div>\n    </h3>\n</div>\n<div class="app-datagrid" #datagridElement></div>\n<div class="panel-footer clearfix" [hidden]="!_actions.footer.length && (!shownavigation || dataNavigator?.dataSize <= pagesize)">\n    <div class="app-datagrid-paginator" [hidden]="!dataNavigator?.dataSize || !shownavigation || dataNavigator?.dataSize <= pagesize">\n        <nav wmPagination show.bind="shownavigation" navigationalign.bind="navigationalign"\n             navigationsize.bind="navigationSize"\n             navigation.bind="navControls" showrecordcount.bind="showrecordcount" maxsize.bind="maxsize"\n             boundarylinks.bind="boundarylinks"\n             forceellipses.bind="forceellipses" directionlinks.bind="directionlinks"></nav>\n    </div>\n    <div class="app-datagrid-actions" *ngIf="_actions.footer.length">\n        <ng-container *ngFor="let btn of _actions.footer"\n                      [ngTemplateOutlet]="btn.widgetType === \'button\' ? buttonRef : anchorRef" [ngTemplateOutletContext]="{btn:btn}">\n        </ng-container>\n    </div>\n</div>\n\n<ng-template #buttonRef let-btn="btn">\n    <button wmButton caption.bind="btn.displayName" show.bind="btn.show" class.bind="btn.class"  iconclass.bind="btn.iconclass" (click)="invokeActionEvent($event, btn.action)"\n            [ngClass]="{\'btn-sm\': spacing === \'condensed\', \'disabled-new\': btn.key === \'addNewRow\' && (isGridEditMode || isLoading)}"\n            type="button" shortcutkey.bind="btn.shortcutkey" tabindex.bind="btn.tabindex" hint.bind="btn.title" disabled.bind="btn.disabled" conditionalclass.bind="btn.conditionalclass" conditionalstyle.bind="btn.conditionalstyle"></button>\n</ng-template>\n\n<ng-template #anchorRef let-btn="btn">\n    <a wmAnchor caption.bind="btn.displayName" show.bind="btn.show" class.bind="btn.class"  iconclass.bind="btn.iconclass" (click)="invokeActionEvent($event, btn.action)"\n            [ngClass]="{\'btn-sm\': spacing === \'condensed\', \'disabled-new\': btn.key === \'addNewRow\' && (isGridEditMode || isLoading)}"\n            shortcutkey.bind="btn.shortcutkey" tabindex.bind="btn.tabindex" hint.bind="btn.title"\n            hyperlink.bind="btn.hyperlink" target.bind="btn.target" conditionalclass.bind="btn.conditionalclass" conditionalstyle.bind="btn.conditionalstyle"></a>\n</ng-template>\n\n<div hidden>\n    <ng-container #multiColumnFilterView></ng-container>\n\n    <ng-container #inlineEditView></ng-container>\n\n    <ng-container #inlineEditNewView></ng-container>\n\n    <ng-container #rowActionsView></ng-container>\n\n    <ng-container #rowExpansionActionView></ng-container>\n\n    <ng-container #customExprView></ng-container>\n\n    <ng-container #dynamicTable></ng-container>\n\n    <ng-container #rowDetailView></ng-container>\n\n    <div class="dynamic-table-container"></div>\n</div>\n',
                providers: [ base.provideAs(TableComponent, forms.NG_VALUE_ACCESSOR, true), base.provideAsWidgetRef(TableComponent) ]
            } ]
        } ];
        TableComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: forms.FormBuilder
            }, {
                type: core.App
            }, {
                type: core.DynamicComponentRefProvider
            }, {
                type: list.ListComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "datasource.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "readonlygrid" ]
                } ]
            }, {
                type: core$1.NgZone
            } ];
        };
        TableComponent.propDecorators = {
            dataNavigator: [ {
                type: core$1.ViewChild,
                args: [ pagination.PaginationComponent ]
            } ],
            _tableElement: [ {
                type: core$1.ViewChild,
                args: [ "datagridElement" ]
            } ],
            rowActionTmpl: [ {
                type: core$1.ContentChildren,
                args: [ "rowActionTmpl" ]
            } ],
            rowActionsViewRef: [ {
                type: core$1.ViewChild,
                args: [ "rowActionsView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            filterTmpl: [ {
                type: core$1.ContentChildren,
                args: [ "filterTmpl", {
                    descendants: true
                } ]
            } ],
            filterViewRef: [ {
                type: core$1.ViewChild,
                args: [ "multiColumnFilterView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            inlineWidgetTmpl: [ {
                type: core$1.ContentChildren,
                args: [ "inlineWidgetTmpl", {
                    descendants: true
                } ]
            } ],
            inlineEditViewRef: [ {
                type: core$1.ViewChild,
                args: [ "inlineEditView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            inlineWidgetNewTmpl: [ {
                type: core$1.ContentChildren,
                args: [ "inlineWidgetTmplNew", {
                    descendants: true
                } ]
            } ],
            inlineEditNewViewRef: [ {
                type: core$1.ViewChild,
                args: [ "inlineEditNewView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            customExprTmpl: [ {
                type: core$1.ContentChildren,
                args: [ "customExprTmpl", {
                    descendants: true
                } ]
            } ],
            customExprViewRef: [ {
                type: core$1.ViewChild,
                args: [ "customExprView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            rowExpansionActionTmpl: [ {
                type: core$1.ContentChildren,
                args: [ "rowExpansionActionTmpl" ]
            } ],
            rowExpansionTmpl: [ {
                type: core$1.ContentChild,
                args: [ "rowExpansionTmpl" ]
            } ],
            rowDetailViewRef: [ {
                type: core$1.ViewChild,
                args: [ "rowDetailView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            rowExpansionActionViewRef: [ {
                type: core$1.ViewChild,
                args: [ "rowExpansionActionView", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            dynamicTableRef: [ {
                type: core$1.ViewChild,
                args: [ "dynamicTable", {
                    read: core$1.ViewContainerRef
                } ]
            } ],
            onKeyPress: [ {
                type: core$1.HostListener,
                args: [ "keypress", [ "$event" ] ]
            } ]
        };
        return TableComponent;
    }(base.StylableComponent);
    var OPERATION = {
        NEW: "new",
        EDIT: "edit",
        DELETE: "delete"
    };
    var TableCUDDirective = function() {
        function TableCUDDirective(table, dialogService, app) {
            this.table = table;
            this.dialogService = dialogService;
            this.app = app;
            table.initiateSelectItem = this.initiateSelectItem.bind(this);
            table.updateVariable = this.updateVariable.bind(this);
            table.updateRecord = this.updateRecord.bind(this);
            table.deleteRecord = this.deleteRecord.bind(this);
            table.insertRecord = this.insertRecord.bind(this);
            table.editRow = this.editRow.bind(this);
            table.addNewRow = this.addNewRow.bind(this);
            table.addRow = this.addNewRow.bind(this);
            table.deleteRow = this.deleteRow.bind(this);
            table.onRecordDelete = this.onRecordDelete.bind(this);
            table.hideEditRow = this.hideEditRow.bind(this);
            table.saveRow = this.saveRow.bind(this);
            table.cancelRow = this.cancelRow.bind(this);
        }
        TableCUDDirective.prototype.selectItemOnSuccess = function(row, skipSelectItem, callBack) {
            var _this = this;
            setTimeout(function() {
                if (!skipSelectItem) {
                    _this.table.selectItem(row, _this.table.dataset);
                }
                core.triggerFn(callBack);
            }, 250);
        };
        TableCUDDirective.prototype.initiateSelectItem = function(index, row, skipSelectItem, isStaticVariable, callBack) {
            var _this = this;
            if (index === "last") {
                if (!isStaticVariable) {
                    this.table.dataNavigator.dataSize += 1;
                }
                if (!this.table.isNavigationEnabled()) {
                    index = "current";
                }
            }
            this.table.dataNavigator.calculatePagingValues();
            this.table.dataNavigator.__fullData = this.table.__fullData;
            this.table.dataNavigator.navigatePage(index, null, true, function() {
                if (_this.table.isNavigationEnabled() || isStaticVariable) {
                    _this.selectItemOnSuccess(row, skipSelectItem, callBack);
                }
            });
        };
        TableCUDDirective.prototype.updateVariable = function(row, callBack) {
            var _this = this;
            var dataSource = this.table.datasource;
            if (!dataSource) {
                return;
            }
            dataSource.execute(core.DataSource.Operation.FETCH_DISTINCT_VALUES);
            if (!this.table.isNavigationEnabled()) {
                var sortInfo = this.table.sortInfo;
                var sortOptions = sortInfo && sortInfo.direction ? sortInfo.field + " " + sortInfo.direction : "";
                base.refreshDataSource(dataSource, {
                    page: 1,
                    filterFields: this.table.getFilterFields(this.table.filterInfo),
                    orderBy: sortOptions,
                    matchMode: "anywhereignorecase"
                }).then(function() {
                    core.$appDigest();
                    _this.selectItemOnSuccess(row, true, callBack);
                });
            }
        };
        TableCUDDirective.prototype.insertSuccessHandler = function(response, options) {
            if (response.error) {
                this.table.invokeEventCallback("error", {
                    $event: options.event,
                    $operation: OPERATION.NEW,
                    $data: response.error
                });
                this.table.toggleMessage(true, "error", this.table.errormessage || response.error);
                core.triggerFn(options.error, response);
            } else {
                if (options.event) {
                    var row = $(options.event.target).closest("tr");
                    this.table.callDataGridMethod("hideRowEditMode", row);
                }
                this.table.toggleMessage(true, "success", this.table.insertmessage);
                if (this.table.datasource.execute(core.DataSource.Operation.SUPPORTS_CRUD)) {
                    this.table.initiateSelectItem(this.table.getNavigationTargetBySortInfo(), response, undefined, false, options.callBack);
                    this.updateVariable(response, options.callBack);
                } else if (!this.table.datasource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                    this.table.initiateSelectItem(this.table.getNavigationTargetBySortInfo(), response, undefined, false, options.callBack);
                }
                core.triggerFn(options.success, response);
                this.table.invokeEventCallback("rowinsert", {
                    $event: options.event,
                    $data: response,
                    row: response
                });
            }
        };
        TableCUDDirective.prototype.generatePath = function(binddataset) {
            var path, index;
            var dataBoundExpr = this.table.widget.$attrs.get("datasetboundexpr");
            if (_.startsWith(binddataset, "item") && dataBoundExpr) {
                if (_.startsWith(dataBoundExpr, "Widgets.")) {
                    dataBoundExpr = core.extractCurrentItemExpr(dataBoundExpr, this.table);
                }
                var parentListItems = this.table.$element.parents(".app-list-item");
                var indexArr = _.map(parentListItems, function(item) {
                    return _.parseInt($(item).attr("listitemindex"));
                });
                for (var i = indexArr.length - 1; i >= 0; i--) {
                    dataBoundExpr = dataBoundExpr.replace("$i", indexArr[i]);
                }
                index = _.last(indexArr);
                path = dataBoundExpr.replace(/^Variables\..*\.dataSet([^.])*(\.|$)/g, "");
            } else {
                var regEx = /^Variables\..*\.dataSet([\[][0-9]])/g;
                if (regEx.test(binddataset)) {
                    index = _.parseInt(binddataset.replace(/^Variables\..*\.dataSet([\[])/g, ""));
                }
                path = binddataset.replace(/^Variables\..*\.dataSet([^.])*(\.|$)/g, "");
            }
            return {
                path: path,
                index: index
            };
        };
        TableCUDDirective.prototype.insertRecord = function(options) {
            var _this = this;
            var dataSource = this.table.datasource;
            if (!dataSource) {
                return;
            }
            var dataObject = {
                row: options.row,
                skipNotification: true,
                period: options.period
            };
            if (dataSource.execute(core.DataSource.Operation.SUPPORTS_CRUD) || !dataSource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                if (!dataSource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                    var extraOptions = this.generatePath(this.table.binddataset);
                    dataSource.execute(core.DataSource.Operation.ADD_ITEM, {
                        item: options.row,
                        path: extraOptions.path,
                        parentIndex: extraOptions.index
                    });
                    this.insertSuccessHandler(options.row, options);
                    return;
                }
                dataSource.execute(core.DataSource.Operation.INSERT_RECORD, dataObject).then(function(response) {
                    _this.insertSuccessHandler(response, options);
                }, function(error) {
                    _this.table.invokeEventCallback("error", {
                        $event: options.event,
                        $operation: OPERATION.NEW,
                        $data: error
                    });
                    _this.table.toggleMessage(true, "error", _this.table.errormessage || error);
                    core.triggerFn(options.error, error);
                    core.triggerFn(options.callBack, undefined, true);
                });
            } else {
                this.table.invokeEventCallback("rowinsert", {
                    $event: options.event,
                    row: options.row
                });
            }
        };
        TableCUDDirective.prototype.updateSuccessHandler = function(response, options) {
            if (response.error) {
                this.table.invokeEventCallback("error", {
                    $event: options.event,
                    $operation: OPERATION.EDIT,
                    $data: response.error
                });
                this.table.toggleMessage(true, "error", this.table.errormessage || response.error);
                core.triggerFn(options.error, response);
            } else {
                if (options.event) {
                    var row = $(options.event.target).closest("tr");
                    this.table.callDataGridMethod("hideRowEditMode", row);
                }
                this.table.toggleMessage(true, "success", this.table.updatemessage);
                if (this.table.datasource.execute(core.DataSource.Operation.SUPPORTS_CRUD)) {
                    this.table.initiateSelectItem("current", response, undefined, false, options.callBack);
                    this.updateVariable(response, options.callBack);
                } else if (!this.table.datasource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                    this.table.initiateSelectItem("current", response, undefined, false, options.callBack);
                }
                core.triggerFn(options.success, response);
                this.table.invokeEventCallback("rowupdate", {
                    $event: options.event,
                    $data: response,
                    row: response
                });
            }
        };
        TableCUDDirective.prototype.updateRecord = function(options) {
            var _this = this;
            var dataSource = this.table.datasource;
            if (!dataSource) {
                return;
            }
            var dataObject = {
                row: options.row,
                prevData: options.prevData,
                skipNotification: true,
                period: options.period
            };
            if (dataSource.execute(core.DataSource.Operation.SUPPORTS_CRUD) || !dataSource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                if (!dataSource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                    var extraOptions = this.generatePath(this.table.binddataset);
                    dataSource.execute(core.DataSource.Operation.SET_ITEM, {
                        prevItem: options.prevData,
                        item: options.row,
                        path: extraOptions.path,
                        parentIndex: extraOptions.index
                    });
                    this.updateSuccessHandler(options.row, options);
                    return;
                }
                dataSource.execute(core.DataSource.Operation.UPDATE_RECORD, dataObject).then(function(response) {
                    _this.updateSuccessHandler(response, options);
                }, function(error) {
                    _this.table.invokeEventCallback("error", {
                        $event: options.event,
                        $operation: OPERATION.EDIT,
                        $data: error
                    });
                    _this.table.toggleMessage(true, "error", _this.table.errormessage || error);
                    core.triggerFn(options.error, error);
                    core.triggerFn(options.callBack, undefined, true);
                });
            } else {
                this.table.invokeEventCallback("rowupdate", {
                    $event: options.event,
                    row: options.row
                });
            }
        };
        TableCUDDirective.prototype.onRecordDelete = function(callBack) {
            var index;
            if (this.table.dataNavigator) {
                this.table.dataNavigator.dataSize -= 1;
                this.table.dataNavigator.calculatePagingValues();
                index = this.table.dataNavigator.pageCount < this.table.dataNavigator.dn.currentPage ? "prev" : undefined;
                this.table.dataNavigator.__fullData = this.table.__fullData;
                this.table.dataNavigator.navigatePage(index, null, true, function() {
                    setTimeout(function() {
                        core.triggerFn(callBack);
                    }, undefined, false);
                });
            }
        };
        TableCUDDirective.prototype.deleteSuccessHandler = function(row, response, evt, callBack) {
            if (response && response.error) {
                this.table.toggleMessage(true, "error", this.table.errormessage || response.error);
                return;
            }
            this.onRecordDelete(callBack);
            if (this.table.datasource.execute(core.DataSource.Operation.SUPPORTS_CRUD)) {
                this.updateVariable(row, callBack);
            }
            this.table.toggleMessage(true, "success", this.table.deletemessage);
            this.table.invokeEventCallback("rowdelete", {
                $event: evt,
                $data: row,
                row: row
            });
            this.table.invokeEventCallback("rowdeleted", {
                $event: evt,
                $data: row,
                row: row
            });
        };
        TableCUDDirective.prototype.deleteFn = function(options) {
            var _this = this;
            var dataSource = this.table.datasource;
            if (!dataSource) {
                return;
            }
            if (dataSource.execute(core.DataSource.Operation.SUPPORTS_CRUD) || !dataSource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                if (!dataSource.execute(core.DataSource.Operation.IS_API_AWARE)) {
                    var extraOptions = this.generatePath(this.table.binddataset);
                    dataSource.execute(core.DataSource.Operation.REMOVE_ITEM, {
                        item: options.row,
                        path: extraOptions.path,
                        parentIndex: extraOptions.index
                    });
                    this.deleteSuccessHandler(options.row, undefined, options.evt, options.callBack);
                    return;
                }
                dataSource.execute(core.DataSource.Operation.DELETE_RECORD, {
                    row: options.row,
                    skipNotification: true,
                    period: options.period
                }).then(function(response) {
                    _this.deleteSuccessHandler(response, options.row, options.evt, options.callBack);
                }, function(error) {
                    core.triggerFn(options.callBack, undefined, true);
                    _this.table.invokeEventCallback("error", {
                        $event: options.evt,
                        $operation: OPERATION.DELETE,
                        $data: error
                    });
                    _this.table.toggleMessage(true, "error", _this.table.errormessage || error);
                });
            } else {
                this.table.invokeEventCallback("rowdelete", {
                    $event: options.evt,
                    row: options.row
                });
            }
            core.triggerFn(options.cancelRowDeleteCallback);
        };
        TableCUDDirective.prototype.deleteRecord = function(options) {
            var _this = this;
            if (!this.table.confirmdelete) {
                this.deleteFn(options);
                core.triggerFn(options.cancelRowDeleteCallback);
                return;
            }
            this.dialogService.showAppConfirmDialog({
                title: this.app.appLocale.MESSAGE_DELETE_RECORD || "Delete Record",
                iconclass: "wi wi-delete fa-lg",
                message: this.table.confirmdelete,
                oktext: this.table.deleteoktext,
                canceltext: this.table.deletecanceltext,
                onOk: function() {
                    _this.deleteFn(options);
                    _this.dialogService.closeAppConfirmDialog();
                },
                onCancel: function() {
                    core.triggerFn(options.cancelRowDeleteCallback);
                    _this.dialogService.closeAppConfirmDialog();
                },
                onOpen: function() {
                    $(".cancel-action").focus();
                }
            });
        };
        TableCUDDirective.prototype.editRow = function(evt) {
            var _this = this;
            var row;
            if (evt && evt.target) {
                this.table.callDataGridMethod("toggleEditRow", evt, {
                    selectRow: true,
                    action: "edit"
                });
            } else {
                if (this.table.editmode === "form" || this.table.editmode === "dialog") {
                    row = evt || this.table.selectedItems[0];
                    this.table.gridOptions.beforeRowUpdate(row);
                } else {
                    setTimeout(function() {
                        row = _this.table.datagridElement.find("tr.active");
                        if (row.length) {
                            _this.table.callDataGridMethod("toggleEditRow", undefined, {
                                $row: row,
                                action: "edit"
                            });
                        }
                    });
                }
            }
        };
        TableCUDDirective.prototype.addNewRow = function() {
            if (!this.table.isGridEditMode) {
                this.table.callDataGridMethod("addNewRow");
                if (this.table._liveTableParent) {
                    this.table._liveTableParent.addNewRow();
                }
            }
        };
        TableCUDDirective.prototype.deleteRow = function(evt) {
            var _this = this;
            var row;
            if (evt && evt.target) {
                this.table.callDataGridMethod("deleteRowAndUpdateSelectAll", evt);
            } else {
                setTimeout(function() {
                    row = evt || _this.table.selectedItems[0];
                    _this.deleteRecord({
                        row: row
                    });
                });
            }
        };
        TableCUDDirective.prototype.hideEditRow = function() {
            var $row = this.table.datagridElement.find("tr.row-editing");
            if ($row.length) {
                this.table.callDataGridMethod("hideRowEditMode", $row);
            }
        };
        TableCUDDirective.prototype.saveRow = function() {
            this.table.callDataGridMethod("saveRow");
        };
        TableCUDDirective.prototype.cancelRow = function() {
            var $row = this.table.datagridElement.find("tr.row-editing");
            if ($row.length) {
                this.table.callDataGridMethod("cancelEdit", $row);
            }
        };
        TableCUDDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableCUD]"
            } ]
        } ];
        TableCUDDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core$1.Self
                }, {
                    type: core$1.Inject,
                    args: [ TableComponent ]
                } ]
            }, {
                type: core.AbstractDialogService
            }, {
                type: core.App
            } ];
        };
        return TableCUDDirective;
    }();
    var emptyMatchModes = [ "null", "empty", "nullorempty", "isnotnull", "isnotempty" ];
    var getSearchValue = function(value, type) {
        if (!core.isDefined(value) || value === "") {
            return undefined;
        }
        if (core.isNumberType(type)) {
            return _.toNumber(value);
        }
        if (type === core.DataType.DATETIME) {
            return moment(value).valueOf();
        }
        return _.toString(value).toLowerCase();
    };
    var getFilteredData = function(data, searchObj) {
        var searchVal = getSearchValue(searchObj.value, searchObj.type);
        var currentVal;
        if (!core.isDefined(searchVal) && !_.includes(emptyMatchModes, searchObj.matchMode)) {
            return data;
        }
        data = data.filter(function(obj) {
            var isExists;
            if (searchObj.field) {
                currentVal = getSearchValue(_.get(obj, searchObj.field), searchObj.type);
            } else {
                currentVal = _.values(obj).join(" ").toLowerCase();
            }
            switch (searchObj.matchMode) {
              case "start":
                isExists = _.startsWith(currentVal, searchVal);
                break;

              case "end":
                isExists = _.endsWith(currentVal, searchVal);
                break;

              case "exact":
                isExists = _.isEqual(currentVal, searchVal);
                break;

              case "notequals":
                isExists = !_.isEqual(currentVal, searchVal);
                break;

              case "null":
                isExists = _.isNull(currentVal);
                break;

              case "isnotnull":
                isExists = !_.isNull(currentVal);
                break;

              case "empty":
                isExists = _.isEmpty(currentVal);
                break;

              case "isnotempty":
                isExists = !_.isEmpty(currentVal);
                break;

              case "nullorempty":
                isExists = _.isNull(currentVal) || _.isEmpty(currentVal);
                break;

              case "lessthan":
                isExists = currentVal < searchVal;
                break;

              case "lessthanequal":
                isExists = currentVal <= searchVal;
                break;

              case "greaterthan":
                isExists = currentVal > searchVal;
                break;

              case "greaterthanequal":
                isExists = currentVal >= searchVal;
                break;

              default:
                isExists = core.isNumberType(searchObj.type) ? _.isEqual(currentVal, searchVal) : _.includes(currentVal, searchVal);
                break;
            }
            return isExists;
        });
        return data;
    };
    var setFilterFields = function(filterFields, searchObj) {
        var field = searchObj && searchObj.field;
        if (field) {
            filterFields[field] = {
                value: searchObj.value,
                logicalOp: "AND"
            };
            if (searchObj.matchMode) {
                filterFields[field].matchMode = searchObj.matchMode;
            }
        }
    };
    var transformFilterField = function(userFilters, filterField) {
        if (filterField.field) {
            userFilters[filterField.field] = {
                value: filterField.value,
                matchMode: filterField.matchMode,
                type: filterField.type
            };
        }
    };
    var TableFilterSortDirective = function() {
        function TableFilterSortDirective(table) {
            this.table = table;
            table._searchSortHandler = this.searchSortHandler.bind(this);
            table.getSearchResult = this.getSearchResult.bind(this);
            table.getSortResult = this.getSortResult.bind(this);
            table.checkFiltersApplied = this.checkFiltersApplied.bind(this);
            table.getFilterFields = this.getFilterFields.bind(this);
            table.onRowFilterChange = this.onRowFilterChange.bind(this);
            table.onFilterConditionSelect = this.onFilterConditionSelect.bind(this);
            table.showClearIcon = this.showClearIcon.bind(this);
            table.clearRowFilter = this.clearRowFilter.bind(this);
            table.matchModeTypesMap = base.getMatchModeTypesMap();
            table.matchModeMsgs = base.getMatchModeMsgs(table.appLocale);
            table.emptyMatchModes = emptyMatchModes;
            table.getNavigationTargetBySortInfo = this.getNavigationTargetBySortInfo.bind(this);
            table.refreshData = this.refreshData.bind(this);
            table.clearFilter = this.clearFilter.bind(this);
        }
        TableFilterSortDirective.prototype.getNavigationTargetBySortInfo = function() {
            return this.table.sortInfo && this.table.sortInfo.direction === "desc" && _.includes(this.table.primaryKey, this.table.sortInfo.field) ? "first" : "last";
        };
        TableFilterSortDirective.prototype.getFilterFields = function(searchObj) {
            var filterFields = {};
            if (_.isArray(searchObj)) {
                _.forEach(searchObj, function(obj) {
                    setFilterFields(filterFields, obj);
                });
            } else {
                setFilterFields(filterFields, searchObj);
            }
            return filterFields;
        };
        TableFilterSortDirective.prototype.resetSortStatus = function(variableSort) {
            var gridSortString;
            if (!_.isEmpty(this.table.sortInfo) && this.table.datasource) {
                gridSortString = this.table.sortInfo.field + " " + this.table.sortInfo.direction;
                variableSort = this.table.datasource.execute(core.DataSource.Operation.GET_OPTIONS).orderBy || variableSort;
                if (variableSort) {
                    variableSort = _.head(_.split(variableSort, ","));
                }
                if (gridSortString !== variableSort) {
                    this.table.callDataGridMethod("resetSortIcons");
                    this.table.sortInfo = {};
                    this.table.setDataGridOption("sortInfo", {});
                }
            }
        };
        TableFilterSortDirective.prototype.clearFilter = function(skipFilter) {
            var $gridElement;
            this.table.filterInfo = {};
            if (this.table.filtermode === "multicolumn") {
                this.table.fieldDefs.forEach(function(col) {
                    if (col.resetFilter) {
                        col.resetFilter();
                    }
                });
                if (!skipFilter) {
                    this.table.onRowFilterChange();
                }
            } else if (this.table.filtermode === "search") {
                $gridElement = this.table.datagridElement;
                $gridElement.find('[data-element="dgSearchText"]').val("");
                $gridElement.find('[data-element="dgFilterValue"]').val("");
                if (!skipFilter) {
                    $gridElement.find(".app-search-button").trigger("click");
                }
            }
        };
        TableFilterSortDirective.prototype.checkFiltersApplied = function(variableSort) {
            if (!this.table.datasource) {
                return;
            }
            if (this.table.datasource.execute(core.DataSource.Operation.SUPPORTS_SERVER_FILTER)) {
                if (_.isEmpty(this.table.datasource.execute(core.DataSource.Operation.GET_OPTIONS).filterFields) && _.isEmpty(this.table.filterInfo)) {
                    this.clearFilter(true);
                }
                this.resetSortStatus(variableSort);
                return;
            }
            if (this.table.datasource.execute(core.DataSource.Operation.IS_PAGEABLE)) {
                this.resetSortStatus(variableSort);
            }
        };
        TableFilterSortDirective.prototype.getSearchResult = function(data, searchObj) {
            if (!searchObj) {
                return data;
            }
            if (_.isArray(searchObj)) {
                searchObj.forEach(function(obj) {
                    data = getFilteredData(data, obj);
                });
            } else {
                data = getFilteredData(data, searchObj);
            }
            return data;
        };
        TableFilterSortDirective.prototype.getSortResult = function(data, sortObj) {
            if (sortObj && sortObj.direction) {
                data = _.orderBy(data, sortObj.field, sortObj.direction);
            }
            return data;
        };
        TableFilterSortDirective.prototype.handleClientSideSortSearch = function(searchSortObj, e, type) {
            this.table._isClientSearch = true;
            var data;
            data = this.table.isNavigationEnabled() ? core.getClonedObject(this.table.__fullData) : core.getClonedObject(this.table.dataset);
            if (type === "search") {
                this.table.filterInfo = searchSortObj;
            } else {
                this.table.sortInfo = searchSortObj;
            }
            if (_.isObject(data) && !_.isArray(data)) {
                data = [ data ];
            }
            data = this.getSearchResult(data, this.table.filterInfo);
            data = this.getSortResult(data, this.table.sortInfo);
            this.table.serverData = data;
            if (type === "sort") {
                this.table.invokeEventCallback("sort", {
                    $event: e,
                    $data: {
                        data: this.table.serverData,
                        sortDirection: this.table.sortInfo.direction,
                        colDef: this.table.columns[this.table.sortInfo.field]
                    }
                });
            }
            if (this.table.isNavigationEnabled()) {
                this.table.dataNavigator.dn.currentPage = 1;
                this.table.dataNavigator.setPagingValues(data);
            } else {
                this.table.setGridData(this.table.serverData);
            }
        };
        TableFilterSortDirective.prototype.handleSinglePageSearch = function(searchObj) {
            this.table._isPageSearch = true;
            var data = core.getClonedObject(this.table.gridData);
            var $rows = this.table.datagridElement.find("tbody tr.app-datagrid-row");
            this.table.filterInfo = searchObj;
            data = this.getSearchResult(data, searchObj);
            _.forEach(this.table.gridData, function(value, index) {
                var $row = $($rows[index]);
                if (_.find(data, function(obj) {
                    return _.isEqual(obj, value);
                })) {
                    $row.show();
                } else {
                    $row.hide();
                }
            });
            if (data && data.length) {
                this.table.callDataGridMethod("setStatus", "ready");
                if (this.table.gridfirstrowselect && !this.table.multiselect) {
                    this.table.callDataGridMethod("selectFirstRow", true, true);
                }
            } else {
                this.table.callDataGridMethod("setStatus", "nodata", this.table.nodatamessage);
                this.table.selecteditem = undefined;
            }
            this.table.callDataGridMethod("updateSelectAllCheckboxState");
        };
        TableFilterSortDirective.prototype.handleServerSideSearch = function(searchObj) {
            var _this = this;
            this.table.filterInfo = searchObj;
            if (!this.table.datasource) {
                return;
            }
            var sortInfo = this.table.sortInfo;
            var sortOptions = sortInfo && sortInfo.direction ? sortInfo.field + " " + sortInfo.direction : "";
            var filterFields = this.getFilterFields(searchObj);
            base.refreshDataSource(this.table.datasource, {
                page: 1,
                filterFields: filterFields,
                orderBy: sortOptions
            }).then(function() {
                core.$appDigest();
            }, function() {
                _this.table.toggleMessage(true, "error", _this.table.nodatamessage);
            });
        };
        TableFilterSortDirective.prototype.handleSeverSideSort = function(sortObj, e) {
            var _this = this;
            this.table.gridOptions.sortInfo.field = sortObj.field;
            this.table.gridOptions.sortInfo.direction = sortObj.direction;
            this.table.sortInfo = core.getClonedObject(sortObj);
            var sortOptions = sortObj && sortObj.direction ? sortObj.field + " " + sortObj.direction : "";
            var filterFields = this.getFilterFields(this.table.filterInfo);
            base.refreshDataSource(this.table.datasource, {
                page: 1,
                filterFields: filterFields,
                orderBy: sortOptions
            }).then(function(response) {
                core.$appDigest();
                var data = response && response.data ? response.data : response;
                _this.table.invokeEventCallback("sort", {
                    $event: e,
                    $data: {
                        data: data,
                        sortDirection: sortObj.direction,
                        colDef: _this.table.columns[sortObj.field]
                    }
                });
            });
        };
        TableFilterSortDirective.prototype.searchHandler = function(searchSortObj, e, type) {
            var filterFields = core.getClonedObject(searchSortObj);
            var dataSource = this.table.datasource;
            if (!dataSource) {
                return;
            }
            var output;
            var userFilters = {};
            if (_.isArray(filterFields)) {
                filterFields.forEach(function(filterField) {
                    transformFilterField(userFilters, filterField);
                });
            } else {
                transformFilterField(userFilters, filterFields);
            }
            output = this.table.invokeEventCallback("beforefilter", {
                $event: e,
                $data: userFilters,
                columns: userFilters
            });
            if (output === false) {
                return;
            }
            filterFields = [];
            _.forEach(userFilters, function(val, key) {
                filterFields.push({
                    field: key,
                    matchMode: val.matchMode,
                    type: val.type,
                    value: val.value
                });
            });
            if (dataSource.execute(core.DataSource.Operation.SUPPORTS_SERVER_FILTER)) {
                this.handleServerSideSearch(filterFields);
                return;
            }
            if (dataSource.execute(core.DataSource.Operation.IS_API_AWARE) && dataSource.execute(core.DataSource.Operation.IS_PAGEABLE)) {
                this.handleSinglePageSearch(filterFields);
            } else {
                this.handleClientSideSortSearch(filterFields, e, type);
            }
        };
        TableFilterSortDirective.prototype.sortHandler = function(searchSortObj, e, type) {
            var dataSource = this.table.datasource;
            if (!dataSource) {
                return;
            }
            if (dataSource.execute(core.DataSource.Operation.IS_PAGEABLE)) {
                this.handleSeverSideSort(searchSortObj, e);
            } else {
                this.handleClientSideSortSearch(searchSortObj, e, type);
            }
        };
        TableFilterSortDirective.prototype.searchSortHandler = function(searchSortObj, e, type) {
            if (type === "search") {
                this.searchHandler(searchSortObj, e, type);
            } else {
                this.sortHandler(searchSortObj, e, type);
            }
        };
        TableFilterSortDirective.prototype.showClearIcon = function(fieldName) {
            var value = this.table.rowFilter[fieldName] && this.table.rowFilter[fieldName].value;
            return core.isDefined(value) && value !== "" && value !== null;
        };
        TableFilterSortDirective.prototype.clearRowFilter = function(fieldName) {
            if (this.table.rowFilter && this.table.rowFilter[fieldName]) {
                this.table.columns[fieldName].resetFilter();
                this.onRowFilterChange(fieldName);
            }
        };
        TableFilterSortDirective.prototype.onFilterConditionSelect = function(fieldName, condition) {
            var _this = this;
            this.table.rowFilter[fieldName] = this.table.rowFilter[fieldName] || {};
            this.table.rowFilter[fieldName].matchMode = condition;
            if (_.includes(this.table.emptyMatchModes, condition)) {
                this.table.columns[fieldName].resetFilter();
                this.table.onRowFilterChange();
            } else {
                if (core.isDefined(this.table.rowFilter[fieldName].value) && this.table.rowFilter[fieldName].value !== "") {
                    this.table.onRowFilterChange();
                } else {
                    setTimeout(function() {
                        _this.table.columns[fieldName].filterInstance.focus();
                    });
                }
            }
        };
        TableFilterSortDirective.prototype.getFilterOnFieldValues = function(filterDef) {
            var _this = this;
            if (!this.table.datasource || !this.table.datasource.execute(core.DataSource.Operation.SUPPORTS_DISTINCT_API)) {
                return;
            }
            var fieldName = filterDef.field;
            var formFields = this.table.fullFieldDefs;
            var filterOnFields = _.filter(formFields, {
                filteronfilter: fieldName
            });
            var newVal = _.get(this.table.rowFilter, [ fieldName, "value" ]);
            _.forEach(filterOnFields, function(filterField) {
                var filterOn = filterField.filteronfilter;
                var filterKey = filterField.field;
                var filterFields = {};
                var filterWidget = filterField.filterwidget;
                if (!base.isDataSetWidget(filterWidget) || filterOn === filterKey || filterField.isFilterDataSetBound) {
                    return;
                }
                filterFields[filterOn] = core.isDefined(newVal) && newVal !== "" && newVal !== null ? {
                    value: newVal
                } : {};
                if (filterWidget === core.FormWidgetType.AUTOCOMPLETE && filterField.filterInstance.dataoptions) {
                    filterField.filterInstance.dataoptions.filterFields = filterFields;
                } else {
                    _this.table.datasource.execute(core.DataSource.Operation.GET_DISTINCT_DATA_BY_FIELDS, {
                        fields: filterKey,
                        filterFields: filterFields
                    }).then(function(data) {
                        filterField.filterdataset = data.data;
                    });
                }
            });
        };
        TableFilterSortDirective.prototype.onRowFilterChange = function(fieldName) {
            var _this = this;
            var searchObj = [];
            var field = _.find(this.table.fullFieldDefs, {
                field: fieldName
            });
            _.forEach(this.table.rowFilter, function(value, key) {
                if (core.isDefined(value.value) && value.value !== "" || _.includes(_this.table.emptyMatchModes, value.matchMode)) {
                    if (field && key === field.field) {
                        value.type = value.type || field.type;
                        value.matchMode = value.matchMode || _.get(_this.table.matchModeTypesMap[value.type], 0);
                    }
                    searchObj.push({
                        field: key,
                        value: value.value,
                        matchMode: value.matchMode,
                        type: value.type
                    });
                }
            });
            this.table.gridOptions.searchHandler(searchObj, undefined, "search");
            if (field) {
                this.getFilterOnFieldValues(field);
            }
        };
        TableFilterSortDirective.prototype.refreshData = function(isSamePage) {
            if (!this.table.datasource) {
                return;
            }
            var page = isSamePage ? this.table.dataNavigator.dn.currentPage : 1;
            var sortInfo = this.table.sortInfo;
            var sortOptions = sortInfo && sortInfo.direction ? sortInfo.field + " " + sortInfo.direction : "";
            var filterFields = this.getFilterFields(this.table.filterInfo);
            base.refreshDataSource(this.table.datasource, {
                page: page,
                filterFields: filterFields,
                orderBy: sortOptions
            });
        };
        TableFilterSortDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableFilterSort]"
            } ]
        } ];
        TableFilterSortDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core$1.Self
                }, {
                    type: core$1.Inject,
                    args: [ TableComponent ]
                } ]
            } ];
        };
        return TableFilterSortDirective;
    }();
    var registerProps$1 = function() {
        base.register("wm-table-action", new Map([ [ "accessroles", base.PROP_STRING ], [ "action", base.PROP_STRING ], [ "caption", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "disabled", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "display-name", base.PROP_STRING ], [ "hyperlink", base.PROP_STRING ], [ "icon", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "key", base.PROP_STRING ], [ "position", __assign({
            value: "footer"
        }, base.PROP_STRING) ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", base.PROP_STRING ], [ "target", base.PROP_STRING ], [ "widget-type", __assign({
            value: "button"
        }, base.PROP_STRING) ] ]));
    };
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-table-action",
        hostClass: ""
    };
    var TableActionDirective = function(_super) {
        __extends(TableActionDirective, _super);
        function TableActionDirective(inj, table) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            _this.table = table;
            return _this;
        }
        TableActionDirective.prototype.populateAction = function() {
            this.buttonDef = {
                key: this.key,
                displayName: this["display-name"] || this.caption || "",
                show: this.show,
                class: this.class || "",
                iconclass: this.iconclass || "",
                title: _.isUndefined(this.title) ? this["display-name"] || "" : this.title,
                action: this.action,
                accessroles: this.accessroles,
                shortcutkey: this.shortcutkey,
                disabled: this.disabled,
                tabindex: this.tabindex,
                icon: this.icon,
                position: this.position,
                widgetType: this["widget-type"],
                hyperlink: this.hyperlink,
                target: this.target || "",
                conditionalclass: this.conditionalclass || "",
                conditionalstyle: this.conditionalstyle || {}
            };
            this._propsInitialized = true;
        };
        TableActionDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.populateAction();
            this.table.registerActions(this.buttonDef);
        };
        TableActionDirective.prototype.onPropertyChange = function(key, nv) {
            if (!this._propsInitialized) {
                return;
            }
            if (key === "display-name") {
                this.buttonDef.displayName = nv;
            } else {
                this.buttonDef[key] = nv;
            }
        };
        TableActionDirective.initializeProps = registerProps$1();
        TableActionDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableAction]",
                providers: [ base.provideAsWidgetRef(TableActionDirective) ]
            } ]
        } ];
        TableActionDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: TableComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            } ];
        };
        return TableActionDirective;
    }(base.BaseComponent);
    var registerProps$2 = function() {
        base.register("wm-table-column", new Map([ [ "accessroles", base.PROP_STRING ], [ "backgroundcolor", base.PROP_STRING ], [ "binding", base.PROP_STRING ], [ "caption", base.PROP_STRING ], [ "checkedvalue", base.PROP_STRING ], [ "col-class", base.PROP_STRING ], [ "col-ng-class", base.PROP_STRING ], [ "currencypattern", base.PROP_STRING ], [ "customExpression", base.PROP_BOOLEAN ], [ "dataentrymode", __assign({
            value: "default"
        }, base.PROP_STRING) ], [ "datafield", base.PROP_STRING ], [ "dataoptions", base.PROP_ANY ], [ "dataset", base.PROP_ANY ], [ "datasource", base.PROP_STRING ], [ "datepattern", base.PROP_STRING ], [ "debouncetime", __assign({
            value: 250
        }, base.PROP_NUMBER) ], [ "defaultvalue", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "displayfield", base.PROP_STRING ], [ "displaylabel", base.PROP_STRING ], [ "editdatepattern", base.PROP_STRING ], [ "edit-widget-type", base.PROP_STRING ], [ "editinputtype", base.PROP_STRING ], [ "exportexpression", base.PROP_STRING ], [ "filterdataset", base.PROP_STRING ], [ "filterdatafield", base.PROP_STRING ], [ "filterdisplayfield", base.PROP_STRING ], [ "filterdisplaylabel", base.PROP_STRING ], [ "filterexpressions", __assign({
            value: "{}"
        }, base.PROP_STRING) ], [ "filtersearchkey", base.PROP_STRING ], [ "filter-on", base.PROP_STRING ], [ "filteronfilter", base.PROP_STRING ], [ "filterplaceholder", base.PROP_STRING ], [ "filterwidget", base.PROP_STRING ], [ "filterinputtype", base.PROP_STRING ], [ "formatpattern", base.PROP_STRING ], [ "fractionsize", base.PROP_STRING ], [ "generator", base.PROP_STRING ], [ "limit", base.PROP_NUMBER ], [ "matchmode", base.PROP_STRING ], [ "maxchars", base.PROP_NUMBER ], [ "maxvalue", base.PROP_NUMBER ], [ "mobiledisplay", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "minvalue", base.PROP_NUMBER ], [ "pcdisplay", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "period", base.PROP_BOOLEAN ], [ "placeholder", base.PROP_STRING ], [ "prefix", base.PROP_STRING ], [ "primary-key", base.PROP_BOOLEAN ], [ "readonly", base.PROP_BOOLEAN ], [ "regexp", base.PROP_ANY ], [ "related-entity-name", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "rowactionsposition", base.PROP_STRING ], [ "searchkey", base.PROP_STRING ], [ "searchable", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "suffix", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showdropdownon", __assign({
            value: "default"
        }, base.PROP_STRING) ], [ "sortable", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "textalignment", __assign({
            value: "left"
        }, base.PROP_STRING) ], [ "textcolor", base.PROP_STRING ], [ "type", __assign({
            value: "string"
        }, base.PROP_STRING) ], [ "uncheckedvalue", base.PROP_STRING ], [ "validationmessage", base.PROP_STRING ], [ "widget-type", base.PROP_STRING ], [ "width", base.PROP_STRING ] ]));
    };
    var registerProps$3 = function() {
        base.register("wm-table-column-group", new Map([ [ "backgroundcolor", base.PROP_STRING ], [ "caption", base.PROP_STRING ], [ "col-class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "textalignment", __assign({
            value: "center"
        }, base.PROP_STRING) ] ]));
    };
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-table-column-group",
        hostClass: ""
    };
    var TableColumnGroupDirective = function(_super) {
        __extends(TableColumnGroupDirective, _super);
        function TableColumnGroupDirective(inj, group, table) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            _this.group = group;
            _this.table = table;
            _this.config = {};
            return _this;
        }
        TableColumnGroupDirective.prototype.populateConfig = function() {
            this.config = {
                field: this.name,
                displayName: this.caption || "",
                columns: [],
                isGroup: true,
                accessroles: this.accessroles,
                textAlignment: this.textalignment || "center",
                backgroundColor: this.backgroundcolor,
                class: this["col-class"]
            };
        };
        TableColumnGroupDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "caption") {
                this.config.displayName = nv || "";
                this.table.callDataGridMethod("setColumnProp", this.config.field, "displayName", nv, true);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        TableColumnGroupDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.populateConfig();
            base.setHeaderConfigForTable(this.table.headerConfig, this.config, this.group && this.group.name);
        };
        TableColumnGroupDirective.initializeProps = registerProps$3();
        TableColumnGroupDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableColumnGroup]",
                providers: [ base.provideAsWidgetRef(TableColumnGroupDirective) ]
            } ]
        } ];
        TableColumnGroupDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: TableColumnGroupDirective,
                decorators: [ {
                    type: core$1.SkipSelf
                }, {
                    type: core$1.Optional
                } ]
            }, {
                type: TableComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            } ];
        };
        return TableColumnGroupDirective;
    }(base.BaseComponent);
    var WIDGET_CONFIG$3 = {
        widgetType: "wm-table-column",
        hostClass: ""
    };
    var inlineWidgetProps = [ "datafield", "displayfield", "placeholder", "searchkey", "matchmode", "displaylabel", "checkedvalue", "uncheckedvalue", "showdropdownon", "dataentrymode", "dataset" ];
    var validationProps = [ "maxchars", "regexp", "minvalue", "maxvalue", "required" ];
    inlineWidgetProps = __spread(inlineWidgetProps, validationProps);
    var FieldDef = function() {
        function FieldDef(widget) {
            this.widget = widget;
        }
        FieldDef.prototype.focus = function() {
            this.widget.focus();
        };
        FieldDef.prototype.setProperty = function(prop, newval) {
            prop = prop === "value" ? "datavalue" : prop;
            this.widget[prop] = newval;
        };
        FieldDef.prototype.getProperty = function(prop) {
            prop = prop === "value" ? "datavalue" : prop;
            return this.widget[prop];
        };
        return FieldDef;
    }();
    var TableColumnDirective = function(_super) {
        __extends(TableColumnDirective, _super);
        function TableColumnDirective(inj, appDefaults, table, group, bindfilterdataset, binddataset) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$3) || this;
            _this.appDefaults = appDefaults;
            _this.table = table;
            _this.group = group;
            _this.bindfilterdataset = bindfilterdataset;
            _this.binddataset = binddataset;
            _this._debounceSetUpValidators = core.debounce(_this.setUpValidators.bind(_this, "inlineInstance"), 250);
            _this._debounceSetUpValidatorsNew = core.debounce(_this.setUpValidators.bind(_this, "inlineInstanceNew"), 250);
            return _this;
        }
        Object.defineProperty(TableColumnDirective.prototype, "dataoptions", {
            get: function() {
                return this._dataoptions;
            },
            set: function(options) {
                this._dataoptions = options;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TableColumnDirective.prototype, "datasource", {
            get: function() {
                return this._datasource;
            },
            set: function(ds) {
                this._datasource = ds;
            },
            enumerable: true,
            configurable: true
        });
        TableColumnDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.populateFieldDef();
            base.setHeaderConfigForTable(this.table.headerConfig, {
                field: this.field,
                displayName: this.displayName
            }, this.group && this.group.name);
            this.table.registerColumns(this.widget);
            this._isRowFilter = this.table.filtermode === "multicolumn" && this.searchable;
            this._isInlineEditable = !this.readonly && (this.table.editmode !== base.EDIT_MODE.DIALOG && this.table.editmode !== base.EDIT_MODE.FORM);
            this._isNewEditableRow = this._isInlineEditable && this.table.editmode === base.EDIT_MODE.QUICK_EDIT && this.table.shownewrow;
            this.setUpControls();
            this._propsInitialized = true;
        };
        TableColumnDirective.prototype.ngAfterContentInit = function() {
            var _this = this;
            if (this._isRowFilter) {
                var s1_1 = this._filterInstances.changes.subscribe(function(val) {
                    _this.filterInstance = val.first && val.first.widget;
                    _this.setUpFilterWidget();
                });
                this.registerDestroyListener(function() {
                    return s1_1.unsubscribe();
                });
            }
            if (this._isInlineEditable) {
                var s2_1 = this._inlineInstances.changes.subscribe(function(val) {
                    _this.inlineInstance = val.first && val.first.widget;
                    _this.table.registerFormField(_this.binding, new FieldDef(_this.inlineInstance));
                    _this.setUpInlineWidget("inlineInstance");
                });
                this.registerDestroyListener(function() {
                    return s2_1.unsubscribe();
                });
                if (this._isNewEditableRow) {
                    var s3_1 = this._inlineInstancesNew.changes.subscribe(function(val) {
                        _this.inlineInstanceNew = val.first && val.first.widget;
                        _this.setUpInlineWidget("inlineInstanceNew");
                    });
                    this.registerDestroyListener(function() {
                        return s3_1.unsubscribe();
                    });
                }
            }
            _super.prototype.ngAfterContentInit.call(this);
        };
        TableColumnDirective.prototype.ngAfterViewInit = function() {
            if (this.filterTemplateRef) {
                this.table.renderDynamicFilterColumn(this.filterTemplateRef);
            }
        };
        TableColumnDirective.prototype.addFormControl = function(suffix) {
            var ctrlName = suffix ? this.binding + suffix : this.binding;
            this.table.ngform.addControl(ctrlName, this.table.fb.control(""));
        };
        TableColumnDirective.prototype.getFormControl = function(suffix) {
            var ctrlName = suffix ? this.binding + suffix : this.binding;
            return this.table.ngform.controls[ctrlName];
        };
        TableColumnDirective.prototype.setUpControls = function() {
            if (this._isInlineEditable) {
                if (this.editWidgetType === core.FormWidgetType.UPLOAD) {
                    return;
                }
                this.addFormControl();
                var control = this.getFormControl();
                if (control) {
                    var onValueChangeSubscription_1 = control.valueChanges.subscribe(this.onValueChange.bind(this));
                    this.registerDestroyListener(function() {
                        return onValueChangeSubscription_1.unsubscribe();
                    });
                }
                if (this._isNewEditableRow) {
                    this.addFormControl("_new");
                    var newControl = this.getFormControl("_new");
                    if (newControl) {
                        var onNewValueChangeSubscription_1 = newControl.valueChanges.subscribe(this.onValueChange.bind(this));
                        this.registerDestroyListener(function() {
                            return onNewValueChangeSubscription_1.unsubscribe();
                        });
                    }
                }
            }
            if (this._isRowFilter) {
                this.addFormControl("_filter");
                this.filterControl = this.getFormControl("_filter");
                if (this.filterControl) {
                    var onFilterValueSubscription_1 = this.filterControl.valueChanges.subscribe(this.onFilterValueChange.bind(this));
                    this.registerDestroyListener(function() {
                        return onFilterValueSubscription_1.unsubscribe();
                    });
                }
            }
        };
        TableColumnDirective.prototype.resetFilter = function() {
            if (this.filterControl) {
                this.filterControl.setValue("");
            }
            if (this.filterwidget === core.FormWidgetType.AUTOCOMPLETE) {
                this.filterInstance.query = "";
                this.filterInstance.queryModel = "";
            }
        };
        TableColumnDirective.prototype.onFilterValueChange = function(val) {
            this.table.rowFilter[this.field].value = val;
        };
        TableColumnDirective.prototype.onValueChange = function(val) {
            if (val !== null) {
                base.applyFilterOnField(this.table.datasource, this.widget, this.table.fieldDefs, val, {
                    widget: "edit-widget-type"
                });
            }
        };
        TableColumnDirective.prototype.loadFilterData = function() {
            var _this = this;
            if (this._isRowFilter && base.isDataSetWidget(this.filterwidget) && !this.bindfilterdataset) {
                if (this.table.datasource.execute(core.DataSource.Operation.SUPPORTS_DISTINCT_API)) {
                    if (this.relatedEntityName) {
                        this.widget["is-related"] = true;
                        this.widget["lookup-type"] = this.relatedEntityName;
                        this.widget["lookup-field"] = _.last(_.split(this.field, "."));
                    }
                    if (this.filterwidget === core.FormWidgetType.AUTOCOMPLETE) {
                        this.filterInstance.dataoptions = base.getDistinctFieldProperties(this.table.datasource, this);
                        this.filterInstance.datasource = this.table.datasource;
                    } else {
                        base.getDistinctValues(this.table.datasource, this.widget, "filterwidget").then(function(res) {
                            _this._filterDataSet = res.data;
                            _this.setFilterWidgetDataSet();
                        });
                    }
                } else {
                    this.registerDestroyListener(core.$watch(this.table.binddataset, this.viewParent, {}, function(nv) {
                        return _this.widget.filterdataset = nv;
                    }, base.getWatchIdentifier(this.widgetId, "filterdataset")));
                }
            }
        };
        TableColumnDirective.prototype.loadInlineWidgetData = function() {
            if (base.isDataSetWidget(this["edit-widget-type"]) && !this.binddataset && !this.readonly) {
                var dataSource = this.table.datasource;
                if (this["related-entity-name"] && this["primary-key"]) {
                    this.isDataSetBound = true;
                    var bindings = _.split(this.binding, ".");
                    base.fetchRelatedFieldData(dataSource, this.widget, {
                        relatedField: _.head(bindings),
                        datafield: _.last(bindings),
                        widget: "edit-widget-type"
                    });
                } else if (dataSource.execute(core.DataSource.Operation.SUPPORTS_DISTINCT_API)) {
                    base.getDistinctValuesForField(dataSource, this.widget, {
                        widget: "edit-widget-type"
                    });
                }
            }
        };
        TableColumnDirective.prototype.onDataSourceChange = function() {
            this.loadFilterData();
            this.loadInlineWidgetData();
        };
        TableColumnDirective.prototype.setFilterWidgetDataSet = function() {
            if (this.filterInstance) {
                this.filterInstance.dataset = this._filterDataSet;
            }
        };
        TableColumnDirective.prototype.setUpFilterWidget = function() {
            var _this = this;
            this.filterInstance.registerReadyStateListener(function() {
                if (base.isDataSetWidget(_this.filterwidget)) {
                    var field = _.last(_this.binding.split("."));
                    _this.filterInstance.dataset = _this._filterDataSet;
                    _this.filterInstance.datafield = _this.filterdatafield || field;
                    _this.filterInstance.displayfield = _this.filterdisplayfield || field;
                    if (_this.filterwidget === core.FormWidgetType.AUTOCOMPLETE) {
                        _this.filterInstance.displaylabel = _this.filterdisplaylabel || field;
                        _this.filterInstance.searchkey = _this.filtersearchkey || field;
                    }
                }
                if (_this.filterwidget === core.FormWidgetType.TIME) {
                    _this.filterInstance.timepattern = _this.appDefaults.timeFormat || "hh:mm:ss a";
                }
                _this.filterInstance.placeholder = _this.filterplaceholder || "";
            });
        };
        TableColumnDirective.prototype.setUpValidators = function(widget) {
            var control = this.getFormControl(widget === "inlineInstanceNew" ? "_new" : undefined);
            if (!control) {
                return;
            }
            var validators = [];
            if (this.required) {
                if (this.editWidgetType === core.FormWidgetType.CHECKBOX || this.editWidgetType === core.FormWidgetType.TOGGLE) {
                    validators.push(forms.Validators.requiredTrue);
                } else {
                    validators.push(forms.Validators.required);
                }
            }
            if (this.maxchars) {
                validators.push(forms.Validators.maxLength(this.maxchars));
            }
            if (this.minvalue) {
                validators.push(forms.Validators.min(this.minvalue));
            }
            if (this.maxvalue) {
                validators.push(forms.Validators.max(this.maxvalue));
            }
            if (this.regexp) {
                validators.push(forms.Validators.pattern(this.regexp));
            }
            if (this[widget] && _.isFunction(this[widget].validate)) {
                validators.push(this[widget].validate.bind(this[widget]));
            }
            control.setValidators(validators);
            control.updateValueAndValidity();
        };
        TableColumnDirective.prototype.setInlineWidgetProp = function(widget, prop, nv) {
            if (prop === "datepattern" && this.editWidgetType === core.FormWidgetType.TIME) {
                prop = "timepattern";
            }
            if (this[widget] && core.isDefined(nv)) {
                this[widget][prop] = nv;
            }
            if (validationProps.includes(prop)) {
                this._debounceSetUpValidators();
                this._debounceSetUpValidatorsNew();
            }
        };
        TableColumnDirective.prototype.setUpInlineWidget = function(widget) {
            var _this = this;
            this[widget].registerReadyStateListener(function() {
                if (base.isDataSetWidget(_this["edit-widget-type"])) {
                    _this[widget].dataset = _this.dataset;
                }
                inlineWidgetProps.forEach(function(key) {
                    _this.setInlineWidgetProp(widget, key, _this[key]);
                });
                _this[widget].datasource = _this._datasource;
                _this[widget].dataoptions = _this._dataoptions;
                _this.setInlineWidgetProp(widget, "datepattern", _this.editdatepattern);
            });
        };
        TableColumnDirective.prototype.getStyleDef = function() {
            return "width: " + (this.width || "") + "; background-color: " + (this.backgroundcolor || "") + "; color: " + (this.textcolor || "") + ";";
        };
        TableColumnDirective.prototype.populateFieldDef = function() {
            this.width = this.width === "px" ? "" : this.width || "";
            this.field = this.binding;
            this.displayName = this.caption || "";
            this.pcDisplay = this.pcdisplay;
            this.mobileDisplay = this.mobiledisplay;
            this.textAlignment = this.textalignment;
            this.backgroundColor = this.backgroundcolor;
            this.textColor = this.textcolor;
            this.primaryKey = this["primary-key"];
            this.relatedEntityName = this["related-entity-name"];
            this.style = this.getStyleDef();
            this.class = this["col-class"];
            this.ngclass = this["col-ng-class"];
            this.formatpattern = this.formatpattern === "toNumber" ? "numberToString" : this.formatpattern;
            this.searchable = this.type === "blob" || this.type === "clob" ? false : this.searchable;
            this.limit = this.limit ? +this.limit : undefined;
            this.editWidgetType = this["edit-widget-type"] = this["edit-widget-type"] || base.getEditModeWidget(this);
            this.filterOn = this["filter-on"];
            this.readonly = core.isDefined(this.getAttr("readonly")) ? this.getAttr("readonly") === "true" : this["related-entity-name"] ? !this["primary-key"] : _.includes([ "identity", "uniqueid", "sequence" ], this.generator);
            this.filterwidget = this.filterwidget || base.getDataTableFilterWidget(this.type || "string");
            this.isFilterDataSetBound = !!this.bindfilterdataset;
            this.defaultvalue = base.getDefaultValue(this.defaultvalue, this.type, this.editWidgetType);
            if (core.isDateTimeType(this.type) && this.formatpattern === "toDate" && !this.datepattern) {
                var defaultFormat = core.getDisplayDateTimeFormat(this.type);
                if (this.type === core.DataType.DATE) {
                    this.datepattern = this.appDefaults.dateFormat || defaultFormat;
                } else if (this.type === core.DataType.TIME) {
                    this.datepattern = this.appDefaults.timeFormat || defaultFormat;
                } else if (this.type === core.DataType.TIMESTAMP || this.type === core.DataType.DATETIME) {
                    this.datepattern = this.appDefaults.dateTimeFormat || defaultFormat;
                }
            }
        };
        TableColumnDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (!this._propsInitialized) {
                return;
            }
            switch (key) {
              case "caption":
                this.displayName = nv || "";
                this.setProperty("displayName", this.displayName);
                break;

              case "defaultvalue":
                this.defaultvalue = base.getDefaultValue(this.defaultvalue, this.type, this.editWidgetType);
                break;

              case "show":
                this.table.redraw(true);
                break;

              case "filterdataset":
                this._filterDataSet = nv;
                this.setFilterWidgetDataSet();
                break;

              case "editdatepattern":
                this.setInlineWidgetProp("inlineInstance", "datepattern", nv);
                this.setInlineWidgetProp("inlineInstanceNew", "datepattern", nv);
                break;

              default:
                if (inlineWidgetProps.includes(key)) {
                    this.setInlineWidgetProp("inlineInstance", key, nv);
                    this.setInlineWidgetProp("inlineInstanceNew", key, nv);
                }
                break;
            }
            _super.prototype.onPropertyChange.call(this, key, nv, ov);
        };
        TableColumnDirective.prototype.setProperty = function(property, nv) {
            this[property] = nv;
            switch (property) {
              case "displayName":
                this.table.callDataGridMethod("setColumnProp", this.field, property, nv);
                break;

              default:
                this.table.redraw(true);
            }
        };
        TableColumnDirective.initializeProps = registerProps$2();
        TableColumnDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableColumn]",
                providers: [ base.provideAsWidgetRef(TableColumnDirective) ]
            } ]
        } ];
        TableColumnDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: core.AppDefaults
            }, {
                type: TableComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            }, {
                type: TableColumnGroupDirective,
                decorators: [ {
                    type: core$1.Optional
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "filterdataset.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core$1.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            } ];
        };
        TableColumnDirective.propDecorators = {
            _filterInstances: [ {
                type: core$1.ContentChildren,
                args: [ "filterWidget" ]
            } ],
            _inlineInstances: [ {
                type: core$1.ContentChildren,
                args: [ "inlineWidget" ]
            } ],
            _inlineInstancesNew: [ {
                type: core$1.ContentChildren,
                args: [ "inlineWidgetNew" ]
            } ],
            customExprTmpl: [ {
                type: core$1.ContentChild,
                args: [ "customExprTmpl" ]
            } ],
            filterTemplateRef: [ {
                type: core$1.ContentChild,
                args: [ "filterTmpl" ]
            } ]
        };
        return TableColumnDirective;
    }(base.BaseComponent);
    var registerProps$4 = function() {
        base.register("wm-table-row", new Map([ [ "class", base.PROP_STRING ], [ "closeothers", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "content", base.PROP_STRING ], [ "columnwidth", __assign({
            value: "30px"
        }, base.PROP_STRING) ], [ "collapseicon", base.PROP_STRING ], [ "expandicon", base.PROP_STRING ], [ "height", base.PROP_STRING ], [ "position", __assign({
            value: "0"
        }, base.PROP_STRING) ] ]));
    };
    var WIDGET_CONFIG$4 = {
        widgetType: "wm-table-row",
        hostClass: ""
    };
    var TableRowDirective = function(_super) {
        __extends(TableRowDirective, _super);
        function TableRowDirective(inj, table) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$4) || this;
            _this.table = table;
            return _this;
        }
        TableRowDirective.prototype.populateConfig = function() {
            this.config = {
                closeothers: this.closeothers,
                content: this.content,
                columnwidth: this.columnwidth,
                expandicon: this.expandicon,
                collapseicon: this.collapseicon,
                height: this.height,
                position: this.position
            };
        };
        TableRowDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.populateConfig();
            this.table.registerRow(this.config, this);
        };
        TableRowDirective.prototype.onPropertyChange = function(key, nv) {
            if (key === "content" && this.config) {
                this.config.content = this.content;
            }
        };
        TableRowDirective.initializeProps = registerProps$4();
        TableRowDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableRow]",
                providers: [ base.provideAsWidgetRef(TableRowDirective) ]
            } ]
        } ];
        TableRowDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: TableComponent,
                decorators: [ {
                    type: core$1.Optional
                }, {
                    type: core$1.SkipSelf
                } ]
            } ];
        };
        return TableRowDirective;
    }(base.BaseComponent);
    var registerProps$5 = function() {
        base.register("wm-table-row-action", new Map([ [ "accessroles", base.PROP_STRING ], [ "action", base.PROP_STRING ], [ "caption", base.PROP_STRING ], [ "class ", __assign({
            value: "btn-secondary"
        }, base.PROP_STRING) ], [ "disabled", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "display-name", base.PROP_STRING ], [ "hyperlink", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "key", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "target", base.PROP_STRING ], [ "title", base.PROP_STRING ], [ "widget-type", __assign({
            value: "button"
        }, base.PROP_STRING) ] ]));
    };
    var WIDGET_CONFIG$5 = {
        widgetType: "wm-table-row-action",
        hostClass: ""
    };
    var \u02750$2 = {};
    var TableRowActionDirective = function(_super) {
        __extends(TableRowActionDirective, _super);
        function TableRowActionDirective(inj, table, contexts) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$5) || this;
            _this.table = table;
            contexts[0].editRow = function(evt) {
                return _this.table.editRow(evt);
            };
            contexts[0].deleteRow = function(evt) {
                return _this.table.deleteRow(evt);
            };
            contexts[0].addNewRow = function(evt) {
                return _this.table.addNewRow(evt);
            };
            return _this;
        }
        TableRowActionDirective.prototype.getTitle = function() {
            return _.isUndefined(this.title) ? this["display-name"] || "" : this.title;
        };
        TableRowActionDirective.prototype.populateAction = function() {
            this.buttonDef = {
                key: this.key,
                displayName: this["display-name"] || this.caption || "",
                show: this.show,
                class: this.class || "",
                iconclass: this.iconclass || "",
                title: this.getTitle(),
                action: this.action,
                accessroles: this.accessroles,
                disabled: this.disabled,
                tabindex: this.tabindex ? +this.tabindex : undefined,
                widgetType: this["widget-type"] || "button",
                hyperlink: this.hyperlink,
                target: this.target || "",
                conditionalclass: this.conditionalclass || "",
                conditionalstyle: this.conditionalstyle || {}
            };
        };
        TableRowActionDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.populateAction();
            this.table.registerRowActions(this.buttonDef);
        };
        TableRowActionDirective.initializeProps = registerProps$5();
        TableRowActionDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "[wmTableRowAction]",
                providers: [ base.provideAsWidgetRef(TableRowActionDirective), {
                    provide: base.Context,
                    useValue: \u02750$2,
                    multi: true
                } ]
            } ]
        } ];
        TableRowActionDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: TableComponent,
                decorators: [ {
                    type: core$1.Optional
                } ]
            }, {
                type: Array,
                decorators: [ {
                    type: core$1.Self
                }, {
                    type: core$1.Inject,
                    args: [ base.Context ]
                } ]
            } ];
        };
        return TableRowActionDirective;
    }(base.BaseComponent);
    var components = [ TableComponent, TableCUDDirective, TableFilterSortDirective, TableActionDirective, TableColumnDirective, TableColumnGroupDirective, TableRowDirective, TableRowActionDirective ];
    var TableModule = function() {
        function TableModule() {}
        TableModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ basic.BasicModule, dropdown.BsDropdownModule, common.CommonModule, forms.FormsModule, forms.ReactiveFormsModule, input.InputModule, list.ListModule, menu.MenuModule, pagination.PaginationModule, tooltip.TooltipModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return TableModule;
    }();
    exports.\u0275d = TableActionDirective;
    exports.\u0275e = registerProps$1;
    exports.\u0275g = TableColumnGroupDirective;
    exports.\u0275h = registerProps$3;
    exports.\u0275f = TableColumnDirective;
    exports.\u0275i = registerProps$2;
    exports.\u0275b = TableCUDDirective;
    exports.\u0275c = TableFilterSortDirective;
    exports.\u0275l = TableRowActionDirective;
    exports.\u0275m = registerProps$5;
    exports.\u0275j = TableRowDirective;
    exports.\u0275k = registerProps$4;
    exports.\u0275a = registerProps;
    exports.TableModule = TableModule;
    exports.TableComponent = TableComponent;
    exports.\u02750 = \u02750;
    exports.\u02751 = \u02751;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("rxjs/operators"), require("@wm/core"), require("@wm/components/data/table"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/data/live-table", [ "exports", "@angular/common", "@angular/core", "rxjs/operators", "@wm/core", "@wm/components/data/table", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.data = global.wm.components.data || {}, 
    global.wm.components.data.livetable = {}), global.ng.common, global.ng.core, global.rxjs.operators, global.wm.core, global.wm.components.data.table, global.wm.components.base);
})(this, function(exports, common, core, operators, core$1, table, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-livetable", new Map([ [ "class", base.PROP_STRING ], [ "formlayout", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS = "app-livegrid";
    var WIDGET_CONFIG = {
        widgetType: "wm-livetable",
        hostClass: DEFAULT_CLS
    };
    var LiveTableComponent = function(_super) {
        __extends(LiveTableComponent, _super);
        function LiveTableComponent(inj, elRef, cdr, dialogService, app, layoutType, dialogId) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.dialogService = dialogService;
            _this.app = app;
            _this.$queue = [];
            _this.tableOptions = {
                multiselect: false,
                setGridEditMode: ""
            };
            base.styler(_this.nativeElement, _this);
            if (layoutType === "dialog") {
                _this.isLayoutDialog = true;
                _this.dialogId = dialogId;
            }
            return _this;
        }
        LiveTableComponent.prototype.ngAfterContentInit = function() {
            var _this = this;
            _super.prototype.ngAfterContentInit.call(this);
            if (this.table) {
                this.table._liveTableParent = this;
                this.table.datagridElement.datatable("option", this.tableOptions);
                this.table.selectedItemChange$.pipe(operators.debounceTime(250)).subscribe(this.onSelectedItemChange.bind(this));
                if (!this.isLayoutDialog && !this.form) {
                    this.table.datagridElement.datatable("option", {
                        beforeRowUpdate: function() {
                            _this.showErrorMessage();
                        },
                        beforeRowDelete: function() {
                            _this.showErrorMessage();
                        },
                        beforeRowInsert: function() {
                            _this.showErrorMessage();
                        }
                    });
                }
            }
        };
        LiveTableComponent.prototype.openDialog = function() {
            this.dialogService.open(this.dialogId);
            core$1.$appDigest();
        };
        LiveTableComponent.prototype.closeDialog = function() {
            this.dialogService.close(this.dialogId);
        };
        LiveTableComponent.prototype.focusFirstInput = function() {
            var $firstInput = $(this.form.$element).find('[role="input"]:first');
            $firstInput.focus();
            $firstInput.select();
        };
        LiveTableComponent.prototype.onDialogOpen = function() {
            this.focusFirstInput();
        };
        LiveTableComponent.prototype.setFormData = function(val) {
            if (!this.form.isDestroyed) {
                this.form.getWidget().formdata = val;
            }
        };
        LiveTableComponent.prototype._addNewRow = function() {
            this.form.isSelected = true;
            this.setFormData("");
            this.form.new();
            if (this.isLayoutDialog) {
                this.onDialogOpen();
            }
        };
        LiveTableComponent.prototype.addNewRow = function() {
            if (this.isLayoutDialog) {
                this.openDialog();
                this.$queue.push(this._addNewRow.bind(this));
                return;
            }
            this._addNewRow();
        };
        LiveTableComponent.prototype._updateRow = function(row, eventName) {
            this.setFormData(row);
            this.form.isSelected = true;
            this.form.edit();
            if (this.isLayoutDialog) {
                this.form.isUpdateMode = eventName === "dblclick" ? this.form.updateMode : true;
                this.onDialogOpen();
            }
        };
        LiveTableComponent.prototype.updateRow = function(row, eventName) {
            if (this.isLayoutDialog) {
                this.openDialog();
                this.$queue.push(this._updateRow.bind(this, row, eventName));
                return;
            }
            this._updateRow(row, eventName);
        };
        LiveTableComponent.prototype.onSelectedItemChange = function(newValue) {
            var rowData;
            if (!this.form || !this.table) {
                return;
            }
            if (newValue && newValue.length > 0 && !this.form.isSelected) {
                this.form.isSelected = true;
            }
            if (newValue && newValue.length > 0) {
                if (this.table.multiselect) {
                    rowData = newValue[0];
                } else {
                    rowData = newValue[newValue.length - 1];
                }
                this.setFormData(core$1.getClonedObject(rowData));
                if (this.form.isUpdateMode) {
                    this.form.edit();
                }
            } else {
                this.form.isSelected = false;
                this.setFormData("");
                this.form.clearData();
            }
        };
        LiveTableComponent.prototype.onCancel = function() {
            this.form.isUpdateMode = false;
            if (this.isLayoutDialog) {
                this.closeDialog();
            }
        };
        LiveTableComponent.prototype.onResult = function(operation, response, newForm, updateMode) {
            this.form.isUpdateMode = core$1.isDefined(updateMode) ? updateMode : newForm ? true : false;
            switch (operation) {
              case "insert":
                if (newForm) {
                    this.table.gridfirstrowselect = false;
                    this.table.initiateSelectItem(this.table.getNavigationTargetBySortInfo(), response, true);
                } else {
                    this.table.initiateSelectItem(this.table.getNavigationTargetBySortInfo(), response);
                }
                break;

              case "update":
                if (newForm) {
                    this.table.gridfirstrowselect = false;
                    this.table.initiateSelectItem("current", response, true);
                } else {
                    this.table.initiateSelectItem("current", response);
                }
                break;

              case "delete":
                this.table.onRecordDelete();
                break;
            }
            this.table.updateVariable();
            if (this.isLayoutDialog) {
                if (newForm) {
                    if (operation === "insert") {
                        this.form.new();
                    } else if (operation === "update") {
                        this.form.edit();
                    }
                } else {
                    this.closeDialog();
                }
            }
        };
        LiveTableComponent.prototype.showErrorMessage = function() {
            this.app.notifyApp(this.appLocale.LABEL_ACCESS_DENIED, "error");
        };
        LiveTableComponent.prototype.onFormReady = function(form) {
            var _this = this;
            this.form = form;
            setTimeout(function() {
                core$1.triggerFn(_this.$queue.pop());
            });
        };
        LiveTableComponent.initializeProps = registerProps();
        LiveTableComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmLiveTable]",
                template: "<ng-content></ng-content>",
                providers: [ base.provideAsWidgetRef(LiveTableComponent) ]
            } ]
        } ];
        LiveTableComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: core.ElementRef
            }, {
                type: core.ChangeDetectorRef
            }, {
                type: core$1.AbstractDialogService
            }, {
                type: core$1.App
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "formlayout" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "dialogid" ]
                } ]
            } ];
        };
        LiveTableComponent.propDecorators = {
            table: [ {
                type: core.ContentChild,
                args: [ table.TableComponent ]
            } ]
        };
        return LiveTableComponent;
    }(base.StylableComponent);
    var components = [ LiveTableComponent ];
    var LiveTableModule = function() {
        function LiveTableModule() {}
        LiveTableModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return LiveTableModule;
    }();
    exports.\u0275a = registerProps;
    exports.LiveTableModule = LiveTableModule;
    exports.LiveTableComponent = LiveTableComponent;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/basic"), require("@wm/components/input"), require("@wm/components/dialogs/design-dialog"), require("@wm/components/prefab"), require("@wm/components/data/table"), require("@angular/forms"), require("rxjs/operators"), require("@wm/components/data/list"), require("@angular/core"), require("@wm/core"), require("@wm/components/base"), require("@wm/components/data/live-table")) : typeof define === "function" && define.amd ? define("@wm/components/data/form", [ "exports", "@angular/common", "@wm/components/basic", "@wm/components/input", "@wm/components/dialogs/design-dialog", "@wm/components/prefab", "@wm/components/data/table", "@angular/forms", "rxjs/operators", "@wm/components/data/list", "@angular/core", "@wm/core", "@wm/components/base", "@wm/components/data/live-table" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.data = global.wm.components.data || {}, 
    global.wm.components.data.form = {}), global.ng.common, global.wm.components.basic, global.wm.components.input, global.wm.components.dialogs.designdialog, global.wm.components.prefab, global.wm.components.data.table, global.ng.forms, global.rxjs.operators, global.wm.components.data.list, global.ng.core, global.wm.core, global.wm.components.base, global.wm.components.data.livetable);
})(this, function(exports, common, basic, input, designDialog, prefab, table, forms, operators, list, core, core$1, base, liveTable) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function(resolve, reject) {
            function fulfilled(value) {
                try {
                    step(generator.next(value));
                } catch (e) {
                    reject(e);
                }
            }
            function rejected(value) {
                try {
                    step(generator["throw"](value));
                } catch (e) {
                    reject(e);
                }
            }
            function step(result) {
                result.done ? resolve(result.value) : new P(function(resolve) {
                    resolve(result.value);
                }).then(fulfilled, rejected);
            }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = {
            label: 0,
            sent: function() {
                if (t[0] & 1) throw t[1];
                return t[1];
            },
            trys: [],
            ops: []
        }, f, y, t, g;
        return g = {
            next: verb(0),
            throw: verb(1),
            return: verb(2)
        }, typeof Symbol === "function" && (g[Symbol.iterator] = function() {
            return this;
        }), g;
        function verb(n) {
            return function(v) {
                return step([ n, v ]);
            };
        }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 
                0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [ op[0] & 2, t.value ];
                switch (op[0]) {
                  case 0:
                  case 1:
                    t = op;
                    break;

                  case 4:
                    _.label++;
                    return {
                        value: op[1],
                        done: false
                    };

                  case 5:
                    _.label++;
                    y = op[1];
                    op = [ 0 ];
                    continue;

                  case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;

                  default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue;
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break;
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break;
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break;
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue;
                }
                op = body.call(thisArg, _);
            } catch (e) {
                op = [ 6, e ];
                y = 0;
            } finally {
                f = t = 0;
            }
            if (op[0] & 5) throw op[1];
            return {
                value: op[0] ? op[1] : void 0,
                done: true
            };
        }
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var propsMap = new Map([ [ "autocomplete", __assign({
        value: false
    }, base.PROP_BOOLEAN) ], [ "captionalign", __assign({
        value: "left"
    }, base.PROP_STRING) ], [ "captionposition", __assign({
        value: "left"
    }, base.PROP_STRING) ], [ "captionsize", base.PROP_STRING ], [ "captionwidth", __assign({
        value: "xs-12 sm-3 md-3 lg-3"
    }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "collapsible", base.PROP_BOOLEAN ], [ "dataset", base.PROP_ANY ], [ "datasource", base.PROP_STRING ], [ "expanded", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "formdatasource", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
        value: true
    }, base.PROP_BOOLEAN) ], [ "showindevice", __assign({
        displayType: "inline-block",
        value: "all"
    }, base.PROP_STRING) ], [ "subheading", base.PROP_STRING ], [ "tabindex", __assign({
        value: 0
    }, base.PROP_NUMBER) ], [ "title", base.PROP_STRING ] ]);
    var registerFormProps = function() {
        if (core$1.isMobileApp()) {
            propsMap.set("captionwidth", __assign({
                value: "xs-4 sm-4 md-4 lg-4"
            }, base.PROP_STRING));
        }
        var formMap = new Map(propsMap);
        formMap.set("action", base.PROP_STRING);
        formMap.set("defaultmode", __assign({
            value: "Edit"
        }, base.PROP_STRING));
        formMap.set("metadata", base.PROP_STRING);
        formMap.set("method", base.PROP_STRING);
        formMap.set("postmessage", __assign({
            value: "Data posted successfully"
        }, base.PROP_STRING));
        formMap.set("target", base.PROP_STRING);
        formMap.set("enctype", base.PROP_STRING);
        formMap.set("errormessage", __assign({
            value: "An error occured. Please try again!"
        }, base.PROP_STRING));
        formMap.set("messagelayout", __assign({
            value: "Inline"
        }, base.PROP_STRING));
        formMap.set("formdata", base.PROP_STRING);
        formMap.set("novalidate", base.PROP_BOOLEAN);
        formMap.set("validationtype", __assign({
            value: "default"
        }, base.PROP_STRING));
        formMap.set("iconclass", base.PROP_STRING);
        base.register("wm-form", formMap);
    };
    var registerLiveFormProps = function() {
        if (core$1.isMobileApp()) {
            propsMap.set("captionwidth", __assign({
                value: "xs-4 sm-4 md-4 lg-4"
            }, base.PROP_STRING));
        }
        var liveFormMap = new Map(propsMap);
        liveFormMap.set("defaultmode", __assign({
            value: "View"
        }, base.PROP_STRING));
        liveFormMap.set("formlayout", __assign({
            value: "inline"
        }, base.PROP_STRING));
        liveFormMap.set("insertmessage", __assign({
            value: "Record added successfully"
        }, base.PROP_STRING));
        liveFormMap.set("updatemessage", __assign({
            value: "Record updated successfully"
        }, base.PROP_STRING));
        liveFormMap.set("deletemessage", __assign({
            value: "Record deleted successfully"
        }, base.PROP_STRING));
        liveFormMap.set("errormessage", __assign({
            value: "An error occured. Please try again!"
        }, base.PROP_STRING));
        liveFormMap.set("messagelayout", __assign({
            value: "Toaster"
        }, base.PROP_STRING));
        liveFormMap.set("formdata", base.PROP_STRING);
        liveFormMap.set("novalidate", base.PROP_BOOLEAN);
        liveFormMap.set("validationtype", __assign({
            value: "default"
        }, base.PROP_STRING));
        liveFormMap.set("iconclass", base.PROP_STRING);
        base.register("wm-liveform", liveFormMap);
    };
    var registerLiveFilterProps = function() {
        if (core$1.isMobileApp()) {
            propsMap.set("captionwidth", __assign({
                value: "xs-4 sm-4 md-4 lg-4"
            }, base.PROP_STRING));
        }
        var liveFilterMap = new Map(propsMap);
        liveFilterMap.set("autoupdate", base.PROP_BOOLEAN);
        liveFilterMap.set("enableemptyfilter", __assign({
            value: " "
        }, base.PROP_STRING));
        liveFilterMap.set("pagesize", __assign({
            value: 20
        }, base.PROP_NUMBER));
        liveFilterMap.set("iconclass", __assign({
            value: "wi wi-filter-list"
        }, base.PROP_STRING));
        base.register("wm-livefilter", liveFilterMap);
    };
    var WIDGET_CONFIG = {
        widgetType: "wm-form",
        hostClass: "panel app-panel app-form"
    };
    var LOGIN_FORM_CONFIG = {
        widgetType: "wm-form",
        hostClass: "app-form app-login-form"
    };
    var LIVE_FORM_CONFIG = {
        widgetType: "wm-liveform",
        hostClass: "panel app-panel app-liveform liveform-inline"
    };
    var LIVE_FILTER_CONFIG = {
        widgetType: "wm-livefilter",
        hostClass: "panel app-panel app-livefilter clearfix liveform-inline"
    };
    var getWidgetConfig = function(isLiveForm, isLiveFilter, role) {
        var config = WIDGET_CONFIG;
        if (isLiveForm !== null) {
            config = LIVE_FORM_CONFIG;
        } else if (isLiveFilter !== null) {
            config = LIVE_FILTER_CONFIG;
        } else if (role === "app-login") {
            config = LOGIN_FORM_CONFIG;
        }
        return config;
    };
    var \u02750 = getWidgetConfig;
    var setMarkupForFormField = function(field, columnWidth) {
        var propsTmpl = "";
        _.forEach(field, function(value, key) {
            propsTmpl = propsTmpl + " " + key + '="' + value + '"';
        });
        return '<wm-gridcolumn columnwidth="' + columnWidth + '">\n                  <wm-form-field ' + propsTmpl + "></wm-form-field>\n            </wm-gridcolumn>";
    };
    var \u02751 = setMarkupForFormField;
    var findInvalidElement = function($formEle, ngForm) {
        var $ele = $formEle.find("form.ng-invalid:visible, [formControlName].ng-invalid:visible").first();
        var formObj = ngForm;
        if ($ele.is("form")) {
            formObj = ngForm && ngForm.controls[$ele.attr("formControlName") || $ele.attr("name")];
            if (formObj) {
                return findInvalidElement($ele, formObj);
            }
        }
        return {
            ngForm: formObj,
            $ele: $ele
        };
    };
    var \u02752 = findInvalidElement;
    var setTouchedState = function(ngForm) {
        if (ngForm.valid) {
            return;
        }
        if (ngForm.controls) {
            _.forEach(ngForm.controls, function(ctrl) {
                setTouchedState(ctrl);
            });
        } else {
            ngForm.markAsTouched();
        }
    };
    var \u02753 = setTouchedState;
    var FormComponent = function(_super) {
        __extends(FormComponent, _super);
        function FormComponent(inj, fb, app, dynamicComponentProvider, ngZone, parentList, parentForm, parentPrefab, parentPartial, onBeforeSubmitEvt, onSubmitEvt, onBeforeRenderEvt, binddataset, bindformdata, isLiveForm, isLiveFilter, role, key, name) {
            var _this = _super.call(this, inj, getWidgetConfig(isLiveForm, isLiveFilter, role)) || this;
            _this.fb = fb;
            _this.app = app;
            _this.dynamicComponentProvider = dynamicComponentProvider;
            _this.ngZone = ngZone;
            _this.parentList = parentList;
            _this.parentForm = parentForm;
            _this.parentPrefab = parentPrefab;
            _this.parentPartial = parentPartial;
            _this.onBeforeSubmitEvt = onBeforeSubmitEvt;
            _this.onSubmitEvt = onSubmitEvt;
            _this.onBeforeRenderEvt = onBeforeRenderEvt;
            _this.binddataset = binddataset;
            _this.bindformdata = bindformdata;
            _this._widgetClass = "";
            _this._captionClass = "";
            _this.formFields = [];
            _this.formfields = {};
            _this.formWidgets = {};
            _this.filterWidgets = {};
            _this.buttonArray = [];
            _this.dataoutput = {};
            _this.formdata = {};
            _this.statusMessage = {
                caption: "",
                type: ""
            };
            _this.primaryKey = [];
            _this._debouncedUpdateFieldSource = _.debounce(_this.updateFieldSource, 350);
            _this.validationMessages = [];
            _this._debouncedSubmitForm = core$1.debounce(function($event) {
                _this.ngZone.run(function() {
                    _this.submitForm($event);
                });
            }, 250);
            base.styler(_this.nativeElement, _this);
            _this.isUpdateMode = true;
            _this.dialogId = _this.nativeElement.getAttribute("dialogId");
            _this.ngform = fb.group({});
            _this.bindingValue = key || name;
            var onValueChangeSubscription = _this.ngform.valueChanges.subscribe(_this.updateDataOutput.bind(_this));
            _this.registerDestroyListener(function() {
                return onValueChangeSubscription.unsubscribe();
            });
            _this.elScope = _this;
            _this.addEventsToContext(_this.context);
            return _this;
        }
        Object.defineProperty(FormComponent.prototype, "isLayoutDialog", {
            get: function() {
                return this._isLayoutDialog;
            },
            set: function(nv) {
                if (nv) {
                    core$1.removeClass(this.nativeElement, "panel app-panel liveform-inline");
                }
                this._isLayoutDialog = nv;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormComponent.prototype, "isUpdateMode", {
            get: function() {
                return this._isUpdateMode;
            },
            set: function(nv) {
                this._isUpdateMode = nv;
                this.formFields.forEach(function(field) {
                    field.setReadOnlyState(nv);
                });
            },
            enumerable: true,
            configurable: true
        });
        FormComponent.prototype.submit = function($event) {
            this._debouncedSubmitForm($event);
        };
        FormComponent.prototype.onReset = function() {
            this.reset();
        };
        Object.defineProperty(FormComponent.prototype, "parentFormArray", {
            get: function() {
                return this.parentForm && this.isParentList && this.parentForm.ngform.get(this.parentList.name);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormComponent.prototype, "isParentList", {
            get: function() {
                if (this.parentList && this.parentForm && !core$1.isDefined(this._formIsInList)) {
                    var formEle = this.$element;
                    var listEle = formEle.closest('.app-livelist[name="' + this.parentList.name + '"]');
                    if (listEle.length) {
                        this._formIsInList = !listEle.find('form[widget-id="' + this.parentForm.widgetId + '"]').length;
                    }
                }
                return core$1.isDefined(this._formIsInList) ? this._formIsInList : this.parentList;
            },
            enumerable: true,
            configurable: true
        });
        FormComponent.prototype.ngAfterContentInit = function() {
            var _this = this;
            setTimeout(function() {
                _this.componentRefs.forEach(function(componentRef) {
                    if (componentRef.name) {
                        _this.formWidgets[componentRef.name] = componentRef;
                    }
                });
            }, 250);
        };
        FormComponent.prototype.ngAfterViewInit = function() {
            if (this.parentForm && this.parentForm.ngform && this.isParentList) {
                if (!_.get(this.parentForm.ngform.controls, this.parentList.name)) {
                    this.parentForm.ngform.setControl(this.parentList.name, new forms.FormArray([]));
                }
                this.parentFormArray.push(this.ngform);
                this.formArrayIndex = this.parentFormArray.length - 1;
            }
            this.addInnerNgFormToForm(this.bindingValue);
        };
        FormComponent.prototype.findOperationType = function() {};
        FormComponent.prototype.addInnerNgFormToForm = function(binding) {
            if (this.parentForm && this.parentForm.ngform) {
                if (this.isParentList) {
                    return;
                }
                var parentContainer = this.parentPrefab || this.parentPartial;
                if (parentContainer) {
                    var parentContentEl = void 0;
                    if (this.parentPrefab) {
                        parentContentEl = parentContainer.$element.find("[wmprefabcontainer]");
                    } else {
                        parentContentEl = parentContainer.$element;
                    }
                    var prefabInnerForm = parentContentEl.find("form").first();
                    if (_.get(prefabInnerForm[0], "widget.widgetId") === this.widgetId) {
                        if (!prefabInnerForm.isParentList && !prefabInnerForm.siblings("form").length) {
                            binding = _.get(parentContainer, "name");
                        }
                    }
                }
                var counter = 1;
                var innerBinding = binding;
                while (this.parentForm.ngform.controls.hasOwnProperty(innerBinding)) {
                    innerBinding = binding + "_" + counter;
                    counter++;
                }
                this.formGroupName = innerBinding;
                this.parentForm.ngform.addControl(innerBinding, this.ngform);
            }
        };
        FormComponent.prototype.addEventsToContext = function(context) {
            var _this = this;
            context.cancel = function() {
                return _this.cancel();
            };
            context.reset = function() {
                return _this.reset();
            };
            context.save = function(evt) {
                return _this.save(evt);
            };
            context.saveAndNew = function() {
                return _this.saveAndNew();
            };
            context.saveAndView = function() {
                return _this.saveAndView();
            };
            context.delete = function() {
                return _this.delete();
            };
            context.new = function() {
                return _this.new();
            };
            context.edit = function() {
                return _this.edit();
            };
            context.highlightInvalidFields = function() {
                return _this.highlightInvalidFields();
            };
            context.filter = function() {
                return _this.filter();
            };
            context.clearFilter = function() {
                return _this.clearFilter();
            };
            context.submit = function(evt) {
                return _this.submit(evt);
            };
        };
        FormComponent.prototype.setValidationOnInnerForms = function(validateTouch) {
            var _this = this;
            var formEle = this.getNativeElement();
            var formObjs = formEle.querySelectorAll(".app-form");
            _.forEach(formObjs, function(e) {
                var formInstance = e.widget;
                var formName = _.get(formInstance, "formGroupName") || formInstance.name;
                if (core$1.isDefined(formInstance.formArrayIndex)) {
                    formName = formName + "[" + formInstance.formArrayIndex + "]";
                }
                var current = formInstance;
                while (_.get(current, "parentForm")) {
                    var parentName = current.parentForm.formGroupName || current.parentForm.name;
                    if (current.parentForm.parentFormArray) {
                        parentName = parentName + "[" + current.parentForm.formArrayIndex + "]";
                    }
                    formName = parentName + "." + formName;
                    current = current.parentForm;
                }
                _this.setValidationOnFields(formInstance, formName, validateTouch);
            });
        };
        FormComponent.prototype.setValidationOnFields = function(form, prefix, validateTouch) {
            var _this = this;
            var controls = form.ngform.controls;
            var formFields = form.formFields;
            if (!formFields) {
                return;
            }
            _.forEach(controls, function(v, k) {
                var field = formFields.find(function(e) {
                    return e.key === k;
                });
                if (!field || validateTouch && !v.touched) {
                    return;
                }
                _this.prepareValidationObj(v, k, field, prefix);
                _this.prepareValidationObj.call(form, v, k, field, prefix);
            });
        };
        FormComponent.prototype.prepareValidationObj = function(v, k, field, prefix) {
            var index = this.validationMessages.findIndex(function(e) {
                return e.field === k && e.fullyQualifiedFormName === prefix;
            });
            if (v.invalid) {
                if (index === -1) {
                    this.validationMessages.push({
                        field: k,
                        value: field.value,
                        errorType: _.keys(v.errors),
                        message: field.validationmessage || "",
                        getElement: function() {
                            return field.$element.find("[focus-target]");
                        },
                        formName: _.last(prefix.split(".")),
                        fullyQualifiedFormName: prefix
                    });
                } else {
                    this.validationMessages[index].value = field.value;
                    this.validationMessages[index].errorType = _.keys(v.errors);
                }
            } else if (v.valid && index > -1) {
                this.validationMessages.splice(index, 1);
            }
        };
        FormComponent.prototype.setValidationMsgs = function(validateTouch) {
            if (!this.formFields.length && _.isEmpty(this.ngform.controls)) {
                return;
            }
            this.setValidationOnFields(this, this.name, validateTouch);
            this.setValidationOnInnerForms(validateTouch);
        };
        FormComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName !== "submit") {
                _super.prototype.handleEvent.call(this, this.nativeElement, eventName, callback, locals);
            }
        };
        FormComponent.prototype.updateFieldSource = function() {
            var _this = this;
            if (this.formdatasource && this.formdatasource.execute(core$1.DataSource.Operation.IS_API_AWARE)) {
                return;
            } else if (this.formdatasource && !this.formdatasource.twoWayBinding) {
                return;
            }
            this.formFields.forEach(function(formField) {
                formField.setFormWidget("datavaluesource", _this.formdatasource);
                formField.setFormWidget("binddatavalue", _this.bindformdata + "." + formField.key);
            });
        };
        FormComponent.prototype.highlightInvalidFields = function() {
            setTouchedState(this.ngform);
        };
        FormComponent.prototype.validateFieldsOnSubmit = function() {
            this.setValidationMsgs();
            if (this.operationType !== "delete" && (this.validationtype === "html" || this.validationtype === "default") && this.ngform && this.ngform.invalid) {
                if (this.ngform.invalid) {
                    if (this.validationtype === "default") {
                        this.highlightInvalidFields();
                    }
                    var eleForm = findInvalidElement(this.$element, this.ngform);
                    var $invalidForm = eleForm.ngForm;
                    var $invalidEle = eleForm.$ele;
                    $invalidEle = $invalidEle.parent().find("[focus-target]");
                    if ($invalidEle.length) {
                        if (!$invalidEle.hasClass("app-search-input")) {
                            $invalidEle.focus();
                        }
                        var ngEle = $invalidForm && $invalidForm.controls[$invalidEle.attr("formControlName") || $invalidEle.attr("name")];
                        if (ngEle && ngEle.markAsTouched) {
                            ngEle.markAsTouched();
                        }
                        core$1.$appDigest();
                        return true;
                    }
                    return true;
                }
                return false;
            }
            return false;
        };
        FormComponent.prototype.onPropertyChange = function(key, nv, ov) {
            switch (key) {
              case "captionalign":
                this.captionAlignClass = "align-" + nv;
                break;

              case "captionposition":
                this.setLayoutConfig();
                break;

              case "captionwidth":
                this.setLayoutConfig();
                break;

              case "captionsize":
                this.captionsize = nv;
                break;

              case "novalidate":
                this.widget.validationtype = nv === true || nv === "true" ? "none" : "default";
                break;

              case "formdata":
                _.isArray(nv) ? this.setFormData(_.last(nv)) : this.setFormData(nv);
                if (!this.isDataSourceUpdated && this.datasource) {
                    this.onDataSourceChange();
                }
                break;

              case "defaultmode":
                if (!this.isLayoutDialog) {
                    if (nv && nv === "Edit") {
                        this.updateMode = true;
                    } else {
                        this.updateMode = false;
                    }
                    this.isUpdateMode = this.updateMode;
                }
                break;

              case "datasource":
                this.onDataSourceChange();
                break;

              case "formdatasource":
                this.onFormDataSourceChange();
                break;

              case "metadata":
                this.generateFormFields();
                break;

              case "dataset":
                var formFields = this.getFormFields();
                formFields.forEach(function(field) {
                    if (!field.isDataSetBound && _.get(field.formWidget, "dataset$")) {
                        field.formWidget.dataset$.next();
                    }
                });
                break;

              default:
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        FormComponent.prototype.onResult = function(data, status, event) {
            var params = {
                $event: event,
                $data: data,
                $operation: this.operationType
            };
            this.invokeEventCallback("result", params);
            if (status) {
                this.invokeEventCallback("success", params);
            } else {
                this.invokeEventCallback("error", params);
            }
        };
        FormComponent.prototype.toggleMessage = function(show, msg, type, header) {
            var template;
            if (show && msg) {
                template = type === "error" && this.errormessage ? this.errormessage : msg;
                if (this.messagelayout === "Inline") {
                    this.statusMessage = {
                        caption: template || "",
                        type: type
                    };
                    if (this.messageRef) {
                        this.messageRef.showMessage(this.statusMessage.caption, this.statusMessage.type);
                    }
                } else {
                    this.app.notifyApp(template, type, header);
                }
            } else {
                this.statusMessage.caption = "";
            }
        };
        FormComponent.prototype.clearMessage = function() {
            this.toggleMessage(false);
        };
        FormComponent.prototype.setLayoutConfig = function() {
            var layoutConfig;
            layoutConfig = base.getFieldLayoutConfig(this.captionwidth, this.captionposition, _.get(this.app.selectedViewPort, "os"));
            this._widgetClass = layoutConfig.widgetCls;
            this._captionClass = layoutConfig.captionCls;
            core$1.$appDigest();
        };
        FormComponent.prototype.registerFormWidget = function(widget) {
            var name = widget.name || widget.key;
            this.formWidgets[name] = widget;
        };
        FormComponent.prototype.registerFormFields = function(formField) {
            this.formFields.push(formField);
            this.formfields[formField.key] = formField;
            this.registerFormWidget(formField);
            this._debouncedUpdateFieldSource();
            if (this.parentForm) {
                this.parentForm.formFields.push(formField);
                this.parentForm.formfields[formField.key] = formField;
                this.parentForm.setFormData(this.parentForm.formdata, this.formFields, this.formdata || {});
            }
        };
        FormComponent.prototype.registerActions = function(formAction) {
            this.buttonArray.push(formAction);
        };
        FormComponent.prototype.updateFormDataOutput = function(dataObject) {
            var _this = this;
            _.forEach(this.ngform.value, function(val, key) {
                if (!_.find(_this.formFields, {
                    key: key
                })) {
                    dataObject[key] = val;
                }
            });
            this.dataoutput = dataObject;
        };
        FormComponent.prototype.constructDataObject = function() {
            var _this = this;
            var formData = {};
            var formFields = this.getFormFields();
            formFields.forEach(function(field) {
                var fieldName, fieldValue;
                fieldValue = field.datavalue || field._control.value;
                fieldValue = fieldValue === null || fieldValue === "" ? undefined : fieldValue;
                if (field.type === "file") {
                    fieldValue = core$1.getFiles(_this.name, field.key + "_formWidget", field.multiple);
                }
                fieldName = field.key || field.target || field.name;
                if (field.form.widgetId !== _this.widgetId && field.form.formGroupName) {
                    var fd = _.get(formData, field.form.formGroupName, {});
                    fd[fieldName] = fieldValue;
                    _.set(formData, field.form.formGroupName, fd);
                } else if (field.form.isParentList) {
                    var fd = _.get(formData, field.form.parentList.name, []);
                    fd[field.form.formArrayIndex] = fd[field.form.formArrayIndex] || {};
                    fd[field.form.formArrayIndex][fieldName] = fieldValue;
                    _.set(formData, field.form.parentList.name, fd);
                } else {
                    _.set(formData, fieldName, fieldValue);
                }
            });
            this.updateFormDataOutput(formData);
            return this.dataoutput;
        };
        FormComponent.prototype.updateDataOutput = function() {
            this.constructDataObject();
            if (this.ngform.touched) {
                this.setValidationMsgs(true);
            }
        };
        FormComponent.prototype.getFormFields = function() {
            var _this = this;
            return _.filter(this.formFields, function(formField) {
                return formField.form.name === _this.name;
            });
        };
        FormComponent.prototype.setFieldValue = function(field, data, innerFormdata) {
            var key = field.key || field.name;
            var fd = innerFormdata ? innerFormdata : data;
            if (fd) {
                if (fd.hasOwnProperty(key)) {
                    field.value = _.get(fd, key);
                } else if (_.includes(key, ".")) {
                    if (fd.hasOwnProperty(_.split(key, ".")[0])) {
                        field.value = _.get(fd, key);
                    }
                }
            }
            var formGroupName = field.form.formGroupName;
            if (formGroupName && _.get(data, formGroupName)) {
                this.setFormData.call(field.form, data[formGroupName]);
            }
            if (_.get(field.form, "parentFormArray")) {
                this.setFormDataFromParentFormData.call(field.form, data);
            }
        };
        FormComponent.prototype.setFormData = function(data, innerFormFields, innerFormdata) {
            var _this = this;
            var formFields = innerFormFields || this.formFields;
            formFields.forEach(function(field) {
                _this.setFieldValue(field, data, innerFormdata);
            });
            this.constructDataObject();
        };
        FormComponent.prototype.resetFormState = function() {
            var _this = this;
            if (this.validationMessages.length) {
                this.validationMessages = [];
            }
            if (!this.ngform) {
                return;
            }
            setTimeout(function() {
                _this.ngform.markAsUntouched();
                _this.ngform.markAsPristine();
            });
        };
        FormComponent.prototype.reset = function() {
            this.resetFormState();
            this.formFields.forEach(function(field) {
                field.value = "";
            });
            this.constructDataObject();
            this.clearMessage();
        };
        FormComponent.prototype.submitForm = function($event) {
            var _this = this;
            var formData, template, params;
            var dataSource = this.datasource;
            if (this.validateFieldsOnSubmit()) {
                return;
            }
            this.resetFormState();
            formData = core$1.getClonedObject(this.constructDataObject());
            params = {
                $event: $event,
                $formData: formData,
                $data: formData
            };
            if (this.onBeforeSubmitEvt && this.invokeEventCallback("beforesubmit", params) === false) {
                return;
            }
            if (this.onSubmitEvt || dataSource) {
                if (dataSource) {
                    base.performDataOperation(dataSource, formData, {}).then(function(data) {
                        _this.onResult(data, true, $event);
                        _this.toggleMessage(true, _this.postmessage, "success");
                        _this.invokeEventCallback("submit", params);
                    }, function(error) {
                        template = _this.errormessage || error.error || error;
                        _this.onResult(error, false, $event);
                        _this.toggleMessage(true, template, "error");
                        _this.invokeEventCallback("submit", params);
                        core$1.$appDigest();
                    });
                } else {
                    this.onResult({}, true, $event);
                    this.invokeEventCallback("submit", params);
                }
            } else {
                this.onResult({}, true, $event);
            }
        };
        FormComponent.prototype.showButtons = function(position) {
            var _this = this;
            return _.some(this.buttonArray, function(btn) {
                return _.includes(btn.position, position) && btn.updateMode === _this.isUpdateMode;
            });
        };
        FormComponent.prototype.expandCollapsePanel = function() {
            if (this.collapsible) {
                this.expanded = !this.expanded;
            }
        };
        FormComponent.prototype.getNearestParentFormData = function(form) {
            if (!form.parentForm) {
                return {};
            }
            if (!form.bindformdata && _.get(form.parentForm, "formdata") && !_.isEmpty(form.parentForm.formdata)) {
                return form.parentForm.formdata;
            }
            return this.getNearestParentFormData(form.parentForm);
        };
        FormComponent.prototype.setFormDataFromParentFormData = function(formdata) {
            if (_.isEmpty(this.formdata) && this.parentForm && formdata) {
                if (this.parentFormArray) {
                    var childFormArrayData = _.get(formdata, this.parentList.name);
                    if (childFormArrayData) {
                        if (!_.isArray(childFormArrayData)) {
                            childFormArrayData = [ childFormArrayData ];
                        }
                        this.parentFormArray.patchValue(childFormArrayData);
                        if (!this.bindformdata) {
                            this.formdata = childFormArrayData[this.formArrayIndex];
                        }
                        this.setFormData(this.formdata);
                    } else if (this.isParentList && this.parentForm.formGroupName) {
                        var parentFormData = _.get(formdata, this.parentForm.formGroupName);
                        this.setFormDataFromParentFormData(parentFormData);
                    }
                } else {
                    this.setFormData(formdata);
                }
            }
        };
        FormComponent.prototype.onDataSourceChange = function() {
            if (_.get(this.formFields, "length") && !this.bindformdata) {
                this.isDataSourceUpdated = true;
                var formdata = this.getNearestParentFormData(this);
                this.setFormDataFromParentFormData(formdata);
            }
        };
        FormComponent.prototype.onFormDataSourceChange = function() {
            this.updateFieldSource();
        };
        FormComponent.prototype.onFieldDefaultValueChange = function(field, nv) {
            field.value = base.parseValueByType(nv, undefined, field.widgettype);
        };
        FormComponent.prototype.onFieldValueChange = function() {};
        FormComponent.prototype.generateFormFields = function() {
            return __awaiter(this, void 0, void 0, function() {
                var noOfColumns, $gridLayout, columnWidth, fieldTemplate, colCount, index, userFields, fields, colTmpl, componentFactoryRef, component;
                return __generator(this, function(_a) {
                    switch (_a.label) {
                      case 0:
                        if (_.isUndefined(this._isGridLayoutPresent)) {
                            this._isGridLayoutPresent = this.$element.find(".panel-body [wmlayoutgrid]").length > 0;
                        }
                        if (this._isGridLayoutPresent) {
                            $gridLayout = this.$element.find(".form-elements [wmlayoutgrid]:first");
                            noOfColumns = Number($gridLayout.attr("columns")) || 1;
                        } else {
                            $gridLayout = this.$element.find(".form-elements .dynamic-form-container");
                            if (!$gridLayout.length) {
                                this.$element.find(".form-elements").prepend('<div class="dynamic-form-container"></div>');
                                $gridLayout = this.$element.find(".form-elements .dynamic-form-container");
                            }
                            noOfColumns = 1;
                        }
                        columnWidth = 12 / noOfColumns;
                        fieldTemplate = "";
                        colCount = 0;
                        fields = this.metadata ? this.metadata.data || this.metadata : [];
                        this.formFields = [];
                        if (_.isEmpty(fields)) {
                            return [ 2 ];
                        }
                        if (this.onBeforeRenderEvt) {
                            userFields = this.invokeEventCallback("beforerender", {
                                $metadata: fields
                            });
                            if (userFields) {
                                fields = userFields;
                            }
                        }
                        if (!_.isArray(fields)) {
                            return [ 2 ];
                        }
                        while (fields[colCount]) {
                            colTmpl = "";
                            for (index = 0; index < noOfColumns; index++) {
                                if (fields[colCount]) {
                                    colTmpl += setMarkupForFormField(fields[colCount], columnWidth);
                                }
                                colCount++;
                            }
                            fieldTemplate += "<wm-gridrow>" + colTmpl + "</wm-gridrow>";
                        }
                        if (!this._isGridLayoutPresent) {
                            fieldTemplate = "<wm-layoutgrid>" + fieldTemplate + "</wm-layoutgrid>";
                        }
                        this.dynamicFormRef.clear();
                        if (!this._dynamicContext) {
                            this._dynamicContext = Object.create(this.viewParent);
                            this._dynamicContext.form = this;
                        }
                        return [ 4, this.dynamicComponentProvider.getComponentFactoryRef("app-form-dynamic-" + this.widgetId, fieldTemplate, {
                            noCache: true,
                            transpile: true
                        }) ];

                      case 1:
                        componentFactoryRef = _a.sent();
                        component = this.dynamicFormRef.createComponent(componentFactoryRef, 0, this.inj);
                        core$1.extendProto(component.instance, this._dynamicContext);
                        $gridLayout[0].appendChild(component.location.nativeElement);
                        this.setFormData(this.formdata);
                        return [ 2 ];
                    }
                });
            });
        };
        Object.defineProperty(FormComponent.prototype, "mode", {
            get: function() {
                return this.operationType || this.findOperationType();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormComponent.prototype, "dirty", {
            get: function() {
                return this.ngform && this.ngform.dirty;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormComponent.prototype, "invalid", {
            get: function() {
                return this.ngform && this.ngform.invalid;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormComponent.prototype, "touched", {
            get: function() {
                return this.ngform && this.ngform.touched;
            },
            enumerable: true,
            configurable: true
        });
        FormComponent.prototype.invokeActionEvent = function($event, expression) {
            var fn = core$1.$parseEvent(expression);
            fn(this.viewParent, Object.assign(this.context, {
                $event: $event
            }));
        };
        FormComponent.prototype.ngOnDestroy = function() {
            var controls = this.parentForm && _.get(this.parentForm, "ngform.controls");
            if (controls) {
                if (_.get(this.parentList, "name") && controls.hasOwnProperty(this.parentList.name)) {
                    this.parentForm.ngform.removeControl(this.parentList.name);
                }
                if (this.formGroupName && controls.hasOwnProperty(this.formGroupName)) {
                    this.parentForm.ngform.removeControl(this.formGroupName);
                } else {
                    this.parentForm.ngform.removeControl(this.name);
                }
            }
        };
        FormComponent.initializeProps = registerFormProps();
        FormComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "form[wmForm]",
                template: '<ng-template #content><ng-content></ng-content></ng-template>\n\n<ng-container *ngIf="formlayout === \'page\'; then pageLayoutTemplate else defaultTemplate">\n</ng-container>\n\n<ng-template #defaultTemplate>\n    <div class="panel-heading" *ngIf="!isLayoutDialog && (title || subheading || iconclass || showButtons(\'header\'))">\n        <h3 class="panel-title">\n            <div class="pull-left">\n                <i class="app-icon panel-icon" aria-hidden="true" [ngClass]="iconclass" *ngIf="iconclass"></i>\n            </div>\n            <div class="pull-left">\n                <div class="heading" [innerHTML]="title | trustAs: \'html\'"></div>\n                <div class="description" [innerHTML]="subheading | trustAs: \'html\'"></div>\n            </div>\n            <div class="form-action panel-actions basic-btn-grp">\n                <ng-container *ngFor="let btn of buttonArray | filter : \'position\' : \'header\'"\n                              [ngTemplateOutlet]="btn.widgetType === \'button\' ? buttonRef : anchorRef" [ngTemplateOutletContext]="{btn:btn}">\n                </ng-container>\n                <button type="button" class="app-icon wi panel-action" *ngIf="collapsible" title="Collapse/Expand"\n                        [ngClass]="expanded ? \'wi-minus\': \'wi-plus\'" (click)="expandCollapsePanel();"></button>\n            </div>\n        </h3>\n    </div>\n    <div class="panel-body" [ngClass]="{\'form-elements\': isLayoutDialog, \'form-body\': !isLayoutDialog}" [class.hidden]="!expanded">\n        <p wmMessage [hidden]="!statusMessage.caption.toString()" caption.bind="statusMessage.caption" type.bind="statusMessage.type"></p>\n        <div [ngClass]="{\'form-elements\': !isLayoutDialog, \'form-content\': isLayoutDialog}">\n            <ng-container *ngTemplateOutlet="content"></ng-container>\n        </div>\n        <div class="basic-btn-grp form-action panel-footer clearfix" [ngClass]="{\'modal-footer\': isLayoutDialog}" [class.hidden]="!expanded || !showButtons(\'footer\')">\n            <ng-container *ngFor="let btn of buttonArray | filter : \'position\' : \'footer\'"\n                          [ngTemplateOutlet]="btn.widgetType === \'button\' ? buttonRef : anchorRef" [ngTemplateOutletContext]="{btn:btn}">\n            </ng-container>\n        </div>\n    </div>\n</ng-template>\n\n<ng-template #pageLayoutTemplate>\n    <ng-container *ngTemplateOutlet="content"></ng-container>\n</ng-template>\n\n<ng-template #buttonRef let-btn="btn">\n    <button  wmButton name="{{btn.key}}" caption.bind="btn.displayName" class.bind="btn.class" iconclass.bind="btn.iconclass" show.bind="btn.show"\n             (click)="invokeActionEvent($event, btn.action)" type.bind="btn.type" hint.bind="btn.title" shortcutkey.bind="btn.shortcutkey" disabled.bind="ngform.status === \'PENDING\' || btn.disabled"\n             tabindex.bind="btn.tabindex" [class.hidden]="btn.updateMode ? !isUpdateMode : isUpdateMode"></button>\n</ng-template>\n\n<ng-template #anchorRef let-btn="btn">\n    <a wmAnchor name="{{btn.key}}" caption.bind="btn.displayName" class.bind="btn.class" iconclass.bind="btn.iconclass" show.bind="btn.show"\n             (click)="invokeActionEvent($event, btn.action)" hint.bind="btn.title" shortcutkey.bind="btn.shortcutkey"\n             hyperlink.bind="btn.hyperlink" target.bind="btn.target"\n             tabindex.bind="btn.tabindex" [class.hidden]="btn.updateMode ? !isUpdateMode : isUpdateMode"></a>\n</ng-template>\n\n<ng-container #dynamicForm></ng-container>\n',
                providers: [ base.provideAsWidgetRef(FormComponent) ]
            } ]
        } ];
        FormComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: forms.FormBuilder
            }, {
                type: core$1.App
            }, {
                type: core$1.DynamicComponentRefProvider
            }, {
                type: core.NgZone
            }, {
                type: list.ListComponent,
                decorators: [ {
                    type: core.Optional
                } ]
            }, {
                type: FormComponent,
                decorators: [ {
                    type: core.SkipSelf
                }, {
                    type: core.Optional
                } ]
            }, {
                type: prefab.PrefabDirective,
                decorators: [ {
                    type: core.SkipSelf
                }, {
                    type: core.Optional
                } ]
            }, {
                type: base.PartialDirective,
                decorators: [ {
                    type: core.SkipSelf
                }, {
                    type: core.Optional
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "beforesubmit.event" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "submit.event" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "beforerender.event" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "formdata.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "wmLiveForm" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "wmLiveFilter" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "role" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "key" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "name" ]
                } ]
            } ];
        };
        FormComponent.propDecorators = {
            dynamicFormRef: [ {
                type: core.ViewChild,
                args: [ "dynamicForm", {
                    read: core.ViewContainerRef
                } ]
            } ],
            messageRef: [ {
                type: core.ViewChild,
                args: [ base.MessageComponent ]
            } ],
            componentRefs: [ {
                type: core.ContentChildren,
                args: [ base.WidgetRef, {
                    descendants: true
                } ]
            } ],
            action: [ {
                type: core.HostBinding,
                args: [ "action" ]
            } ],
            submit: [ {
                type: core.HostListener,
                args: [ "submit", [ "$event" ] ]
            } ],
            onReset: [ {
                type: core.HostListener,
                args: [ "reset" ]
            } ]
        };
        return FormComponent;
    }(base.StylableComponent);
    var FormWidgetDirective = function() {
        function FormWidgetDirective(form, table$$1, componentInstance, fb, name, key) {
            var _this = this;
            this.componentInstance = componentInstance;
            this.name = name;
            this.key = key;
            this.fb = fb;
            this.parent = form || table$$1;
            this.ngform = this.parent.ngform;
            this.componentInstance.registerPropertyChangeListener(function(k, nv) {
                if (k === "datavalue" && _this._control) {
                    _this._control.setValue(nv);
                } else if (k === "name" && !_this._control) {
                    _this.addControl(_this.key || nv);
                }
            });
        }
        Object.defineProperty(FormWidgetDirective.prototype, "_control", {
            get: function() {
                var fieldName = this.key || this.name;
                if (!fieldName) {
                    return undefined;
                }
                return this.ngform && this.ngform.controls[fieldName];
            },
            enumerable: true,
            configurable: true
        });
        FormWidgetDirective.prototype.addControl = function(fieldName) {
            this.ngform.addControl(fieldName, this.createControl());
        };
        FormWidgetDirective.prototype.createControl = function() {
            return this.fb.control(this.componentInstance.datavalue);
        };
        FormWidgetDirective.prototype.ngOnInit = function() {
            var fieldName = this.key || this.name;
            if (fieldName && !this._control) {
                this.addControl(fieldName);
                this.parent.registerFormWidget(this.componentInstance);
            }
        };
        FormWidgetDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmFormWidget]"
            } ]
        } ];
        FormWidgetDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Optional
                }, {
                    type: core.Inject,
                    args: [ FormComponent ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Optional
                }, {
                    type: core.Inject,
                    args: [ table.TableComponent ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ base.WidgetRef ]
                } ]
            }, {
                type: forms.FormBuilder
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "name" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "key" ]
                } ]
            } ];
        };
        return FormWidgetDirective;
    }();
    var registerProps = function() {
        base.register("wm-form-action", new Map([ [ "accessroles", base.PROP_STRING ], [ "action", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "binding", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "display-name", base.PROP_STRING ], [ "hyperlink", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "iconname", base.PROP_STRING ], [ "key", base.PROP_STRING ], [ "position", __assign({
            value: "footer"
        }, base.PROP_STRING) ], [ "shortcutkey", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "target", base.PROP_STRING ], [ "title", base.PROP_STRING ], [ "type", __assign({
            value: "button"
        }, base.PROP_STRING) ], [ "update-mode", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "widget-type", __assign({
            value: "button"
        }, base.PROP_STRING) ] ]));
    };
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-form-action",
        hostClass: ""
    };
    var FormActionDirective = function(_super) {
        __extends(FormActionDirective, _super);
        function FormActionDirective(inj, form) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            _this.form = form;
            return _this;
        }
        FormActionDirective.prototype.populateAction = function() {
            this.buttonDef = {
                key: this.key || this.binding,
                displayName: this["display-name"],
                show: this.show,
                class: this.class ? this.class : this["widget-type"] === "button" ? "btn-secondary" : "",
                iconclass: this.iconclass || "",
                title: _.isUndefined(this.title) ? this["display-name"] || "" : this.title,
                action: this.action,
                accessroles: this.accessroles,
                shortcutkey: this.shortcutkey,
                disabled: this.disabled,
                tabindex: this.tabindex,
                iconname: this.iconname,
                type: this.type,
                updateMode: this["update-mode"],
                position: this.position,
                widgetType: this["widget-type"],
                hyperlink: this.hyperlink,
                target: this.target
            };
            this._propsInitialized = true;
        };
        FormActionDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.populateAction();
            this.form.registerActions(this.buttonDef);
        };
        FormActionDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (!this._propsInitialized) {
                return;
            }
            switch (key) {
              case "display-name":
                this.buttonDef.displayName = nv;

              default:
                this.buttonDef[key] = nv;
                break;
            }
        };
        FormActionDirective.initializeProps = registerProps();
        FormActionDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmFormAction]",
                providers: [ base.provideAsWidgetRef(FormActionDirective) ]
            } ]
        } ];
        FormActionDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: FormComponent,
                decorators: [ {
                    type: core.Optional
                } ]
            } ];
        };
        return FormActionDirective;
    }(base.BaseComponent);
    var registerProps$1 = function() {
        var formFieldMap = new Map([ [ "dataentrymode", __assign({
            value: "default"
        }, base.PROP_STRING) ], [ "debouncetime", __assign({
            value: 250
        }, base.PROP_NUMBER) ], [ "defaultvalue", base.PROP_STRING ], [ "displayname", base.PROP_STRING ], [ "display-name", base.PROP_STRING ], [ "field", base.PROP_STRING ], [ "filterexpressions", base.PROP_STRING ], [ "filter-on", base.PROP_STRING ], [ "generator", base.PROP_STRING ], [ "hint", base.PROP_STRING ], [ "inputtype", base.PROP_STRING ], [ "is-primary-key", base.PROP_BOOLEAN ], [ "is-range", base.PROP_BOOLEAN ], [ "is-related", base.PROP_BOOLEAN ], [ "isformfield", {
            value: true
        } ], [ "key", base.PROP_STRING ], [ "limit", base.PROP_NUMBER ], [ "lookup-type", base.PROP_STRING ], [ "lookup-field", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "matchmode", base.PROP_STRING ], [ "maxdefaultvalue", base.PROP_STRING ], [ "maxplaceholder", base.PROP_STRING ], [ "mobile-display", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "period", base.PROP_BOOLEAN ], [ "pc-display", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "placeholder", base.PROP_STRING ], [ "primary-key", base.PROP_BOOLEAN ], [ "related-entity-name", base.PROP_STRING ], [ "required", base.PROP_BOOLEAN ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "type", base.PROP_STRING ], [ "validationmessage", base.PROP_STRING ], [ "viewmodewidget", base.PROP_STRING ], [ "widgettype", base.PROP_STRING ] ]);
        var _loop_1 = function(key) {
            var widgetName = "wm-form-field-" + core$1.FormWidgetType[key];
            var widgetProps = base.getWidgetPropsByType(widgetName);
            formFieldMap.forEach(function(v, k) {
                if (widgetProps.get(k) == undefined) {
                    widgetProps.set(k, v);
                }
            });
        };
        for (var key in core$1.FormWidgetType) {
            _loop_1(key);
        }
    };
    var customValidatorFn = function() {
        return {
            custom: true
        };
    };
    var FILE_TYPES = {
        image: "image/*",
        video: "video/*",
        audio: "audio/*"
    };
    var DEFAULT_VALIDATOR = {
        pattern: "regexp",
        max: "maxvalue",
        min: "minvalue",
        required: "required",
        maxlength: "maxchars",
        mindate: "mindate",
        maxdate: "maxdate",
        excludedates: "excludedates",
        excludedays: "excludedays"
    };
    var \u02751$1 = {};
    var FormFieldDirective = function(_super) {
        __extends(FormFieldDirective, _super);
        function FormFieldDirective(inj, form, fb, parentList, binddataset, binddisplayexpression, binddisplaylabel, _widgetType, name, key, isRange, pcDisplay, mobileDisplay, contexts) {
            var _this = this;
            var WIDGET_CONFIG = {
                widgetType: "wm-form-field",
                hostClass: "",
                widgetSubType: "wm-form-field-" + (_widgetType || core$1.FormWidgetType.TEXT).trim()
            };
            _this = _super.call(this, inj, WIDGET_CONFIG, new Promise(function(res) {
                return _this._initPropsRes = res;
            })) || this;
            _this._validators = [];
            _this.class = "";
            _this.binddataset = binddataset;
            _this.binddisplayexpression = binddisplayexpression;
            _this.binddisplaylabel = binddisplaylabel;
            _this.form = form;
            _this.fb = fb;
            _this._fieldName = key || name;
            _this.isRange = isRange;
            _this.excludeProps = new Set([ "type", "name" ]);
            _this.widgettype = _widgetType;
            _this.parentList = parentList;
            _this.defaultValidatorMessages = [];
            _this.notifyForFields = [];
            if (_this.binddataset || _this.$element.attr("dataset")) {
                _this.isDataSetBound = true;
            }
            contexts[0]._onFocusField = _this._onFocusField.bind(_this);
            contexts[0]._onBlurField = _this._onBlurField.bind(_this);
            _this._debounceSetUpValidators = core$1.debounce(function() {
                return _this.setUpValidators();
            }, 500);
            return _this;
        }
        FormFieldDirective.prototype._onFocusField = function($evt) {
            this._activeField = true;
            $($evt.target).closest(".live-field").addClass("active");
        };
        FormFieldDirective.prototype._onBlurField = function($evt) {
            $($evt.target).closest(".live-field").removeClass("active");
            this._activeField = false;
        };
        FormFieldDirective.prototype.evaluateExpr = function(object, displayExpr) {
            if (!displayExpr) {
                displayExpr = Object.keys(object)[0];
                if (!displayExpr) {
                    return;
                }
            }
            return base.getEvaluatedData(object, {
                expression: displayExpr
            }, this.viewParent);
        };
        FormFieldDirective.prototype.getDisplayExpr = function() {
            var _this = this;
            var caption = [];
            var value = this.value;
            var displayExpr = this.displayexpression || this.displayfield || this.displaylabel;
            if (_.isObject(value)) {
                if (_.isArray(value)) {
                    _.forEach(value, function(obj) {
                        if (_.isObject(obj)) {
                            caption.push(_this.evaluateExpr(obj, displayExpr));
                        }
                    });
                } else {
                    caption.push(this.evaluateExpr(value, displayExpr));
                }
                return _.join(caption, ",");
            }
            return value === undefined || value === null ? "" : this.value;
        };
        FormFieldDirective.prototype.getCaption = function() {
            return this.value === undefined || this.value === null ? _.get(this.form.dataoutput, this._fieldName) || "" : this.value;
        };
        FormFieldDirective.prototype.getDefaultValidators = function() {
            var _validator = [];
            if (this.required && this.show !== false) {
                if (this.widgettype === core$1.FormWidgetType.CHECKBOX || this.widgettype === core$1.FormWidgetType.TOGGLE) {
                    _validator.push(forms.Validators.requiredTrue);
                } else {
                    _validator.push(forms.Validators.required);
                }
            }
            if (this.maxchars) {
                _validator.push(forms.Validators.maxLength(this.maxchars));
            }
            if (this.minvalue) {
                _validator.push(forms.Validators.min(this.minvalue));
            }
            if (this.maxvalue && this.widgettype !== core$1.FormWidgetType.RATING) {
                _validator.push(forms.Validators.max(this.maxvalue));
            }
            if (this.regexp) {
                _validator.push(forms.Validators.pattern(this.regexp));
            }
            if (_.isFunction(this.formWidget.validate)) {
                _validator.push(this.formWidget.validate.bind(this.formWidget));
            }
            return _validator;
        };
        FormFieldDirective.prototype.setUpValidators = function(customValidator) {
            if (this.hasValidators) {
                return;
            }
            this._validators = this.getDefaultValidators();
            if (customValidator) {
                this._validators.push(customValidator);
            }
            if (this.ngform) {
                this._control.setValidators(this._validators);
                var opt = {};
                if (this.value === this.formWidget.prevDatavalue) {
                    opt["emitEvent"] = false;
                }
                this._control.updateValueAndValidity(opt);
            }
        };
        FormFieldDirective.prototype.getPromiseList = function(validators) {
            var _this = this;
            var arr = [];
            _.forEach(validators, function(fn, index) {
                var promise = fn;
                if (fn instanceof Function && fn.bind) {
                    promise = fn(_this, _this.form);
                }
                if (promise instanceof Promise) {
                    arr.push(promise);
                }
            });
            return arr;
        };
        FormFieldDirective.prototype.setAsyncValidators = function(validators) {
            var _this = this;
            this._asyncValidatorFn = function() {
                return function() {
                    return Promise.all(_this.getPromiseList(validators)).then(function() {
                        _this.validationmessage = "";
                        return null;
                    }, function(err) {
                        if (err.hasOwnProperty("errorMessage")) {
                            _this.validationmessage = _.get(err, "errorMessage");
                        } else {
                            var keys = _.keys(err);
                            _this.validationmessage = err[keys[0]].toString();
                        }
                        return err;
                    }).then(function(response) {
                        var checkForStatusChange = function() {
                            setTimeout(function() {
                                if (_this._control.status === "PENDING") {
                                    checkForStatusChange();
                                } else {
                                    _this.onStatusChange(_this._control.status);
                                }
                            }, 100);
                        };
                        checkForStatusChange();
                        return response;
                    });
                };
            };
            this._control.setAsyncValidators([ this._asyncValidatorFn() ]);
            this._control.updateValueAndValidity();
        };
        FormFieldDirective.prototype.isDefaultValidator = function(type) {
            return _.get(core$1.VALIDATOR, _.toUpper(type));
        };
        FormFieldDirective.prototype.setDefaultValidator = function(key, value) {
            if (value.bind) {
                this.watchDefaultValidatorExpr(value, key);
            } else {
                this.widget[key] = value;
                this[key] = value;
            }
        };
        FormFieldDirective.prototype.setValidators = function(validators) {
            var _this = this;
            this.hasValidators = true;
            this._syncValidators = [];
            _.forEach(validators, function(obj, index) {
                if (obj.bind) {
                    validators[index] = obj.bind(undefined, _this, _this.form);
                    _this._syncValidators.push(validators[index]);
                } else {
                    var key = _.get(obj, "type");
                    _this.defaultValidatorMessages[key] = _.get(obj, "errorMessage");
                    if (_this.isDefaultValidator(key)) {
                        var value = _.get(obj, "validator");
                        _this.setDefaultValidator(key, value);
                        validators[index] = "";
                    }
                }
            });
            this._syncValidators = _.filter(validators, function(val) {
                if (val) {
                    return val;
                }
            });
            this.applyDefaultValidators();
        };
        FormFieldDirective.prototype.observeOn = function(fields) {
            var _this = this;
            _.forEach(fields, function(field) {
                var formfield = _.find(_this.form.formfields, {
                    key: field
                });
                if (formfield) {
                    if (!formfield.notifyForFields) {
                        formfield.notifyForFields = [];
                    }
                    formfield.notifyForFields.push(_this);
                }
            });
        };
        FormFieldDirective.prototype.notifyChanges = function() {
            _.forEach(this.notifyForFields, function(field) {
                field.validate();
            });
        };
        FormFieldDirective.prototype.validate = function() {
            this.applyDefaultValidators();
            if (this._asyncValidatorFn) {
                this._control.setAsyncValidators([ this._asyncValidatorFn() ]);
                this._control.updateValueAndValidity();
            }
            if (this.form.touched) {
                this._control.markAsTouched();
            }
        };
        FormFieldDirective.prototype.setFormWidget = function(key, val) {
            if (this.formWidget && this.formWidget.widget) {
                this.formWidget.widget[key] = val;
            }
        };
        FormFieldDirective.prototype.boundFn = function(fn) {
            return fn();
        };
        FormFieldDirective.prototype.watchDefaultValidatorExpr = function(fn, key) {
            var _this = this;
            var watchName = this.widgetId + "_" + key + "_formField";
            core$1.$unwatch(watchName);
            this.registerDestroyListener(core$1.$watch("boundFn(fn)", _.extend(this, this.viewParent), {
                fn: fn
            }, function(nv, ov) {
                _this.widget[key] = nv;
                _this.applyDefaultValidators();
            }, watchName));
        };
        FormFieldDirective.prototype.applyDefaultValidators = function() {
            var validators = this.getDefaultValidators();
            this._control.setValidators(_.concat(this._syncValidators || [], validators));
            this._control.updateValueAndValidity();
            this.setCustomValidationMessage();
        };
        FormFieldDirective.prototype.setMaxFormWidget = function(key, val) {
            if (this.formWidgetMax) {
                this.formWidgetMax.widget[key] = val;
            }
        };
        FormFieldDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key !== "tabindex") {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
            if (this.excludeProps.has(key)) {
                return;
            }
            if (this.widgettype === core$1.FormWidgetType.UPLOAD) {
                if (key === "required") {
                    this._debounceSetUpValidators();
                }
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
                return;
            }
            this.setFormWidget(key, nv);
            if (key !== "placeholder") {
                this.setMaxFormWidget(key, nv);
            }
            switch (key) {
              case "defaultvalue":
                this.form.onFieldDefaultValueChange(this, nv);
                break;

              case "maxdefaultvalue":
                this.maxValue = nv;
                this.setMaxFormWidget("datavalue", nv);
                this.form.onMaxDefaultValueChange();
                break;

              case "maxplaceholder":
                this.setMaxFormWidget("placeholder", nv);
                break;

              case "required":
              case "maxchars":
              case "minvalue":
              case "maxvalue":
              case "regexp":
              case "show":
                this._debounceSetUpValidators();
                break;

              case "primary-key":
                if (nv) {
                    this.form.setPrimaryKey(this._fieldName);
                }
                break;

              case "display-name":
                this.displayname = nv;
                break;

              case "readonly":
                this.setReadOnlyState();
                break;
            }
        };
        FormFieldDirective.prototype.onStyleChange = function(key, nv, ov) {
            this.setFormWidget(key, nv);
            this.setMaxFormWidget(key, nv);
            _super.prototype.onStyleChange.call(this, key, nv, ov);
        };
        Object.defineProperty(FormFieldDirective.prototype, "datavalue", {
            get: function() {
                return this.formWidget && this.formWidget.datavalue;
            },
            set: function(val) {
                if (this._control && this.widgettype !== core$1.FormWidgetType.UPLOAD) {
                    this._control.setValue(val);
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormFieldDirective.prototype, "value", {
            get: function() {
                return this.datavalue;
            },
            set: function(val) {
                this.datavalue = val;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormFieldDirective.prototype, "maxValue", {
            get: function() {
                return this.formWidgetMax && this.formWidgetMax.datavalue;
            },
            set: function(val) {
                if (this._maxControl) {
                    this._maxControl.setValue(val);
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormFieldDirective.prototype, "minValue", {
            get: function() {
                return this.value;
            },
            set: function(val) {
                this.value = val;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormFieldDirective.prototype, "_control", {
            get: function() {
                return this.ngform && this.ngform.controls[this._fieldName];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormFieldDirective.prototype, "_maxControl", {
            get: function() {
                return this.ngform && this.ngform.controls[this._fieldName + "_max"];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(FormFieldDirective.prototype, "displayValue", {
            get: function() {
                return this.formWidget && this.formWidget.displayValue;
            },
            enumerable: true,
            configurable: true
        });
        FormFieldDirective.prototype.createControl = function() {
            return this.fb.control(undefined, {
                validators: this._validators
            });
        };
        FormFieldDirective.prototype.onValueChange = function(val) {
            if (!this.isDestroyed) {
                this.form.onFieldValueChange(this, val);
                this.notifyChanges();
                if (this.form.touched) {
                    this.setCustomValidationMessage();
                }
            }
        };
        FormFieldDirective.prototype.onStatusChange = function(status) {
            if (!this.isDestroyed) {
                this.showPendingSpinner = status === "PENDING";
                if (status === "PENDING") {
                    this.formWidget.disabled = true;
                } else if (this.formWidget.disabled !== this.disabled) {
                    this.formWidget.disabled = this.disabled;
                }
            }
        };
        FormFieldDirective.prototype.setValidationMessage = function(val) {
            var _this = this;
            setTimeout(function() {
                _this.validationmessage = val;
                _this.setUpValidators(customValidatorFn);
            });
        };
        FormFieldDirective.prototype.setCustomValidationMessage = function() {
            var fieldErrors = this._control.errors;
            if (!fieldErrors) {
                return;
            }
            if (fieldErrors.hasOwnProperty("errorMessage")) {
                this.validationmessage = _.get(fieldErrors, "errorMessage");
            } else {
                var keys = _.keys(fieldErrors);
                var key = keys[0];
                var validationMsgKey = _.get(DEFAULT_VALIDATOR, key) || this.formWidget.validateType;
                if (validationMsgKey) {
                    this.validationmessage = _.get(this.defaultValidatorMessages, validationMsgKey) || this.validationmessage;
                } else {
                    this.validationmessage = "";
                }
            }
        };
        FormFieldDirective.prototype.setReadOnlyState = function() {
            var readOnly;
            if (this.form.isUpdateMode) {
                if (this["primary-key"] && !this["is-related"] && !this.period) {
                    readOnly = !(this.generator === "assigned" && this.form.operationType !== "update");
                } else {
                    readOnly = this.readonly;
                }
            } else {
                readOnly = true;
            }
            this.setFormWidget("readonly", readOnly);
        };
        FormFieldDirective.prototype.resetDisplayInput = function() {
            if (!core$1.isDefined(this.value) || this.value === "") {
                this.formWidget && this.formWidget.resetDisplayInput && this.formWidget.resetDisplayInput();
            }
        };
        FormFieldDirective.prototype.triggerUploadEvent = function($event, eventName) {
            var params = {
                $event: $event
            };
            if (eventName === "change") {
                params.newVal = $event.target.files;
                params.oldVal = this._oldUploadVal;
                this._oldUploadVal = params.newVal;
            }
            this.invokeEventCallback(eventName, params);
        };
        FormFieldDirective.prototype.registerFormField = function() {
            var fieldName = this._fieldName;
            if (this.parentList && !(this.form.parentList === this.parentList)) {
                var counter = 1;
                var _fieldName = fieldName;
                while (this.ngform.controls.hasOwnProperty(_fieldName)) {
                    _fieldName = fieldName + "_" + counter;
                    counter++;
                }
                this.ngform.addControl(_fieldName, this.createControl());
                this._fieldName = _fieldName;
            } else {
                this.ngform.addControl(fieldName, this.createControl());
            }
            var onValueChangeSubscription = this._control.valueChanges.pipe(operators.debounceTime(200)).subscribe(this.onValueChange.bind(this));
            this.registerDestroyListener(function() {
                return onValueChangeSubscription.unsubscribe();
            });
            var onStatusChangeSubscription = this._control.statusChanges.pipe(operators.debounceTime(100)).subscribe(this.onStatusChange.bind(this));
            this.registerDestroyListener(function() {
                return onStatusChangeSubscription.unsubscribe();
            });
            if (this.isRange === "true") {
                this.ngform.addControl(fieldName + "_max", this.createControl());
                var onMaxValueChangeSubscription_1 = this._maxControl.valueChanges.pipe(operators.debounceTime(200)).subscribe(this.onValueChange.bind(this));
                this.registerDestroyListener(function() {
                    return onMaxValueChangeSubscription_1.unsubscribe();
                });
            }
            this.value = _.get(this.form.formdata, this._fieldName);
        };
        FormFieldDirective.prototype.ngOnInit = function() {
            this.ngform = this.form.ngform;
            this.registerFormField();
            _super.prototype.ngOnInit.call(this);
        };
        FormFieldDirective.prototype.ngAfterContentInit = function() {
            var _this = this;
            _super.prototype.ngAfterContentInit.call(this);
            if (this.formWidget) {
                this._initPropsRes();
                this.setFormWidget("binddisplaylabel", this.binddisplaylabel);
                this.setFormWidget("binddisplayexpression", this.binddisplayexpression);
            }
            this.registerReadyStateListener(function() {
                _this.key = _this._fieldName || _this.target || _this.binding;
                _this.viewmodewidget = _this.viewmodewidget || base.getDefaultViewModeWidget(_this.widgettype);
                if (_this.widgettype === core$1.FormWidgetType.UPLOAD) {
                    var fileType = void 0;
                    fileType = _this.filetype ? FILE_TYPES[_this.filetype] : "";
                    _this.permitted = fileType + (_this.extensions ? (fileType ? "," : "") + _this.extensions : "");
                }
                if (core$1.isMobile()) {
                    if (!_this["mobile-display"]) {
                        _this.widget.show = false;
                    }
                } else {
                    if (!_this["pc-display"]) {
                        _this.widget.show = false;
                    }
                }
                _this.form.registerFormFields(_this.widget);
                core$1.addForIdAttributes(_this.nativeElement);
                _this.setReadOnlyState();
            });
        };
        FormFieldDirective.initializeProps = registerProps$1();
        FormFieldDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmFormField]",
                exportAs: "wmFormField",
                providers: [ base.provideAsWidgetRef(FormFieldDirective), base.provideAs(FormFieldDirective, forms.NG_VALUE_ACCESSOR, true), {
                    provide: base.Context,
                    useValue: \u02751$1,
                    multi: true
                } ]
            } ]
        } ];
        FormFieldDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: FormComponent
            }, {
                type: forms.FormBuilder
            }, {
                type: list.ListComponent,
                decorators: [ {
                    type: core.Optional
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "dataset.bind" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "displayexpression.bind" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "displaylabel.bind" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "widgettype" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "name" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "key" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "is-range" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "pc-display" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "mobile-display" ]
                } ]
            }, {
                type: Array,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ base.Context ]
                } ]
            } ];
        };
        FormFieldDirective.propDecorators = {
            formWidget: [ {
                type: core.ContentChild,
                args: [ "formWidget" ]
            } ],
            formWidgetMax: [ {
                type: core.ContentChild,
                args: [ "formWidgetMax" ]
            } ]
        };
        return FormFieldDirective;
    }(base.StylableComponent);
    var LiveActionsDirective = function() {
        function LiveActionsDirective(subscribedWidget, app, dialogService) {
            this.subscribedWidget = subscribedWidget;
            this.app = app;
            this.dialogService = dialogService;
            subscribedWidget.addRow = this.addRow.bind(this);
            subscribedWidget.updateRow = this.updateRow.bind(this);
            subscribedWidget.deleteRow = this.deleteRow.bind(this);
            subscribedWidget.call = this.call.bind(this);
        }
        LiveActionsDirective.prototype.addRow = function() {
            this.app.notify("wm-event", {
                eventName: base.Live_Operations.INSERT,
                widgetName: this.subscribedWidget.name,
                row: this.subscribedWidget.selecteditem
            });
        };
        LiveActionsDirective.prototype.updateRow = function() {
            this.app.notify("wm-event", {
                eventName: base.Live_Operations.UPDATE,
                widgetName: this.subscribedWidget.name,
                row: this.subscribedWidget.selecteditem
            });
        };
        LiveActionsDirective.prototype.deleteRow = function() {
            this.app.notify("wm-event", {
                eventName: base.Live_Operations.DELETE,
                widgetName: this.subscribedWidget.name,
                row: this.subscribedWidget.selecteditem
            });
        };
        LiveActionsDirective.prototype.successHandler = function(options, response) {
            core$1.triggerFn(options.success, response);
        };
        LiveActionsDirective.prototype.errorHandler = function(options, error) {
            this.app.notifyApp(error, "error", "ERROR");
            core$1.triggerFn(options.error, error);
        };
        LiveActionsDirective.prototype.getRecords = function(options, operation) {
            var _this = this;
            var index;
            var dataNavigator;
            if (this.subscribedWidget.navigation !== "None" && this.subscribedWidget.dataNavigator) {
                dataNavigator = this.subscribedWidget.dataNavigator;
                if (operation === base.Live_Operations.DELETE) {
                    dataNavigator.dataSize -= 1;
                    dataNavigator.calculatePagingValues();
                    index = dataNavigator.pageCount < dataNavigator.dn.currentPage ? "prev" : undefined;
                } else {
                    index = operation === base.Live_Operations.INSERT ? "last" : "current";
                    if (index === "last") {
                        dataNavigator.dataSize += 1;
                    }
                    dataNavigator.calculatePagingValues();
                }
                dataNavigator.navigatePage(index, null, true, function(response) {
                    _this.successHandler(options, response);
                });
            } else {
                this.subscribedWidget.datasource.execute(core$1.DataSource.Operation.LIST_RECORDS, {
                    skipToggleState: true
                }).then(function(response) {
                    _this.successHandler(options, response);
                }, function(err) {
                    _this.errorHandler(options, err);
                });
            }
        };
        LiveActionsDirective.prototype.performCUDOperation = function(requestData, operation, options) {
            var _this = this;
            base.performDataOperation(this.subscribedWidget.datasource, requestData, {
                operationType: operation
            }).then(function(response) {
                if (response.error) {
                    _this.errorHandler(options, response.error);
                    return;
                }
                _this.getRecords(options, operation);
                if (operation === "delete") {
                    _this.app.notifyApp(_this.app.appLocale.MESSAGE_DELETE_RECORD_SUCCESS, "success");
                }
            }, function(error) {
                _this.errorHandler(options, error);
            });
        };
        LiveActionsDirective.prototype.insertRecord = function(requestData, operation, options) {
            this.performCUDOperation(requestData, operation, options);
        };
        LiveActionsDirective.prototype.updateRecord = function(requestData, operation, options) {
            this.performCUDOperation(requestData, operation, options);
        };
        LiveActionsDirective.prototype.deleteRecord = function(requestData, operation, options) {
            var _this = this;
            this.dialogService.showAppConfirmDialog({
                title: this.app.appLocale.MESSAGE_DELETE_RECORD || "Delete Record",
                iconclass: "wi wi-delete fa-lg",
                message: this.subscribedWidget.confirmdelete || "Are you sure you want to delete this?",
                oktext: this.subscribedWidget.deleteoktext || "Ok",
                canceltext: this.subscribedWidget.deletecanceltext || "Cancel",
                onOk: function() {
                    _this.performCUDOperation(requestData, operation, options);
                    _this.dialogService.closeAppConfirmDialog();
                },
                onCancel: function() {
                    core$1.triggerFn(options.cancelDeleteCallback);
                    _this.dialogService.closeAppConfirmDialog();
                }
            });
        };
        LiveActionsDirective.prototype.performOperation = function(operation, options) {
            var requestData = {
                row: options.row,
                prevData: {},
                rowData: {},
                transform: true,
                skipNotification: true
            };
            if (operation === base.Live_Operations.UPDATE) {
                requestData.rowData = options.rowData;
                requestData.prevData = options.prevData;
            }
            switch (operation) {
              case base.Live_Operations.INSERT:
                this.insertRecord(requestData, operation, options);
                break;

              case base.Live_Operations.UPDATE:
                this.updateRecord(requestData, operation, options);
                break;

              case base.Live_Operations.DELETE:
                this.deleteRecord(requestData, operation, options);
                break;

              case base.Live_Operations.READ:
                this.getRecords(options, operation);
                break;
            }
        };
        LiveActionsDirective.prototype.call = function(operation, options, success, error) {
            options.success = success;
            options.error = error;
            this.performOperation(operation, options);
        };
        LiveActionsDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLiveActions]"
            } ]
        } ];
        LiveActionsDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ list.ListComponent ]
                } ]
            }, {
                type: core$1.App
            }, {
                type: core$1.AbstractDialogService
            } ];
        };
        return LiveActionsDirective;
    }();
    var FILTER_CONSTANTS = {
        EMPTY_KEY: "EMPTY_NULL_FILTER"
    };
    var LiveFilterDirective = function() {
        function LiveFilterDirective(form) {
            var _this = this;
            this.form = form;
            this._filter = core$1.debounce(function(options) {
                _this.filter(options);
            }, 250);
            form.clearFilter = this.clearFilter.bind(this);
            form.applyFilter = this.applyFilter.bind(this);
            form.filter = this.filter.bind(this);
            form.filterOnDefault = this.filterOnDefault.bind(this);
            form.execute = this.execute.bind(this);
            form.onFieldDefaultValueChange = this.onFieldDefaultValueChange.bind(this);
            form.onMaxDefaultValueChange = this.onMaxDefaultValueChange.bind(this);
            form.onDataSourceChange = this.onDataSourceChange.bind(this);
            form.onFieldValueChange = this.onFieldValueChange.bind(this);
            form.submitForm = this.submitForm.bind(this);
            form.registerFormWidget = this.registerFormWidget.bind(this);
        }
        LiveFilterDirective.prototype.execute = function(operation, options) {
            if (operation === core$1.DataSource.Operation.LIST_RECORDS || operation === core$1.DataSource.Operation.DOWNLOAD) {
                return this.applyFilter(options);
            }
            if (operation === core$1.DataSource.Operation.GET_OPTIONS) {
                return this._options || {};
            }
            if (operation === core$1.DataSource.Operation.GET_PAGING_OPTIONS) {
                return this.form.pagination;
            }
            if (!this.form.datasource) {
                return {};
            }
            if (operation === core$1.DataSource.Operation.FETCH_DISTINCT_VALUES) {
                return base.fetchDistinctValues(this.form.datasource, this.form.formFields, {
                    widget: "widgettype",
                    enableemptyfilter: this.form.enableemptyfilter,
                    EMPTY_VALUE: this.form.appLocale.LABEL_NO_VALUE
                });
            }
            return this.form.datasource.execute(operation, options);
        };
        LiveFilterDirective.prototype.onFieldDefaultValueChange = function(field, nv) {
            field.minValue = nv;
            field.value = nv;
            this.filterOnDefault();
        };
        LiveFilterDirective.prototype.onFieldValueChange = function(field, nv) {
            base.applyFilterOnField(this.form.datasource, field.widget, this.form.formFields, nv, {
                EMPTY_VALUE: this.form.appLocale.LABEL_NO_VALUE
            });
            if (this.form.autoupdate && core$1.isDefined(nv)) {
                this._filter();
            }
        };
        LiveFilterDirective.prototype.onMaxDefaultValueChange = function() {
            var _this = this;
            setTimeout(function() {
                _this.filterOnDefault();
            });
        };
        LiveFilterDirective.prototype.onDataSourceChange = function() {
            var _this = this;
            var dataSource = this.form.datasource;
            if (!dataSource) {
                return;
            }
            this.form.formFields.forEach(function(field) {
                if (base.isDataSetWidget(field.widgettype)) {
                    base.getDistinctValuesForField(dataSource, field.widget, {
                        widget: "widgettype",
                        enableemptyfilter: _this.form.enableemptyfilter,
                        EMPTY_VALUE: _this.form.appLocale.LABEL_NO_VALUE
                    });
                    base.applyFilterOnField(dataSource, field.widget, _this.form.formFields, field.value, {
                        isFirst: true,
                        EMPTY_VALUE: _this.form.appLocale.LABEL_NO_VALUE
                    });
                }
            });
            this._filter(this._options);
        };
        LiveFilterDirective.prototype.clearFilter = function() {
            var _this = this;
            this.form.resetFormState();
            this.form.formFields.forEach(function(filterField) {
                if (!filterField.readonly && filterField.show) {
                    if (filterField.widgettype === core$1.FormWidgetType.AUTOCOMPLETE || filterField.widgettype === core$1.FormWidgetType.TYPEAHEAD) {
                        _this.form.$element.find("div[name=" + filterField.name + "] input").val("");
                    }
                    if (filterField["is-range"]) {
                        filterField.minValue = "";
                        filterField.maxValue = "";
                    } else {
                        filterField.value = "";
                        filterField.resetDisplayInput();
                    }
                }
            });
            setTimeout(function() {
                _this._filter();
            });
        };
        LiveFilterDirective.prototype.submitForm = function() {
            this.filter();
        };
        LiveFilterDirective.prototype.applyFilter = function(options) {
            options = options ? options.data || options : {};
            options.page = options.page || 1;
            options.orderBy = core$1.isDefined(options.orderBy) ? options.orderBy : this.orderBy;
            return this.filter(options);
        };
        LiveFilterDirective.prototype.filter = function(options) {
            var _this = this;
            if (!this.form.datasource) {
                return;
            }
            var filterFields = {};
            var dataModel = {};
            var page = 1, orderBy, isValid;
            options = options || {};
            page = options.page || page;
            orderBy = core$1.isDefined(options.orderBy) ? options.orderBy : this.orderBy || "";
            this.orderBy = orderBy;
            this.form.formFields.forEach(function(field) {
                var fieldSelector = "div[name=" + field.name + "] input";
                var $el = _this.form.$element;
                var fieldEle;
                if ((field.widgettype === core$1.FormWidgetType.AUTOCOMPLETE || field.widgettype === core$1.FormWidgetType.TYPEAHEAD) && $el) {
                    fieldEle = $el.find(fieldSelector);
                    if (!field["is-range"]) {
                        dataModel[field.field] = {
                            value: core$1.isDefined(field.value) ? field.value : fieldEle.val()
                        };
                    } else {
                        dataModel[field.field] = {
                            minValue: core$1.isDefined(field.minValue) ? field.minValue : fieldEle.first().val(),
                            maxValue: core$1.isDefined(field.maxValue) ? field.maxValue : fieldEle.last().val()
                        };
                    }
                    return;
                }
                if (!field["is-range"]) {
                    dataModel[field.field] = {
                        value: field.value
                    };
                } else {
                    dataModel[field.field] = {
                        minValue: field.minValue,
                        maxValue: field.maxValue
                    };
                }
            });
            try {
                isValid = this.form.invokeEventCallback("beforeservicecall", {
                    $data: dataModel
                });
                if (isValid === false) {
                    return;
                }
                if (isValid && isValid.error) {
                    this.form.toggleMessage(true, isValid.error, "error", "ERROR");
                    return;
                }
                this.form.formFields.forEach(function(filterField) {
                    if (!filterField["is-range"]) {
                        filterField._value = dataModel[filterField.field].value;
                    } else {
                        filterField._minValue = dataModel[filterField.field].minValue;
                        filterField._maxValue = dataModel[filterField.field].maxValue;
                    }
                });
            } catch (err) {
                if (err.message === "Abort") {
                    return;
                }
            }
            this.form.formFields.forEach(function(filterField) {
                var fieldValue;
                var matchMode;
                var colName = filterField.field;
                var minValue = filterField._minValue;
                var maxvalue = filterField._maxValue;
                if (filterField["is-related"]) {
                    colName += "." + filterField["lookup-field"];
                }
                if (filterField["is-range"]) {
                    fieldValue = base.getRangeFieldValue(minValue, maxvalue);
                    matchMode = base.getRangeMatchMode(minValue, maxvalue);
                    if (core$1.isDefined(fieldValue)) {
                        filterFields[colName] = {
                            value: fieldValue,
                            matchMode: matchMode,
                            logicalOp: "AND"
                        };
                    }
                } else {
                    switch (filterField.widgettype) {
                      case core$1.FormWidgetType.SELECT:
                      case core$1.FormWidgetType.RADIOSET:
                        if (base.getEnableEmptyFilter(_this.form.enableemptyfilter) && filterField._value === FILTER_CONSTANTS.EMPTY_KEY) {
                            matchMode = base.getEmptyMatchMode(_this.form.enableemptyfilter);
                            fieldValue = filterField._value;
                        } else {
                            if (filterField.type === core$1.DataType.BOOLEAN) {
                                if (core$1.isDefined(filterField._value) && filterField._value !== "") {
                                    fieldValue = JSON.parse(filterField._value);
                                }
                            } else {
                                fieldValue = filterField._value;
                            }
                        }
                        break;

                      case core$1.FormWidgetType.CHECKBOXSET:
                      case core$1.FormWidgetType.CHIPS:
                        if (filterField._value && filterField._value.length) {
                            fieldValue = filterField._value;
                        }
                        break;

                      case core$1.FormWidgetType.CHECKBOX:
                      case core$1.FormWidgetType.TOGGLE:
                        if (core$1.isDefined(filterField._value) && filterField._value !== "") {
                            fieldValue = filterField.type === core$1.DataType.BOOLEAN ? JSON.parse(filterField._value) : filterField._value;
                        }
                        break;

                      default:
                        fieldValue = filterField._value;
                        break;
                    }
                    if (core$1.isDefined(fieldValue) && fieldValue !== "" && fieldValue !== null) {
                        filterFields[colName] = {};
                        if (matchMode) {
                            filterFields[colName].matchMode = matchMode;
                            fieldValue = undefined;
                        } else if (filterField.type === core$1.DataType.STRING || filterField.isRelated) {
                            filterFields[colName].matchMode = matchMode || filterField.matchmode || _this.form.datasource.execute(core$1.DataSource.Operation.GET_MATCH_MODE);
                        }
                        filterFields[colName].value = fieldValue;
                        filterFields[colName].logicalOp = "AND";
                        filterFields[colName].type = filterField.type;
                    }
                }
            });
            if (options.exportType) {
                return this.form.datasource.execute(core$1.DataSource.Operation.DOWNLOAD, {
                    data: {
                        matchMode: "anywhereignorecase",
                        filterFields: filterFields,
                        orderBy: orderBy,
                        exportType: options.exportType,
                        logicalOp: "AND",
                        exportSize: options.exportSize,
                        fields: options.fields,
                        fileName: options.fileName
                    }
                });
            }
            return this.form.datasource.execute(core$1.DataSource.Operation.LIST_RECORDS, {
                filterFields: filterFields,
                orderBy: orderBy,
                page: page,
                pagesize: this.form.pagesize || 20,
                skipDataSetUpdate: true,
                inFlightBehavior: "executeAll"
            }).then(function(response) {
                var data = response.data;
                _this.form.pagination = response.pagination;
                if (data.error) {
                    _this.form.toggleMessage(true, data.error, "error", "ERROR");
                    _this.form.onResult(data, false);
                } else {
                    _this._options = {
                        page: page,
                        orderBy: orderBy
                    };
                    _this.form.result = core$1.getClonedObject(data);
                    _this.form.onResult(data, true);
                }
                core$1.$appDigest();
                return _this.form.result;
            }, function(error) {
                _this.form.toggleMessage(true, error, "error", "ERROR");
                _this.form.onResult(error, false);
                return error;
            });
        };
        LiveFilterDirective.prototype.filterOnDefault = function() {
            var defaultObj = _.find(this.form.formFields, function(obj) {
                return core$1.isDefined(obj.value) || core$1.isDefined(obj.minValue) || core$1.isDefined(obj.maxValue);
            });
            if (defaultObj) {
                this._filter(this._options);
            }
        };
        LiveFilterDirective.prototype.registerFormWidget = function(widget) {
            var name = widget.key || widget.name;
            this.form.filterWidgets[name] = widget;
        };
        LiveFilterDirective.initializeProps = registerLiveFilterProps();
        LiveFilterDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLiveFilter]"
            } ]
        } ];
        LiveFilterDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ FormComponent ]
                } ]
            } ];
        };
        return LiveFilterDirective;
    }();
    var isTimeType = function(field) {
        return field.widgettype === core$1.DataType.TIME || field.type === core$1.DataType.TIME && !field.widgettype;
    };
    var getValidTime = function(val) {
        if (val) {
            var date = new Date().toDateString();
            return new Date(date + " " + val).getTime();
        }
        return undefined;
    };
    var LiveFormDirective = function() {
        function LiveFormDirective(form, liveTable$$1, datePipe, dialogService, formlayout) {
            var _this = this;
            this.form = form;
            this.datePipe = datePipe;
            this.dialogService = dialogService;
            this._debouncedSavePrevDataValues = core$1.debounce(function() {
                _this.savePrevDataValues();
            }, 250);
            if (liveTable$$1 && !this.form.parentForm) {
                this.form._liveTableParent = liveTable$$1;
                this.form.isLayoutDialog = liveTable$$1.isLayoutDialog;
                liveTable$$1.onFormReady(this.form);
            } else {
                this.form.isLayoutDialog = formlayout === "dialog";
            }
            form.edit = this.edit.bind(this);
            form.cancel = this.cancel.bind(this);
            form.reset = this.reset.bind(this);
            form.new = this.new.bind(this);
            form.delete = this.delete.bind(this);
            form.save = this.save.bind(this);
            form.saveAndNew = this.saveAndNew.bind(this);
            form.saveAndView = this.saveAndView.bind(this);
            form.setPrimaryKey = this.setPrimaryKey.bind(this);
            form.constructDataObject = this.constructDataObject.bind(this);
            form.changeDataObject = this.setFormData.bind(this);
            form.setFormData = this.setFormData.bind(this);
            form.findOperationType = this.findOperationType.bind(this);
            form.clearData = this.clearData.bind(this);
            form.onFieldDefaultValueChange = this.onFieldDefaultValueChange.bind(this);
            form.onDataSourceChange = this.onDataSourceChange.bind(this);
            form.onFieldValueChange = this.onFieldValueChange.bind(this);
            form.submitForm = this.submitForm.bind(this);
        }
        LiveFormDirective.prototype.onDataSourceChange = function() {
            var _this = this;
            if (_.get(this.form.formFields, "length")) {
                this.form.isDataSourceUpdated = true;
            }
            var formFields = this.form.getFormFields();
            formFields.forEach(function(field) {
                if (!field.isDataSetBound && base.isDataSetWidget(field.widgettype)) {
                    if (field["is-related"]) {
                        field.isDataSetBound = true;
                        base.fetchRelatedFieldData(_this.form.datasource, field.widget, {
                            relatedField: field.key,
                            datafield: base.ALLFIELDS,
                            widget: "widgettype"
                        });
                    } else {
                        base.getDistinctValuesForField(_this.form.datasource, field.widget, {
                            widget: "widgettype",
                            enableemptyfilter: _this.form.enableemptyfilter
                        });
                        base.applyFilterOnField(_this.form.datasource, field.widget, formFields, field.value, {
                            isFirst: true
                        });
                    }
                }
            });
        };
        LiveFormDirective.prototype.onFieldDefaultValueChange = function(field, nv) {
            if (this.form.operationType === "update") {
                return;
            }
            if (core$1.isDefined(nv) && nv !== null && nv !== "" && nv !== "null") {
                field.value = base.parseValueByType(nv, field.type, field.widgettype);
            } else {
                field.value = undefined;
            }
            this._debouncedSavePrevDataValues();
        };
        LiveFormDirective.prototype.onFieldValueChange = function(field, nv) {
            base.applyFilterOnField(this.form.datasource, field.widget, this.form.formFields, nv);
        };
        LiveFormDirective.prototype.getBlobURL = function(dataObj, key, value) {
            var href = "";
            var primaryKeys;
            var primaryKey;
            if (value === null || value === undefined || !this.form.datasource) {
                return href;
            }
            primaryKeys = this.form.datasource.execute(core$1.DataSource.Operation.GET_PRIMARY_KEY) || [];
            primaryKey = dataObj[primaryKeys[0]];
            href += this.form.datasource.execute(core$1.DataSource.Operation.GET_BLOB_URL, {
                primaryValue: primaryKey,
                columnName: key
            });
            href += "?" + Math.random();
            return href;
        };
        LiveFormDirective.prototype.resetFileUploadWidget = function(field, skipValueSet) {
            var $formEle = this.form.$element;
            $formEle.find('[name="' + field.key + '_formWidget"]').val("");
            field._control.reset();
            if (!skipValueSet) {
                field.href = "";
                field.value = null;
            }
        };
        LiveFormDirective.prototype.setDefaultValues = function() {
            var _this = this;
            this.form.formFields.forEach(function(field) {
                _this.onFieldDefaultValueChange(field, field.defaultvalue);
            });
        };
        LiveFormDirective.prototype.setFormData = function(dataObj, formFields) {
            var _this = this;
            if (!dataObj) {
                return;
            }
            formFields = formFields || this.form.formFields;
            formFields.forEach(function(field) {
                var value = _.get(dataObj, field.key || field.name);
                if (isTimeType(field)) {
                    field.value = getValidTime(value);
                } else if (field.type === core$1.DataType.BLOB) {
                    _this.resetFileUploadWidget(field, true);
                    field.href = _this.getBlobURL(dataObj, field.key, value);
                    field.value = _.isString(value) ? "" : value;
                } else {
                    _this.form.setFieldValue(field, dataObj);
                }
            });
            this.savePrevDataValues();
            this.form.constructDataObject();
        };
        LiveFormDirective.prototype.onDataSourceUpdate = function(response, newForm, updateMode) {
            if (newForm) {
                this.form.new();
            } else {
                this.form.setFormData(response);
                this.closeDialog();
            }
            this.form.isUpdateMode = core$1.isDefined(updateMode) ? updateMode : true;
        };
        LiveFormDirective.prototype.savePrevformFields = function() {
            this.form.prevformFields = core$1.getClonedObject(this.form.formFields.map(function(field) {
                return {
                    key: field.key,
                    type: field.type,
                    widgettype: field.widgettype,
                    outputformat: field.outputformat,
                    value: field.value
                };
            }));
        };
        LiveFormDirective.prototype.getPrevformFields = function() {
            var _this = this;
            this.form.formFields.map(function(field) {
                var prevField = _this.form.prevformFields.find(function(pField) {
                    return pField.key === field.key;
                });
                field.value = prevField.value;
            });
        };
        LiveFormDirective.prototype.getDataObject = function() {
            if (this.form.operationType === base.Live_Operations.INSERT) {
                return {};
            }
            if (core$1.isDefined(this.form.prevDataObject) && !core$1.isEmptyObject(this.form.prevDataObject)) {
                return core$1.getClonedObject(this.form.prevDataObject);
            }
            return core$1.getClonedObject(this.form.formdata || {});
        };
        LiveFormDirective.prototype.constructDataObject = function(isPreviousData) {
            var _this = this;
            var dataObject = this.getDataObject();
            var formName = this.form.name;
            var formFields;
            formFields = isPreviousData ? this.form.prevformFields : this.form.getFormFields();
            formFields.forEach(function(field) {
                var dateTime, fieldValue;
                var fieldTarget = _.split(field.key, ".");
                var fieldName = fieldTarget[0] || field.key;
                if (field.widgettype && core$1.isDateTimeType(field.widgettype) || core$1.isDateTimeType(field.type)) {
                    if (field.value) {
                        dateTime = core$1.getValidDateObject(field.value);
                        if (field.outputformat === core$1.DataType.TIMESTAMP || field.type === core$1.DataType.TIMESTAMP) {
                            fieldValue = field.value ? dateTime : null;
                        } else if (field.outputformat) {
                            fieldValue = _this.datePipe.transform(dateTime, field.outputformat);
                        } else {
                            fieldValue = field.value;
                        }
                    } else {
                        fieldValue = undefined;
                    }
                } else if (field.type === core$1.DataType.BLOB) {
                    fieldValue = core$1.getFiles(formName, fieldName + "_formWidget", field.multiple);
                } else if (field.type === core$1.DataType.LIST) {
                    fieldValue = field.value || undefined;
                } else {
                    fieldValue = field.value === null || field.value === "" ? undefined : field.value;
                }
                if (fieldTarget.length === 1) {
                    dataObject[fieldName] = fieldValue;
                } else {
                    dataObject[fieldName] = dataObject[fieldName] || {};
                    dataObject[fieldName][fieldTarget[1]] = fieldValue;
                }
            });
            if (!isPreviousData) {
                this.form.updateFormDataOutput(dataObject);
                return this.form.dataoutput;
            }
            return dataObject;
        };
        LiveFormDirective.prototype.setPrimaryKey = function(fieldName) {
            this.form.primaryKey = this.form.primaryKey || [];
            if (this.form.primaryKey.indexOf(fieldName) === -1) {
                this.form.primaryKey.push(fieldName);
            }
        };
        LiveFormDirective.prototype.findOperationType = function() {
            var _this = this;
            var operation;
            var isPrimary = false;
            var sourceOperation = this.form.datasource && this.form.datasource.execute(core$1.DataSource.Operation.GET_OPERATION_TYPE);
            if (sourceOperation && sourceOperation !== "read") {
                return sourceOperation;
            }
            if (this.form.primaryKey && !_.isEmpty(this.form.formdata)) {
                if (this.form.primaryKey.length === 1) {
                    if (this.form.formdata[this.form.primaryKey[0]]) {
                        operation = base.Live_Operations.UPDATE;
                    }
                } else if (this.form.primaryKey.length === 0) {
                    _.forEach(this.form.formdata, function(value) {
                        if (value) {
                            isPrimary = true;
                        }
                    });
                    if (isPrimary) {
                        operation = base.Live_Operations.UPDATE;
                    }
                } else {
                    isPrimary = _.some(this.form.primaryKey, function(primaryKey) {
                        if (_this.form.formdata[primaryKey]) {
                            return true;
                        }
                    });
                    if (isPrimary) {
                        operation = base.Live_Operations.UPDATE;
                    }
                }
            }
            return operation || base.Live_Operations.INSERT;
        };
        LiveFormDirective.prototype.getPrevDataValues = function() {
            var prevDataValues = _.fromPairs(_.map(this.form.prevDataValues, function(item) {
                return [ item.key, item.value ];
            }));
            this.form.formFields.forEach(function(field) {
                field.value = prevDataValues[field.key] || "";
                field.resetDisplayInput();
            });
            return prevDataValues;
        };
        LiveFormDirective.prototype.savePrevDataValues = function() {
            this.form.prevDataValues = this.form.formFields.map(function(obj) {
                return {
                    key: obj.key,
                    value: obj.value
                };
            });
        };
        LiveFormDirective.prototype.emptyDataModel = function() {
            var _this = this;
            this.form.formFields.forEach(function(field) {
                if (core$1.isDefined(field)) {
                    if (field.type === core$1.DataType.BLOB) {
                        _this.resetFileUploadWidget(field);
                    } else {
                        field.datavalue = "";
                    }
                }
            });
        };
        LiveFormDirective.prototype.clearData = function() {
            this.form.toggleMessage(false);
            this.emptyDataModel();
        };
        LiveFormDirective.prototype.setReadonlyFields = function() {
            this.form.formFields.forEach(function(field) {
                field.setReadOnlyState();
            });
        };
        LiveFormDirective.prototype.edit = function() {
            this.form.resetFormState();
            this.form.clearMessage();
            this.form.operationType = base.Live_Operations.UPDATE;
            if (this.form.isSelected) {
                this.savePrevformFields();
                this.savePrevDataValues();
            }
            this.form.prevDataObject = core$1.getClonedObject(this.form.formdata || {});
            this.setReadonlyFields();
            this.form.isUpdateMode = true;
            core$1.$appDigest();
        };
        LiveFormDirective.prototype.reset = function() {
            var _this = this;
            var prevDataValues;
            this.form.resetFormState();
            prevDataValues = this.getPrevDataValues();
            this.form.formFields.forEach(function(field) {
                if (field.type === core$1.DataType.BLOB) {
                    _this.resetFileUploadWidget(field, true);
                    field.href = _this.getBlobURL(prevDataValues, field.key, field.value);
                }
            });
            this.form.constructDataObject();
        };
        LiveFormDirective.prototype.closeDialog = function() {
            if (this.form.isLayoutDialog) {
                this.dialogService.close(this.form.dialogId);
            }
        };
        LiveFormDirective.prototype.cancel = function() {
            this.form.clearMessage();
            this.form.isUpdateMode = false;
            this.form.reset();
            if (this.form.isSelected) {
                this.getPrevformFields();
            }
            this.form.isUpdateMode = false;
            this.closeDialog();
            if (this.form._liveTableParent) {
                this.form._liveTableParent.onCancel();
            }
            core$1.$appDigest();
        };
        LiveFormDirective.prototype.new = function() {
            var _this = this;
            this.form.resetFormState();
            this.form.operationType = base.Live_Operations.INSERT;
            this.form.clearMessage();
            if (this.form.isSelected) {
                this.savePrevformFields();
            }
            this.emptyDataModel();
            setTimeout(function() {
                _this.setDefaultValues();
                _this.savePrevDataValues();
                _this.form.constructDataObject();
            });
            this.form.isUpdateMode = true;
        };
        LiveFormDirective.prototype.delete = function(callBackFn) {
            this.form.resetFormState();
            this.form.operationType = base.Live_Operations.DELETE;
            this.form.prevDataObject = core$1.getClonedObject(this.form.formdata || {});
            this.form.save(undefined, undefined, undefined, callBackFn);
        };
        LiveFormDirective.prototype.saveAndNew = function() {
            this.save(undefined, true, true);
        };
        LiveFormDirective.prototype.saveAndView = function() {
            this.save(undefined, false);
        };
        LiveFormDirective.prototype.submitForm = function($event) {
            this.save($event);
        };
        LiveFormDirective.prototype.save = function(event, updateMode, newForm) {
            var _this = this;
            if (!this.form.datasource) {
                return;
            }
            var data, prevData, operationType, isValid;
            var requestData = {};
            operationType = this.form.operationType = this.form.operationType || this.findOperationType();
            if (this.form.validateFieldsOnSubmit()) {
                return;
            }
            data = core$1.getClonedObject(this.form.constructDataObject());
            prevData = this.form.prevformFields ? this.form.constructDataObject(true) : data;
            try {
                isValid = this.form.invokeEventCallback("beforeservicecall", {
                    $event: event,
                    $operation: this.form.operationType,
                    $data: data,
                    options: requestData
                });
                if (isValid === false) {
                    return;
                }
                if (isValid && isValid.error) {
                    this.form.toggleMessage(true, isValid.error, "error");
                    return;
                }
            } catch (err) {
                if (err.message === "Abort") {
                    return;
                }
            }
            if (this.form.operationType === base.Live_Operations.UPDATE && this.form.ngform && this.form.ngform.pristine && (this.form.isSelected && _.isEqual(data, prevData))) {
                this.form.toggleMessage(true, this.form.appLocale.MESSAGE_NO_CHANGES, "info", "");
                core$1.$appDigest();
                return;
            }
            requestData.row = data;
            requestData.transform = true;
            requestData.skipNotification = true;
            if (operationType === base.Live_Operations.UPDATE) {
                requestData.rowData = this.form.formdata;
                requestData.prevData = prevData;
            }
            base.performDataOperation(this.form.datasource, requestData, {
                operationType: operationType
            }).then(function(response) {
                var msg = operationType === base.Live_Operations.INSERT ? _this.form.insertmessage : operationType === base.Live_Operations.UPDATE ? _this.form.updatemessage : _this.form.deletemessage;
                if (operationType === base.Live_Operations.DELETE) {
                    _this.form.onResult(requestData.row, true, event);
                    _this.emptyDataModel();
                    _this.form.prevDataValues = [];
                    _this.form.isSelected = false;
                } else {
                    _this.form.onResult(response, true, event);
                }
                _this.form.toggleMessage(true, msg, "success");
                if (_this.form._liveTableParent) {
                    _this.form._liveTableParent.onResult(operationType, response, newForm, updateMode);
                } else {
                    _this.form.datasource.execute(core$1.DataSource.Operation.LIST_RECORDS, {
                        skipToggleState: true
                    });
                    _this.onDataSourceUpdate(response, newForm, updateMode);
                }
            }, function(error) {
                _this.form.onResult(error, false, event);
                _this.form.toggleMessage(true, error, "error");
                core$1.$appDigest();
            }).then(this.form.resetFormState.bind(this.form));
        };
        LiveFormDirective.initializeProps = registerLiveFormProps();
        LiveFormDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLiveForm]"
            } ]
        } ];
        LiveFormDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ FormComponent ]
                } ]
            }, {
                type: liveTable.LiveTableComponent,
                decorators: [ {
                    type: core.Optional
                } ]
            }, {
                type: base.ToDatePipe
            }, {
                type: core$1.AbstractDialogService
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "formlayout" ]
                } ]
            } ];
        };
        return LiveFormDirective;
    }();
    var components = [ FormComponent, FormWidgetDirective, FormActionDirective, FormFieldDirective, LiveActionsDirective, LiveFilterDirective, LiveFormDirective ];
    var FormModule = function() {
        function FormModule() {}
        FormModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ basic.BasicModule, common.CommonModule, designDialog.DesignDialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return FormModule;
    }();
    exports.\u0275e = FormActionDirective;
    exports.\u0275f = registerProps;
    exports.\u0275g = FormFieldDirective;
    exports.\u0275h = registerProps$1;
    exports.\u0275d = FormWidgetDirective;
    exports.\u0275a = registerFormProps;
    exports.\u0275c = registerLiveFilterProps;
    exports.\u0275b = registerLiveFormProps;
    exports.\u0275i = LiveActionsDirective;
    exports.\u0275j = LiveFilterDirective;
    exports.\u0275k = LiveFormDirective;
    exports.FormModule = FormModule;
    exports.FormComponent = FormComponent;
    exports.\u02750 = \u02750;
    exports.\u02751 = \u02751;
    exports.\u02752 = \u02752;
    exports.\u02753 = \u02753;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/basic"), require("@wm/components/input"), require("@angular/core"), require("@wm/core"), require("@wm/components/dialogs"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs/iframe-dialog", [ "exports", "@angular/common", "@wm/components/basic", "@wm/components/input", "@angular/core", "@wm/core", "@wm/components/dialogs", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = global.wm.components.dialogs || {}, 
    global.wm.components.dialogs.iframedialog = {}), global.ng.common, global.wm.components.basic, global.wm.components.input, global.ng.core, global.wm.core, global.wm.components.dialogs, global.wm.components.base);
})(this, function(exports, common, basic, input, core, core$1, dialogs, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-iframedialog", new Map([ [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "closable", {
            value: true,
            PROP_BOOLEAN: base.PROP_BOOLEAN
        } ], [ "encodeurl", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "height", __assign({
            value: "400px"
        }, base.PROP_STRING) ], [ "iconclass", {
            value: "wi wi-globe",
            PROP_STRING: base.PROP_STRING
        } ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "modal", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "name", base.PROP_STRING ], [ "oktext", __assign({
            value: "OK"
        }, base.PROP_STRING) ], [ "showactions", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "showheader", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "External Content"
        }, base.PROP_STRING) ], [ "url", __assign({
            value: "//www.wavemaker.com"
        }, base.PROP_STRING) ] ]));
    };
    var DIALOG_CLS = "app-dialog modal-dialog app-iframe-dialog";
    var WIDGET_INFO = {
        widgetType: "wm-iframedialog"
    };
    var IframeDialogComponent = function(_super) {
        __extends(IframeDialogComponent, _super);
        function IframeDialogComponent(inj, dialogClass, modal, closable) {
            var _this = this;
            if (modal === null || modal === undefined) {
                modal = false;
            }
            if (closable === null || closable === undefined) {
                closable = true;
            }
            var backdrop = core$1.toBoolean(modal) ? "static" : true;
            _this = _super.call(this, inj, WIDGET_INFO, {
                class: DIALOG_CLS + " " + (dialogClass || ""),
                backdrop: backdrop,
                keyboard: !core$1.toBoolean(modal)
            }) || this;
            return _this;
        }
        IframeDialogComponent.prototype.getTemplateRef = function() {
            return this.dialogTemplate;
        };
        IframeDialogComponent.prototype.onOk = function($event) {
            this.invokeEventCallback("ok", {
                $event: $event
            });
        };
        IframeDialogComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.register(this.viewParent);
        };
        IframeDialogComponent.initializeProps = registerProps();
        IframeDialogComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmIframeDialog]",
                template: '<ng-template #dialogTemplate>\n    <div wmDialogHeader [closable]="closable"\n         [iconclass]="iconclass"\n         [iconurl]="iconurl"\n         [iconwidth]="iconwidth"\n         [iconheight]="iconheight"\n         [iconmargin]="iconmargin"\n         [heading]="title"\n         *ngIf="showheader"\n    ></div>\n    <div wmDialogBody>\n        <div wmIframe encodeurl.bind="encodeurl" iframesrc.bind="url" height.bind="height" width.bind="width" hint.bind="hint"></div>\n    </div>\n    <div wmDialogFooter *ngIf="showactions">\n        <button wmButton class="btn-primary ok-action" caption.bind="oktext" aria-label="Submit button" (click)="onOk($event)"></button>\n    </div>\n</ng-template>\n',
                providers: [ base.provideAsWidgetRef(IframeDialogComponent), base.provideAsDialogRef(IframeDialogComponent) ]
            } ]
        } ];
        IframeDialogComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "class" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "modal" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "closable" ]
                } ]
            } ];
        };
        IframeDialogComponent.propDecorators = {
            dialogTemplate: [ {
                type: core.ViewChild,
                args: [ "dialogTemplate" ]
            } ]
        };
        return IframeDialogComponent;
    }(dialogs.BaseDialog);
    var components = [ IframeDialogComponent ];
    var IframeDialogModule = function() {
        function IframeDialogModule() {}
        IframeDialogModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ basic.BasicModule, common.CommonModule, dialogs.DialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return IframeDialogModule;
    }();
    exports.\u0275a = IframeDialogComponent;
    exports.\u0275b = registerProps;
    exports.IframeDialogModule = IframeDialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/dialogs"), require("@wm/components/dialogs/design-dialog"), require("@wm/components/input"), require("@angular/core"), require("@wm/core"), require("@wm/components/base"), require("@wm/components/data/form")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs/login-dialog", [ "exports", "@angular/common", "@wm/components/dialogs", "@wm/components/dialogs/design-dialog", "@wm/components/input", "@angular/core", "@wm/core", "@wm/components/base", "@wm/components/data/form" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = global.wm.components.dialogs || {}, 
    global.wm.components.dialogs.logindialog = {}), global.ng.common, global.wm.components.dialogs, global.wm.components.dialogs.designdialog, global.wm.components.input, global.ng.core, global.wm.core, global.wm.components.base, global.wm.components.data.form);
})(this, function(exports, common, dialogs, designDialog, input, core, core$1, base, form) {
    "use strict";
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var LoginDialogDirective = function() {
        function LoginDialogDirective(contexts, dialogRef) {
            var _this = this;
            this.contexts = contexts;
            this.dialogRef = dialogRef;
            this.contexts[0].doLogin = function() {
                return _this.doLogin();
            };
        }
        LoginDialogDirective.prototype.hideMsg = function() {
            if (this.msgCmp) {
                this.msgCmp.hideMessage();
            }
        };
        LoginDialogDirective.prototype.showError = function(msg) {
            if (this.msgCmp) {
                this.msgCmp.showMessage(msg, "error");
            }
        };
        LoginDialogDirective.prototype.showLoading = function() {
            if (this.msgCmp) {
                this.msgCmp.showMessage("Loading...", "loading");
            }
        };
        LoginDialogDirective.prototype.onSuccess = function() {
            this.hideMsg();
        };
        LoginDialogDirective.prototype.onError = function(error) {
            this.showError(error);
        };
        LoginDialogDirective.prototype.getLoginDetails = function() {
            return this.formCmp.first.dataoutput;
        };
        LoginDialogDirective.prototype.doLogin = function() {
            var loginInfo = this.getLoginDetails();
            var ds = this.dialogRef.eventsource;
            if (ds) {
                this.showLoading();
                ds.invoke({
                    loginInfo: loginInfo
                }, this.onSuccess.bind(this), this.onError.bind(this));
            }
        };
        LoginDialogDirective.prototype.ngAfterViewInit = function() {
            var _this = this;
            this.dialogOpenSubscription = this.dialogRef.bsModal.onShown.subscribe(function() {
                setTimeout(function() {
                    $(".app-textbox").keypress(function(evt) {
                        if (evt.which === 13) {
                            evt.stopPropagation();
                            core$1.$appDigest();
                            _this.doLogin();
                        }
                    });
                });
            });
        };
        LoginDialogDirective.prototype.ngOnDestroy = function() {
            this.dialogOpenSubscription.unsubscribe();
        };
        LoginDialogDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmDialog][wmLoginDialog]"
            } ]
        } ];
        LoginDialogDirective.ctorParameters = function() {
            return [ {
                type: Array,
                decorators: [ {
                    type: core.Self
                }, {
                    type: core.Inject,
                    args: [ base.Context ]
                } ]
            }, {
                type: base.DialogRef,
                decorators: [ {
                    type: core.Self
                } ]
            } ];
        };
        LoginDialogDirective.propDecorators = {
            formCmp: [ {
                type: core.ContentChildren,
                args: [ form.FormComponent ]
            } ],
            msgCmp: [ {
                type: core.ContentChild,
                args: [ base.MessageComponent ]
            } ]
        };
        return LoginDialogDirective;
    }();
    var components = [ LoginDialogDirective ];
    var LoginDialogModule = function() {
        function LoginDialogModule() {}
        LoginDialogModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, designDialog.DesignDialogModule, dialogs.DialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return LoginDialogModule;
    }();
    exports.\u0275a = LoginDialogDirective;
    exports.LoginDialogModule = LoginDialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/components/input"), require("@angular/core"), require("@wm/core"), require("@wm/components/dialogs"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/dialogs/partial-dialog", [ "exports", "@angular/common", "@wm/components/input", "@angular/core", "@wm/core", "@wm/components/dialogs", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.dialogs = global.wm.components.dialogs || {}, 
    global.wm.components.dialogs.partialdialog = {}), global.ng.common, global.wm.components.input, global.ng.core, global.wm.core, global.wm.components.dialogs, global.wm.components.base);
})(this, function(exports, common, input, core, core$1, dialogs, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-partialdialog", new Map([ [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "closable", {
            value: true,
            PROP_BOOLEAN: base.PROP_BOOLEAN
        } ], [ "content", base.PROP_STRING ], [ "iconclass", {
            value: "wi wi-file",
            PROP_STRING: base.PROP_STRING
        } ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "modal", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "name", base.PROP_STRING ], [ "oktext", __assign({
            value: "OK"
        }, base.PROP_STRING) ], [ "showactions", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "Page Content"
        }, base.PROP_STRING) ] ]));
    };
    var DIALOG_CLS = "app-dialog modal-dialog app-page-dialog";
    var WIDGET_INFO = {
        widgetType: "wm-partialdialog"
    };
    var PartialDialogComponent = function(_super) {
        __extends(PartialDialogComponent, _super);
        function PartialDialogComponent(inj, dialogClass, modal, closable) {
            var _this = this;
            if (modal === null || modal === undefined) {
                modal = false;
            }
            if (closable === null || closable === undefined) {
                closable = true;
            }
            var backdrop = core$1.toBoolean(modal) ? "static" : true;
            _this = _super.call(this, inj, WIDGET_INFO, {
                class: DIALOG_CLS + " " + (dialogClass || ""),
                backdrop: backdrop,
                keyboard: !core$1.toBoolean(modal)
            }) || this;
            return _this;
        }
        PartialDialogComponent.prototype.getTemplateRef = function() {
            return this.dialogTemplate;
        };
        PartialDialogComponent.prototype.onOk = function($event) {
            this.invokeEventCallback("ok", {
                $event: $event
            });
        };
        PartialDialogComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.register(this.viewParent);
        };
        PartialDialogComponent.initializeProps = registerProps();
        PartialDialogComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmPartialDialog]",
                template: '<ng-template #dialogTemplate>\n    <div wmDialogHeader [closable]="closable"\n         [iconclass]="iconclass"\n         [iconurl]="iconurl"\n         [iconwidth]="iconwidth"\n         [iconheight]="iconheight"\n         [iconmargin]="iconmargin"\n         [heading]="title"\n    ></div>\n    <div wmDialogBody>\n        <ng-container *ngTemplateOutlet="dialogContent"></ng-container>\n    </div>\n    <div wmDialogFooter *ngIf="showactions">\n        <button wmButton class="btn-primary ok-action" caption.bind="oktext" aria-label="Submit button" (click)="onOk($event)"></button>\n    </div>\n</ng-template>\n',
                providers: [ base.provideAsWidgetRef(PartialDialogComponent), base.provideAsDialogRef(PartialDialogComponent) ]
            } ]
        } ];
        PartialDialogComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "class" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "modal" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "closable" ]
                } ]
            } ];
        };
        PartialDialogComponent.propDecorators = {
            dialogTemplate: [ {
                type: core.ViewChild,
                args: [ "dialogTemplate" ]
            } ],
            dialogContent: [ {
                type: core.ContentChild,
                args: [ core.TemplateRef ]
            } ]
        };
        return PartialDialogComponent;
    }(dialogs.BaseDialog);
    var components = [ PartialDialogComponent ];
    var PartialDialogModule = function() {
        function PartialDialogModule() {}
        PartialDialogModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, dialogs.DialogModule, input.InputModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return PartialDialogModule;
    }();
    exports.\u0275a = PartialDialogComponent;
    exports.\u0275b = registerProps;
    exports.PartialDialogModule = PartialDialogModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/containers/accordion", [ "exports", "@angular/common", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.containers = global.wm.components.containers || {}, 
    global.wm.components.containers.accordion = {}), global.ng.common, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-accordion", new Map([ [ "class", base.PROP_STRING ], [ "closeothers", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "defaultpaneindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ] ]));
    };
    var registerProps$1 = function() {
        base.register("wm-accordionpane", new Map([ [ "badgetype", __assign({
            value: "default"
        }, base.PROP_STRING) ], [ "badgevalue", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "content", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "isdefaultpane", base.PROP_BOOLEAN ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "smoothscroll", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "subheading", base.PROP_STRING ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "Title"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS = "app-accordion-panel panel";
    var WIDGET_CONFIG = {
        widgetType: "wm-accordionpane",
        hostClass: DEFAULT_CLS
    };
    var AccordionPaneComponent = function(_super) {
        __extends(AccordionPaneComponent, _super);
        function AccordionPaneComponent(inj, accordionRef) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.accordionRef = accordionRef;
            _this.isActive = false;
            _this.$lazyLoad = core$1.noop;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.SHELL);
            core$1.removeAttr(_this.nativeElement, "title");
            return _this;
        }
        AccordionPaneComponent.prototype.expand = function(evt) {
            if (this.isActive) {
                return;
            }
            this.isActive = true;
            this.$lazyLoad();
            this.redrawChildren();
            this.invokeEventCallback("expand", {
                $event: evt
            });
            this.notifyParent(true, evt);
        };
        AccordionPaneComponent.prototype.collapse = function(evt) {
            if (!this.isActive) {
                return;
            }
            this.isActive = false;
            this.invokeEventCallback("collapse", {
                $event: evt
            });
            this.notifyParent(false, evt);
        };
        AccordionPaneComponent.prototype.toggle = function(evt) {
            if (this.isActive) {
                this.collapse(evt);
            } else {
                this.expand(evt);
            }
        };
        AccordionPaneComponent.prototype.redrawChildren = function() {
            var _this = this;
            setTimeout(function() {
                if (_this.reDrawableComponents) {
                    _this.reDrawableComponents.forEach(function(c) {
                        return c.redraw();
                    });
                }
            }, 100);
        };
        AccordionPaneComponent.prototype.notifyParent = function(isExpand, evt) {
            this.accordionRef.notifyChange(this, isExpand, evt);
        };
        AccordionPaneComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "content") {
                if (this.isActive) {
                    setTimeout(function() {
                        return _this.$lazyLoad();
                    }, 100);
                }
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        AccordionPaneComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.nativeElement.querySelector(".panel-body"), this, base.APPLY_STYLES_TYPE.INNER_SHELL);
        };
        AccordionPaneComponent.initializeProps = registerProps$1();
        AccordionPaneComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmAccordionPane]",
                template: '<div class="panel-heading clearfix" role="tab" (click)="toggle($event)" [ngClass]="{active: isActive}">\n    <h3 class="panel-title">\n        <a href="javascript:void(0);" role="button" class="accordion-toggle" [attr.aria-expanded]="isActive" [attr.aria-controls]="name">\n            <div class="pull-left">\n                <i class="app-icon panel-icon {{iconclass}}" [hidden]="!iconclass"></i>\n            </div>\n            <div class="pull-left">\n                <div class="heading" [innerHTML]="title | trustAs: \'html\'"></div>\n                <div class="description" [innerHTML]="subheading | trustAs: \'html\'"></div>\n            </div>\n        </a>\n    </h3>\n    <div class="panel-actions">\n        <span class="label label-{{badgetype}}">{{badgevalue}}</span>\n        <button type="button" aria-label="Collapse/Expand" [attr.aria-expanded]="isActive" [attr.aria-controls]="name"\n                class="app-icon panel-action wi"\n                title="{{appLocale.LABEL_COLLAPSE}}/{{appLocale.LABEL_EXPAND}}">\n            <i [ngClass]="isActive ? \'wi-minus\' : \'wi-plus\'"></i>\n        </button>\n    </div>\n</div>\n<div class="panel-collapse collapse" role="tabpanel" aria-labelledby="panel description" [ngClass]="isActive ? \'collapse in\' : \'collapse\'">\n    <div class="panel-body" [wmSmoothscroll]="smoothscroll" partial-container-target>\n        <ng-content></ng-content>\n    </div>\n</div>\n',
                providers: [ base.provideAsWidgetRef(AccordionPaneComponent) ]
            } ]
        } ];
        AccordionPaneComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: AccordionDirective
            } ];
        };
        AccordionPaneComponent.propDecorators = {
            reDrawableComponents: [ {
                type: core.ContentChildren,
                args: [ base.RedrawableDirective, {
                    descendants: true
                } ]
            } ]
        };
        return AccordionPaneComponent;
    }(base.StylableComponent);
    var DEFAULT_CLS$1 = "app-accordion panel-group";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-accordion",
        hostClass: DEFAULT_CLS$1
    };
    var AccordionDirective = function(_super) {
        __extends(AccordionDirective, _super);
        function AccordionDirective(inj) {
            var _this = this;
            var resolveFn = core$1.noop;
            _this = _super.call(this, inj, WIDGET_CONFIG$1, new Promise(function(res) {
                return resolveFn = res;
            })) || this;
            _this.promiseResolverFn = resolveFn;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.SCROLLABLE_CONTAINER);
            return _this;
        }
        AccordionDirective.prototype.notifyChange = function(paneRef, isExpand, evt) {
            if (isExpand) {
                this.closePanesExcept(paneRef);
                var index = this.getPaneIndexByRef(paneRef);
                this.activePane = paneRef.getWidget();
                if (evt) {
                    this.invokeEventCallback("change", {
                        $event: evt,
                        newPaneIndex: index,
                        oldPaneIndex: this.activePaneIndex
                    });
                }
                this.activePaneIndex = index;
            }
        };
        AccordionDirective.prototype.isValidPaneIndex = function(index) {
            return index >= 0 && index < this.panes.length;
        };
        AccordionDirective.prototype.getPaneIndexByRef = function(paneRef) {
            return this.panes.toArray().indexOf(paneRef);
        };
        AccordionDirective.prototype.getPaneRefByIndex = function(index) {
            return this.panes.toArray()[index];
        };
        AccordionDirective.prototype.closePanesExcept = function(paneRef) {
            if (core$1.isNumber(paneRef)) {
                paneRef = this.getPaneRefByIndex(paneRef);
            }
            if (this.closeothers) {
                this.panes.forEach(function(pane) {
                    if (pane !== paneRef) {
                        pane.collapse();
                    }
                });
            }
        };
        AccordionDirective.prototype.expandPane = function(index) {
            this.closePanesExcept(index);
            this.panes.toArray()[index].expand();
        };
        AccordionDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "defaultpaneindex") {
                if (this.isValidPaneIndex(nv)) {
                    this.expandPane(nv);
                }
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        AccordionDirective.prototype.ngAfterContentInit = function() {
            _super.prototype.ngAfterContentInit.call(this);
            this.promiseResolverFn();
        };
        AccordionDirective.initializeProps = registerProps();
        AccordionDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "div[wmAccordion]",
                providers: [ base.provideAsWidgetRef(AccordionDirective) ]
            } ]
        } ];
        AccordionDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        AccordionDirective.propDecorators = {
            panes: [ {
                type: core.ContentChildren,
                args: [ AccordionPaneComponent ]
            } ]
        };
        return AccordionDirective;
    }(base.StylableComponent);
    var components = [ AccordionPaneComponent, AccordionDirective ];
    var AccordionModule = function() {
        function AccordionModule() {}
        AccordionModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return AccordionModule;
    }();
    exports.\u0275a = AccordionPaneComponent;
    exports.\u0275d = registerProps$1;
    exports.\u0275b = AccordionDirective;
    exports.\u0275c = registerProps;
    exports.AccordionModule = AccordionModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/containers/layout-grid", [ "exports", "@angular/common", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.containers = global.wm.components.containers || {}, 
    global.wm.components.containers.layoutgrid = {}), global.ng.common, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-layoutgrid", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS = "app-grid-layout clearfix";
    var WIDGET_CONFIG = {
        widgetType: "wm-layoutgrid",
        hostClass: DEFAULT_CLS
    };
    var LayoutgridDirective = function(_super) {
        __extends(LayoutgridDirective, _super);
        function LayoutgridDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        LayoutgridDirective.initializeProps = registerProps();
        LayoutgridDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLayoutGrid]",
                providers: [ base.provideAsWidgetRef(LayoutgridDirective) ]
            } ]
        } ];
        LayoutgridDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return LayoutgridDirective;
    }(base.StylableComponent);
    var registerProps$1 = function() {
        base.register("wm-layout-grid-row", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$1 = "app-grid-row clearfix";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-layout-grid-row",
        hostClass: DEFAULT_CLS$1
    };
    var LayoutGridRowDirective = function(_super) {
        __extends(LayoutGridRowDirective, _super);
        function LayoutGridRowDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        LayoutGridRowDirective.initializeProps = registerProps$1();
        LayoutGridRowDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLayoutGridRow]",
                providers: [ base.provideAsWidgetRef(LayoutGridRowDirective) ]
            } ]
        } ];
        LayoutGridRowDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return LayoutGridRowDirective;
    }(base.StylableComponent);
    var registerProps$2 = function() {
        base.register("wm-gridcolumn", new Map([ [ "class", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "columnwidth", base.PROP_NUMBER ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS$2 = "app-grid-column";
    var WIDGET_CONFIG$2 = {
        widgetType: "wm-gridcolumn",
        hostClass: DEFAULT_CLS$2
    };
    var LayoutGridColumnDirective = function(_super) {
        __extends(LayoutGridColumnDirective, _super);
        function LayoutGridColumnDirective(inj, height) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$2) || this;
            if (height) {
                core$1.setCSS(_this.nativeElement, "overflow", "auto");
            }
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        LayoutGridColumnDirective.prototype.onPropertyChange = function(key, nv, ov) {
            var prefix = core$1.isMobileApp() ? "xs" : "sm";
            if (key === "columnwidth") {
                core$1.switchClass(this.nativeElement, "col-" + prefix + "-" + nv, ov ? "col-" + prefix + "-" + ov : "");
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        LayoutGridColumnDirective.initializeProps = registerProps$2();
        LayoutGridColumnDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmLayoutGridColumn]",
                providers: [ base.provideAsWidgetRef(LayoutGridColumnDirective) ]
            } ]
        } ];
        LayoutGridColumnDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "height" ]
                } ]
            } ];
        };
        return LayoutGridColumnDirective;
    }(base.StylableComponent);
    var components = [ LayoutgridDirective, LayoutGridRowDirective, LayoutGridColumnDirective ];
    var LayoutGridModule = function() {
        function LayoutGridModule() {}
        LayoutGridModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return LayoutGridModule;
    }();
    exports.\u0275e = LayoutGridColumnDirective;
    exports.\u0275f = registerProps$2;
    exports.\u0275c = LayoutGridRowDirective;
    exports.\u0275d = registerProps$1;
    exports.\u0275a = LayoutgridDirective;
    exports.\u0275b = registerProps;
    exports.LayoutGridModule = LayoutGridModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("ngx-bootstrap/dropdown"), require("@angular/core"), require("@wm/core"), require("@wm/components/navigation/menu"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/containers/panel", [ "exports", "@angular/common", "ngx-bootstrap/dropdown", "@angular/core", "@wm/core", "@wm/components/navigation/menu", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.containers = global.wm.components.containers || {}, 
    global.wm.components.containers.panel = {}), global.ng.common, global.ngxBootstrap, global.ng.core, global.wm.core, global.wm.components.navigation.menu, global.wm.components.base);
})(this, function(exports, common, dropdown, core, core$1, menu, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-panel", new Map([ [ "actions", {} ], [ "animation", base.PROP_STRING ], [ "autoclose", base.PROP_STRING ], [ "badgetype", __assign({
            value: "default"
        }, base.PROP_STRING) ], [ "badgevalue", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "closable", base.PROP_BOOLEAN ], [ "collapsible", base.PROP_BOOLEAN ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "content", base.PROP_STRING ], [ "datafield", base.PROP_STRING ], [ "enablefullscreen", base.PROP_BOOLEAN ], [ "expanded", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "fullscreen", base.PROP_BOOLEAN ], [ "helptext", base.PROP_STRING ], [ "iconclass", base.PROP_STRING ], [ "iconheight", base.PROP_STRING ], [ "iconmargin", base.PROP_STRING ], [ "iconurl", base.PROP_STRING ], [ "iconwidth", base.PROP_STRING ], [ "itemaction", base.PROP_STRING ], [ "itemchildren", base.PROP_STRING ], [ "itemicon", base.PROP_STRING ], [ "itemlabel", base.PROP_STRING ], [ "itemlink", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "subheading", base.PROP_STRING ], [ "title", base.PROP_STRING ], [ "userrole", base.PROP_STRING ] ]));
    };
    var DEFAULT_CLS = "app-panel panel";
    var WIDGET_CONFIG = {
        widgetType: "wm-panel",
        hostClass: DEFAULT_CLS
    };
    var PanelComponent = function(_super) {
        __extends(PanelComponent, _super);
        function PanelComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.$lazyLoad = core$1.noop;
            _this.expanded = true;
            _this.helpClass = "";
            _this.helptext = "";
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.SHELL);
            _this.fullScreenTitle = _this.appLocale.LABEL_FULLSCREEN + "/" + _this.appLocale.LABEL_EXITFULLSCREEN;
            _this.expandCollapseTitle = _this.appLocale.LABEL_COLLAPSE + "/" + _this.appLocale.LABEL_EXPAND;
            core$1.removeAttr(_this.nativeElement, "title");
            return _this;
        }
        Object.defineProperty(PanelComponent.prototype, "hideFooter", {
            get: function() {
                return !this.hasFooter || !this.expanded;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(PanelComponent.prototype, "showHeader", {
            get: function() {
                return this.iconurl || this.iconclass || this.collapsible || this.actions || this.title || this.subheading || this.enablefullscreen;
            },
            enumerable: true,
            configurable: true
        });
        PanelComponent.prototype.toggle = function($event) {
            if (this.collapsible) {
                this.invokeEventCallback(this.expanded ? "collapse" : "expand", {
                    $event: $event
                });
                this.expanded = !this.expanded;
                if (this.expanded) {
                    this.$lazyLoad();
                    this.reDrawChildren();
                }
            }
        };
        PanelComponent.prototype.expand = function($event) {
            if (!this.expanded) {
                this.toggle($event);
            }
        };
        PanelComponent.prototype.collapse = function($event) {
            if (this.expanded) {
                this.toggle($event);
            }
        };
        PanelComponent.prototype.toggleFullScreen = function($event) {
            if (this.enablefullscreen) {
                this.invokeEventCallback(this.fullscreen ? "exitfullscreen" : "fullscreen", {
                    $event: $event
                });
                this.fullscreen = !this.fullscreen;
                core$1.toggleClass(this.nativeElement, "fullscreen", this.fullscreen);
                this.reDrawChildren();
            }
            this.computeDimensions();
        };
        PanelComponent.prototype.toggleHelp = function() {
            this.helpClass = this.helpClass ? "" : "show-help";
            core$1.toggleClass(this.nativeElement, "show-help", !!this.helpClass);
            core$1.$appDigest();
        };
        PanelComponent.prototype.menuActionItemClick = function($event, $item) {
            this.selectedAction = _.omit($item, [ "children", "value" ]);
            this.invokeEventCallback("actionsclick", {
                $event: $event,
                $item: this.selectedAction
            });
        };
        PanelComponent.prototype.close = function($event) {
            this.getWidget().show = false;
            this.invokeEventCallback("close", {
                $event: $event
            });
        };
        PanelComponent.prototype.computeDimensions = function() {
            var headerHeight = this.panelHeader.nativeElement.offsetHeight;
            var footer = this.nativeElement.querySelector(".panel-footer");
            var content = this.panelContent.nativeElement;
            var vHeight = window.innerHeight;
            var inlineHeight;
            if (this.fullscreen) {
                inlineHeight = this.hideFooter ? vHeight - headerHeight : vHeight - (footer.offsetHeight + headerHeight);
            } else {
                inlineHeight = this.height || "";
            }
            core$1.setCSS(content, "height", inlineHeight);
        };
        PanelComponent.prototype.reDrawChildren = function() {
            var _this = this;
            setTimeout(function() {
                if (_this.reDrawableComponents) {
                    _this.reDrawableComponents.forEach(function(c) {
                        return c.redraw();
                    });
                }
            }, 100);
        };
        PanelComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "expanded") {
                this.expanded = nv;
            } else if (key === "content") {
                setTimeout(function() {
                    if (_this.expanded || !_this.collapsible) {
                        _this.$lazyLoad();
                    }
                }, 20);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        PanelComponent.prototype.ngAfterContentInit = function() {
            _super.prototype.ngAfterContentInit.call(this);
            this.hasFooter = !!this.nativeElement.querySelector("[wmPanelFooter]");
            base.styler(this.panelBody.nativeElement, this, base.APPLY_STYLES_TYPE.INNER_SHELL);
        };
        PanelComponent.initializeProps = registerProps();
        PanelComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "[wmPanel]",
                template: '<div class="panel-heading {{helpClass}}" *ngIf="showHeader" #panelHeading>\n    <h3 class="panel-title">\n        <a href="javascript:void(0)" class="panel-toggle" (click)="toggle($event)">\n            <div class="pull-left">\n                <i class="app-icon panel-icon {{iconclass}}" *ngIf="iconclass && !iconurl"></i>\n                <img data-identifier="img" title="iconurl" alt="Panel icon" class="panel-image-icon"\n                     [src]="iconurl | image" *ngIf="iconurl"\n                     [ngStyle]="{width: iconwidth ,height: iconheight, margin: iconmargin}" />\n            </div>\n            <div class="pull-left">\n                <div class="heading" [innerHTML]="title | trustAs: \'html\'" [title]="title"></div>\n                <div class="description" [innerHTML]="subheading | trustAs: \'html\'"></div>\n            </div>\n        </a>\n        <div class="panel-actions">\n            <span *ngIf="badgevalue" aria-label="badge"\n                  class="app-badge label label-{{badgetype}}">{{badgevalue}}</span>\n            <div wmMenu aria-label="dropdown" dropdown type="anchor" class="panel-action" dataset.bind="actions"\n                 *ngIf="actions" caption="" menuposition="down,left" iconclass="wi wi-more-vert"\n                 autoclose.bind="autoclose" datafield.bind="datafield" select.event="menuActionItemClick($event,$item)">\n            </div>\n            <button type="button" aria-label="Help" class="app-icon panel-action wi" [title]="appLocale.LABEL_HELP"\n                    *ngIf="helptext" (click)="toggleHelp()"><i class="wi-question"></i></button>\n            <button type="button" aria-label="Collapse/Expand" class="app-icon wi panel-action" *ngIf="collapsible"\n                    [title]="expandCollapseTitle" (click)="toggle($event);"><i\n                   [ngClass]="expanded ? \'wi-minus\' : \'wi-plus\'"></i></button>\n            <button type="button" aria-label="Fullscreen/Exit" class="app-icon panel-action wi" *ngIf="enablefullscreen"\n                    [title]="fullScreenTitle" (click)="toggleFullScreen($event);"><i\n                   [ngClass]="fullscreen ? \'wi-fullscreen-exit\' : \'wi-fullscreen\'"></i></button>\n            <button type="button" aria-label="Close button" class="app-icon panel-action"\n                    title="{{appLocale.LABEL_CLOSE}}" *ngIf="closable" (click)="close($event)"><i\n                   class="wi wi-close"></i></button>\n        </div>\n    </h3>\n</div>\n<div class="panel-content" [hidden]="!expanded" #panelContent>\n    \x3c!-- Todo Bandhavya - implement smooth scroll --\x3e\n    <div partial-container-target #panelBody [ngClass]="[\'panel-body\', helpClass]">\n        <ng-content></ng-content>\n    </div>\n    <aside class="panel-help-message" [ngClass]="helpClass">\n        <h5 class="panel-help-header" [textContent]="appLocale.LABEL_HELP"></h5>\n        <div class="panel-help-content" [innerHTML]="helptext | trustAs : \'html\'"></div>\n    </aside>\n</div>\n<div class="app-panel-footer panel-footer clearfix" [hidden]="hideFooter">\n    <ng-content select="[wmPanelFooter]"></ng-content>\n</div>',
                providers: [ base.provideAsWidgetRef(PanelComponent) ]
            } ]
        } ];
        PanelComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        PanelComponent.propDecorators = {
            panelHeader: [ {
                type: core.ViewChild,
                args: [ "panelHeading" ]
            } ],
            panelContent: [ {
                type: core.ViewChild,
                args: [ "panelContent" ]
            } ],
            panelBody: [ {
                type: core.ViewChild,
                args: [ "panelBody" ]
            } ],
            reDrawableComponents: [ {
                type: core.ContentChildren,
                args: [ base.RedrawableDirective, {
                    descendants: true
                } ]
            } ]
        };
        return PanelComponent;
    }(menu.MenuAdapterComponent);
    var components = [ PanelComponent ];
    var PanelModule = function() {
        function PanelModule() {}
        PanelModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ dropdown.BsDropdownModule, common.CommonModule, menu.MenuModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return PanelModule;
    }();
    exports.\u0275a = PanelComponent;
    exports.\u0275b = registerProps;
    exports.PanelModule = PanelModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@swipey"), require("@angular/core"), require("@wm/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/containers/tabs", [ "exports", "@angular/common", "@swipey", "@angular/core", "@wm/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.containers = global.wm.components.containers || {}, 
    global.wm.components.containers.tabs = {}), global.ng.common, global.swipey, global.ng.core, global.wm.core, global.wm.components.base);
})(this, function(exports, common, _swipey, core, core$1, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m) return m.call(o);
        return {
            next: function() {
                if (o && i >= o.length) o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var TabsAnimator = function(_super) {
        __extends(TabsAnimator, _super);
        function TabsAnimator(tabs) {
            var e_1, _a;
            var _this = _super.call(this) || this;
            _this.tabs = tabs;
            _this._$el = $(_this.tabs.getNativeElement()).find(">.tab-content");
            var childEls = _this._$el.find(">[wmTabPane]");
            _this._noOfTabs = childEls.length;
            var maxWidth = _this._noOfTabs * 100 + "%";
            core$1.addClass(_this.tabs.getNativeElement(), "has-transition");
            core$1.setCSSFromObj(_this._$el[0], {
                maxWidth: maxWidth,
                width: maxWidth
            });
            var width = 100 / _this._noOfTabs + "%";
            try {
                for (var _b = __values(Array.from(childEls)), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var child = _c.value;
                    core$1.setCSS(child, "width", width);
                }
            } catch (e_1_1) {
                e_1 = {
                    error: e_1_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_1) throw e_1.error;
                }
            }
            _this.init(_this._$el);
            return _this;
        }
        TabsAnimator.prototype.bounds = function() {
            var activeTabIndex = this.tabs.getActiveTabIndex(), w = this._$el.find(">.tab-pane:first").width(), noOfTabs = this._$el.find(">.tab-pane:visible").length, centerVal = -1 * activeTabIndex * w;
            this.clearContentFocus();
            return {
                strict: false,
                lower: activeTabIndex === noOfTabs - 1 ? 0 : -w,
                center: centerVal,
                upper: activeTabIndex === 0 ? centerVal : w
            };
        };
        TabsAnimator.prototype.context = function() {
            return {
                w: this._$el.width()
            };
        };
        TabsAnimator.prototype.animation = function() {
            return {
                transform: "translate3d(${{ ($D + $d)/w * 100 + '%'}}, 0, 0)",
                "-webkit-transform": "translate3d(${{ ($D + $d)/w * 100 + '%'}}, 0, 0)"
            };
        };
        TabsAnimator.prototype.clearContentFocus = function() {
            var activeTab = this._$el.find(">.tab-pane.active");
            if (activeTab.length && activeTab.find(document.activeElement).length) {
                document.activeElement.blur();
            }
        };
        TabsAnimator.prototype.transitionTabIntoView = function() {
            var activeTabIndex = this.tabs.getActiveTabIndex();
            core$1.setCSS(this._$el[0], "transform", "translate3d(" + -1 * activeTabIndex / this._noOfTabs * 100 + "%, 0, 0)");
        };
        TabsAnimator.prototype.onUpper = function() {
            this.tabs.prev();
            core$1.$appDigest();
        };
        TabsAnimator.prototype.onLower = function() {
            this.tabs.next();
            core$1.$appDigest();
        };
        TabsAnimator.prototype.threshold = function() {
            return 5;
        };
        return TabsAnimator;
    }(_swipey.SwipeAnimation);
    var registerProps = function() {
        var props = new Map([ [ "class", base.PROP_STRING ], [ "defaultpaneindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "justified", base.PROP_BOOLEAN ], [ "tabsposition", __assign({
            value: "top"
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "transition", base.PROP_STRING ] ]);
        if (core$1.isMobileApp()) {
            props.set("transition", __assign({
                value: "slide"
            }, base.PROP_STRING));
        }
        base.register("wm-tabs", props);
    };
    var registerProps$1 = function() {
        base.register("wm-tabpane", new Map([ [ "badgevalue", base.PROP_STRING ], [ "badgetype", __assign({
            value: "default"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "content", base.PROP_STRING ], [ "disabled", base.PROP_BOOLEAN ], [ "heading", base.PROP_STRING ], [ "isdefaulttab", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "paneicon", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "smoothscroll", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "tabindex", __assign({
            value: 0
        }, base.PROP_NUMBER) ], [ "title", __assign({
            value: "Tab Title"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS = "tab-pane";
    var WIDGET_CONFIG = {
        widgetType: "wm-tabpane",
        hostClass: DEFAULT_CLS
    };
    var TabPaneComponent = function(_super) {
        __extends(TabPaneComponent, _super);
        function TabPaneComponent(inj, tabsRef, heading, title) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.tabsRef = tabsRef;
            _this.heading = heading;
            _this.title = title;
            _this._isFirstLoad = true;
            _this.$lazyLoad = core$1.noop;
            _this.isActive = false;
            _this.disabled = false;
            core$1.removeAttr(_this.nativeElement, "title");
            return _this;
        }
        TabPaneComponent.prototype.invokeOnSelectCallback = function($event) {
            this.invokeEventCallback("select", {
                $event: $event
            });
        };
        TabPaneComponent.prototype.select = function($event) {
            if (this.isActive || this.disabled) {
                return;
            }
            this.isActive = true;
            this.$lazyLoad();
            this.redrawChildren();
            this.notifyParent($event);
        };
        TabPaneComponent.prototype.deselect = function() {
            if (this.isActive) {
                this.isActive = false;
                this.invokeEventCallback("deselect");
            }
        };
        TabPaneComponent.prototype.redrawChildren = function() {
            var _this = this;
            setTimeout(function() {
                if (_this.reDrawableComponents) {
                    _this.reDrawableComponents.forEach(function(c) {
                        return c.redraw();
                    });
                }
            }, 100);
        };
        TabPaneComponent.prototype.notifyParent = function(evt) {
            this.tabsRef.notifyChange(this, evt);
        };
        TabPaneComponent.prototype.handleSwipeLeft = function() {
            this.tabsRef.next();
        };
        TabPaneComponent.prototype.handleSwipeRight = function() {
            this.tabsRef.prev();
        };
        TabPaneComponent.prototype.handleEvent = function(node, eventName, callback, locals) {
            if (eventName !== "select") {
                _super.prototype.handleEvent.call(this, this.nativeElement, eventName, callback, locals);
            }
        };
        TabPaneComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "content") {
                if (this.isActive) {
                    setTimeout(function() {
                        return _this.$lazyLoad();
                    }, 100);
                }
            } else if (key === "show") {
                this.nativeElement.hidden = !nv;
                if (this._isFirstLoad) {
                    this.tabsRef.selectDefaultPaneByIndex(this.tabsRef.defaultpaneindex);
                }
                this._isFirstLoad = false;
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        TabPaneComponent.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.title = this.title || this.heading;
        };
        TabPaneComponent.prototype.ngAfterViewInit = function() {
            base.styler(this.nativeElement.querySelector(".tab-body"), this, base.APPLY_STYLES_TYPE.CONTAINER);
            _super.prototype.ngAfterViewInit.call(this);
        };
        TabPaneComponent.initializeProps = registerProps$1();
        TabPaneComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmTabPane]",
                template: '<div class="tab-body" partial-container-target [wmSmoothscroll]="smoothscroll">\n    <ng-content></ng-content>\n</div>',
                providers: [ base.provideAsWidgetRef(TabPaneComponent) ]
            } ]
        } ];
        TabPaneComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: TabsComponent
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "heading" ]
                } ]
            }, {
                type: undefined,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "title" ]
                } ]
            } ];
        };
        TabPaneComponent.propDecorators = {
            isActive: [ {
                type: core.HostBinding,
                args: [ "class.active" ]
            } ],
            disabled: [ {
                type: core.HostBinding,
                args: [ "class.disabled" ]
            } ],
            reDrawableComponents: [ {
                type: core.ContentChildren,
                args: [ base.RedrawableDirective, {
                    descendants: true
                } ]
            } ]
        };
        return TabPaneComponent;
    }(base.StylableComponent);
    var DEFAULT_CLS$1 = "app-tabs clearfix";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-tabs",
        hostClass: DEFAULT_CLS$1
    };
    var TabsComponent = function(_super) {
        __extends(TabsComponent, _super);
        function TabsComponent(inj, _transition, _tabsPosition) {
            var _this = this;
            var resolveFn = core$1.noop;
            _this = _super.call(this, inj, WIDGET_CONFIG$1, new Promise(function(res) {
                return resolveFn = res;
            })) || this;
            _this.transition = _transition;
            _this.tabsposition = _tabsPosition;
            _this.promiseResolverFn = resolveFn;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        TabsComponent.prototype.animateIn = function(element) {
            var tabHeader = $(element);
            tabHeader.siblings(".active").removeClass("active");
            tabHeader.addClass("active");
            var ul = this.nativeElement.querySelector("ul.nav.nav-tabs");
            var $prevHeaderEle = tabHeader.prev();
            if ($prevHeaderEle.length) {
                ul.scrollLeft = $prevHeaderEle[0].offsetLeft;
            } else {
                ul.scrollLeft = 0;
            }
        };
        TabsComponent.prototype.notifyChange = function(paneRef, evt) {
            if (!this.isSelectableTab(paneRef)) {
                return;
            }
            var headerElement;
            if (this.activeTab) {
                this.activeTab.deselect();
            }
            paneRef.invokeOnSelectCallback(evt);
            this.activeTab = paneRef.getWidget();
            var newPaneIndex = this.getPaneIndexByRef(paneRef);
            if (evt) {
                this.invokeEventCallback("change", {
                    $event: evt,
                    newPaneIndex: newPaneIndex,
                    oldPaneIndex: this._oldPaneIndex || 0
                });
            }
            this._oldPaneIndex = newPaneIndex;
            if (evt) {
                headerElement = $(evt.target).closest("li.tab-header");
            } else {
                headerElement = this.nativeElement.querySelector("li[data-paneid=" + paneRef.widgetId + "]");
            }
            this.animateIn(headerElement);
            if (this.canSlide()) {
                if (!this.tabsAnimator) {
                    this.tabsAnimator = new TabsAnimator(this);
                    this.tabsAnimator.setGesturesEnabled(this.canSlide());
                }
                this.tabsAnimator.transitionTabIntoView();
            }
        };
        TabsComponent.prototype.goToTab = function(tabIndex) {
            if (this.isValidPaneIndex(tabIndex - 1)) {
                var tab = this.getPaneRefByIndex(tabIndex - 1);
                tab.select();
            }
        };
        TabsComponent.prototype.getPaneIndexByRef = function(paneRef) {
            return this.panes.toArray().indexOf(paneRef);
        };
        TabsComponent.prototype.getActiveTabIndex = function() {
            return _.findIndex(this.panes.toArray(), {
                isActive: true
            });
        };
        TabsComponent.prototype.isValidPaneIndex = function(index) {
            return index >= 0 && index < this.panes.length;
        };
        TabsComponent.prototype.getPaneRefByIndex = function(index) {
            return this.panes.toArray()[index];
        };
        TabsComponent.prototype.isSelectableTab = function(paneRef) {
            return paneRef.show && !paneRef.disabled;
        };
        TabsComponent.prototype.canSlide = function() {
            return this.transition === "slide" && !this.vertical;
        };
        TabsComponent.prototype.getSelectableTabAfterIndex = function(index) {
            for (var i = index + 1; i < this.panes.length; i++) {
                var pane = this.getPaneRefByIndex(i);
                if (this.isSelectableTab(pane)) {
                    return pane;
                }
            }
        };
        TabsComponent.prototype.getSelectableTabBeforeIndex = function(index) {
            for (var i = index - 1; i >= 0; i--) {
                var pane = this.getPaneRefByIndex(i);
                if (this.isSelectableTab(pane)) {
                    return pane;
                }
            }
        };
        TabsComponent.prototype.next = function() {
            var pane = this.getSelectableTabAfterIndex(this.getActiveTabIndex());
            if (pane) {
                pane.select();
            }
        };
        TabsComponent.prototype.prev = function() {
            var pane = this.getSelectableTabBeforeIndex(this.getActiveTabIndex());
            if (pane) {
                pane.select();
            }
        };
        TabsComponent.prototype.selectDefaultPaneByIndex = function(index) {
            if (!this.isValidPaneIndex(index)) {
                return;
            }
            var paneRef = this.getPaneRefByIndex(index);
            if (!this.isSelectableTab(paneRef)) {
                paneRef = this.getSelectableTabAfterIndex(0);
            }
            if (paneRef) {
                paneRef.select();
            }
        };
        TabsComponent.prototype.setTabsPosition = function() {
            var ul = this.nativeElement.children[0];
            this.vertical = this.tabsposition === "left" || this.tabsposition === "right";
            core$1.removeClass(this.nativeElement, "inverted");
            if (this.tabsposition === "bottom" || this.tabsposition === "right") {
                core$1.appendNode(ul, this.nativeElement);
                core$1.addClass(this.nativeElement, "inverted");
            }
        };
        TabsComponent.prototype.onPropertyChange = function(key, nv, ov) {
            var _this = this;
            if (key === "defaultpaneindex") {
                setTimeout(function() {
                    return _this.selectDefaultPaneByIndex(nv || 0);
                }, 20);
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        TabsComponent.prototype.registerTabsScroll = function() {
            var _this = this;
            setTimeout(function() {
                var $ul = _this.$element.find("> ul");
                var $liPosition;
                var $li = $ul.children();
                $liPosition = $li.last().position();
                if ($liPosition && $liPosition.left > $ul.width()) {
                    $ul.on("mousewheel", function(e) {
                        var left = $ul[0].scrollLeft, _delta = -1 * e.originalEvent.wheelDelta;
                        e.stopPropagation();
                        e.preventDefault();
                        $ul.animate({
                            scrollLeft: left + _delta
                        }, {
                            duration: 10
                        });
                    });
                }
            });
        };
        TabsComponent.prototype.ngAfterContentInit = function() {
            this.promiseResolverFn();
            _super.prototype.ngAfterContentInit.call(this);
            this.setTabsPosition();
        };
        TabsComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            this.registerTabsScroll();
        };
        TabsComponent.initializeProps = registerProps();
        TabsComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmTabs]",
                template: '<ul class="nav nav-tabs" [ngClass]="{\'nav-stacked\': vertical, \'nav-justified\': justified}" role="tablist">\n    <li class="tab-header" *ngFor="let pane of panes;" [attr.data-paneid]="pane.widgetId" [ngClass]="{\'active\': pane.isActive, \'disabled\': pane.disabled}"\n        [hidden]="!pane.show" (click)="pane.select($event)" role="tab">\n        <a href="javascript:void(0);" role="button" [attr.aria-label]="pane.title" [attr.title]="pane.title" [tabindex]="pane.tabindex">\n            <div class="tab-heading">\n                <i [ngClass]="[\'app-icon\', pane.paneicon]" *ngIf="pane.paneicon"></i>\n                <span [textContent]="pane.title"></span>\n                <span *ngIf="pane.badgevalue" class="label label-{{pane.badgetype}}" [textContent]="pane.badgevalue"></span>\n            </div>\n        </a>\n    </li>\n</ul>\n<div class="tab-content" [ngClass]="{\'tab-stacked\': vertical, \'tab-justified\': justified}">\n    <ng-content select="div[wmTabPane]"></ng-content>\n</div>\n',
                providers: [ base.provideAsWidgetRef(TabsComponent) ]
            } ]
        } ];
        TabsComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "transition" ]
                } ]
            }, {
                type: String,
                decorators: [ {
                    type: core.Attribute,
                    args: [ "tabsposition" ]
                } ]
            } ];
        };
        TabsComponent.propDecorators = {
            panes: [ {
                type: core.ContentChildren,
                args: [ TabPaneComponent ]
            } ]
        };
        return TabsComponent;
    }(base.StylableComponent);
    var components = [ TabPaneComponent, TabsComponent ];
    var TabsModule = function() {
        function TabsModule() {}
        TabsModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return TabsModule;
    }();
    exports.\u0275a = TabPaneComponent;
    exports.\u0275d = registerProps$1;
    exports.\u0275b = TabsComponent;
    exports.\u0275c = registerProps;
    exports.TabsModule = TabsModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/containers/tile", [ "exports", "@angular/common", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.containers = global.wm.components.containers || {}, 
    global.wm.components.containers.tile = {}), global.ng.common, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-tile", new Map([ [ "animation", base.PROP_STRING ], [ "class", base.PROP_STRING ], [ "conditionalclass", base.PROP_ANY ], [ "conditionalstyle", base.PROP_ANY ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS = "app-tile";
    var WIDGET_CONFIG = {
        widgetType: "wm-tile",
        hostClass: DEFAULT_CLS
    };
    var TileDirective = function(_super) {
        __extends(TileDirective, _super);
        function TileDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        TileDirective.initializeProps = registerProps();
        TileDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmTile]",
                providers: [ base.provideAsWidgetRef(TileDirective) ]
            } ]
        } ];
        TileDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return TileDirective;
    }(base.StylableComponent);
    var components = [ TileDirective ];
    var TileModule = function() {
        function TileModule() {}
        TileModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return TileModule;
    }();
    exports.\u0275a = TileDirective;
    exports.\u0275b = registerProps;
    exports.TileModule = TileModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@wm/core"), require("@angular/core"), require("@angular/forms"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/containers/wizard", [ "exports", "@angular/common", "@wm/core", "@angular/core", "@angular/forms", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.containers = global.wm.components.containers || {}, 
    global.wm.components.containers.wizard = {}), global.ng.common, global.wm.core, global.ng.core, global.ng.forms, global.wm.components.base);
})(this, function(exports, common, core, core$1, forms, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m) return m.call(o);
        return {
            next: function() {
                if (o && i >= o.length) o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-wizard", new Map([ [ "actionsalignment", __assign({
            value: "right"
        }, base.PROP_STRING) ], [ "cancelable", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "cancelbtnlabel", __assign({
            value: "Cancel"
        }, base.PROP_STRING) ], [ "class", base.PROP_STRING ], [ "defaultstep", __assign({
            value: "none"
        }, base.PROP_STRING) ], [ "donebtnlabel", __assign({
            value: "Done"
        }, base.PROP_STRING) ], [ "name", base.PROP_STRING ], [ "nextbtnlabel", __assign({
            value: "Next"
        }, base.PROP_STRING) ], [ "previousbtnlabel", __assign({
            value: "Previous"
        }, base.PROP_STRING) ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "stepstyle", __assign({
            value: "auto"
        }, base.PROP_STRING) ] ]));
    };
    var registerProps$1 = function() {
        base.register("wm-wizardstep", new Map([ [ "class", base.PROP_STRING ], [ "enableskip", __assign({
            value: false
        }, base.PROP_BOOLEAN) ], [ "iconclass", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ], [ "title", __assign({
            value: "Step Title"
        }, base.PROP_STRING) ] ]));
    };
    var DEFAULT_CLS = "app-wizard-step-content";
    var WIDGET_CONFIG = {
        widgetType: "wm-wizardstep",
        hostClass: DEFAULT_CLS
    };
    var WizardStepDirective = function(_super) {
        __extends(WizardStepDirective, _super);
        function WizardStepDirective(inj, ngForm) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.ngForm = ngForm;
            _this.status = 2;
            return _this;
        }
        Object.defineProperty(WizardStepDirective.prototype, "isCurrent", {
            get: function() {
                return this.active;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardStepDirective.prototype, "isValid", {
            get: function() {
                return this.ngForm.valid && this.areEmbeddedFormsValid();
            },
            enumerable: true,
            configurable: true
        });
        WizardStepDirective.prototype.areEmbeddedFormsValid = function() {
            var e_1, _a;
            var embeddedForms = this.getAllEmbeddedForms();
            try {
                for (var embeddedForms_1 = __values(embeddedForms), embeddedForms_1_1 = embeddedForms_1.next(); !embeddedForms_1_1.done; embeddedForms_1_1 = embeddedForms_1.next()) {
                    var form = embeddedForms_1_1.value;
                    if (!form.widget.ngform.valid) {
                        return false;
                    }
                }
            } catch (e_1_1) {
                e_1 = {
                    error: e_1_1
                };
            } finally {
                try {
                    if (embeddedForms_1_1 && !embeddedForms_1_1.done && (_a = embeddedForms_1.return)) _a.call(embeddedForms_1);
                } finally {
                    if (e_1) throw e_1.error;
                }
            }
            return true;
        };
        WizardStepDirective.prototype.getAllEmbeddedForms = function() {
            return this.$element.find("form");
        };
        Object.defineProperty(WizardStepDirective.prototype, "enableNext", {
            get: function() {
                return !this.disablenext;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardStepDirective.prototype, "enableDone", {
            get: function() {
                return !this.disabledone;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardStepDirective.prototype, "enablePrev", {
            get: function() {
                return !this.disableprevious;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardStepDirective.prototype, "active", {
            get: function() {
                return this.status === 1;
            },
            set: function(nv) {
                var isActive = this.active;
                this.status = 1;
                if (nv && !isActive) {
                    this.redrawChildren();
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardStepDirective.prototype, "done", {
            get: function() {
                return this.status === 3;
            },
            set: function(nv) {
                if (nv) {
                    this.status = 3;
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardStepDirective.prototype, "disabled", {
            get: function() {
                return this.status === 2;
            },
            set: function(nv) {
                if (nv) {
                    this.status = 2;
                }
            },
            enumerable: true,
            configurable: true
        });
        WizardStepDirective.prototype.onNext = function(index) {
            return this.invokeEventCallback("next", {
                currentStep: this,
                stepIndex: index
            });
        };
        WizardStepDirective.prototype.onPrev = function(index) {
            return this.invokeEventCallback("prev", {
                currentStep: this,
                stepIndex: index
            });
        };
        WizardStepDirective.prototype.onSkip = function(index) {
            return this.invokeEventCallback("skip", {
                currentStep: this,
                stepIndex: index
            });
        };
        WizardStepDirective.prototype.redrawChildren = function() {
            var _this = this;
            setTimeout(function() {
                if (_this.reDrawableComponents) {
                    _this.reDrawableComponents.forEach(function(c) {
                        return c.redraw();
                    });
                }
                _this.invokeEventCallback("load");
            }, 100);
        };
        WizardStepDirective.initializeProps = registerProps$1();
        WizardStepDirective.decorators = [ {
            type: core$1.Directive,
            args: [ {
                selector: "form[wmWizardStep]",
                providers: [ base.provideAsWidgetRef(WizardStepDirective) ],
                exportAs: "wmWizardStep"
            } ]
        } ];
        WizardStepDirective.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            }, {
                type: forms.NgForm,
                decorators: [ {
                    type: core$1.Self
                } ]
            } ];
        };
        WizardStepDirective.propDecorators = {
            reDrawableComponents: [ {
                type: core$1.ContentChildren,
                args: [ base.RedrawableDirective, {
                    descendants: true
                } ]
            } ],
            isCurrent: [ {
                type: core$1.HostBinding,
                args: [ "class.current" ]
            } ]
        };
        return WizardStepDirective;
    }(base.BaseComponent);
    var DEFAULT_CLS$1 = "app-wizard panel clearfix";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-wizard",
        hostClass: DEFAULT_CLS$1
    };
    var WizardComponent = function(_super) {
        __extends(WizardComponent, _super);
        function WizardComponent(inj) {
            var _this = this;
            var resolveFn = core.noop;
            _this = _super.call(this, inj, WIDGET_CONFIG$1, new Promise(function(res) {
                return resolveFn = res;
            })) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.SHELL);
            _this.promiseResolverFn = resolveFn;
            _this.message = {
                caption: "",
                type: ""
            };
            return _this;
        }
        Object.defineProperty(WizardComponent.prototype, "hasPrevStep", {
            get: function() {
                return !this.isFirstStep(this.currentStep);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardComponent.prototype, "hasNextStep", {
            get: function() {
                return !this.isLastStep(this.currentStep);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardComponent.prototype, "showDoneBtn", {
            get: function() {
                if (!this.currentStep) {
                    return;
                }
                return !this.hasNextStep && this.currentStep.enableDone;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardComponent.prototype, "enablePrev", {
            get: function() {
                if (!this.currentStep) {
                    return;
                }
                return this.currentStep.enablePrev;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardComponent.prototype, "enableNext", {
            get: function() {
                if (!this.currentStep) {
                    return;
                }
                return this.currentStep.enableNext && this.currentStep.isValid;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(WizardComponent.prototype, "enableDone", {
            get: function() {
                if (!this.currentStep) {
                    return;
                }
                return this.currentStep.enableDone && this.currentStep.isValid;
            },
            enumerable: true,
            configurable: true
        });
        WizardComponent.prototype.getNextValidStepFormIndex = function(index) {
            for (var i = index; i < this.steps.length; i++) {
                var step = this.getStepRefByIndex(i);
                if (step.show) {
                    return step;
                }
            }
        };
        WizardComponent.prototype.getPreviousValidStepFormIndex = function(index) {
            for (var i = index; i >= 0; i--) {
                var step = this.getStepRefByIndex(i);
                if (step.show) {
                    return step;
                }
            }
        };
        WizardComponent.prototype.getCurrentStepIndex = function() {
            return this.getStepIndexByRef(this.currentStep);
        };
        WizardComponent.prototype.getStepRefByIndex = function(index) {
            return this.steps.toArray()[index];
        };
        WizardComponent.prototype.getStepIndexByRef = function(wizardStep) {
            return this.steps.toArray().indexOf(wizardStep);
        };
        WizardComponent.prototype.getStepRefByName = function(name) {
            return this.steps.find(function(step) {
                return step.name === name;
            });
        };
        WizardComponent.prototype.setDefaultStep = function(step) {
            if (step && step.show) {
                this.currentStep = step;
                step.active = true;
                step.isInitialized = true;
                var index = this.getStepIndexByRef(step) - 1;
                while (index >= 0) {
                    var prevStep = this.getStepRefByIndex(index);
                    prevStep.done = true;
                    prevStep.isInitialized = true;
                    index--;
                }
            } else {
                step = this.getNextValidStepFormIndex(0);
                if (step) {
                    this.setDefaultStep(step);
                }
            }
        };
        WizardComponent.prototype.onWizardHeaderClick = function($event, currentStep) {
            var _this = this;
            if (currentStep.done) {
                this.steps.forEach(function(step, index) {
                    if (index < _this.getStepIndexByRef(currentStep)) {
                        step.done = true;
                    } else {
                        step.disabled = true;
                    }
                });
                this.currentStep = currentStep;
                this.currentStep.active = true;
            }
        };
        WizardComponent.prototype.next = function(eventName) {
            if (eventName === void 0) {
                eventName = "next";
            }
            var currentStep = this.currentStep;
            var currentStepIndex = this.getCurrentStepIndex();
            var nextStep;
            if (eventName === "skip") {
                if (currentStep.onSkip(currentStepIndex) === false) {
                    return;
                }
            } else if (eventName === "next") {
                if (currentStep.onNext(currentStepIndex) === false) {
                    return;
                }
            }
            nextStep = this.getNextValidStepFormIndex(currentStepIndex + 1);
            nextStep.isInitialized = true;
            if (nextStep) {
                currentStep.done = true;
                nextStep.active = true;
                this.currentStep = nextStep;
            }
        };
        WizardComponent.prototype.prev = function() {
            var currentStep = this.currentStep;
            var currentStepIndex = this.getCurrentStepIndex();
            var prevStep;
            if (currentStep.onPrev(currentStepIndex) === false) {
                return;
            }
            prevStep = this.getPreviousValidStepFormIndex(currentStepIndex - 1);
            if (prevStep) {
                currentStep.disabled = true;
                prevStep.active = true;
                this.currentStep = prevStep;
            }
        };
        WizardComponent.prototype.skip = function() {
            this.next("skip");
        };
        WizardComponent.prototype.done = function() {
            this.invokeEventCallback("done", {
                steps: this.steps.toArray()
            });
        };
        WizardComponent.prototype.cancel = function() {
            this.invokeEventCallback("cancel", {
                steps: this.steps.toArray()
            });
        };
        WizardComponent.prototype.isFirstStep = function(stepRef) {
            return this.steps.first === stepRef;
        };
        WizardComponent.prototype.isLastStep = function(stepRef) {
            return this.steps.last === stepRef;
        };
        WizardComponent.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "stepstyle") {
                this.stepClass = nv === "justified" ? "nav-justified" : "";
            } else if (key === "defaultstep") {
                this.setDefaultStep(this.getStepRefByName(nv));
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        WizardComponent.prototype.ngAfterContentInit = function() {
            _super.prototype.ngAfterContentInit.call(this);
            this.promiseResolverFn();
        };
        WizardComponent.prototype.ngAfterViewInit = function() {
            _super.prototype.ngAfterViewInit.call(this);
            base.styler(this.nativeElement.querySelector(".panel-body"), this, base.APPLY_STYLES_TYPE.INNER_SHELL);
        };
        WizardComponent.initializeProps = registerProps();
        WizardComponent.decorators = [ {
            type: core$1.Component,
            args: [ {
                selector: "div[wmWizard]",
                template: '<div class="app-wizard-heading" role="tab">\n    <ul class="app-wizard-steps nav nav-pills {{stepClass}}">\n        <li class="app-wizard-step" *ngFor="let step of steps" [hidden]="!step.show"\n            [ngClass]="{active: step.done, current: step.active, disabled: step.disabled}"\n            (click)="onWizardHeaderClick($event, step)">\n            <a href="javascript:void(0)" [attr.aria-label]="step.title" [attr.title]="step.title">\n                <span class="arrow"></span>\n                <i class="app-icon {{step.iconclass}}" *ngIf="step.iconclass"></i>\n                <span class="step-title" [textContent]="step.title"></span>\n            </a>\n        </li>\n    </ul>\n</div>\n<div class="app-wizard-body panel-body" role="tabpanel">\n    <p wmMessage *ngIf="message.caption" caption.bind="message.caption" type.bind="message.type"></p>\n    <ng-content select="form[wmWizardStep]"></ng-content>\n</div>\n<div class="app-wizard-actions panel-footer {{actionsalignment}}">\n    <a class="app-wizard-skip" name="skipStep_{{name}}" *ngIf="currentStep?.enableskip" title="Skip step" (click)="skip()">Skip &raquo;</a>\n    <div class="app-wizard-actions-right">\n        <button type="button" name="cancelBtn_{{name}}" class="btn app-button btn-secondary" *ngIf="cancelable"\n                (click)="cancel()" [title]="cancelbtnlabel" [textContent]="cancelbtnlabel"></button>\n        <button type="button" name="previousBtn_{{name}}" class="btn app-button btn-secondary"\n                *ngIf="hasPrevStep" (click)="prev()" [disabled]="!enablePrev">\n            <i class="app-icon wi wi-chevron-left"></i>\n            <span class="btn-caption" [textContent]="previousbtnlabel"></span>\n        </button>\n        <button type="button" name="nextBtn_{{name}}" class="btn app-button btn-primary"\n                *ngIf="hasNextStep" (click)="next()" [disabled]="!enableNext">\n            <span class="btn-caption" [textContent]="nextbtnlabel"></span>\n            <i class="app-icon wi wi-chevron-right"></i>\n        </button>\n        <button type="button" name="doneBtn_{{name}}" class="btn app-button btn-success"\n                *ngIf="showDoneBtn" (click)="done()"\n                [disabled]="!enableDone">\n            <i class="app-icon wi wi-done"></i>\n            <span class="btn-caption" [textContent]="donebtnlabel"></span>\n        </button>\n    </div>\n</div>\n',
                providers: [ base.provideAsWidgetRef(WizardComponent) ]
            } ]
        } ];
        WizardComponent.ctorParameters = function() {
            return [ {
                type: core$1.Injector
            } ];
        };
        WizardComponent.propDecorators = {
            steps: [ {
                type: core$1.ContentChildren,
                args: [ WizardStepDirective ]
            } ]
        };
        return WizardComponent;
    }(base.StylableComponent);
    var components = [ WizardStepDirective, WizardComponent ];
    var WizardModule = function() {
        function WizardModule() {}
        WizardModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return WizardModule;
    }();
    exports.\u0275a = WizardStepDirective;
    exports.\u0275b = registerProps$1;
    exports.\u0275c = WizardComponent;
    exports.\u0275d = registerProps;
    exports.WizardModule = WizardModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("ngx-bootstrap/carousel"), require("@swipey"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/advanced/carousel", [ "exports", "@angular/common", "ngx-bootstrap/carousel", "@swipey", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.advanced = global.wm.components.advanced || {}, 
    global.wm.components.advanced.carousel = {}), global.ng.common, global.ngxBootstrap, global.swipey, global.ng.core, global.wm.components.base);
})(this, function(exports, common, carousel, _swipey, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-carousel", new Map([ [ "animation", __assign({
            value: "auto"
        }, base.PROP_STRING) ], [ "animationinterval", __assign({
            value: 3
        }, base.PROP_NUMBER) ], [ "controls", __assign({
            value: "both"
        }, base.PROP_STRING) ], [ "dataset", base.PROP_ANY ], [ "nodatamessage", __assign({
            value: "No Data Found"
        }, base.PROP_STRING) ], [ "show", base.PROP_BOOLEAN ] ]));
    };
    var CarouselAnimator = function(_super) {
        __extends(CarouselAnimator, _super);
        function CarouselAnimator(carousel$$1, interval, ngZone) {
            var _this = _super.call(this) || this;
            _this.carousel = carousel$$1;
            _this.interval = interval;
            _this.ngZone = ngZone;
            _this._activeIndex = 0;
            _this._animationPaused = false;
            _this._pauseCaroselTill = 0;
            _this._oldIndex = 0;
            var self = _this;
            _this._$el = $(_this.carousel.getNativeElement()).find(">.carousel");
            _this.init(_this._$el.find(">.carousel-inner"));
            _this._items = _this._$el.find(">.carousel-inner >.carousel-item");
            _this._indicators = _this._$el.find(">.carousel-indicators");
            _this._indicators.find("li").each(function(i) {
                $(this).on("click", function() {
                    self._activeIndex = i;
                    self.setActiveItem();
                });
            });
            _this._$el.find(">.left.carousel-control").on("click", function() {
                _this._pauseCaroselTill = Date.now() + _this.interval;
                _this.goToUpper();
            });
            _this._$el.find(">.right.carousel-control").on("click", function() {
                _this._pauseCaroselTill = Date.now() + _this.interval;
                _this.goToLower();
            });
            _this.setActiveItem();
            if (_this.interval) {
                _this.start();
            }
            return _this;
        }
        CarouselAnimator.prototype.bounds = function() {
            this._width = this._items.width();
            this._swiping = true;
            return {
                lower: -this._width,
                center: 0,
                upper: this._width
            };
        };
        CarouselAnimator.prototype.context = function() {
            return {
                w: this._width
            };
        };
        CarouselAnimator.prototype.animation = function() {
            return [ {
                target: this.getTarget.bind(this),
                css: {
                    transform: "translate3d(${{ (($D + $d) / w) * 100 + '%'}}, 0, 0)",
                    "-webkit-transform": "translate3d(${{ (($D + $d) / w) * 100 + '%'}}, 0, 0)"
                }
            } ];
        };
        CarouselAnimator.prototype.onUpper = function() {
            this.resetTransition();
            this._activeIndex -= 1;
            this.setActiveItem();
            this._swiping = false;
        };
        CarouselAnimator.prototype.onLower = function() {
            this.resetTransition();
            this._activeIndex += 1;
            this.setActiveItem();
            this._swiping = false;
        };
        CarouselAnimator.prototype.onAnimation = function() {
            var newIndex = (this._items.length + this._activeIndex) % this._items.length;
            this.carousel.onChangeCB(newIndex, this._oldIndex);
            this._oldIndex = newIndex;
        };
        CarouselAnimator.prototype.start = function() {
            var _this = this;
            this.ngZone.runOutsideAngular(function() {
                _this._intervalId = setInterval(function() {
                    if (!_this._swiping && _this._pauseCaroselTill < Date.now()) {
                        _this.goToLower(600);
                    }
                }, _this.interval);
            });
        };
        CarouselAnimator.prototype.pause = function() {
            this._animationPaused = true;
            if (!this._intervalId) {
                this.start();
            }
        };
        CarouselAnimator.prototype.resume = function() {
            this._animationPaused = false;
        };
        CarouselAnimator.prototype.stop = function() {
            if (this._intervalId) {
                clearInterval(this._intervalId);
                this._intervalId = 0;
            }
        };
        CarouselAnimator.prototype.threshold = function() {
            return 5;
        };
        CarouselAnimator.prototype.getTarget = function() {
            var noOfItems = this._items.length, activeItem = this._items.eq((noOfItems + this._activeIndex) % noOfItems), leftItem = this._items.eq((noOfItems + this._activeIndex - 1) % noOfItems), rightItem = this._items.eq((noOfItems + this._activeIndex + 1) % noOfItems);
            return activeItem.add(rightItem).add(leftItem);
        };
        CarouselAnimator.prototype.resetTransition = function() {
            this.getTarget().css({
                "-webkit-transition": "none",
                "-webkit-transform": "",
                transition: "none",
                transform: ""
            });
        };
        CarouselAnimator.prototype.setActiveItem = function() {
            var items = this._items, left = this._activeIndex - 1, right = this._activeIndex + 1;
            if (items.length === 1) {
                items.eq(0).removeClass("left-item right-item");
                return;
            }
            this._indicators.find(">.active").removeClass("active");
            this._indicators.find("> li").eq((items.length + this._activeIndex) % items.length).addClass("active");
            items.filter(".active").removeClass("active");
            items.addClass("left-item");
            items.eq((items.length + left) % items.length).addClass("left-item").removeClass("right-item");
            items.eq((items.length + this._activeIndex) % items.length).removeClass("left-item right-item").addClass("active");
            items.eq((items.length + right) % items.length).addClass("right-item").removeClass("left-item");
        };
        return CarouselAnimator;
    }(_swipey.SwipeAnimation);
    var WIDGET_CONFIG = {
        widgetType: "wm-carousel"
    };
    var navigationClassMap = {
        indicators: "hide-navs",
        navs: "hide-indicators",
        none: "hide-both"
    };
    var CarouselDirective = function(_super) {
        __extends(CarouselDirective, _super);
        function CarouselDirective(component, inj, ngZone) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            _this.component = component;
            _this.ngZone = ngZone;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        CarouselDirective.prototype.onDataChange = function(newVal) {
            this.fieldDefs = base.createArrayFrom(newVal);
        };
        CarouselDirective.prototype.stopAnimation = function() {
            if (this.animator) {
                this.animator.stop();
            }
        };
        CarouselDirective.prototype.startAnimation = function() {
            if (this.animator) {
                this.animator.interval = this.animationinterval * 1e3;
                this.animator.start();
            }
        };
        CarouselDirective.prototype.onSlidesRender = function(slides) {
            var _this = this;
            if (this.fieldDefs && this.fieldDefs.length) {
                this.currentslide = this.fieldDefs[0];
            }
            setTimeout(function() {
                _this.animator = new CarouselAnimator(_this, _this.interval, _this.ngZone);
            }, 50);
        };
        CarouselDirective.prototype.setupHandlers = function() {
            var _this = this;
            this.slides.changes.subscribe(function(slides) {
                _this.stopAnimation();
                _this.onSlidesRender(slides);
            });
            this.slides.setDirty();
        };
        CarouselDirective.prototype.onChangeCB = function(newIndex, oldIndex) {
            this.currentslide = this.fieldDefs && this.fieldDefs[newIndex];
            this.previousslide = this.fieldDefs && this.fieldDefs[oldIndex];
            this.invokeEventCallback("change", {
                newIndex: newIndex,
                oldIndex: oldIndex
            });
        };
        CarouselDirective.prototype.ngAfterContentInit = function() {
            this.setupHandlers();
        };
        CarouselDirective.prototype.ngOnDestroy = function() {
            this.stopAnimation();
            _super.prototype.ngOnDestroy.call(this);
        };
        CarouselDirective.prototype.ngOnInit = function() {
            _super.prototype.ngOnInit.call(this);
            this.animation === "auto" ? this.interval = this.animationinterval * 1e3 : this.interval = 0;
        };
        CarouselDirective.prototype.onPropertyChange = function(key, nv, ov) {
            if (key === "dataset") {
                this.onDataChange(nv);
            } else if (key === "controls") {
                this.navigationClass = navigationClassMap[this.controls];
            } else if (key === "animation" || key === "animationinterval") {
                this.animation === "none" ? this.stopAnimation() : this.startAnimation();
            } else {
                _super.prototype.onPropertyChange.call(this, key, nv, ov);
            }
        };
        CarouselDirective.initializeProps = registerProps();
        CarouselDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmCarousel]",
                exportAs: "wmCarousel"
            } ]
        } ];
        CarouselDirective.ctorParameters = function() {
            return [ {
                type: carousel.CarouselComponent
            }, {
                type: core.Injector
            }, {
                type: core.NgZone
            } ];
        };
        CarouselDirective.propDecorators = {
            slides: [ {
                type: core.ContentChildren,
                args: [ carousel.SlideComponent ]
            } ]
        };
        return CarouselDirective;
    }(base.StylableComponent);
    var registerProps$1 = function() {
        base.register("wm-carousel-template", new Map([ [ "show", base.PROP_BOOLEAN ] ]));
    };
    var DEFAULT_CLS = "app-carousel-item";
    var WIDGET_CONFIG$1 = {
        widgetType: "wm-carousel-template",
        hostClass: DEFAULT_CLS
    };
    var CarouselTemplateDirective = function(_super) {
        __extends(CarouselTemplateDirective, _super);
        function CarouselTemplateDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG$1) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        CarouselTemplateDirective.initializeProps = registerProps$1();
        CarouselTemplateDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmCarouselTemplate]"
            } ]
        } ];
        CarouselTemplateDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return CarouselTemplateDirective;
    }(base.StylableComponent);
    var components = [ CarouselDirective, CarouselTemplateDirective ];
    var CarouselModule = function() {
        function CarouselModule() {}
        CarouselModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, carousel.CarouselModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return CarouselModule;
    }();
    exports.\u0275c = CarouselTemplateDirective;
    exports.\u0275d = registerProps$1;
    exports.\u0275a = CarouselDirective;
    exports.\u0275b = registerProps;
    exports.CarouselModule = CarouselModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/advanced/marquee", [ "exports", "@angular/common", "@angular/core", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.advanced = global.wm.components.advanced || {}, 
    global.wm.components.advanced.marquee = {}), global.ng.common, global.ng.core, global.wm.components.base);
})(this, function(exports, common, core, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-marquee", new Map([ [ "class", base.PROP_STRING ], [ "direction", base.PROP_STRING ], [ "name", base.PROP_STRING ], [ "scrollamount", base.PROP_NUMBER ], [ "scrolldelay", base.PROP_NUMBER ], [ "show", __assign({
            value: true
        }, base.PROP_BOOLEAN) ] ]));
    };
    var DEFAULT_CLS = "app-marquee app-container";
    var WIDGET_CONFIG = {
        widgetType: "wm-marquee",
        hostClass: DEFAULT_CLS
    };
    var MarqueeDirective = function(_super) {
        __extends(MarqueeDirective, _super);
        function MarqueeDirective(inj) {
            var _this = _super.call(this, inj, WIDGET_CONFIG) || this;
            base.styler(_this.nativeElement, _this);
            return _this;
        }
        MarqueeDirective.initializeProps = registerProps();
        MarqueeDirective.decorators = [ {
            type: core.Directive,
            args: [ {
                selector: "[wmMarquee]",
                providers: [ base.provideAsWidgetRef(MarqueeDirective) ]
            } ]
        } ];
        MarqueeDirective.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        return MarqueeDirective;
    }(base.StylableComponent);
    var components = [ MarqueeDirective ];
    var MarqueeModule = function() {
        function MarqueeModule() {}
        MarqueeModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return MarqueeModule;
    }();
    exports.\u0275a = MarqueeDirective;
    exports.\u0275b = registerProps;
    exports.MarqueeModule = MarqueeModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/common"), require("@angular/core"), require("@wm/components/data/form"), require("@wm/components/input"), require("@wm/components/base")) : typeof define === "function" && define.amd ? define("@wm/components/advanced/login", [ "exports", "@angular/common", "@angular/core", "@wm/components/data/form", "@wm/components/input", "@wm/components/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.components = global.wm.components || {}, global.wm.components.advanced = global.wm.components.advanced || {}, 
    global.wm.components.advanced.login = {}), global.ng.common, global.ng.core, global.wm.components.data.form, global.wm.components.input, global.wm.components.base);
})(this, function(exports, common, core, form, input, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var registerProps = function() {
        base.register("wm-login", new Map([ [ "errormessage", base.PROP_STRING ], [ "eventsource", base.PROP_ANY ] ]));
    };
    var WIDGET_INFO = {
        widgetType: "wm-login",
        hostClass: "app-login"
    };
    var LoginComponent = function(_super) {
        __extends(LoginComponent, _super);
        function LoginComponent(inj) {
            var _this = _super.call(this, inj, WIDGET_INFO) || this;
            base.styler(_this.nativeElement, _this, base.APPLY_STYLES_TYPE.CONTAINER);
            return _this;
        }
        LoginComponent.prototype.onSuccessCB = function() {
            this.invokeEventCallback("success");
        };
        LoginComponent.prototype.onErrorCB = function(error) {
            this.loginMessage = {
                type: "error",
                caption: this.errormessage || error || this.appLocale.LABEL_INVALID_USERNAME_OR_PASSWORD,
                show: true
            };
            this.messageCmp.showMessage(this.loginMessage.caption, this.loginMessage.type);
            this.invokeEventCallback("error");
        };
        LoginComponent.prototype.getLoginDetails = function() {
            return this.formCmp.dataoutput;
        };
        LoginComponent.prototype.doLogin = function() {
            if (this.eventsource) {
                this.eventsource.invoke({
                    loginInfo: this.getLoginDetails()
                }, this.onSuccessCB.bind(this), this.onErrorCB.bind(this));
            } else {
                console.warn('Default action "loginAction" does not exist. Either create the Action or assign an event to onSubmit of the login widget');
            }
        };
        LoginComponent.prototype.initLoginButtonActions = function() {
            var _this = this;
            this.loginBtnCmp.getNativeElement().addEventListener("click", function(event) {
                if (!_this.nativeElement.hasAttribute("submit.event") && !_this.loginBtnCmp.getNativeElement().hasAttribute("click.event") && !_this.loginBtnCmp.getNativeElement().hasAttribute("tap.event")) {
                    _this.doLogin();
                }
            });
        };
        LoginComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            this.formCmp.getNativeElement().addEventListener("submit", function(e) {
                return e.preventDefault();
            });
            this.buttonComponents.forEach(function(cmp) {
                if (cmp.getNativeElement().getAttribute("name") === "loginButton" || _.includes(cmp.getNativeElement().classList, "app-login-button")) {
                    if (_this.loginBtnCmp) {
                        return;
                    }
                    _this.loginBtnCmp = cmp;
                    _this.initLoginButtonActions();
                }
            });
        };
        LoginComponent.initializeProps = registerProps();
        LoginComponent.decorators = [ {
            type: core.Component,
            args: [ {
                selector: "div[wmLogin]",
                template: '<p wmMessage class="app-login-message" #message show.bind="loginMessage.show" caption.bind="loginMessage.caption" type.bind="loginMessage.type"></p>\n<ng-content></ng-content>\n',
                providers: [ base.provideAsWidgetRef(LoginComponent) ]
            } ]
        } ];
        LoginComponent.ctorParameters = function() {
            return [ {
                type: core.Injector
            } ];
        };
        LoginComponent.propDecorators = {
            formCmp: [ {
                type: core.ContentChild,
                args: [ form.FormComponent ]
            } ],
            buttonComponents: [ {
                type: core.ContentChildren,
                args: [ input.ButtonComponent, {
                    descendants: true
                } ]
            } ],
            messageCmp: [ {
                type: core.ViewChild,
                args: [ base.MessageComponent ]
            } ]
        };
        return LoginComponent;
    }(base.StylableComponent);
    var components = [ LoginComponent ];
    var LoginModule = function() {
        function LoginModule() {}
        LoginModule.decorators = [ {
            type: core.NgModule,
            args: [ {
                imports: [ common.CommonModule, base.WmComponentsModule ],
                declarations: __spread(components),
                exports: __spread(components),
                entryComponents: []
            } ]
        } ];
        return LoginModule;
    }();
    exports.\u0275a = LoginComponent;
    exports.\u0275b = registerProps;
    exports.LoginModule = LoginModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("angular2-websocket/angular2-websocket"), require("@angular/router"), require("@wm/core"), require("@angular/core"), require("@angular/common"), require("@angular/common/http"), require("ngx-toastr"), require("@wm/http"), require("@wm/security"), require("@wm/oAuth")) : typeof define === "function" && define.amd ? define("@wm/variables", [ "exports", "angular2-websocket/angular2-websocket", "@angular/router", "@wm/core", "@angular/core", "@angular/common", "@angular/common/http", "ngx-toastr", "@wm/http", "@wm/security", "@wm/oAuth" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.variables = {}), global.angularWebSocket, global.ng.router, global.wm.core, global.ng.core, global.ng.common, global.ng.common.http, global.ngxToastr, global.wm.http, global.wm.security, global.wm.oAuth);
})(this, function(exports, angular2Websocket, router, core, core$1, common, http, ngxToastr, http$1, security, oAuth) {
    "use strict";
    var CONSTANTS = {
        hasCordova: window["cordova"] !== undefined,
        isWaveLens: window["WaveLens"] !== undefined,
        isStudioMode: false,
        isRunMode: true,
        XSRF_COOKIE_NAME: "wm_xsrf_token",
        DEFAULT_TIMER_DELAY: 500,
        WIDGET_DOESNT_EXIST: "The widget you're trying to navigate to doesn't exist on this page"
    };
    var VARIABLE_CONSTANTS = {
        CATEGORY: {
            MODEL: "wm.Variable",
            LIVE: "wm.LiveVariable",
            SERVICE: "wm.ServiceVariable",
            WEBSOCKET: "wm.WebSocketVariable",
            NAVIGATION: "wm.NavigationVariable",
            NOTIFICATION: "wm.NotificationVariable",
            TIMER: "wm.TimerVariable",
            LOGIN: "wm.LoginVariable",
            LOGOUT: "wm.LogoutVariable",
            DEVICE: "wm.DeviceVariable"
        },
        EVENTS: [ "onBefore", "onBeforeUpdate", "onResult", "onBeforeOpen", "onOpen", "onBeforeMessageSend", "onMessageReceive", "onProgress", "onError", "onBeforeDatasetReady", "onCanUpdate", "onClick", "onHide", "onOk", "onCancel", "onBeforeClose", "onClose", "onTimerFire", "onSuccess", "onOnline", "onOffline" ],
        EVENT: {
            CAN_UPDATE: "onCanUpdate",
            BEFORE: "onBefore",
            BEFORE_UPDATE: "onBeforeUpdate",
            PREPARE_SETDATA: "onBeforeDatasetReady",
            RESULT: "onResult",
            ERROR: "onError",
            ABORT: "onAbort",
            PROGRESS: "onProgress",
            CLICK: "onClick",
            HIDE: "onHide",
            OK: "onOk",
            CANCEL: "onCancel",
            CLOSE: "onClose",
            TIMER_FIRE: "onTimerFire",
            SUCCESS: "onSuccess",
            BEFORE_OPEN: "onBeforeOpen",
            OPEN: "onOpen",
            BEFORE_SEND: "onBeforeMessageSend",
            MESSAGE_RECEIVE: "onMessageReceive",
            BEFORE_CLOSE: "onBeforeClose"
        },
        OWNER: {
            APP: "App",
            PAGE: "Page"
        },
        REST_SUPPORTED_SERVICES: [ "JavaService", "SoapService", "FeedService", "RestService", "SecurityServiceType", "DataService", "WebSocketService" ],
        PAGINATION_PARAMS: [ "page", "size", "sort" ],
        REST_SERVICE: {
            BASE_PATH_KEY: "x-WM-BASE_PATH",
            RELATIVE_PATH_KEY: "x-WM-RELATIVE_PATH",
            OAUTH_PROVIDER_KEY: "x-WM-PROVIDER_ID",
            AUTH_HDR_KEY: "Authorization",
            SECURITY_DEFN: {
                BASIC: "basic",
                OAUTH2: "oauth2"
            },
            AUTH_TYPE: {
                BASIC: "BASIC",
                OAUTH: "OAUTH2",
                NONE: "NONE"
            },
            CONTENT_TYPE_KEY: "x-WM-CONTENT_TYPE",
            ACCESSTOKEN_PLACEHOLDER: {
                LEFT: "",
                RIGHT: ".access_token"
            },
            ERR_TYPE: {
                NO_ACCESSTOKEN: "missing_accesstoken",
                NO_CREDENTIALS: "no_credentials",
                METADATA_MISSING: "metadata_missing",
                USER_UNAUTHORISED: "user_unauthorised",
                REQUIRED_FIELD_MISSING: "required_field_missing"
            },
            ERR_MSG: {
                NO_ACCESSTOKEN: "Access token missing",
                NO_CREDENTIALS: "No credentials present",
                METADATA_MISSING: "Metadata missing",
                USER_UNAUTHORISED: "Unauthorized User",
                REQUIRED_FIELD_MISSING: 'Required field(s) missing: "${0}"'
            },
            UNCLOAKED_HEADERS: [ "CONTENT-TYPE", "ACCEPT", "CONTENT-LENGTH", "ACCEPT-ENCODING", "ACCEPT-LANGUAGE" ],
            PREFIX: {
                AUTH_HDR_VAL: {
                    BASIC: "Basic",
                    OAUTH: "Bearer"
                },
                CLOAK_HEADER_KEY: "X-WM-"
            }
        },
        SERVICE_TYPE: {
            JAVA: "JavaService",
            REST: "RestService",
            SOAP: "SoapService",
            FEED: "FeedService",
            DATA: "DataService",
            SECURITY: "SecurityServiceType",
            WEBSOCKET: "WebSocketService"
        },
        CONTROLLER_TYPE: {
            QUERY: "QueryExecution",
            PROCEDURE: "ProcedureExecution"
        },
        HTTP_STATUS_CODE: {
            CORS_FAILURE: -1,
            UNAUTHORIZED: 401,
            FORBIDDEN: 403
        },
        EXPORT_TYPES_MAP: {
            EXCEL: ".xlsx",
            CSV: ".csv"
        },
        DEFAULT_VAR: {
            NOTIFICATION: "appNotification"
        }
    };
    var WS_CONSTANTS = {
        NON_BODY_HTTP_METHODS: [ "GET", "HEAD" ],
        CONTENT_TYPES: {
            FORM_URL_ENCODED: "application/x-www-form-urlencoded",
            MULTIPART_FORMDATA: "multipart/form-data",
            OCTET_STREAM: "application/octet-stream"
        }
    };
    var DB_CONSTANTS = {
        DATABASE_MATCH_MODES: {
            like: "LIKE",
            start: "STARTING_WITH",
            startignorecase: "STARTING_WITH_IGNORECASE",
            end: "ENDING_WITH",
            endignorecase: "ENDING_WITH_IGNORECASE",
            anywhere: "CONTAINING",
            anywhereignorecase: "CONTAINING_IGNORECASE",
            exact: "EQUALS",
            exactignorecase: "EQUALS_IGNORECASE",
            notequals: "NOT_EQUALS",
            notequalsignorecase: "NOT_EQUALS_IGNORECASE",
            between: "BETWEEN",
            in: "IN",
            notin: "NOTIN",
            lessthan: "LESS_THAN",
            lessthanequal: "LESS_THAN_OR_EQUALS",
            greaterthan: "GREATER_THAN",
            greaterthanequal: "GREATER_THAN_OR_EQUALS",
            null: "NULL",
            isnotnull: "IS_NOT_NULL",
            empty: "EMPTY",
            isnotempty: "IS_NOT_EMPTY",
            nullorempty: "NULL_OR_EMPTY"
        },
        DATABASE_EMPTY_MATCH_MODES: [ "NULL", "IS_NOT_NULL", "EMPTY", "IS_NOT_EMPTY", "NULL_OR_EMPTY" ],
        DATABASE_RANGE_MATCH_MODES: [ "IN", "NOTIN", "BETWEEN", "LESS_THAN", "LESS_THAN_OR_EQUALS", "GREATER_THAN", "GREATER_THAN_OR_EQUALS", "NOT_EQUALS" ],
        DATABASE_NULL_EMPTY_MATCH: {
            NULL: "NULL",
            IS_NOT_NULL: "IS_NOT_NULL",
            EMPTY: "NULL",
            IS_NOT_EMPTY: "IS_NOT_NULL",
            NULL_OR_EMPTY: "NULL"
        },
        DATABASE_MATCH_MODES_WITH_QUERY: {
            LIKE: "${0} like ${1}",
            STARTING_WITH: "${0} like ${1}",
            STARTING_WITH_IGNORECASE: "${0} like ${1}",
            ENDING_WITH: "${0} like ${1}",
            ENDING_WITH_IGNORECASE: "${0} like ${1}",
            CONTAINING: "${0} like ${1}",
            CONTAINING_IGNORECASE: "${0} like ${1}",
            EQUALS: "${0}=${1}",
            EQUALS_IGNORECASE: "${0}=${1}",
            NOT_EQUALS: "${0}!=${1}",
            NOT_EQUALS_IGNORECASE: "${0}!=${1}",
            BETWEEN: "${0} between ${1}",
            IN: "${0} in ${1}",
            NOTIN: "${0} not in ${1}",
            LESS_THAN: "${0}<${1}",
            LESS_THAN_OR_EQUALS: "${0}<=${1}",
            GREATER_THAN: "${0}>${1}",
            GREATER_THAN_OR_EQUALS: "${0}>=${1}",
            NULL: "${0} is null",
            IS_NOT_NULL: "${0} is not null",
            EMPTY: "${0}=''",
            IS_NOT_EMPTY: "${0}<>''",
            NULL_OR_EMPTY: "${0} is null or ${0}=''"
        },
        DATABASE_STRING_MODES: [ "LIKE", "STARTING_WITH", "STARTING_WITH_IGNORECASE", "ENDING_WITH", "ENDING_WITH_IGNORECASE", "CONTAINING", "CONTAINING_IGNORECASE", "EQUALS", "EQUALS_IGNORECASE", "NOT_EQUALS", "NOT_EQUALS_IGNORECASE" ]
    };
    var SWAGGER_CONSTANTS = {
        WM_DATA_JSON: "wm_data_json",
        WM_HTTP_JSON: "wm_httpRequestDetails"
    };
    var VARIABLE_URLS = {
        DATABASE: {
            searchTableData: {
                url: "/:service/:dataModelName/:entityName/search?page=:page&size=:size&:sort",
                method: "POST"
            },
            searchTableDataWithQuery: {
                url: "/:service/:dataModelName/:entityName/filter?page=:page&size=:size&:sort",
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                }
            },
            readTableData: {
                url: "/:service/:dataModelName/:entityName?page=:page&size=:size&:sort",
                method: "GET"
            },
            insertTableData: {
                url: "/:service/:dataModelName/:entityName",
                method: "POST"
            },
            insertMultiPartTableData: {
                url: "/:service/:dataModelName/:entityName",
                method: "POST",
                headers: {}
            },
            updateTableData: {
                url: "/:service/:dataModelName/:entityName/:id",
                method: "PUT"
            },
            updateMultiPartTableData: {
                url: "/:service/:dataModelName/:entityName/:id",
                method: "POST",
                headers: {}
            },
            deleteTableData: {
                url: "/:service/:dataModelName/:entityName/:id",
                method: "DELETE"
            },
            updateCompositeTableData: {
                url: "/:service/:dataModelName/:entityName/composite-id?:id",
                method: "PUT"
            },
            periodUpdateCompositeTableData: {
                url: "/:service/:dataModelName/:entityName/composite-id/periods?:id",
                method: "PUT"
            },
            updateMultiPartCompositeTableData: {
                url: "/:service/:dataModelName/:entityName/composite-id?:id",
                method: "POST",
                headers: {}
            },
            deleteCompositeTableData: {
                url: "/:service/:dataModelName/:entityName/composite-id?:id",
                method: "DELETE"
            },
            periodDeleteCompositeTableData: {
                url: "/:service/:dataModelName/:entityName/composite-id/periods?:id",
                method: "DELETE"
            },
            getDistinctDataByFields: {
                url: "/:service/:dataModelName/:entityName/aggregations?page=:page&size=:size&:sort",
                method: "POST"
            },
            exportTableData: {
                url: "/services/:dataModelName/:entityName/export?:sort",
                method: "POST"
            },
            readTableRelatedData: {
                url: "/:service/:dataModelName/:entityName/:id/:relatedFieldName?page=:page&size=:size&:sort",
                method: "GET"
            },
            executeNamedQuery: {
                url: "/:service/:dataModelName/queryExecutor/queries/:queryName?page=:page&size=:size&:queryParams",
                method: "GET"
            },
            executeCustomQuery: {
                url: "/:service/:dataModelName/queries/execute?page=:page&size=:size",
                method: "POST"
            },
            executeAggregateQuery: {
                url: "/services/:dataModelName/:entityName/aggregations?page=:page&size=:size&sort=:sort",
                method: "POST"
            },
            executeNamedProcedure: {
                url: "/:service/:dataModelName/procedureExecutor/procedure/execute/:procedureName?page=:page&size=:size&:procedureParams",
                method: "GET"
            },
            countTableDataWithQuery: {
                url: "/:service/:dataModelName/:entityName/count",
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                }
            }
        },
        oauthConfiguration: {
            getAuthorizationUrl: {
                url: "services/oauth2/:providerId/authorizationUrl",
                method: "GET"
            }
        }
    };
    var $rootScope = {
        project: {
            deployedUrl: "./",
            id: "temp_id"
        },
        projectName: "test_project_name",
        isApplicationType: true
    };
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var exportTypesMap = {
        EXCEL: ".xlsx",
        CSV: ".csv"
    };
    var DOT_EXPR_REX = /^\[("|')[\w\W]*(\1)\]$/, internalBoundNodeMap = new Map(), timers = new Map();
    var _invoke = function(variable, op) {
        var debouncedFn, cancelFn = _.noop, retVal;
        if (timers.has(variable)) {
            cancelFn = timers.get(variable).cancel;
        }
        cancelFn();
        debouncedFn = _.debounce(function() {
            retVal = variable[op]();
            if (retVal instanceof Promise) {
                retVal.catch(_.noop);
            }
        }, 100);
        timers.set(variable, debouncedFn);
        debouncedFn();
    };
    var processVariablePostBindUpdate = function(nodeName, nodeVal, nodeType, variable, noUpdate) {
        switch (variable.category) {
          case VARIABLE_CONSTANTS.CATEGORY.LIVE:
            if (variable.operation === "read") {
                if (nodeName === "dataBinding") {
                    _.forEach(nodeVal, function(val, key) {
                        variable.filterFields[key] = {
                            value: val
                        };
                    });
                } else {
                    variable.filterFields[nodeName] = {
                        value: nodeVal,
                        type: nodeType
                    };
                }
                if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable.listRecords) && !noUpdate) {
                    _invoke(variable, "listRecords");
                }
            } else {
                if (nodeName === "dataBinding") {
                    variable.inputFields = nodeVal;
                } else {
                    variable.inputFields[nodeName] = nodeVal;
                }
                if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable[variable.operation + "Record"]) && !noUpdate) {
                    _invoke(variable, variable.operation + "Record");
                }
            }
            break;

          case VARIABLE_CONSTANTS.CATEGORY.SERVICE:
          case VARIABLE_CONSTANTS.CATEGORY.LOGIN:
            if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable.invoke) && !noUpdate) {
                _invoke(variable, "invoke");
            }
            break;

          case VARIABLE_CONSTANTS.CATEGORY.DEVICE:
            variable[nodeName] = nodeVal;
            if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable.invoke) && !noUpdate) {
                _invoke(variable, "invoke");
            }
            break;
        }
    };
    var \u02751 = processVariablePostBindUpdate;
    var setDependency = function(type, ref) {
        switch (type) {
          case "appManager":
            exports.appManager = ref;
            break;

          case "http":
            exports.httpService = ref;
            break;

          case "metadata":
            exports.metadataService = ref;
            break;

          case "navigationService":
            exports.navigationService = ref;
            break;

          case "router":
            exports.routerService = ref;
            break;

          case "toaster":
            exports.toasterService = ref;
            break;

          case "oAuth":
            exports.oauthService = ref;
            break;

          case "security":
            exports.securityService = ref;
            break;

          case "dialog":
            exports.dialogService = ref;
            break;
        }
    };
    var initiateCallback = function(type, variable, data, options, skipDefaultNotification) {
        var eventValues = variable[type], callBackScope = variable._context;
        var errorVariable;
        if (type === VARIABLE_CONSTANTS.EVENT.ERROR && !skipDefaultNotification) {
            if (!eventValues) {
                errorVariable = callBackScope.Actions[VARIABLE_CONSTANTS.DEFAULT_VAR.NOTIFICATION];
                if (errorVariable) {
                    data = errorVariable.getMessage() || data;
                    data = _.isString(data) ? data : "An error has occured. Please check the app logs.";
                    errorVariable.invoke({
                        message: data
                    }, undefined, undefined);
                }
            }
        }
        var fn = core.$parseEvent(variable[type]);
        if (type === VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE) {
            if (variable.category === "wm.LiveVariable" && variable.operation === "read") {
                return fn(variable._context, {
                    variable: variable,
                    dataFilter: data,
                    options: options
                });
            } else {
                return fn(variable._context, {
                    variable: variable,
                    inputData: data,
                    options: options
                });
            }
        } else {
            return fn(variable._context, {
                variable: variable,
                data: data,
                options: options
            });
        }
    };
    var triggerOnTimeout = function(success) {
        setTimeout(function() {
            core.triggerFn(success);
        }, 500);
    };
    var \u02752 = triggerOnTimeout;
    var downloadFilefromResponse = function(response, headers, success, error) {
        var filename = "", filenameRegex, matches, type, blob, URL, downloadUrl, popup;
        var disposition = headers.get("Content-Disposition");
        if (disposition && disposition.indexOf("attachment") !== -1) {
            filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
            matches = filenameRegex.exec(disposition);
            if (matches !== null && matches[1]) {
                filename = matches[1].replace(/['"]/g, "");
            }
        }
        type = headers.get("Content-Type");
        blob = new Blob([ response ], {
            type: type
        });
        if (typeof window.navigator.msSaveBlob !== "undefined") {
            if (window.navigator.msSaveBlob(blob, filename)) {
                triggerOnTimeout(success);
            } else {
                core.triggerFn(error);
            }
        } else {
            URL = window.URL || window.webkitURL;
            downloadUrl = URL.createObjectURL(blob);
            if (filename) {
                var a = document.createElement("a");
                var reader_1;
                if (typeof a.download === "undefined") {
                    reader_1 = new FileReader();
                    reader_1.onloadend = function() {
                        var url = reader_1.result.replace(/^data:[^;]*;/, "data:attachment/file;");
                        popup = window.open(url, "_blank");
                        if (!popup) {
                            window.location.href = url;
                        }
                    };
                    reader_1.onload = triggerOnTimeout.bind(undefined, success);
                    reader_1.onerror = error;
                    reader_1.readAsDataURL(blob);
                } else {
                    a.href = downloadUrl;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    triggerOnTimeout(success);
                }
            } else {
                popup = window.open(downloadUrl, "_blank");
                if (!popup) {
                    window.location.href = downloadUrl;
                }
            }
            setTimeout(function() {
                URL.revokeObjectURL(downloadUrl);
            }, 100);
        }
    };
    var \u02753 = downloadFilefromResponse;
    var getService = function(serviceName) {
        if (!serviceName) {
            return;
        }
        return serviceName;
    };
    var \u02754 = getService;
    var setParamsFromURL = function(queryParams, params) {
        queryParams = _.split(queryParams, "&");
        _.forEach(queryParams, function(param) {
            param = _.split(param, "=");
            params[param[0]] = decodeURIComponent(_.join(_.slice(param, 1), "="));
        });
    };
    var \u02755 = setParamsFromURL;
    var downloadThroughIframe = function(requestParams, success) {
        if (requestParams.url[1] === "/" && requestParams.url[2] === "/") {
            requestParams.url = requestParams.url.slice(0, 1) + requestParams.url.slice(2);
        }
        var iFrameElement, formEl, paramElement, queryParams = "";
        var IFRAME_NAME = "fileDownloadIFrame", FORM_NAME = "fileDownloadForm", CONTENT_TYPE = "Content-Type", url = requestParams.url, encType = _.get(requestParams.headers, CONTENT_TYPE), params = _.pickBy(requestParams.headers, function(val, key) {
            return key !== CONTENT_TYPE;
        });
        iFrameElement = $("#" + IFRAME_NAME);
        if (iFrameElement.length) {
            iFrameElement.first().remove();
        }
        iFrameElement = $('<iframe id="' + IFRAME_NAME + '" name="' + IFRAME_NAME + '" class="ng-hide"></iframe>');
        formEl = $('<form id="' + FORM_NAME + '" name="' + FORM_NAME + '"></form>');
        formEl.attr({
            target: iFrameElement.attr("name"),
            action: url,
            method: requestParams.method,
            enctype: encType
        });
        queryParams += url.indexOf("?") !== -1 ? url.substring(url.indexOf("?") + 1) : "";
        queryParams += encType === WS_CONSTANTS.CONTENT_TYPES.FORM_URL_ENCODED ? (queryParams ? "&" : "") + requestParams.dataParams : "";
        if (_.includes(WS_CONSTANTS.NON_BODY_HTTP_METHODS, _.toUpper(requestParams.method))) {
            setParamsFromURL(queryParams, params);
        }
        setParamsFromURL(requestParams.data, params);
        _.forEach(params, function(val, key) {
            paramElement = $('<input type="hidden">');
            paramElement.attr({
                name: key,
                value: val
            });
            formEl.append(paramElement);
        });
        $("body").append(iFrameElement);
        setTimeout(function() {
            iFrameElement.contents().find("body").append(formEl);
            formEl.submit();
            core.triggerFn(success);
        }, 100);
    };
    var \u02756 = downloadThroughIframe;
    var downloadThroughAnchor = function(config, success, error) {
        var url = config.url, method = config.method, data = config.dataParams || config.data, headers = config.headers;
        headers["Content-Type"] = headers["Content-Type"] || "application/x-www-form-urlencoded";
        exports.httpService.send({
            target: "WebService",
            action: "invokeRuntimeRestCall",
            method: method,
            url: url,
            headers: headers,
            data: data,
            responseType: "arraybuffer"
        }).then(function(response) {
            setTimeout(function() {
                downloadFilefromResponse(response.body, response.headers, success, error);
            }, 900);
        }, function(err) {
            core.triggerFn(error, err);
        });
    };
    var \u02757 = downloadThroughAnchor;
    var getModifiedFileName = function(fileName, exportFormat) {
        var fileExtension;
        var currentTimestamp = Date.now();
        if (exportFormat) {
            fileExtension = exportTypesMap[exportFormat];
        } else {
            fileExtension = "." + _.last(_.split(fileName, "."));
            fileName = _.replace(fileName, fileExtension, "");
        }
        return fileName + "_" + currentTimestamp + fileExtension;
    };
    var \u02758 = getModifiedFileName;
    var getCookieByName = function(name) {
        return "cookie";
    };
    var \u02759 = getCookieByName;
    var isXsrfEnabled = function() {
        if (CONSTANTS.hasCordova) {
            return localStorage.getItem(CONSTANTS.XSRF_COOKIE_NAME);
        }
        return false;
    };
    var \u027510 = isXsrfEnabled;
    var getTargetObj = function(obj, root, variable) {
        var target = obj.target, targetObj;
        var rootNode = variable[root];
        if (DOT_EXPR_REX.test(target)) {
            targetObj = rootNode;
        } else {
            target = target.substr(0, target.lastIndexOf("."));
            if (obj.target === root) {
                targetObj = variable;
            } else if (target) {
                targetObj = core.findValueOf(rootNode, target, true);
            } else {
                targetObj = rootNode;
            }
        }
        return targetObj;
    };
    var \u027511 = getTargetObj;
    var getTargetNodeKey = function(target) {
        var targetNodeKey;
        if (DOT_EXPR_REX.test(target)) {
            targetNodeKey = target.replace(/^(\[["'])|(["']\])$/g, "");
        } else {
            targetNodeKey = target.split(".").pop();
        }
        return targetNodeKey;
    };
    var \u027512 = getTargetNodeKey;
    var setValueToNode = function(target, obj, root, variable, value, noUpdate) {
        var targetNodeKey = getTargetNodeKey(target), targetObj = getTargetObj(obj, root, variable);
        value = !_.isUndefined(value) ? value : obj.value;
        if (targetObj) {
            targetObj[targetNodeKey] = value;
        }
        processVariablePostBindUpdate(targetNodeKey, value, obj.type, variable, noUpdate);
    };
    var \u027513 = setValueToNode;
    var updateInternalNodes = function(target, root, variable) {
        var boundInternalNodes = _.keys(_.get(internalBoundNodeMap.get(variable), [ variable.name, root ])), targetNodeKey = getTargetNodeKey(target);
        var internalNodes;
        function findInternalNodeBound() {
            return _.filter(boundInternalNodes, function(node) {
                return node !== targetNodeKey && _.includes(node, targetNodeKey) || (targetNodeKey === root || targetNodeKey === "dataBinding") && node !== targetNodeKey;
            });
        }
        internalNodes = findInternalNodeBound();
        if (internalNodes.length) {
            _.forEach(internalNodes, function(node) {
                setValueToNode(node, {
                    target: node
                }, root, variable, _.get(internalBoundNodeMap.get(variable), [ variable.name, root, node ]));
            });
        }
    };
    var \u027514 = updateInternalNodes;
    var processBindObject = function(obj, scope, root, variable) {
        var target = obj.target, targetObj = getTargetObj(obj, root, variable), targetNodeKey = getTargetNodeKey(target);
        var destroyFn = scope.registerDestroyListener ? scope.registerDestroyListener.bind(scope) : _.noop;
        if (core.stringStartsWith(obj.value, "bind:")) {
            destroyFn(core.$watch(obj.value.replace("bind:", ""), scope, {}, function(newVal, oldVal) {
                if (newVal === oldVal && _.isUndefined(newVal) || _.isUndefined(newVal) && (!_.isUndefined(oldVal) || !_.isUndefined(targetObj[targetNodeKey]))) {
                    return;
                }
                if (!_.includes([ "blob", "file" ], obj.type)) {
                    newVal = core.getClonedObject(newVal);
                }
                setValueToNode(target, obj, root, variable, newVal);
                {
                    if (!internalBoundNodeMap.has(variable)) {
                        internalBoundNodeMap.set(variable, {});
                    }
                    _.set(internalBoundNodeMap.get(variable), [ variable.name, root, target ], newVal);
                    if (_.isObject(newVal)) {
                        updateInternalNodes(target, root, variable);
                    }
                }
            }));
        } else if (!_.isUndefined(obj.value)) {
            setValueToNode(target, obj, root, variable, obj.value, true);
            if (root !== targetNodeKey) {
                if (!internalBoundNodeMap.has(variable)) {
                    internalBoundNodeMap.set(variable, {});
                }
                _.set(internalBoundNodeMap.get(variable), [ variable.name, root, target ], obj.value);
            }
        }
    };
    var \u027515 = processBindObject;
    var processBinding = function(variable, context, bindSource, bindTarget) {
        bindSource = bindSource || "dataBinding";
        bindTarget = bindTarget || "dataBinding";
        var bindMap = variable[bindSource];
        variable[bindSource] = {};
        variable["_bind" + bindSource] = bindMap;
        if (!bindMap) {
            return;
        }
        bindMap.forEach(function(node) {
            if (variable.category === "wm.Variable" && node.target === "dataBinding") {
                node.target = "dataSet";
            }
            processBindObject(node, context, bindTarget, variable);
        });
    };
    var simulateFileDownload = function(requestParams, fileName, exportFormat, success, error) {
        if (CONSTANTS.hasCordova) {
            var fileExtension = void 0;
            if (exportFormat) {
                fileExtension = exportTypesMap[exportFormat];
            }
            exports.appManager.notify("device-file-download", {
                url: requestParams.url,
                name: fileName,
                extension: fileExtension,
                successCb: success,
                errorCb: error
            });
        } else if (!_.isEmpty(requestParams.headers) || isXsrfEnabled()) {
            downloadThroughAnchor(requestParams, success, error);
        } else {
            downloadThroughIframe(requestParams, success);
        }
    };
    var setInput = function(targetObj, key, val, options) {
        targetObj = targetObj || {};
        var keys, lastKey, paramObj = {};
        if (_.isObject(options)) {
            switch (options.type) {
              case "file":
                val = core.getBlob(val, options.contentType);
                break;

              case "number":
                val = _.isNumber(val) ? val : parseInt(val, 10);
                break;
            }
        }
        if (_.isObject(key)) {
            paramObj = key;
        } else if (key.indexOf(".") > -1) {
            keys = key.split(".");
            lastKey = keys.pop();
            targetObj = core.findValueOf(targetObj, keys.join("."), true);
            key = lastKey;
            paramObj[key] = val;
        } else {
            paramObj[key] = val;
        }
        _.forEach(paramObj, function(paramVal, paramKey) {
            targetObj[paramKey] = paramVal;
        });
        return targetObj;
    };
    var isFileUploadSupported = function() {
        return window.File && window.FileReader && window.FileList && window.Blob;
    };
    var getEvaluatedOrderBy = function(varOrder, optionsOrder) {
        var optionFields, varOrderBy;
        if (!optionsOrder || _.isEmpty(optionsOrder)) {
            return varOrder;
        }
        if (!varOrder) {
            return optionsOrder;
        }
        varOrder = _.split(varOrder, ",");
        optionsOrder = _.split(optionsOrder, ",");
        optionFields = _.map(optionsOrder, function(order) {
            return _.split(_.trim(order), " ")[0];
        });
        _.remove(varOrder, function(orderBy) {
            return _.includes(optionFields, _.split(_.trim(orderBy), " ")[0]);
        });
        varOrderBy = varOrder.length ? "," + _.join(varOrder, ",") : "";
        return _.join(optionsOrder, ",") + varOrderBy;
    };
    var formatExportExpression = function(fieldDefs) {
        _.forEach(fieldDefs, function(fieldDef) {
            if (fieldDef.expression) {
                fieldDef.expression = "${" + fieldDef.expression + "}";
            }
        });
        return fieldDefs;
    };
    var debounceVariableCall = _invoke;
    var getDateTimeFormatForType = function(type) {
        return core.DEFAULT_FORMATS[_.toUpper(type)];
    };
    var \u027516 = getDateTimeFormatForType;
    var _formatDate = function(dateValue, type) {
        var epoch;
        if (_.isDate(dateValue)) {
            epoch = dateValue.getTime();
        } else {
            if (!isNaN(dateValue)) {
                dateValue = parseInt(dateValue, 10);
            }
            epoch = dateValue && moment(dateValue).valueOf();
        }
        if (type === core.DataType.TIMESTAMP) {
            return epoch;
        }
        if (type === core.DataType.TIME && !epoch) {
            epoch = moment(new Date().toDateString() + " " + dateValue).valueOf();
        }
        return dateValue && exports.appManager.getPipe("date").transform(epoch, getDateTimeFormatForType(type));
    };
    var \u027517 = _formatDate;
    var formatDate = function(value, type) {
        if (_.includes(type, ".")) {
            type = _.toLower(core.extractType(type));
        }
        if (_.isArray(value)) {
            return _.map(value, function(val) {
                return _formatDate(val, type);
            });
        }
        return _formatDate(value, type);
    };
    var BaseVariableManager = function() {
        function BaseVariableManager() {}
        BaseVariableManager.prototype.initBinding = function(variable, bindSource, bindTarget) {
            processBinding(variable, variable._context, bindSource, bindTarget);
        };
        BaseVariableManager.prototype.notifyInflight = function(variable, status, data) {
            exports.appManager.notify("toggle-variable-state", {
                variable: variable,
                active: status,
                data: data
            });
        };
        BaseVariableManager.prototype.httpCall = function(requestParams, variable, params) {
            var _this = this;
            return new Promise(function(resolve, reject) {
                variable._observable = exports.httpService.sendCallAsObservable(requestParams, params).subscribe(function(response) {
                    if (response && response.type) {
                        resolve(response);
                    }
                }, function(err) {
                    if (exports.httpService.isPlatformSessionTimeout(err)) {
                        _this.notifyInflight(variable, false, err);
                        err._401Subscriber.asObservable().subscribe(function(response) {
                            return resolve(response);
                        }, function(e) {
                            return reject(e);
                        });
                    } else {
                        reject(err);
                    }
                });
            });
        };
        BaseVariableManager.prototype.prepareCallbackOptions = function(xhrObj, moreOptions) {
            var options = {};
            options["xhrObj"] = xhrObj;
            if (moreOptions) {
                _.extend(options, moreOptions);
            }
            return options;
        };
        return BaseVariableManager;
    }();
    var checkEmptyObject = function(obj) {
        var isEmpty = true;
        _.forEach(obj, function(value) {
            if (_.isEmpty(value)) {
                return;
            }
            if (!_.isObject(value)) {
                isEmpty = false;
            } else if (_.isArray(value)) {
                isEmpty = _.isEmpty(value) || (value.length === 1 ? _.isEmpty(value[0]) : false);
            } else {
                isEmpty = checkEmptyObject(value);
            }
            return isEmpty;
        });
        return isEmpty;
    };
    var ModelVariableManager = function(_super) {
        __extends(ModelVariableManager, _super);
        function ModelVariableManager() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        ModelVariableManager.prototype.removeFirstEmptyObject = function(variable) {
            if (_.isArray(variable.dataSet) && variable.dataSet.length === 1 && checkEmptyObject(variable.dataSet[0])) {
                variable.dataSet = [];
            }
        };
        return ModelVariableManager;
    }(BaseVariableManager);
    var NotifyPromise = function() {
        function NotifyPromise(fn) {
            var notifyQueue = [], notify = function(status) {
                notifyQueue.forEach(function(fn1) {
                    fn1(status);
                });
            };
            var cleanUp = function() {
                notifyQueue.length = 0;
            };
            var p1 = new Promise(function(res, rej) {
                fn(res, rej, notify);
            });
            p1.superThen = p1.then.bind(p1);
            p1.then = function(onResolve, onReject, onNotify) {
                p1.superThen(function(response) {
                    onResolve(response);
                    cleanUp();
                }, function(reason) {
                    onResolve(reason);
                    cleanUp();
                });
                if (onNotify) {
                    notifyQueue.push(onNotify);
                }
            };
            return p1;
        }
        return NotifyPromise;
    }();
    var HTTP_EVENT_TYPE;
    (function(HTTP_EVENT_TYPE) {
        HTTP_EVENT_TYPE[HTTP_EVENT_TYPE["Sent"] = 0] = "Sent";
        HTTP_EVENT_TYPE[HTTP_EVENT_TYPE["UploadProgress"] = 1] = "UploadProgress";
        HTTP_EVENT_TYPE[HTTP_EVENT_TYPE["ResponseHeader"] = 2] = "ResponseHeader";
        HTTP_EVENT_TYPE[HTTP_EVENT_TYPE["DownloadProgress"] = 3] = "DownloadProgress";
        HTTP_EVENT_TYPE[HTTP_EVENT_TYPE["Response"] = 4] = "Response";
        HTTP_EVENT_TYPE[HTTP_EVENT_TYPE["User"] = 5] = "User";
    })(HTTP_EVENT_TYPE || (HTTP_EVENT_TYPE = {}));
    var UPLOAD_STATUS;
    (function(UPLOAD_STATUS) {
        UPLOAD_STATUS["QUEUED"] = "queued";
        UPLOAD_STATUS["IN_PROGRESS"] = "inprogress";
        UPLOAD_STATUS["SUCCESS"] = "success";
        UPLOAD_STATUS["ERROR"] = "error";
        UPLOAD_STATUS["ABORTED"] = "abort";
    })(UPLOAD_STATUS || (UPLOAD_STATUS = {}));
    var FileTransferObject = function() {
        function FileTransferObject(file, transferFn, promise, abortFn) {
            this.name = file.name;
            this.size = file.size || "";
            this.status = UPLOAD_STATUS.QUEUED;
            this.transferFn = transferFn;
            this.promise = promise;
            this.abortFn = abortFn;
        }
        FileTransferObject.prototype.start = function() {
            if (this.status === UPLOAD_STATUS.QUEUED) {
                this.status = UPLOAD_STATUS.IN_PROGRESS;
                core.triggerFn(this.transferFn);
            }
        };
        FileTransferObject.prototype.then = function(onSuccess, onError, onProgress) {
            var self = this;
            this.promise.then(function(event) {
                self.status = UPLOAD_STATUS.SUCCESS;
                core.triggerFn(onSuccess, event);
            }, function(event) {
                self.status = UPLOAD_STATUS.ERROR;
                core.triggerFn(onError, event);
            }, function(event) {
                self.progress = Math.round(event.loaded / event.total * 100);
                core.triggerFn(onProgress, event);
            });
            return this;
        };
        FileTransferObject.prototype.finally = function(onFinal) {
            this.promise.finally(onFinal);
        };
        FileTransferObject.prototype.abort = function() {
            this.status = UPLOAD_STATUS.ABORTED;
            core.triggerFn(this.abortFn);
            this.finally();
        };
        return FileTransferObject;
    }();
    var AjaxFileTransferObject = function(_super) {
        __extends(AjaxFileTransferObject, _super);
        function AjaxFileTransferObject(file, transferFn, promise, abortFn) {
            return _super.call(this, file, transferFn, promise, abortFn) || this;
        }
        return AjaxFileTransferObject;
    }(FileTransferObject);
    function appendFileToFormData(file, fd, options) {
        if (_.isArray(file)) {
            _.forEach(file, function(fileObject) {
                fd.append(options.paramName, fileObject.content || fileObject, fileObject.name);
            });
        } else if (_.isObject(file)) {
            fd.append(options.paramName, file.content || file, file.name);
        }
    }
    function uploadWithAjax(file, fd, url, options) {
        var cloneFD = new FormData();
        var iterate = function(value, key) {
            var fileObject = _.isArray(value) ? value[0] : value;
            if (!(fileObject instanceof File || fileObject instanceof Blob)) {
                cloneFD.append(key, value);
            }
        };
        if (fd.forEach) {
            fd.forEach(iterate);
        } else {
            _.forEach(fd, iterate);
        }
        appendFileToFormData(file, cloneFD, options);
        var promise = new NotifyPromise(function(resolve, reject, notify) {
            var request = exports.httpService.upload(url, cloneFD).subscribe(function(event) {
                if (event.type === HTTP_EVENT_TYPE.UploadProgress) {
                    var uploadProgress = Math.round(100 * event.loaded / event.total);
                    notify(uploadProgress);
                }
                if (event.type === HTTP_EVENT_TYPE.Response) {
                    resolve(event.body);
                }
            });
            file._uploadProgress = request;
        });
        return promise;
    }
    function upload(files, fd, config, options) {
        options = _.extend({
            paramName: config.fileParamName
        }, options);
        return uploadWithAjax(files, fd, config.url, options);
    }
    var performAuthorization = function(url, providerId, onSuccess, onError) {
        exports.oauthService.perfromOAuthorization(url, providerId, onSuccess, onError);
    };
    var getAccessToken = function(provider, checkLoaclStorage) {
        return exports.oauthService.getAccessToken(provider, checkLoaclStorage);
    };
    var removeAccessToken = function(provider) {
        exports.oauthService.removeAccessToken(provider);
    };
    var isBodyTypeQueryOrProcedure = function(variable) {
        return _.includes([ "QueryExecution", "ProcedureExecution" ], variable.controller) && _.includes([ "put", "post" ], variable.operationType);
    };
    var isQueryServiceVar = function(controller, serviceType) {
        return controller === VARIABLE_CONSTANTS.CONTROLLER_TYPE.QUERY && serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.DATA;
    };
    var getFormData = function(formData, param, paramValue) {
        var paramType = _.toLower(core.extractType(_.get(param, "items.type") || param.type)), paramContentType = CONSTANTS.isStudioMode ? param["x-WM-CONTENT_TYPE"] : param.contentType;
        if (isFileUploadSupported()) {
            if (paramType !== "file" && (paramContentType === "string" || !paramContentType)) {
                if (_.isObject(paramValue)) {
                    paramValue = JSON.stringify(paramValue);
                }
                formData.append(param.name, paramValue);
            } else {
                if (_.isArray(paramValue) && paramType === "file") {
                    _.forEach(paramValue, function(fileObject) {
                        formData.append(param.name, fileObject && fileObject.content || core.getBlob(fileObject), fileObject.name);
                    });
                } else {
                    formData.append(param.name, core.getBlob(paramValue, paramContentType), paramValue && paramValue.name);
                }
            }
            return formData;
        }
    };
    var processRequestBody = function(inputData, params) {
        var requestBody = {}, missingParams = [];
        var paramValue;
        _.forEach(params, function(param) {
            paramValue = _.get(inputData, param.name);
            if (!_.isUndefined(paramValue) && paramValue !== "" && paramValue !== null && !param.readOnly) {
                paramValue = core.isDateTimeType(param.type) ? formatDate(paramValue, param.type) : paramValue;
                if (_.isArray(paramValue) && _.toLower(core.extractType(param.type)) === "string") {
                    paramValue = _.join(paramValue, ",");
                }
                requestBody[param.name] = paramValue;
            } else if (param.required) {
                missingParams.push(param.name || param.id);
            }
        });
        return {
            requestBody: requestBody,
            missingParams: missingParams
        };
    };
    var cloakHeadersForProxy = function(headers) {
        var _headers = {}, UNCLOAKED_HEADERS = VARIABLE_CONSTANTS.REST_SERVICE.UNCLOAKED_HEADERS, CLOAK_PREFIX = VARIABLE_CONSTANTS.REST_SERVICE.PREFIX.CLOAK_HEADER_KEY;
        _.forEach(headers, function(val, key) {
            if (_.includes(UNCLOAKED_HEADERS, key.toUpperCase())) {
                _headers[key] = val;
            } else {
                _headers[CLOAK_PREFIX + key] = val;
            }
        });
        return _headers;
    };
    var ServiceVariableUtils = function() {
        function ServiceVariableUtils() {}
        ServiceVariableUtils.constructRequestParams = function(variable, operationInfo, inputFields) {
            variable = variable || {};
            if (operationInfo === null) {
                return {
                    error: {
                        type: VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.USER_UNAUTHORISED,
                        message: VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.USER_UNAUTHORISED,
                        field: "_wmServiceOperationInfo"
                    }
                };
            } else if (_.isEmpty(operationInfo)) {
                return {
                    error: {
                        type: VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.METADATA_MISSING,
                        message: VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.METADATA_MISSING,
                        field: "_wmServiceOperationInfo"
                    }
                };
            }
            var directPath = operationInfo.directPath || "", relativePath = operationInfo.basePath ? operationInfo.basePath + operationInfo.relativePath : operationInfo.relativePath, isBodyTypeQueryProcedure = isBodyTypeQueryOrProcedure(variable);
            var queryParams = "", bodyInfo, headers = {}, requestBody, url, requiredParamMissing = [], target, pathParamRex, invokeParams, authDetails = null, uname, pswd, method, formData, isProxyCall, paramValueInfo, params, securityDefnObj, accessToken, withCredentials;
            function getFormDataObj() {
                if (formData) {
                    return formData;
                }
                formData = new FormData();
                return formData;
            }
            securityDefnObj = _.get(operationInfo.securityDefinitions, "0");
            if (securityDefnObj) {
                switch (securityDefnObj.type) {
                  case VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.OAUTH2:
                    accessToken = getAccessToken(securityDefnObj[VARIABLE_CONSTANTS.REST_SERVICE.OAUTH_PROVIDER_KEY], null);
                    if (accessToken) {
                        headers[VARIABLE_CONSTANTS.REST_SERVICE.AUTH_HDR_KEY] = VARIABLE_CONSTANTS.REST_SERVICE.PREFIX.AUTH_HDR_VAL.OAUTH + " " + accessToken;
                    } else {
                        return {
                            error: {
                                type: VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.NO_ACCESSTOKEN,
                                message: VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.NO_ACCESSTOKEN
                            },
                            securityDefnObj: securityDefnObj
                        };
                    }
                    break;

                  case VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.BASIC:
                    uname = inputFields["wm_auth_username"];
                    pswd = inputFields["wm_auth_password"];
                    if (uname && pswd) {
                        headers[VARIABLE_CONSTANTS.REST_SERVICE.AUTH_HDR_KEY] = VARIABLE_CONSTANTS.REST_SERVICE.PREFIX.AUTH_HDR_VAL.BASIC + " " + btoa(uname + ":" + pswd);
                        authDetails = {
                            type: VARIABLE_CONSTANTS.REST_SERVICE.AUTH_TYPE.BASIC
                        };
                    } else {
                        return {
                            error: {
                                type: VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.NO_CREDENTIALS,
                                message: VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.NO_CREDENTIALS
                            },
                            securityDefnObj: securityDefnObj
                        };
                    }
                    break;
                }
            }
            operationInfo.proxySettings = operationInfo.proxySettings || {
                web: true,
                mobile: false
            };
            method = operationInfo.httpMethod || operationInfo.methodType;
            isProxyCall = function() {
                if (CONSTANTS.hasCordova) {
                    return operationInfo.proxySettings.mobile;
                }
                return operationInfo.proxySettings.web;
            }();
            withCredentials = operationInfo.proxySettings.withCredentials;
            url = isProxyCall ? relativePath : directPath;
            _.forEach(operationInfo.parameters, function(param) {
                function setParamsOfChildNode() {
                    if (inputFields) {
                        if (inputFields[param.name] && _.isObject(inputFields[param.name])) {
                            paramValueInfo = inputFields[param.name];
                        } else {
                            paramValueInfo = inputFields;
                        }
                        params = _.get(operationInfo, [ "definitions", param.type ]);
                    } else {
                        paramValueInfo = paramValue || {};
                        params = param.children;
                    }
                }
                var paramValue = param.sampleValue;
                if (core.isDefined(paramValue) && paramValue !== null && paramValue !== "" || isBodyTypeQueryProcedure && param.type !== "file") {
                    if (variable.serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.DATA && core.isDateTimeType(param.type)) {
                        paramValue = formatDate(paramValue, param.type);
                    }
                    if (_.isArray(paramValue) && _.toLower(core.extractType(param.type)) === "string" && variable.serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.DATA) {
                        paramValue = _.join(paramValue, ",");
                    }
                    switch (param.parameterType.toUpperCase()) {
                      case "QUERY":
                        if (_.isNull(paramValue) && isQueryServiceVar(variable.controller, variable.serviceType)) {
                            break;
                        }
                        if (!queryParams) {
                            queryParams = "?" + param.name + "=" + encodeURIComponent(paramValue);
                        } else {
                            queryParams += "&" + param.name + "=" + encodeURIComponent(paramValue);
                        }
                        break;

                      case "PATH":
                        pathParamRex = new RegExp("\\s*\\{\\s*" + param.name + "(:\\.\\+)?\\s*\\}\\s*");
                        url = url.replace(pathParamRex, paramValue);
                        break;

                      case "HEADER":
                        headers[param.name] = paramValue;
                        break;

                      case "BODY":
                        if (isBodyTypeQueryProcedure) {
                            setParamsOfChildNode();
                            bodyInfo = processRequestBody(paramValueInfo, params);
                            requestBody = bodyInfo.requestBody;
                            requiredParamMissing = _.concat(requiredParamMissing, bodyInfo.missingParams);
                        } else {
                            requestBody = paramValue;
                        }
                        break;

                      case "FORMDATA":
                        if (isBodyTypeQueryProcedure && param.name === SWAGGER_CONSTANTS.WM_DATA_JSON) {
                            setParamsOfChildNode();
                            bodyInfo = processRequestBody(paramValueInfo, params);
                            requestBody = getFormData(getFormDataObj(), param, bodyInfo.requestBody);
                            requiredParamMissing = _.concat(requiredParamMissing, bodyInfo.missingParams);
                        } else {
                            requestBody = getFormData(getFormDataObj(), param, paramValue);
                        }
                        break;
                    }
                } else if (param.required) {
                    requiredParamMissing.push(param.name || param.id);
                }
            });
            if (requiredParamMissing.length) {
                return {
                    error: {
                        type: VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.REQUIRED_FIELD_MISSING,
                        field: requiredParamMissing.join(","),
                        message: core.replace(VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.REQUIRED_FIELD_MISSING, [ requiredParamMissing.join(",") ]),
                        skipDefaultNotification: true
                    }
                };
            }
            if (!_.includes(WS_CONSTANTS.NON_BODY_HTTP_METHODS, _.toUpper(method))) {
                if (!(operationInfo.consumes && operationInfo.consumes[0] === WS_CONSTANTS.CONTENT_TYPES.MULTIPART_FORMDATA)) {
                    headers["Content-Type"] = operationInfo.consumes && operationInfo.consumes[0] || "application/json";
                }
            }
            if (_.includes(operationInfo.consumes, WS_CONSTANTS.CONTENT_TYPES.FORM_URL_ENCODED) && !_.includes(WS_CONSTANTS.NON_BODY_HTTP_METHODS, (method || "").toUpperCase())) {
                if (queryParams) {
                    requestBody = (requestBody ? requestBody + "&" : "") + queryParams.substring(1);
                }
                headers["Content-Type"] = WS_CONSTANTS.CONTENT_TYPES.FORM_URL_ENCODED;
            } else {
                url += queryParams;
            }
            if (isProxyCall) {
                headers = variable.serviceType !== VARIABLE_CONSTANTS.SERVICE_TYPE.REST || operationInfo.skipCloakHeaders ? headers : cloakHeadersForProxy(headers);
                if (variable.getPrefabName() && VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES.indexOf(variable.serviceType) !== -1) {
                    url = "prefabs/" + variable.getPrefabName() + url;
                    target = "invokePrefabRestService";
                } else if (!variable.getPrefabName()) {
                    url = "services" + url;
                }
                url = $rootScope.project.deployedUrl + url;
            }
            invokeParams = {
                projectID: $rootScope.project.id,
                url: url,
                target: target,
                method: method,
                headers: headers,
                data: requestBody,
                authDetails: authDetails,
                isDirectCall: !isProxyCall,
                isExtURL: variable.serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.REST,
                withCredentials: withCredentials
            };
            return invokeParams;
        };
        ServiceVariableUtils.isFileUploadRequest = function(variable) {
            return variable.service === "FileService" && variable.operation === "uploadFile";
        };
        ServiceVariableUtils.excludePaginationParams = function(params) {
            return _.map(_.reject(params, function(param) {
                return _.includes(VARIABLE_CONSTANTS.PAGINATION_PARAMS, param.name);
            }), function(param) {
                return param.name;
            });
        };
        return ServiceVariableUtils;
    }();
    var InflightQueue = function() {
        function InflightQueue() {
            this.requestsQueue = new Map();
        }
        InflightQueue.prototype.addToQueue = function(variable, param2) {
            if (this.requestsQueue.has(variable)) {
                this.requestsQueue.get(variable).push(param2);
            } else {
                var processes = [];
                processes.push({
                    resolve: param2.resolve,
                    reject: param2.reject,
                    active: false
                });
                this.requestsQueue.set(variable, processes);
            }
        };
        InflightQueue.prototype.rejectProcess = function(process) {
            process.reject('Process rejected in the queue. Check the "Inflight behavior" for more info.');
        };
        InflightQueue.prototype.clear = function(variable) {
            this.requestsQueue.delete(variable);
        };
        InflightQueue.prototype.process = function(variable) {
            var processes = this.requestsQueue.get(variable);
            var nextProcess;
            if (!processes || !processes.length) {
                this.clear(variable);
                return;
            }
            if (processes.length === 1) {
                nextProcess = processes[0];
                if (nextProcess.active) {
                    this.clear(variable);
                } else {
                    nextProcess.active = true;
                    nextProcess.resolve();
                }
                return;
            }
            switch (variable.inFlightBehavior) {
              case "executeLast":
                for (var i = 0; i < processes.length - 2; i++) {
                    this.rejectProcess(processes[i]);
                }
                processes.splice(0, processes.length - 1);
                this.process(variable);
                break;

              case "executeAll":
                nextProcess = processes.splice(0, 1)[0];
                if (nextProcess.active) {
                    nextProcess = processes.splice(0, 1)[0];
                }
                nextProcess.active = true;
                nextProcess.resolve();
                break;

              default:
                for (var i = 0; i < processes.length - 1; i++) {
                    this.rejectProcess(processes[i]);
                }
                this.clear(variable);
                break;
            }
        };
        InflightQueue.prototype.submit = function(variable) {
            var _this = this;
            return new Promise(function(resolve, reject) {
                _this.addToQueue(variable, {
                    resolve: resolve,
                    reject: reject
                });
                if (_this.requestsQueue.get(variable).length === 1) {
                    _this.process(variable);
                }
            });
        };
        return InflightQueue;
    }();
    var $queue = new InflightQueue();
    var ServiceVariableManager = function(_super) {
        __extends(ServiceVariableManager, _super);
        function ServiceVariableManager() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.fileUploadResponse = [];
            _this.fileUploadCount = 0;
            _this.totalFilesCount = 0;
            _this.successFileUploadCount = 0;
            _this.failedFileUploadCount = 0;
            return _this;
        }
        ServiceVariableManager.prototype.processErrorResponse = function(variable, errMsg, errorCB, xhrObj, skipNotification, skipDefaultNotification) {
            var methodInfo = this.getMethodInfo(variable, {}, {});
            var securityDefnObj = _.get(methodInfo, "securityDefinitions.0");
            var advancedOptions = this.prepareCallbackOptions(xhrObj);
            if (!skipNotification) {
                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, errMsg, advancedOptions, skipDefaultNotification);
            }
            if (_.get(securityDefnObj, "type") === VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.OAUTH2 && _.includes([ VARIABLE_CONSTANTS.HTTP_STATUS_CODE.UNAUTHORIZED, VARIABLE_CONSTANTS.HTTP_STATUS_CODE.FORBIDDEN ], _.get(xhrObj, "status"))) {
                removeAccessToken(securityDefnObj["x-WM-PROVIDER_ID"]);
            }
            core.triggerFn(errorCB, errMsg);
            if (!CONSTANTS.isStudioMode) {
                variable.canUpdate = true;
                $queue.process(variable);
                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, errMsg, advancedOptions);
            }
        };
        ServiceVariableManager.prototype.processSuccessResponse = function(response, variable, options, success) {
            var dataSet;
            var newDataSet;
            var pagination = {};
            var advancedOptions;
            var jsonParsedResponse = core.getValidJSON(response);
            response = core.isDefined(jsonParsedResponse) ? jsonParsedResponse : core.xmlToJson(response) || response;
            var isResponsePageable = core.isPageable(response);
            if (isResponsePageable) {
                dataSet = response.content;
                pagination = _.omit(response, "content");
            } else {
                dataSet = response;
            }
            advancedOptions = this.prepareCallbackOptions(options.xhrObj, {
                pagination: pagination,
                rawData: dataSet
            });
            initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);
            core.triggerFn(success, response, pagination);
            if (variable.transformationColumns) {
                this.transformData(response, variable);
            }
            dataSet = !_.isObject(dataSet) ? {
                value: dataSet
            } : dataSet;
            newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, dataSet, advancedOptions);
            if (core.isDefined(newDataSet)) {
                dataSet = newDataSet;
            }
            if (!options.forceRunMode && !options.skipDataSetUpdate) {
                variable.pagination = pagination;
                variable.dataSet = dataSet;
                if (isResponsePageable) {
                    Object.defineProperty(variable.dataSet, "content", {
                        get: function() {
                            return variable.dataSet;
                        }
                    });
                }
            }
            core.$invokeWatchers(true);
            setTimeout(function() {
                initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, dataSet, advancedOptions);
                if (!CONSTANTS.isStudioMode) {
                    variable.canUpdate = true;
                    $queue.process(variable);
                }
                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, dataSet, advancedOptions);
            });
            return {
                data: variable.dataSet,
                pagination: variable.pagination
            };
        };
        ServiceVariableManager.prototype.uploadFileInFormData = function(variable, options, success, error, file, requestParams) {
            var _this = this;
            var promise = upload(file, requestParams.data, {
                fileParamName: "files",
                url: requestParams.url
            });
            promise.then(function(data) {
                _this.fileUploadCount++;
                _this.successFileUploadCount++;
                _this.fileUploadResponse.push(data[0]);
                if (_this.totalFilesCount === _this.fileUploadCount) {
                    if (_this.failedFileUploadCount === 0) {
                        _this.processSuccessResponse(_this.fileUploadResponse, variable, options, success);
                        _this.fileUploadResponse = [];
                        exports.appManager.notifyApp(exports.appManager.getAppLocale().MESSAGE_FILE_UPLOAD_SUCCESS, "success");
                    } else {
                        initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, _this.fileUploadResponse);
                        _this.fileUploadResponse = [];
                        exports.appManager.notifyApp(exports.appManager.getAppLocale().MESSAGE_FILE_UPLOAD_ERROR, "error");
                    }
                    _this.fileUploadCount = 0;
                    _this.successFileUploadCount = 0;
                    _this.totalFilesCount = 0;
                }
                return data;
            }, function(e) {
                _this.fileUploadCount++;
                _this.failedFileUploadCount++;
                _this.fileUploadResponse.push(e);
                if (_this.totalFilesCount === _this.fileUploadCount) {
                    _this.processErrorResponse(variable, _this.fileUploadResponse, error, options.xhrObj, options.skipNotification);
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, _this.fileUploadResponse);
                    _this.fileUploadResponse = [];
                    _this.fileUploadCount = 0;
                    _this.failedFileUploadCount = 0;
                    _this.totalFilesCount = 0;
                }
                return e;
            }, function(data) {
                if (variable._progressObservable) {
                    variable._progressObservable.next({
                        progress: data,
                        status: VARIABLE_CONSTANTS.EVENT.PROGRESS,
                        fileName: file.name
                    });
                }
                initiateCallback(VARIABLE_CONSTANTS.EVENT.PROGRESS, variable, data);
                return data;
            });
            return promise;
        };
        ServiceVariableManager.prototype.handleAuthError = function(variable, success, errorCB, options) {
            var isUserAuthenticated = _.get(exports.securityService.get(), "authenticated");
            var info;
            if (isUserAuthenticated) {
                info = {
                    error: {
                        message: "You're not authorised to access the resource \"" + variable.service + '".'
                    }
                };
            } else {
                info = {
                    error: {
                        message: "You're not authenticated to access the resource \"" + variable.service + '".',
                        skipDefaultNotification: true
                    }
                };
                exports.appManager.pushToSessionFailureRequests(variable.invoke.bind(variable, options, success, errorCB));
                exports.appManager.handle401();
            }
            return info;
        };
        ServiceVariableManager.prototype.handleRequestMetaError = function(info, variable, success, errorCB, options) {
            var err_type = _.get(info, "error.type");
            switch (err_type) {
              case VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.NO_ACCESSTOKEN:
                performAuthorization(undefined, info.securityDefnObj[VARIABLE_CONSTANTS.REST_SERVICE.OAUTH_PROVIDER_KEY], this.invoke.bind(this, variable, options, null, errorCB), null);
                this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, true, true);
                break;

              case VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.USER_UNAUTHORISED:
                info = this.handleAuthError(variable, success, errorCB, options);
                this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, options.skipNotification, info.error.skipDefaultNotification);
                break;

              case VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.METADATA_MISSING:
                this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, options.skipNotification, info.error.skipDefaultNotification);
                break;

              default:
                if (info.error.message) {
                    console.warn(info.error.message, variable.name);
                    this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, options.skipNotification, info.error.skipDefaultNotification);
                }
            }
            return info;
        };
        ServiceVariableManager.prototype.transformData = function(data, variable) {
            data.wmTransformedData = [];
            var columnsArray = variable.transformationColumns, dataArray = _.get(data, variable.dataField) || [], transformedData = data.wmTransformedData;
            _.forEach(dataArray, function(datum, index) {
                transformedData[index] = {};
                _.forEach(columnsArray, function(column, columnIndex) {
                    transformedData[index][column] = datum[columnIndex];
                });
            });
        };
        ServiceVariableManager.prototype.getMethodInfo = function(variable, inputFields, options) {
            var serviceDef = core.getClonedObject(exports.metadataService.getByOperationId(variable.operationId, variable.getPrefabName()));
            var methodInfo = serviceDef === null ? null : _.get(serviceDef, "wmServiceOperationInfo");
            if (!methodInfo) {
                return methodInfo;
            }
            var securityDefnObj = _.get(methodInfo.securityDefinitions, "0"), isOAuthTypeService = securityDefnObj && securityDefnObj.type === VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.OAUTH2;
            if (methodInfo.parameters) {
                methodInfo.parameters.forEach(function(param) {
                    if (param.readOnly) {
                        return;
                    }
                    param.sampleValue = inputFields[param.name];
                    if (VARIABLE_CONSTANTS.PAGINATION_PARAMS.indexOf(param.name) !== -1) {
                        if (param.name === "size") {
                            param.sampleValue = options.size || param.sampleValue || parseInt(variable.maxResults, 10);
                        } else if (param.name === "page") {
                            param.sampleValue = options.page || param.sampleValue || 1;
                        } else if (param.name === "sort") {
                            param.sampleValue = getEvaluatedOrderBy(variable.orderBy, options.orderBy) || param.sampleValue || "";
                        }
                    } else if (param.name === "access_token" && isOAuthTypeService) {
                        param.sampleValue = getAccessToken(securityDefnObj[VARIABLE_CONSTANTS.REST_SERVICE.OAUTH_PROVIDER_KEY], null);
                    }
                });
            }
            return methodInfo;
        };
        ServiceVariableManager.prototype.isFileUploadInProgress = function(dataBindings) {
            var filesStatus = false;
            _.forEach(dataBindings, function(dataBinding) {
                if (_.isArray(dataBinding) && dataBinding[0] instanceof File) {
                    _.forEach(dataBinding, function(file) {
                        if (file.status === "onProgress") {
                            filesStatus = true;
                            return;
                        }
                    });
                }
            });
            return filesStatus;
        };
        ServiceVariableManager.prototype.uploadFile = function(variable, options, success, error, inputFields, requestParams) {
            var _this = this;
            var fileParamCount = 0;
            var fileArr = [], promArr = [];
            _.forEach(inputFields, function(inputField) {
                if (_.isArray(inputField)) {
                    if (inputField[0] instanceof File) {
                        fileParamCount++;
                    }
                    _.forEach(inputField, function(input) {
                        if (input instanceof File || _.find(_.values(input), function(o) {
                            return o instanceof Blob;
                        })) {
                            fileArr.push(input);
                            _this.totalFilesCount++;
                            fileParamCount = fileParamCount || 1;
                        }
                    });
                } else {
                    if (inputField instanceof File) {
                        fileParamCount++;
                        _this.totalFilesCount++;
                        fileArr.push(inputField);
                    }
                }
            });
            if (fileParamCount === 1) {
                if (inputFields.files.length > 1) {
                    _.forEach(fileArr, function(file) {
                        promArr.push(_this.uploadFileInFormData(variable, options, success, error, file, requestParams));
                    });
                    return Promise.all(promArr);
                } else {
                    return this.uploadFileInFormData(variable, options, success, error, fileArr[0], requestParams);
                }
            }
        };
        ServiceVariableManager.prototype._invoke = function(variable, options, success, error) {
            var _this = this;
            var inputFields = core.getClonedObject(options.inputFields || variable.dataBinding);
            var output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, inputFields, options);
            var successHandler;
            var errorHandler;
            if (output === false) {
                $queue.process(variable);
                core.triggerFn(error);
                return;
            }
            if (_.isObject(output)) {
                inputFields = output;
            }
            var operationInfo = this.getMethodInfo(variable, inputFields, options), requestParams = ServiceVariableUtils.constructRequestParams(variable, operationInfo, inputFields);
            if (requestParams.error) {
                var info = this.handleRequestMetaError(requestParams, variable, success, error, options);
                var reason = (_.get(info, "error.message") || "An error occurred while triggering the variable: ") + ": " + variable.name;
                core.triggerFn(error);
                return Promise.reject(reason);
            }
            if (ServiceVariableUtils.isFileUploadRequest(variable)) {
                var uploadPromise = this.uploadFile(variable, options, success, error, inputFields, requestParams);
                if (uploadPromise) {
                    return uploadPromise;
                }
            }
            if (operationInfo && _.isArray(operationInfo.produces) && _.includes(operationInfo.produces, WS_CONSTANTS.CONTENT_TYPES.OCTET_STREAM)) {
                return simulateFileDownload(requestParams, variable.dataBinding.file || variable.name, variable.dataBinding.exportType, function() {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, null, null, null);
                    $queue.process(variable);
                    core.triggerFn(success);
                }, function() {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, null, null, null);
                    $queue.process(variable);
                    core.triggerFn(error);
                });
            }
            this.notifyInflight(variable, !options.skipToggleState);
            successHandler = function(response, resolve) {
                if (response && response.type) {
                    var data = _this.processSuccessResponse(response.body, variable, _.extend(options, {
                        xhrObj: response
                    }), success);
                    _this.notifyInflight(variable, false, data);
                    resolve(response);
                }
            };
            errorHandler = function(err, reject) {
                var errMsg = exports.httpService.getErrMessage(err);
                _this.notifyInflight(variable, false);
                _this.processErrorResponse(variable, errMsg, error, err, options.skipNotification);
                reject({
                    error: errMsg,
                    details: err
                });
            };
            return new Promise(function(resolve, reject) {
                requestParams.responseType = "text";
                _this.httpCall(requestParams, variable).then(function(response) {
                    successHandler(response, resolve);
                }, function(err) {
                    errorHandler(err, reject);
                });
            });
        };
        ServiceVariableManager.prototype.invoke = function(variable, options, success, error) {
            options = options || {};
            options.inputFields = options.inputFields || core.getClonedObject(variable.dataBinding);
            return $queue.submit(variable).then(this._invoke.bind(this, variable, options, success, error), error);
        };
        ServiceVariableManager.prototype.download = function(variable, options, successHandler, errorHandler) {
            options = options || {};
            var inputParams = core.getClonedObject(variable.dataBinding);
            var inputData = options.data || {};
            var methodInfo = this.getMethodInfo(variable, inputParams, options);
            var requestParams;
            methodInfo.relativePath += "/export";
            requestParams = ServiceVariableUtils.constructRequestParams(variable, methodInfo, inputParams);
            requestParams.data = inputData;
            requestParams.data.fields = formatExportExpression(inputData.fields || []);
            requestParams.method = options.httpMethod || "POST";
            requestParams.url = options.url || requestParams.url;
            if (_.hasIn(requestParams, "error.message")) {
                core.triggerFn(errorHandler, requestParams.error.message);
                return Promise.reject(requestParams.error.message);
            }
            return exports.httpService.send(requestParams).then(function(response) {
                if (response && core.isValidWebURL(response.body.result)) {
                    window.location.href = response.body.result;
                    core.triggerFn(successHandler, response);
                } else {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response);
                    core.triggerFn(errorHandler, response);
                }
            }, function(response, xhrObj) {
                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response, xhrObj);
                core.triggerFn(errorHandler, response);
            });
        };
        ServiceVariableManager.prototype.getInputParms = function(variable) {
            var wmServiceOperationInfo = _.get(exports.metadataService.getByOperationId(variable.operationId), "wmServiceOperationInfo");
            return _.get(wmServiceOperationInfo, "parameters");
        };
        ServiceVariableManager.prototype.setInput = function(variable, key, val, options) {
            return setInput(variable.dataBinding, key, val, options);
        };
        ServiceVariableManager.prototype.cancel = function(variable, $file) {
            if ($queue.requestsQueue.has(variable)) {
                if (ServiceVariableUtils.isFileUploadRequest(variable)) {
                    $file._uploadProgress.unsubscribe();
                    $file.status = "abort";
                    this.totalFilesCount--;
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ABORT, variable, $file);
                    if (!this.isFileUploadInProgress(variable.dataBinding) && this.totalFilesCount === 0) {
                        $queue.process(variable);
                        this.notifyInflight(variable, false);
                    }
                } else {
                    if (variable._observable) {
                        variable._observable.unsubscribe();
                        $queue.process(variable);
                        this.notifyInflight(variable, false);
                    }
                }
            }
        };
        ServiceVariableManager.prototype.defineFirstLastRecord = function(variable) {
            if (variable.isList) {
                Object.defineProperty(variable, "firstRecord", {
                    configurable: true,
                    get: function() {
                        var dataSet = variable.dataSet;
                        return _.head(dataSet && dataSet.content) || _.head(dataSet) || {};
                    }
                });
                Object.defineProperty(variable, "lastRecord", {
                    configurable: true,
                    get: function() {
                        var dataSet = variable.dataSet;
                        return _.last(dataSet && dataSet.content) || _.last(dataSet) || {};
                    }
                });
            }
        };
        ServiceVariableManager.prototype.getQueryParams = function(filterFields, searchValue, variable) {
            var inputParams = this.getInputParms(variable);
            var queryParams = ServiceVariableUtils.excludePaginationParams(inputParams);
            var inputFields = {};
            _.map(variable.dataBinding, function(value, key) {
                inputFields[key] = value;
            });
            _.forEach(filterFields, function(value) {
                if (_.includes(queryParams, value)) {
                    inputFields[value] = searchValue;
                }
            });
            return inputFields;
        };
        ServiceVariableManager.prototype.searchRecords = function(variable, options, success, error) {
            var inputFields = this.getQueryParams(_.split(options.searchKey, ","), options.query, variable);
            var requestParams = {
                page: options.page,
                pagesize: options.pagesize,
                skipDataSetUpdate: true,
                skipToggleState: true,
                inFlightBehavior: "executeAll",
                inputFields: inputFields
            };
            if (options.onBeforeservicecall) {
                options.onBeforeservicecall(inputFields);
            }
            return this.invoke(variable, requestParams, success, error).catch(core.noop);
        };
        return ServiceVariableManager;
    }(BaseVariableManager);
    var LiveVariableUtils = function() {
        function LiveVariableUtils() {}
        LiveVariableUtils.isCompositeKey = function(primaryKey) {
            return !primaryKey || primaryKey && (!primaryKey.length || primaryKey.length > 1);
        };
        LiveVariableUtils.isNoPrimaryKey = function(primaryKey) {
            return !primaryKey || primaryKey && !primaryKey.length;
        };
        LiveVariableUtils.getCompositeIDURL = function(primaryKeysData) {
            var compositeId = "";
            _.forEach(primaryKeysData, function(paramValue, paramName) {
                compositeId += paramName + "=" + encodeURIComponent(paramValue) + "&";
            });
            compositeId = compositeId.slice(0, -1);
            return compositeId;
        };
        LiveVariableUtils.hasBlob = function(variable) {
            return _.find(_.get(variable, [ "propertiesMap", "columns" ]), {
                type: "blob"
            });
        };
        LiveVariableUtils.getPrimaryKey = function(variable) {
            if (!variable.propertiesMap) {
                return [];
            }
            if (variable.propertiesMap.primaryFields) {
                return variable.propertiesMap.primaryFields;
            }
            var primaryKey = [];
            _.forEach(variable.propertiesMap.columns, function(index, column) {
                if (column.isPrimaryKey) {
                    if (column.isRelated && !_.includes(column.relatedFieldName, primaryKey)) {
                        primaryKey.push(column.relatedFieldName);
                    } else if (!_.includes(column.fieldName, primaryKey)) {
                        primaryKey.push(column.fieldName);
                    }
                }
            });
            return primaryKey;
        };
        LiveVariableUtils.processBlobColumns = function(responseData, variable) {
            if (!responseData) {
                return;
            }
            var blobCols = _.map(_.filter(variable.propertiesMap.columns, {
                type: "blob"
            }), "fieldName"), deployedUrl = _.trim($rootScope.project.deployedUrl);
            var href = "", primaryKeys;
            if (_.isEmpty(blobCols)) {
                return;
            }
            if (core.hasCordova()) {
                href += _.endsWith(deployedUrl, "/") ? deployedUrl : deployedUrl + "/";
            }
            href += (variable._prefabName !== "" && variable._prefabName !== undefined ? "prefabs/" + variable._prefabName : "services") + "/" + variable.liveSource + "/" + variable.type + "/";
            primaryKeys = variable.propertiesMap.primaryFields || variable.propertiesMap.primaryKeys;
            _.forEach(responseData, function(data) {
                if (data) {
                    _.forEach(blobCols, function(col) {
                        var compositeKeysData = {};
                        if (data[col] === null || !_.isEmpty(_.trim(data[col]))) {
                            return;
                        }
                        if (LiveVariableUtils.isCompositeKey(primaryKeys)) {
                            primaryKeys.forEach(function(key) {
                                compositeKeysData[key] = data[key];
                            });
                            data[col] = href + "composite-id/content/" + col + "?" + LiveVariableUtils.getCompositeIDURL(compositeKeysData);
                        } else {
                            data[col] = href + data[_.join(primaryKeys)] + "/content/" + col;
                        }
                    });
                }
            });
        };
        LiveVariableUtils.getHibernateOrSqlType = function(variable, fieldName, type, entityName) {
            var columns = variable.propertiesMap.columns;
            var column, relatedCols, relatedCol;
            if (_.includes(fieldName, ".")) {
                column = _.find(columns, function(col) {
                    return col.fieldName === fieldName.split(".")[0];
                });
                relatedCols = column && column.columns;
                relatedCol = _.find(relatedCols, function(col) {
                    return col.fieldName === fieldName.split(".")[1];
                });
                return relatedCol && relatedCol[type];
            }
            column = _.find(columns, function(col) {
                return col.fieldName === fieldName || col.relatedColumnName === fieldName;
            });
            if (!column && entityName) {
                var entity = _.find(columns, function(col) {
                    return col.relatedEntityName === entityName;
                });
                column = _.find(entity.columns, function(col) {
                    return col.fieldName === fieldName || col.relatedColumnName === fieldName;
                });
            }
            return column && column[type];
        };
        LiveVariableUtils.getSqlType = function(variable, fieldName, entityName) {
            return LiveVariableUtils.getHibernateOrSqlType(variable, fieldName, "type", entityName);
        };
        LiveVariableUtils.isRelatedFieldMany = function(variable, fieldName) {
            var columns = variable.propertiesMap.columns, columnsCount = columns.length;
            var index, column;
            for (index = 0; index < columnsCount; index += 1) {
                column = columns[index];
                if (column.fieldName === fieldName) {
                    return false;
                }
            }
            return true;
        };
        LiveVariableUtils.isStringType = function(type) {
            return _.includes([ "text", "string" ], _.toLower(type));
        };
        LiveVariableUtils.getSQLFieldType = function(variable, options) {
            if (_.includes([ "timestamp", "datetime", "date" ], options.type)) {
                return options.type;
            }
            return LiveVariableUtils.getSqlType(variable, options.fieldName) || options.type;
        };
        LiveVariableUtils.getAttributeName = function(variable, fieldName) {
            var attrName = fieldName;
            variable.propertiesMap.columns.forEach(function(column) {
                if (column.fieldName === fieldName && column.isRelated) {
                    attrName = column.relatedFieldName;
                }
            });
            return attrName;
        };
        LiveVariableUtils.getFilterCondition = function(filterCondition) {
            if (_.includes(DB_CONSTANTS.DATABASE_RANGE_MATCH_MODES, filterCondition)) {
                return filterCondition;
            }
            return DB_CONSTANTS.DATABASE_MATCH_MODES["exact"];
        };
        LiveVariableUtils.getFilterOption = function(variable, fieldOptions, options) {
            var attributeName, fieldValue = fieldOptions.value, filterOption, filterCondition;
            var matchModes = DB_CONSTANTS.DATABASE_MATCH_MODES, fieldName = fieldOptions.fieldName, fieldRequired = fieldOptions.required || false, fieldType = LiveVariableUtils.getSQLFieldType(variable, fieldOptions);
            filterCondition = matchModes[fieldOptions.matchMode] || matchModes[fieldOptions.filterCondition] || fieldOptions.filterCondition;
            fieldOptions.type = fieldType;
            if (_.isObject(fieldValue) && !_.isArray(fieldValue)) {
                var firstLevelValues_1 = [];
                _.forEach(fieldValue, function(subFieldValue, subFieldName) {
                    if (subFieldValue && !_.isObject(subFieldValue)) {
                        firstLevelValues_1.push(fieldName + "." + subFieldName + "=" + subFieldValue);
                    }
                });
                return firstLevelValues_1;
            }
            if (_.includes(DB_CONSTANTS.DATABASE_EMPTY_MATCH_MODES, filterCondition)) {
                attributeName = LiveVariableUtils.getAttributeName(variable, fieldName);
                if (fieldType && !LiveVariableUtils.isStringType(fieldType)) {
                    filterCondition = DB_CONSTANTS.DATABASE_NULL_EMPTY_MATCH[filterCondition];
                }
                filterOption = {
                    attributeName: attributeName,
                    attributeValue: "",
                    attributeType: _.toUpper(fieldType),
                    filterCondition: filterCondition,
                    required: fieldRequired
                };
                if (options.searchWithQuery) {
                    filterOption.isVariableFilter = fieldOptions.isVariableFilter;
                }
                return filterOption;
            }
            if (core.isDefined(fieldValue) && fieldValue !== null && fieldValue !== "") {
                if (fieldType) {
                    switch (fieldType) {
                      case "integer":
                        fieldValue = _.isArray(fieldValue) ? _.reduce(fieldValue, function(result, value) {
                            value = parseInt(value, 10);
                            if (!_.isNaN(value)) {
                                result.push(value);
                            }
                            return result;
                        }, []) : parseInt(fieldValue, 10);
                        filterCondition = filterCondition ? LiveVariableUtils.getFilterCondition(filterCondition) : matchModes["exact"];
                        break;

                      case "date":
                      case "datetime":
                      case "timestamp":
                        fieldValue = formatDate(fieldValue, fieldType);
                        filterCondition = filterCondition ? LiveVariableUtils.getFilterCondition(filterCondition) : matchModes["exact"];
                        break;

                      case "text":
                      case "string":
                        if (_.isArray(fieldValue)) {
                            filterCondition = _.includes([ matchModes["in"], matchModes["notin"] ], filterCondition) ? filterCondition : matchModes["exact"];
                        } else {
                            filterCondition = filterCondition || matchModes["anywhereignorecase"];
                        }
                        break;

                      default:
                        filterCondition = filterCondition ? LiveVariableUtils.getFilterCondition(filterCondition) : matchModes["exact"];
                        break;
                    }
                } else {
                    filterCondition = _.isString(fieldValue) ? matchModes["anywhereignorecase"] : matchModes["exact"];
                }
                attributeName = LiveVariableUtils.getAttributeName(variable, fieldName);
                filterOption = {
                    attributeName: attributeName,
                    attributeValue: fieldValue,
                    attributeType: _.toUpper(fieldType),
                    filterCondition: filterCondition,
                    required: fieldRequired
                };
                if (options.searchWithQuery) {
                    filterOption.isVariableFilter = fieldOptions.isVariableFilter;
                }
                return filterOption;
            }
        };
        LiveVariableUtils.getFilterOptions = function(variable, filterFields, options) {
            var filterOptions = [];
            _.each(filterFields, function(fieldOptions) {
                var filterOption = LiveVariableUtils.getFilterOption(variable, fieldOptions, options);
                if (!_.isNil(filterOption)) {
                    if (_.isArray(filterOption)) {
                        filterOptions = filterOptions.concat(filterOption);
                    } else {
                        filterOptions.push(filterOption);
                    }
                }
            });
            return filterOptions;
        };
        LiveVariableUtils.wrapInLowerCase = function(value, options, ignoreCase, isField) {
            var type = _.toLower(options.attributeType);
            if (!isField) {
                if (type === "datetime") {
                    return "wm_dt(" + value + ")";
                }
                if (type === "timestamp") {
                    return "wm_ts(" + value + ")";
                }
                if (type === "float") {
                    return "wm_float(" + value + ")";
                }
                if (type === "boolean") {
                    return "wm_bool(" + value + ")";
                }
            }
            if (ignoreCase && (!type || LiveVariableUtils.isStringType(type)) && _.includes(DB_CONSTANTS.DATABASE_STRING_MODES, options.filterCondition)) {
                return "lower(" + value + ")";
            }
            return value;
        };
        LiveVariableUtils.encodeAndAddQuotes = function(value, type, skipEncode) {
            var encodedValue = skipEncode ? value : encodeURIComponent(value);
            type = _.toLower(type);
            encodedValue = _.replace(encodedValue, /'/g, "''");
            if (core.isNumberType(type) && type !== "float") {
                return encodedValue;
            }
            return "'" + encodedValue + "'";
        };
        LiveVariableUtils.getParamValue = function(value, options, ignoreCase, skipEncode) {
            var param;
            var filterCondition = options.filterCondition, dbModes = DB_CONSTANTS.DATABASE_MATCH_MODES, type = options.attributeType;
            if (_.includes(DB_CONSTANTS.DATABASE_EMPTY_MATCH_MODES, filterCondition)) {
                return "";
            }
            switch (filterCondition) {
              case dbModes.startignorecase:
              case dbModes.start:
                param = LiveVariableUtils.encodeAndAddQuotes(value + "%", type, skipEncode);
                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);
                break;

              case dbModes.endignorecase:
              case dbModes.end:
                param = LiveVariableUtils.encodeAndAddQuotes("%" + value, type, skipEncode);
                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);
                break;

              case dbModes.anywhereignorecase:
              case dbModes.anywhere:
                param = LiveVariableUtils.encodeAndAddQuotes("%" + value + "%", type, skipEncode);
                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);
                break;

              case dbModes.between:
                param = _.join(_.map(value, function(val) {
                    return LiveVariableUtils.wrapInLowerCase(LiveVariableUtils.encodeAndAddQuotes(val, type, skipEncode), options, ignoreCase);
                }), " and ");
                break;

              case dbModes.in:
              case dbModes.notin:
                param = _.join(_.map(value, function(val) {
                    return LiveVariableUtils.wrapInLowerCase(LiveVariableUtils.encodeAndAddQuotes(val, type, skipEncode), options, ignoreCase);
                }), ", ");
                param = "(" + param + ")";
                break;

              default:
                param = LiveVariableUtils.encodeAndAddQuotes(value, type, skipEncode);
                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);
                break;
            }
            return core.isDefined(param) ? param : "";
        };
        LiveVariableUtils.getSearchQuery = function(filterOptions, operator, ignoreCase, skipEncode) {
            var query;
            var params = [];
            _.forEach(filterOptions, function(fieldValue) {
                var value = fieldValue.attributeValue, dbModes = DB_CONSTANTS.DATABASE_MATCH_MODES, isValArray = _.isArray(value);
                var fieldName = fieldValue.attributeName, filterCondition = fieldValue.filterCondition, matchModeExpr, paramValue;
                if (isValArray && _.isEmpty(value) || !isValArray && isNaN(value) && core.isNumberType(fieldValue.attributeType)) {
                    return;
                }
                if (isValArray) {
                    filterCondition = filterCondition === dbModes.between || filterCondition === dbModes.notin ? filterCondition : dbModes.in;
                    fieldValue.filterCondition = filterCondition;
                }
                matchModeExpr = DB_CONSTANTS.DATABASE_MATCH_MODES_WITH_QUERY[filterCondition];
                paramValue = LiveVariableUtils.getParamValue(value, fieldValue, ignoreCase, skipEncode);
                fieldName = LiveVariableUtils.wrapInLowerCase(fieldName, fieldValue, ignoreCase, true);
                params.push(core.replace(matchModeExpr, [ fieldName, paramValue ]));
            });
            query = _.join(params, operator);
            return query;
        };
        LiveVariableUtils.processFilterFields = function(rules, variable, options) {
            _.remove(rules, function(rule) {
                return rule && (_.isString(rule.value) && rule.value.indexOf("bind:") === 0 || (rule.matchMode === "between" ? _.isString(rule.secondvalue) && rule.secondvalue.indexOf("bind:") === 0 : false));
            });
            _.forEach(rules, function(rule, index) {
                if (rule) {
                    if (rule.rules) {
                        LiveVariableUtils.processFilterFields(rule.rules, variable, options);
                    } else {
                        if (!_.isNull(rule.target)) {
                            var value = rule.matchMode.toLowerCase() === DB_CONSTANTS.DATABASE_MATCH_MODES.between.toLowerCase() ? _.isArray(rule.value) ? rule.value : [ rule.value, rule.secondvalue ] : rule.matchMode.toLowerCase() === DB_CONSTANTS.DATABASE_MATCH_MODES.in.toLowerCase() || rule.matchMode.toLowerCase() === DB_CONSTANTS.DATABASE_MATCH_MODES.notin.toLowerCase() ? _.isArray(rule.value) ? rule.value : rule.value ? rule.value.split(",").map(function(val) {
                                return val.trim();
                            }) : "" : rule.value;
                            rules[index] = LiveVariableUtils.getFilterOption(variable, {
                                fieldName: rule.target,
                                type: rule.type,
                                value: value,
                                required: rule.required,
                                filterCondition: rule.matchMode || options.matchMode || variable.matchMode
                            }, options);
                        }
                    }
                }
            });
        };
        LiveVariableUtils.getSearchField = function(fieldValue, ignoreCase, skipEncode) {
            var fieldName = fieldValue.attributeName;
            var matchModeExpr;
            var paramValue;
            var filterCondition = fieldValue.filterCondition;
            var value = fieldValue.attributeValue;
            var isValArray = _.isArray(value);
            var dbModes = DB_CONSTANTS.DATABASE_MATCH_MODES;
            if (isValArray && _.isEmpty(value) || isValArray && _.some(value, function(val) {
                return _.isNull(val) || _.isNaN(val) || val === "";
            }) || !isValArray && isNaN(value) && core.isNumberType(fieldValue.attributeType)) {
                return;
            }
            if (isValArray) {
                filterCondition = filterCondition === dbModes.between || filterCondition === dbModes.notin ? filterCondition : dbModes.in;
                fieldValue.filterCondition = filterCondition;
            }
            matchModeExpr = DB_CONSTANTS.DATABASE_MATCH_MODES_WITH_QUERY[filterCondition];
            paramValue = LiveVariableUtils.getParamValue(value, fieldValue, ignoreCase, skipEncode);
            fieldName = LiveVariableUtils.wrapInLowerCase(fieldName, fieldValue, ignoreCase, true);
            return core.replace(matchModeExpr, [ fieldName, paramValue ]);
        };
        LiveVariableUtils.getIgnoreCase = function(matchMode, ignoreCase) {
            var matchModes = DB_CONSTANTS.DATABASE_MATCH_MODES;
            if (_.indexOf([ matchModes["anywhere"], matchModes["start"], matchModes["end"], matchModes["exact"] ], matchMode) !== -1) {
                return false;
            }
            if (_.indexOf([ matchModes["anywhereignorecase"], matchModes["startignorecase"], matchModes["endignorecase"], matchModes["exactignorecase"] ], matchMode) !== -1) {
                return true;
            }
            return ignoreCase;
        };
        LiveVariableUtils.generateSearchQuery = function(rules, condition, ignoreCase, skipEncode) {
            var params = [];
            _.forEach(rules, function(rule) {
                if (rule) {
                    if (rule.rules) {
                        var query = LiveVariableUtils.generateSearchQuery(rule.rules, rule.condition, ignoreCase, skipEncode);
                        if (query !== "") {
                            params.push("(" + query + ")");
                        }
                    } else {
                        var searchField = LiveVariableUtils.getSearchField(rule, LiveVariableUtils.getIgnoreCase(rule.filterCondition, ignoreCase), skipEncode);
                        if (!_.isNil(searchField)) {
                            params.push(searchField);
                        }
                    }
                }
            });
            return _.join(params, " " + condition + " ");
        };
        LiveVariableUtils.prepareTableOptionsForFilterExps = function(variable, options, clonedFields) {
            if (!core.isDefined(options.searchWithQuery)) {
                options.searchWithQuery = true;
            }
            var filterOptions = [];
            var matchModes = DB_CONSTANTS.DATABASE_MATCH_MODES;
            var orderByFields, orderByOptions, query;
            var clonedObj = clonedFields || core.getClonedObject(variable.filterExpressions);
            if (options.filterExpr && !_.isEmpty(options.filterExpr)) {
                clonedObj = options.filterExpr;
            }
            var filterRules = {};
            if (!_.isEmpty(options.filterFields)) {
                filterRules = {
                    condition: options.logicalOp || "AND",
                    rules: []
                };
                _.forEach(options.filterFields, function(filterObj, filterName) {
                    var filterCondition = matchModes[filterObj.matchMode] || matchModes[filterObj.filterCondition] || filterObj.filterCondition;
                    if (_.includes(DB_CONSTANTS.DATABASE_EMPTY_MATCH_MODES, filterCondition) || !_.isNil(filterObj.value) && filterObj.value !== "") {
                        var type = filterObj.type || LiveVariableUtils.getSqlType(variable, filterName, options.entityName);
                        var ruleObj = {
                            target: filterName,
                            type: type,
                            matchMode: filterObj.matchMode || (LiveVariableUtils.isStringType(type) ? "startignorecase" : "exact"),
                            value: filterObj.value,
                            required: filterObj.required || false
                        };
                        filterRules.rules.push(ruleObj);
                    }
                });
            }
            if (!_.isEmpty(clonedObj)) {
                if (!_.isNil(filterRules.rules) && filterRules.rules.length) {
                    var tempRules = {
                        condition: "AND",
                        rules: []
                    };
                    tempRules.rules.push(core.getClonedObject(clonedObj));
                    tempRules.rules.push(filterRules);
                    clonedObj = tempRules;
                }
            } else {
                clonedObj = filterRules;
            }
            LiveVariableUtils.processFilterFields(clonedObj.rules, variable, options);
            query = LiveVariableUtils.generateSearchQuery(clonedObj.rules, clonedObj.condition, variable.ignoreCase, options.skipEncode);
            orderByFields = getEvaluatedOrderBy(variable.orderBy, options.orderBy);
            orderByOptions = orderByFields ? "sort=" + orderByFields : "";
            return {
                filter: filterOptions,
                sort: orderByOptions,
                query: query
            };
        };
        LiveVariableUtils.prepareTableOptions = function(variable, options, clonedFields) {
            if (variable.operation === "read") {
                return LiveVariableUtils.prepareTableOptionsForFilterExps(variable, options, clonedFields);
            }
            if (!core.isDefined(options.searchWithQuery)) {
                options.searchWithQuery = true;
            }
            var filterFields = [];
            var filterOptions = [], orderByFields, orderByOptions, query, optionsQuery;
            clonedFields = clonedFields || variable.filterFields;
            _.forEach(clonedFields, function(value, key) {
                if (_.isObject(value) && (!options.filterFields || !options.filterFields[key] || options.filterFields[key].logicalOp === "AND")) {
                    value.fieldName = key;
                    if (LiveVariableUtils.isStringType(LiveVariableUtils.getSQLFieldType(variable, value))) {
                        value.filterCondition = DB_CONSTANTS.DATABASE_MATCH_MODES[value.matchMode || variable.matchMode];
                    }
                    value.isVariableFilter = true;
                    filterFields.push(value);
                }
            });
            _.forEach(options.filterFields, function(value, key) {
                value.fieldName = key;
                value.filterCondition = DB_CONSTANTS.DATABASE_MATCH_MODES[value.matchMode || options.matchMode || variable.matchMode];
                filterFields.push(value);
            });
            if (variable.operation === "read" || options.operation === "read") {
                filterOptions = LiveVariableUtils.getFilterOptions(variable, filterFields, options);
            }
            if (options.searchWithQuery && filterOptions.length) {
                query = LiveVariableUtils.getSearchQuery(_.filter(filterOptions, {
                    isVariableFilter: true
                }), " AND ", variable.ignoreCase, options.skipEncode);
                optionsQuery = LiveVariableUtils.getSearchQuery(_.filter(filterOptions, {
                    isVariableFilter: undefined
                }), " " + (options.logicalOp || "AND") + " ", variable.ignoreCase, options.skipEncode);
                if (optionsQuery) {
                    query = query ? query + " AND ( " + optionsQuery + " )" : optionsQuery;
                }
            }
            orderByFields = getEvaluatedOrderBy(variable.orderBy, options.orderBy);
            orderByOptions = orderByFields ? "sort=" + orderByFields : "";
            return {
                filter: filterOptions,
                sort: orderByOptions,
                query: query
            };
        };
        LiveVariableUtils.getFieldType = function(fieldName, variable, relatedField) {
            var fieldType, columns, result;
            if (variable.propertiesMap) {
                columns = variable.propertiesMap.columns || [];
                result = _.find(columns, function(obj) {
                    return obj.fieldName === fieldName;
                });
                if (relatedField && result) {
                    result = _.find(result.columns, function(obj) {
                        return obj.fieldName === relatedField;
                    });
                }
                fieldType = result && result.type;
            }
            return fieldType;
        };
        LiveVariableUtils.prepareFormData = function(variableDetails, rowObject) {
            var formData = new FormData();
            formData.rowData = _.clone(rowObject);
            _.forEach(rowObject, function(colValue, colName) {
                if (LiveVariableUtils.getFieldType(colName, variableDetails) === "blob") {
                    if (_.isObject(colValue)) {
                        if (_.isArray(colValue)) {
                            _.forEach(colValue, function(fileObject) {
                                formData.append(colName, fileObject, fileObject.name);
                            });
                        } else {
                            formData.append(colName, colValue, colValue.name);
                        }
                    }
                    rowObject[colName] = colValue !== null ? "" : null;
                }
            });
            formData.append(SWAGGER_CONSTANTS.WM_DATA_JSON, new Blob([ JSON.stringify(rowObject) ], {
                type: "application/json"
            }));
            return formData;
        };
        LiveVariableUtils.traverseFilterExpressions = function(filterExpressions, traverseCallbackFn) {
            if (filterExpressions && filterExpressions.rules) {
                _.forEach(filterExpressions.rules, function(filExpObj, i) {
                    if (filExpObj.rules) {
                        LiveVariableUtils.traverseFilterExpressions(filExpObj, traverseCallbackFn);
                    } else {
                        return core.triggerFn(traverseCallbackFn, filterExpressions, filExpObj);
                    }
                });
            }
        };
        LiveVariableUtils.getFilterExprFields = function(filterExpressions) {
            var isRequiredFieldAbsent = false;
            var traverseCallbackFn = function(parentFilExpObj, filExpObj) {
                if (filExpObj && filExpObj.required && (_.indexOf([ "null", "isnotnull", "empty", "isnotempty", "nullorempty" ], filExpObj.matchMode) === -1 && filExpObj.value === "")) {
                    isRequiredFieldAbsent = true;
                    return false;
                }
            };
            LiveVariableUtils.traverseFilterExpressions(filterExpressions, traverseCallbackFn);
            return isRequiredFieldAbsent ? !isRequiredFieldAbsent : filterExpressions;
        };
        LiveVariableUtils.getWhereClauseGenerator = function(variable, options, updatedFilterFields) {
            return function(modifier, skipEncode) {
                var clonedFields = LiveVariableUtils.getFilterExprFields(core.getClonedObject(updatedFilterFields || variable.filterExpressions));
                if (core.isDefined(skipEncode)) {
                    options.skipEncode = skipEncode;
                }
                if (modifier) {
                    if (options.filterFields) {
                        modifier(clonedFields, options);
                    } else {
                        modifier(clonedFields);
                    }
                }
                return LiveVariableUtils.prepareTableOptions(variable, options, clonedFields).query;
            };
        };
        return LiveVariableUtils;
    }();
    var isStudioMode = false;
    var parseConfig = function(serviceParams) {
        var val, param, config;
        var urlParams = serviceParams.urlParams;
        if (VARIABLE_URLS.hasOwnProperty(serviceParams.target) && VARIABLE_URLS[serviceParams.target].hasOwnProperty(serviceParams.action)) {
            config = core.getClonedObject(VARIABLE_URLS[serviceParams.target][serviceParams.action]);
            if (serviceParams.config) {
                config.url = (serviceParams.config.url || "") + config.url;
                config.method = serviceParams.config.method || config.method;
                config.headers = config.headers || {};
                for (var key in serviceParams.config.headers) {
                    val = serviceParams.config.headers[key];
                    config.headers[key] = val;
                }
            }
            if (urlParams) {
                for (param in urlParams) {
                    if (urlParams.hasOwnProperty(param)) {
                        val = urlParams[param];
                        if (!_.isUndefined(val) && val !== null) {
                            config.url = config.url.replace(new RegExp(":" + param, "g"), val);
                        }
                    }
                }
            }
            if (serviceParams.params) {
                config.params = serviceParams.params;
            }
            if (!_.isUndefined(serviceParams.data)) {
                config.data = serviceParams.data;
            }
            if (serviceParams.dataParams) {
                config.data.params = serviceParams.dataParams;
            }
            if (serviceParams.headers) {
                config.headers = serviceParams.headers;
            }
            config.byPassResult = serviceParams.byPassResult;
            config.isDirectCall = serviceParams.isDirectCall;
            config.isExtURL = serviceParams.isExtURL;
            config.preventMultiple = serviceParams.preventMultiple;
            config.responseType = serviceParams.responseType;
            return config;
        }
        return null;
    };
    var generateConnectionParams = function(params, action) {
        var connectionParams, urlParams, requestData;
        requestData = params.data;
        urlParams = {
            projectID: params.projectID,
            service: !_.isUndefined(params.service) ? params.service : "services",
            dataModelName: params.dataModelName,
            entityName: params.entityName,
            queryName: params.queryName,
            queryParams: params.queryParams,
            procedureName: params.procedureName,
            procedureParams: params.procedureParams,
            id: params.id,
            relatedFieldName: params.relatedFieldName,
            page: params.page,
            size: params.size,
            sort: params.sort
        };
        connectionParams = {
            target: "DATABASE",
            action: action,
            urlParams: urlParams,
            data: requestData || "",
            config: {
                url: params.url
            }
        };
        connectionParams = parseConfig(connectionParams);
        connectionParams.url = core.removeExtraSlashes(connectionParams.url);
        return connectionParams;
    };
    var initiateAction = function(action, params, successCallback, failureCallback, noproxy) {
        var connectionParams;
        if (params.url && isStudioMode && !noproxy) ; else {
            connectionParams = generateConnectionParams(params, action);
            params.operation = action;
            return exports.httpService.sendCallAsObservable({
                url: connectionParams.url,
                method: connectionParams.method,
                data: connectionParams.data,
                headers: connectionParams.headers
            }, params);
        }
    };
    var \u02750$3 = initiateAction;
    var LVService = {
        searchTableDataWithQuery: function(params, successCallback, failureCallback) {
            return initiateAction("searchTableDataWithQuery", params, successCallback, failureCallback);
        },
        executeAggregateQuery: function(params, successCallback, failureCallback) {
            return initiateAction("executeAggregateQuery", params, successCallback, failureCallback);
        },
        searchTableData: function(params, successCallback, failureCallback) {
            return initiateAction("searchTableData", params, successCallback, failureCallback);
        },
        readTableData: function(params, successCallback, failureCallback) {
            return initiateAction("readTableData", params, successCallback, failureCallback);
        },
        insertTableData: function(params, successCallback, failureCallback) {
            return initiateAction("insertTableData", params, successCallback, failureCallback);
        },
        insertMultiPartTableData: function(params, successCallback, failureCallback) {
            return initiateAction("insertMultiPartTableData", params, successCallback, failureCallback);
        },
        updateTableData: function(params, successCallback, failureCallback) {
            return initiateAction("updateTableData", params, successCallback, failureCallback);
        },
        updateCompositeTableData: function(params, successCallback, failureCallback) {
            return initiateAction("updateCompositeTableData", params, successCallback, failureCallback);
        },
        periodUpdateCompositeTableData: function(params, successCallback, failureCallback) {
            return initiateAction("periodUpdateCompositeTableData", params, successCallback, failureCallback);
        },
        updateMultiPartTableData: function(params, successCallback, failureCallback) {
            return initiateAction("updateMultiPartTableData", params, successCallback, failureCallback);
        },
        updateMultiPartCompositeTableData: function(params, successCallback, failureCallback) {
            return initiateAction("updateMultiPartCompositeTableData", params, successCallback, failureCallback);
        },
        deleteTableData: function(params, successCallback, failureCallback) {
            return initiateAction("deleteTableData", params, successCallback, failureCallback);
        },
        deleteCompositeTableData: function(params, successCallback, failureCallback) {
            return initiateAction("deleteCompositeTableData", params, successCallback, failureCallback);
        },
        periodDeleteCompositeTableData: function(params, successCallback, failureCallback) {
            return initiateAction("periodDeleteCompositeTableData", params, successCallback, failureCallback);
        },
        exportTableData: function(params) {
            return initiateAction("exportTableData", params);
        },
        getDistinctDataByFields: function(params) {
            return initiateAction("getDistinctDataByFields", params);
        },
        countTableDataWithQuery: function(params, successCallback, failureCallback) {
            return initiateAction("countTableDataWithQuery", params, successCallback, failureCallback);
        }
    };
    var emptyArr = [];
    var LiveVariableManager = function(_super) {
        __extends(LiveVariableManager, _super);
        function LiveVariableManager() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.getFilterExprFields = function(filterExpressions) {
                var isRequiredFieldAbsent = false;
                var traverseCallbackFn = function(parentFilExpObj, filExpObj) {
                    if (filExpObj && filExpObj.required && (_.indexOf([ "null", "isnotnull", "empty", "isnotempty", "nullorempty" ], filExpObj.matchMode) === -1 && filExpObj.value === "")) {
                        isRequiredFieldAbsent = true;
                        return false;
                    }
                };
                LiveVariableUtils.traverseFilterExpressions(filterExpressions, traverseCallbackFn);
                return isRequiredFieldAbsent ? !isRequiredFieldAbsent : filterExpressions;
            };
            _this.getDataFilterObj = function(clonedFilterFields) {
                return function(clonedFields) {
                    function getCriteria(filterField) {
                        var criterian = [];
                        LiveVariableUtils.traverseFilterExpressions(clonedFields, function(filterExpressions, criteria) {
                            if (filterField === criteria.target) {
                                criterian.push(criteria);
                            }
                        });
                        return criterian;
                    }
                    function getFilterFields() {
                        return clonedFields;
                    }
                    return {
                        getFilterFields: getFilterFields,
                        getCriteria: getCriteria
                    };
                }(clonedFilterFields);
            };
            return _this;
        }
        LiveVariableManager.prototype.initFilterExpressionBinding = function(variable) {
            var context = variable._context;
            var destroyFn = context.registerDestroyListener ? context.registerDestroyListener.bind(context) : _.noop;
            var filterSubscription = core.processFilterExpBindNode(context, variable.filterExpressions).subscribe(function(response) {
                if (variable.operation === "read") {
                    if (variable.autoUpdate && !_.isUndefined(response.newVal) && _.isFunction(variable.update)) {
                        debounceVariableCall(variable, "update");
                    }
                } else {
                    if (variable.autoUpdate && !_.isUndefined(response.newVal) && _.isFunction(variable[variable.operation + "Record"])) {
                        debounceVariableCall(variable, variable.operation + "Record");
                    }
                }
            });
            destroyFn(function() {
                return filterSubscription.unsubscribe();
            });
        };
        LiveVariableManager.prototype.updateDataset = function(variable, data, propertiesMap, pagination) {
            variable.pagination = pagination;
            variable.dataSet = data;
            Object.defineProperty(variable.dataSet, "data", {
                get: function() {
                    return variable.dataSet;
                }
            });
            Object.defineProperty(variable.dataSet, "pagination", {
                get: function() {
                    return variable.pagination;
                }
            });
        };
        LiveVariableManager.prototype.setVariableOptions = function(variable, options) {
            variable._options = variable._options || {};
            variable._options.orderBy = options && options.orderBy;
            variable._options.filterFields = options && options.filterFields;
        };
        LiveVariableManager.prototype.handleError = function(variable, errorCB, response, options, advancedOptions) {
            var opt;
            core.triggerFn(errorCB, response);
            initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);
            if (!options.skipDataSetUpdate) {
                this.updateDataset(variable, emptyArr, variable.propertiesMap, null);
            }
            opt = this.prepareCallbackOptions(options.errorDetails);
            initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response, opt);
            variable.canUpdate = true;
            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, response, advancedOptions);
        };
        LiveVariableManager.prototype.makeCall = function(variable, dbOperation, params) {
            var _this = this;
            var successHandler = function(response, resolve) {
                if (response && response.type) {
                    resolve(response);
                }
            };
            var errorHandler = function(error, reject) {
                var errMsg = exports.httpService.getErrMessage(error);
                _this.notifyInflight(variable, false);
                reject({
                    error: errMsg,
                    details: error
                });
            };
            return new Promise(function(resolve, reject) {
                var reqParams = generateConnectionParams(params, dbOperation);
                reqParams = {
                    url: reqParams.url,
                    method: reqParams.method,
                    data: reqParams.data,
                    headers: reqParams.headers
                };
                params.operation = dbOperation;
                _this.httpCall(reqParams, variable, params).then(function(response) {
                    successHandler(response, resolve);
                }, function(e) {
                    errorHandler(e, reject);
                });
            });
        };
        LiveVariableManager.prototype.getEntityData = function(variable, options, success, error) {
            var _this = this;
            var dataObj = {};
            var tableOptions, dbOperation, output, newDataSet, clonedFields, requestData, dbOperationOptions, getEntitySuccess, getEntityError;
            clonedFields = this.getFilterExprFields(core.getClonedObject(variable.filterExpressions || {}));
            output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, this.getDataFilterObj(clonedFields), options);
            var updateFilterFields = _.isObject(output) ? core.getClonedObject(output) : undefined;
            if (output === false) {
                $queue.process(variable);
                core.triggerFn(error, "Call stopped from the event: " + VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE);
                return Promise.reject("Call stopped from the event: " + VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE);
            }
            variable.canUpdate = false;
            tableOptions = LiveVariableUtils.prepareTableOptions(variable, options, _.isObject(output) ? output : clonedFields);
            if (options.searchWithQuery) {
                dbOperation = "searchTableDataWithQuery";
                requestData = tableOptions.query ? "q=" + tableOptions.query : "";
            } else {
                dbOperation = tableOptions.filter && tableOptions.filter.length ? "searchTableData" : "readTableData";
                requestData = tableOptions.filter;
            }
            dbOperationOptions = {
                projectID: $rootScope.project.id,
                service: variable.getPrefabName() ? "" : "services",
                dataModelName: variable.liveSource,
                entityName: variable.type,
                page: options.page || 1,
                size: options.pagesize || (CONSTANTS.isRunMode ? variable.maxResults || 20 : variable.designMaxResults || 20),
                sort: tableOptions.sort,
                data: requestData,
                filter: LiveVariableUtils.getWhereClauseGenerator(variable, options, updateFilterFields),
                url: variable.getPrefabName() ? $rootScope.project.deployedUrl + "/prefabs/" + variable.getPrefabName() : $rootScope.project.deployedUrl
            };
            getEntitySuccess = function(response, resolve) {
                if (response && response.type) {
                    response = response.body;
                    dataObj.data = response.content;
                    dataObj.pagination = _.omit(response, "content");
                    var advancedOptions_1 = _this.prepareCallbackOptions(response, {
                        pagination: dataObj.pagination
                    });
                    if (response && response.error || !response || !_.isArray(response.content)) {
                        _this.handleError(variable, error, response.error, options, advancedOptions_1);
                        return Promise.reject(response.error);
                    }
                    LiveVariableUtils.processBlobColumns(response.content, variable);
                    if (!options.skipDataSetUpdate) {
                        initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, dataObj.data, advancedOptions_1);
                        newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, dataObj.data, advancedOptions_1);
                        if (newDataSet) {
                            dataObj.data = newDataSet;
                        }
                        _this.updateDataset(variable, dataObj.data, variable.propertiesMap, dataObj.pagination);
                        _this.setVariableOptions(variable, options);
                        core.$invokeWatchers(true);
                        setTimeout(function() {
                            core.triggerFn(success, dataObj.data, variable.propertiesMap, dataObj.pagination);
                            initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, dataObj.data, advancedOptions_1);
                            variable.canUpdate = true;
                            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, dataObj.data, advancedOptions_1);
                        });
                    }
                    return resolve({
                        data: dataObj.data,
                        pagination: dataObj.pagination
                    });
                }
            };
            getEntityError = function(e, reject) {
                _this.setVariableOptions(variable, options);
                _this.handleError(variable, error, e.error, _.extend(options, {
                    errorDetails: e.details
                }));
                return reject(e.error);
            };
            return new Promise(function(resolve, reject) {
                _this.makeCall(variable, dbOperation, dbOperationOptions).then(function(response) {
                    getEntitySuccess(response, resolve);
                }, function(err) {
                    getEntityError(err, reject);
                });
            });
        };
        LiveVariableManager.prototype.performCUD = function(operation, variable, options, success, error) {
            var _this = this;
            options = options || {};
            options.inputFields = options.inputFields || core.getClonedObject(variable.inputFields);
            return $queue.submit(variable).then(function() {
                _this.notifyInflight(variable, !options.skipToggleState);
                return _this.doCUD(operation, variable, options, success, error).then(function(response) {
                    $queue.process(variable);
                    _this.notifyInflight(variable, false, response);
                    return Promise.resolve(response);
                }, function(err) {
                    $queue.process(variable);
                    _this.notifyInflight(variable, false, err);
                    return Promise.reject(err);
                });
            }, error);
        };
        LiveVariableManager.prototype.doCUD = function(action, variable, options, success, error) {
            var _this = this;
            var projectID = $rootScope.project.id || $rootScope.projectName, primaryKey = LiveVariableUtils.getPrimaryKey(variable), isFormDataSupported = window.File && window.FileReader && window.FileList && window.Blob;
            var dbName, compositeId = "", rowObject = {}, prevData, compositeKeysData = {}, prevCompositeKeysData = {}, id, columnName, clonedFields, output, onCUDerror, onCUDsuccess, inputFields = options.inputFields || variable.inputFields;
            clonedFields = core.getClonedObject(inputFields);
            output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, clonedFields, options);
            if (output === false) {
                core.triggerFn(error);
                return Promise.reject("Call stopped from the event: " + VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE);
            }
            inputFields = _.isObject(output) ? output : clonedFields;
            variable.canUpdate = false;
            if (options.row) {
                rowObject = options.row;
                _.forEach(rowObject, function(value, key) {
                    var fieldType = LiveVariableUtils.getFieldType(key, variable);
                    var fieldValue;
                    if (core.isDateTimeType(fieldType)) {
                        fieldValue = formatDate(value, fieldType);
                        rowObject[key] = fieldValue;
                    } else if (_.isArray(value) && LiveVariableUtils.isStringType(fieldType)) {
                        fieldValue = _.join(value, ",");
                        rowObject[key] = fieldValue;
                    }
                });
                _.forEach(inputFields, function(attrValue, attrName) {
                    if (core.isDefined(attrValue) && attrValue !== "" && (!core.isDefined(rowObject[attrName]) || rowObject[attrName] === "")) {
                        rowObject[attrName] = attrValue;
                    }
                });
            } else {
                _.forEach(inputFields, function(fieldValue, fieldName) {
                    var fieldType;
                    var primaryKeys = variable.propertiesMap.primaryFields || variable.propertiesMap.primaryKeys;
                    if (!_.isUndefined(fieldValue) && fieldValue !== "") {
                        if (action === "deleteTableData") {
                            compositeId = fieldValue;
                        }
                        if (action === "updateTableData") {
                            primaryKeys.forEach(function(key) {
                                if (fieldName === key) {
                                    compositeId = fieldValue;
                                }
                            });
                        }
                        if (action !== "deleteTableData" || LiveVariableUtils.isCompositeKey(primaryKey)) {
                            fieldType = LiveVariableUtils.getFieldType(fieldName, variable);
                            if (core.isDateTimeType(fieldType)) {
                                fieldValue = formatDate(fieldValue, fieldType);
                            } else if (_.isArray(fieldValue) && LiveVariableUtils.isStringType(fieldType)) {
                                fieldValue = _.join(fieldValue, ",");
                            }
                            rowObject[fieldName] = fieldValue;
                        }
                        if (_.isObject(fieldValue) && !_.isArray(fieldValue)) {
                            _.forEach(fieldValue, function(val, key) {
                                if (LiveVariableUtils.getFieldType(fieldName, variable, key) === "blob") {
                                    fieldValue[key] = val === null ? val : "";
                                }
                            });
                        }
                    }
                });
            }
            switch (action) {
              case "updateTableData":
                prevData = options.prevData || {};
                if (LiveVariableUtils.isCompositeKey(primaryKey)) {
                    if (LiveVariableUtils.isNoPrimaryKey(primaryKey)) {
                        prevCompositeKeysData = prevData || options.rowData || rowObject;
                        compositeKeysData = rowObject;
                    } else {
                        primaryKey.forEach(function(key) {
                            compositeKeysData[key] = rowObject[key];
                            if (options.period) {
                                prevCompositeKeysData[key] = rowObject[key];
                            } else {
                                prevCompositeKeysData[key] = prevData[key] || options.rowData && options.rowData[key] || rowObject[key];
                            }
                        });
                    }
                    options.row = compositeKeysData;
                    options.compositeKeysData = prevCompositeKeysData;
                } else {
                    primaryKey.forEach(function(key) {
                        if (key.indexOf(".") === -1) {
                            id = prevData[key] || options.rowData && options.rowData[key] || rowObject[key];
                        } else {
                            columnName = key.split(".");
                            id = prevData[columnName[0]][columnName[1]];
                        }
                    });
                    options.id = id;
                    options.row = rowObject;
                }
                break;

              case "deleteTableData":
                if (LiveVariableUtils.isCompositeKey(primaryKey)) {
                    if (LiveVariableUtils.isNoPrimaryKey(primaryKey)) {
                        compositeKeysData = rowObject;
                    } else {
                        primaryKey.forEach(function(key) {
                            compositeKeysData[key] = rowObject[key];
                        });
                    }
                    options.compositeKeysData = compositeKeysData;
                } else if (!_.isEmpty(rowObject)) {
                    primaryKey.forEach(function(key) {
                        if (key.indexOf(".") === -1) {
                            id = rowObject[key];
                        } else {
                            columnName = key.split(".");
                            id = rowObject[columnName[0]][columnName[1]];
                        }
                    });
                    options.id = id;
                }
                break;

              default:
                break;
            }
            if ((action === "updateTableData" || action === "insertTableData") && LiveVariableUtils.hasBlob(variable) && isFormDataSupported) {
                if (action === "updateTableData") {
                    action = "updateMultiPartTableData";
                } else {
                    action = "insertMultiPartTableData";
                }
                rowObject = LiveVariableUtils.prepareFormData(variable, rowObject);
            }
            if (options.compositeKeysData) {
                switch (action) {
                  case "updateTableData":
                    action = "updateCompositeTableData";
                    break;

                  case "deleteTableData":
                    action = "deleteCompositeTableData";
                    break;

                  case "updateMultiPartTableData":
                    action = "updateMultiPartCompositeTableData";
                    break;

                  default:
                    break;
                }
                compositeId = LiveVariableUtils.getCompositeIDURL(options.compositeKeysData);
            }
            dbName = variable.liveSource;
            if (_.isEmpty(rowObject) && action === "deleteTableData") {
                rowObject = undefined;
            }
            if ((action === "updateCompositeTableData" || action === "deleteCompositeTableData") && options.period) {
                action = "period" + action.charAt(0).toUpperCase() + action.substr(1);
            }
            var dbOperations = {
                projectID: projectID,
                service: variable._prefabName ? "" : "services",
                dataModelName: dbName,
                entityName: variable.type,
                id: !_.isUndefined(options.id) ? encodeURIComponent(options.id) : compositeId,
                data: rowObject,
                url: variable._prefabName ? $rootScope.project.deployedUrl + "/prefabs/" + variable._prefabName : $rootScope.project.deployedUrl
            };
            onCUDerror = function(response, reject) {
                var errMsg = response.error;
                var advancedOptions = _this.prepareCallbackOptions(response);
                initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, errMsg, advancedOptions);
                if (!options.skipNotification) {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, errMsg, advancedOptions);
                }
                variable.canUpdate = true;
                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, errMsg, advancedOptions);
                core.triggerFn(error, errMsg);
                reject(errMsg);
            };
            onCUDsuccess = function(data, resolve) {
                var response = data.body;
                var advancedOptions = _this.prepareCallbackOptions(data);
                $queue.process(variable);
                if (response && response.error) {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response.error, advancedOptions);
                    variable.canUpdate = true;
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, response.error, advancedOptions);
                    core.triggerFn(error, response.error);
                    return Promise.reject(response.error);
                }
                initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);
                if (variable.operation !== "read") {
                    var newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, response, advancedOptions);
                    if (newDataSet) {
                        response = newDataSet;
                    }
                    variable.dataSet = response;
                }
                core.$invokeWatchers(true);
                setTimeout(function() {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, response, advancedOptions);
                    variable.canUpdate = true;
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, response, advancedOptions);
                });
                core.triggerFn(success, response);
                resolve(response);
            };
            return new Promise(function(resolve, reject) {
                _this.makeCall(variable, action, dbOperations).then(function(data) {
                    onCUDsuccess(data, resolve);
                }, function(response) {
                    onCUDerror(response, reject);
                });
            });
        };
        LiveVariableManager.prototype.aggregateData = function(deployedUrl, variable, options, success, error) {
            var _this = this;
            var tableOptions, dbOperationOptions, aggregateDataSuccess, aggregateDataError;
            var dbOperation = "executeAggregateQuery";
            options = options || {};
            options.skipEncode = true;
            if (variable.filterFields) {
                tableOptions = LiveVariableUtils.prepareTableOptions(variable, options);
                options.aggregations.filter = tableOptions.query;
            }
            dbOperationOptions = {
                dataModelName: variable.liveSource,
                entityName: variable.type,
                page: options.page || 1,
                size: options.size || variable.maxResults,
                sort: options.sort || "",
                url: deployedUrl,
                data: options.aggregations
            };
            aggregateDataSuccess = function(response, resolve) {
                if (response && response.type) {
                    if (response && response.error || !response) {
                        core.triggerFn(error, response.error);
                        return;
                    }
                    core.triggerFn(success, response);
                    resolve(response);
                }
            };
            aggregateDataError = function(errorMsg, reject) {
                core.triggerFn(error, errorMsg);
                reject(errorMsg);
            };
            return new Promise(function(resolve, reject) {
                _this.makeCall(variable, dbOperation, dbOperationOptions).then(function(response) {
                    aggregateDataSuccess(response, resolve);
                }, function(err) {
                    aggregateDataError(err, reject);
                });
            });
        };
        LiveVariableManager.prototype.listRecords = function(variable, options, success, error) {
            var _this = this;
            options = options || {};
            options.filterFields = options.filterFields || core.getClonedObject(variable.filterFields);
            return $queue.submit(variable).then(function() {
                _this.notifyInflight(variable, !options.skipToggleState);
                return _this.getEntityData(variable, options, success, error).then(function(response) {
                    $queue.process(variable);
                    _this.notifyInflight(variable, false, response);
                    return Promise.resolve(response);
                }, function(err) {
                    $queue.process(variable);
                    _this.notifyInflight(variable, false, err);
                    return Promise.reject(err);
                });
            }, error);
        };
        LiveVariableManager.prototype.insertRecord = function(variable, options, success, error) {
            return this.performCUD("insertTableData", variable, options, success, error);
        };
        LiveVariableManager.prototype.updateRecord = function(variable, options, success, error) {
            return this.performCUD("updateTableData", variable, options, success, error);
        };
        LiveVariableManager.prototype.deleteRecord = function(variable, options, success, error) {
            return this.performCUD("deleteTableData", variable, options, success, error);
        };
        LiveVariableManager.prototype.setInput = function(variable, key, val, options) {
            variable.inputFields = variable.inputFields || {};
            return setInput(variable.inputFields, key, val, options);
        };
        LiveVariableManager.prototype.setFilter = function(variable, key, val) {
            var paramObj = {}, targetObj = {};
            if (_.isObject(key)) {
                paramObj = key;
            } else {
                paramObj[key] = val;
            }
            if (!variable.filterExpressions) {
                variable.filterExpressions = {
                    condition: "AND",
                    rules: []
                };
            }
            targetObj = variable.filterExpressions;
            function getExistingCriteria(filterField) {
                var existingCriteria = null;
                LiveVariableUtils.traverseFilterExpressions(targetObj, function(filterExpressions, criteria) {
                    if (filterField === criteria.target) {
                        return existingCriteria = criteria;
                    }
                });
                return existingCriteria;
            }
            _.forEach(paramObj, function(paramVal, paramKey) {
                var existingCriteria = getExistingCriteria(paramKey);
                if (existingCriteria !== null) {
                    existingCriteria.value = paramVal;
                } else {
                    targetObj.rules.push({
                        target: paramKey,
                        type: "",
                        matchMode: "",
                        value: paramVal,
                        required: false
                    });
                }
            });
            return targetObj;
        };
        LiveVariableManager.prototype.download = function(variable, options, successHandler, errorHandler) {
            var _this = this;
            options = options || {};
            var tableOptions, dbOperationOptions, downloadSuccess, downloadError;
            var data = {};
            var dbOperation = "exportTableData";
            var projectID = $rootScope.project.id || $rootScope.projectName;
            options.data.searchWithQuery = true;
            options.data.skipEncode = true;
            tableOptions = LiveVariableUtils.prepareTableOptions(variable, options.data, undefined);
            data.query = tableOptions.query ? tableOptions.query : "";
            data.exportSize = options.data.exportSize;
            data.exportType = options.data.exportType;
            data.fields = formatExportExpression(options.data.fields);
            if (options.data.fileName) {
                data.fileName = options.data.fileName;
            }
            dbOperationOptions = {
                projectID: projectID,
                service: variable.getPrefabName() ? "" : "services",
                dataModelName: variable.liveSource,
                entityName: variable.type,
                sort: tableOptions.sort,
                url: variable.getPrefabName() ? $rootScope.project.deployedUrl + "/prefabs/" + variable.getPrefabName() : $rootScope.project.deployedUrl,
                data: data,
                filter: LiveVariableUtils.getWhereClauseGenerator(variable, options)
            };
            downloadSuccess = function(response, resolve) {
                if (response && response.type) {
                    window.location.href = response.body.result;
                    core.triggerFn(successHandler, response);
                    resolve(response);
                }
            };
            downloadError = function(err, reject) {
                var opt = _this.prepareCallbackOptions(err.details);
                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, err.error, opt);
                core.triggerFn(errorHandler, err.error);
                reject(err);
            };
            return new Promise(function(resolve, reject) {
                _this.makeCall(variable, dbOperation, dbOperationOptions).then(function(response) {
                    downloadSuccess(response, resolve);
                }, function(error) {
                    downloadError(error, reject);
                });
            });
        };
        LiveVariableManager.prototype.getRelatedTablePrimaryKeys = function(variable, relatedField) {
            var primaryKeys, result, relatedCols;
            if (!variable.propertiesMap) {
                return;
            }
            result = _.find(variable.propertiesMap.columns || [], {
                fieldName: relatedField
            });
            if (result) {
                relatedCols = result.columns;
                primaryKeys = _.map(_.filter(relatedCols, "isPrimaryKey"), "fieldName");
                if (primaryKeys.length) {
                    return primaryKeys;
                }
                if (relatedCols && relatedCols.length) {
                    relatedCols = _.find(relatedCols, {
                        isRelated: false
                    });
                    return relatedCols && relatedCols.fieldName;
                }
            }
        };
        LiveVariableManager.prototype.getRelatedTableData = function(variable, columnName, options, success, error) {
            var _this = this;
            var projectID = $rootScope.project.id || $rootScope.projectName;
            var relatedTable = _.find(variable.relatedTables, function(table) {
                return table.relationName === columnName || table.columnName === columnName;
            });
            var selfRelatedCols = _.map(_.filter(variable.relatedTables, function(o) {
                return o.type === variable.type;
            }), "relationName");
            var filterFields = [];
            var orderBy, filterOptions, query, action, dbOperationOptions, getRelatedTableDataSuccess, getRelatedTableDataError;
            _.forEach(options.filterFields, function(value, key) {
                value.fieldName = key;
                value.type = LiveVariableUtils.getFieldType(columnName, variable, key);
                if (value.filterCondition === DB_CONSTANTS.DATABASE_MATCH_MODES.in.toLowerCase() || value.filterCondition === DB_CONSTANTS.DATABASE_MATCH_MODES.between.toLowerCase()) {
                    value.value = value.value.split(",");
                }
                filterFields.push(value);
            });
            filterOptions = LiveVariableUtils.getFilterOptions(variable, filterFields, options);
            query = LiveVariableUtils.getSearchQuery(filterOptions, " " + (options.logicalOp || "AND") + " ", variable.ignoreCase);
            if (options.filterExpr) {
                var _clonedFields = core.getClonedObject(_.isObject(options.filterExpr) ? options.filterExpr : JSON.parse(options.filterExpr));
                LiveVariableUtils.processFilterFields(_clonedFields.rules, variable, options);
                var filterExpQuery = LiveVariableUtils.generateSearchQuery(_clonedFields.rules, _clonedFields.condition, variable.ignoreCase, options.skipEncode);
                if (query !== "") {
                    if (filterExpQuery !== "") {
                        query = "(" + query + ") AND (" + filterExpQuery + ")";
                    }
                } else if (filterExpQuery !== "") {
                    query = filterExpQuery;
                }
            }
            query = query ? "q=" + query : "";
            action = "searchTableDataWithQuery";
            orderBy = _.isEmpty(options.orderBy) ? "" : "sort=" + options.orderBy;
            dbOperationOptions = {
                projectID: projectID,
                service: variable.getPrefabName() ? "" : "services",
                dataModelName: variable.liveSource,
                entityName: relatedTable ? relatedTable.type : "",
                page: options.page || 1,
                size: options.pagesize || undefined,
                url: variable.getPrefabName() ? $rootScope.project.deployedUrl + "/prefabs/" + variable.getPrefabName() : $rootScope.project.deployedUrl,
                data: query || "",
                filter: LiveVariableUtils.getWhereClauseGenerator(variable, options),
                sort: orderBy
            };
            getRelatedTableDataSuccess = function(res, resolve) {
                if (res && res.type) {
                    var response = res.body;
                    var data = _.map(response.content, function(o) {
                        return _.omit(o, selfRelatedCols);
                    });
                    var pagination = Object.assign({}, response);
                    delete pagination.content;
                    var result = {
                        data: data,
                        pagination: pagination
                    };
                    core.triggerFn(success, result);
                    resolve(result);
                }
            };
            getRelatedTableDataError = function(errMsg, reject) {
                core.triggerFn(error, errMsg);
                reject(errMsg);
            };
            return new Promise(function(resolve, reject) {
                _this.makeCall(variable, action, dbOperationOptions).then(function(response) {
                    getRelatedTableDataSuccess(response, resolve);
                }, function(err) {
                    getRelatedTableDataError(err, reject);
                });
            });
        };
        LiveVariableManager.prototype.getDistinctDataByFields = function(variable, options, success, error) {
            var _this = this;
            var dbOperation = "getDistinctDataByFields";
            var projectID = $rootScope.project.id || $rootScope.projectName;
            var requestData = {};
            var sort;
            var tableOptions, dbOperationOptions, getDistinctDataByFieldsSuccess, getDistinctDataByFieldsError;
            options.skipEncode = true;
            options.operation = "read";
            options = options || {};
            tableOptions = LiveVariableUtils.prepareTableOptions(variable, options);
            if (tableOptions.query) {
                requestData.filter = tableOptions.query;
            }
            requestData.groupByFields = _.isArray(options.fields) ? options.fields : [ options.fields ];
            sort = options.sort || requestData.groupByFields[0] + " asc";
            sort = sort ? "sort=" + sort : "";
            dbOperationOptions = {
                projectID: projectID,
                service: variable.getPrefabName() ? "" : "services",
                dataModelName: variable.liveSource,
                entityName: options.entityName || variable.type,
                page: options.page || 1,
                size: options.pagesize,
                sort: sort,
                data: requestData,
                filter: LiveVariableUtils.getWhereClauseGenerator(variable, options),
                url: variable.getPrefabName() ? $rootScope.project.deployedUrl + "/prefabs/" + variable.getPrefabName() : $rootScope.project.deployedUrl
            };
            getDistinctDataByFieldsSuccess = function(response, resolve) {
                if (response && response.type) {
                    if (response && response.error || !response) {
                        core.triggerFn(error, response.error);
                        return Promise.reject(response.error);
                    }
                    var result = response.body;
                    var pagination = Object.assign({}, response.body);
                    delete pagination.content;
                    result = {
                        data: result.content,
                        pagination: pagination
                    };
                    core.triggerFn(success, result);
                    resolve(result);
                }
            };
            getDistinctDataByFieldsError = function(errorMsg, reject) {
                core.triggerFn(error, errorMsg);
                reject(errorMsg);
            };
            return new Promise(function(resolve, reject) {
                _this.makeCall(variable, dbOperation, dbOperationOptions).then(function(response) {
                    getDistinctDataByFieldsSuccess(response, resolve);
                }, function() {
                    getDistinctDataByFieldsError(error, reject);
                });
            });
        };
        LiveVariableManager.prototype.getAggregatedData = function(variable, options, success, error) {
            var deployedURL = exports.appManager.getDeployedURL();
            if (deployedURL) {
                return this.aggregateData(deployedURL, variable, options, success, error);
            }
        };
        LiveVariableManager.prototype.defineFirstLastRecord = function(variable) {
            if (variable.operation === "read") {
                Object.defineProperty(variable, "firstRecord", {
                    configurable: true,
                    get: function() {
                        return _.get(variable.dataSet, "data[0]", {});
                    }
                });
                Object.defineProperty(variable, "lastRecord", {
                    configurable: true,
                    get: function() {
                        var data = _.get(variable.dataSet, "data", []);
                        return data[data.length - 1];
                    }
                });
            }
        };
        LiveVariableManager.prototype.getPrimaryKey = function(variable) {
            return LiveVariableUtils.getPrimaryKey(variable);
        };
        LiveVariableManager.prototype.prepareRequestParams = function(options) {
            var requestParams;
            var searchKeys = _.split(options.searchKey, ","), matchModes = _.split(options.matchMode, ","), formFields = {};
            _.forEach(searchKeys, function(colName, index) {
                formFields[colName] = {
                    value: options.query,
                    logicalOp: "AND",
                    matchMode: matchModes[index] || matchModes[0] || "startignorecase"
                };
            });
            requestParams = {
                filterFields: formFields,
                page: options.page,
                pagesize: options.limit || options.pagesize,
                skipDataSetUpdate: true,
                skipToggleState: true,
                inFlightBehavior: "executeAll",
                logicalOp: "OR",
                orderBy: options.orderby ? _.replace(options.orderby, /:/g, " ") : ""
            };
            if (options.onBeforeservicecall) {
                options.onBeforeservicecall(formFields);
            }
            return requestParams;
        };
        LiveVariableManager.prototype.searchRecords = function(variable, options, success, error) {
            var requestParams = this.prepareRequestParams(options);
            return this.listRecords(variable, requestParams, success, error);
        };
        LiveVariableManager.prototype.upgradeInputDataToFilterExpressions = function(variable, response, inputData) {
            if (_.isObject(response)) {
                inputData = response;
                inputData.condition = "AND";
                inputData.rules = [];
            }
            var clonedRules = _.cloneDeep(inputData.rules);
            inputData.rules = [];
            _.forEach(inputData, function(valueObj, key) {
                if (key !== "condition" && key !== "rules") {
                    var filteredObj = _.find(clonedRules, function(o) {
                        return o.target === key;
                    });
                    if (filteredObj) {
                        filteredObj.value = valueObj.value;
                        filteredObj.matchMode = valueObj.matchMode || valueObj.filterCondition || filteredObj.matchMode || "";
                        inputData.rules.push(filteredObj);
                    } else {
                        inputData.rules.push({
                            target: key,
                            type: "",
                            matchMode: valueObj.matchMode || valueObj.filterCondition || "",
                            value: valueObj.value,
                            required: false
                        });
                    }
                    delete inputData[key];
                }
            });
            return inputData;
        };
        LiveVariableManager.prototype.downgradeFilterExpressionsToInputData = function(variable, inputData) {
            if (inputData.hasOwnProperty("getFilterFields")) {
                inputData = inputData.getFilterFields();
            }
            _.forEach(inputData.rules, function(ruleObj) {
                if (!_.isNil(ruleObj.target) && ruleObj.target !== "") {
                    inputData[ruleObj.target] = {
                        value: ruleObj.value,
                        matchMode: ruleObj.matchMode
                    };
                }
            });
            return inputData;
        };
        LiveVariableManager.prototype.cancel = function(variable, options) {
            if ($queue.requestsQueue.has(variable) && variable._observable) {
                variable._observable.unsubscribe();
                $queue.process(variable);
                this.notifyInflight(variable, false);
            }
        };
        return LiveVariableManager;
    }(BaseVariableManager);
    var navigate = function(variable, options) {
        variable.dataSet = options && options.data || variable.dataSet;
        var viewName;
        var pageName = variable.dataBinding.pageName || variable.pageName, operation = variable.operation, urlParams = variable.dataSet;
        options = options || {};
        switch (operation) {
          case "goToPreviousPage":
            exports.navigationService.goToPrevious();
            break;

          case "gotoPage":
            exports.navigationService.goToPage(pageName, {
                transition: variable.pageTransitions,
                $event: options.$event,
                urlParams: urlParams
            });
            break;

          case "gotoView":
            viewName = variable.dataBinding && variable.dataBinding.viewName || variable.viewName;
            break;

          case "gotoTab":
            viewName = variable.dataBinding && variable.dataBinding.tabName || variable.tabName;
            break;

          case "gotoAccordion":
            viewName = variable.dataBinding && variable.dataBinding.accordionName || variable.accordionName;
            break;

          case "gotoSegment":
            viewName = variable.dataBinding && variable.dataBinding.segmentName || variable.segmentName;
            break;
        }
        if (viewName) {
            exports.navigationService.goToView(viewName, {
                pageName: pageName,
                transition: variable.pageTransitions,
                $event: options.$event,
                urlParams: urlParams
            }, variable);
        }
    };
    var BaseActionManager = function() {
        function BaseActionManager() {}
        BaseActionManager.prototype.initBinding = function(variable, bindSource, bindTarget) {
            processBinding(variable, variable._context, bindSource, bindTarget);
        };
        BaseActionManager.prototype.notifyInflight = function(variable, status, data) {
            exports.appManager.notify("toggle-variable-state", {
                variable: variable,
                active: status,
                data: data
            });
        };
        return BaseActionManager;
    }();
    var NavigationActionManager = function(_super) {
        __extends(NavigationActionManager, _super);
        function NavigationActionManager() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        NavigationActionManager.prototype.invoke = function(variable, options) {
            navigate(variable, options);
        };
        return NavigationActionManager;
    }(BaseActionManager);
    var NotificationActionManager = function(_super) {
        __extends(NotificationActionManager, _super);
        function NotificationActionManager() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        NotificationActionManager.prototype.onToasterClick = function(variable) {
            initiateCallback("onClick", variable, "");
        };
        NotificationActionManager.prototype.onToasterHide = function(variable) {
            initiateCallback("onHide", variable, "");
        };
        NotificationActionManager.prototype.notifyViaToaster = function(variable, options) {
            var type = (options.class || variable.dataBinding.class || "info").toLowerCase(), body = options.message || variable.dataBinding.text, title = options.title, positionClass = "toast-" + (options.position || variable.dataBinding.toasterPosition || "bottom right").replace(" ", "-"), partialPage = variable.dataBinding.page, DEFAULT_DURATION = 3e3;
            var duration = parseInt(options.duration || variable.dataBinding.duration, null), toaster;
            if (!duration) {
                duration = duration !== 0 && type === "success" ? DEFAULT_DURATION : 0;
            }
            if (variable.dataBinding.content && variable.dataBinding.content === "page" && partialPage) {
                toaster = exports.toasterService.showCustom(partialPage, {
                    positionClass: positionClass,
                    timeOut: duration,
                    partialParams: variable._binddataSet,
                    context: variable._context
                });
            } else {
                toaster = exports.toasterService.show(type, title, body || null, {
                    positionClass: positionClass,
                    timeOut: duration,
                    enableHtml: true
                });
            }
            if (variable.onClick) {
                toaster.onTap.subscribe(this.onToasterClick.bind(this, variable));
            }
            if (variable.onHide) {
                toaster.onHidden.subscribe(this.onToasterHide.bind(this, variable));
            }
        };
        NotificationActionManager.prototype.notifyViaDialog = function(variable, options) {
            var commonPageDialogId = "Common" + _.capitalize(variable.operation) + "Dialog", variableOwner = variable.owner, dialogId = variableOwner === VARIABLE_CONSTANTS.OWNER.APP ? commonPageDialogId : "notification" + variable.operation + "dialog";
            exports.dialogService.open(dialogId, variable._context, {
                notification: {
                    title: options.title || variable.dataBinding.title,
                    text: options.message || variable.dataBinding.text,
                    okButtonText: options.okButtonText || variable.dataBinding.okButtonText || "OK",
                    cancelButtonText: options.cancelButtonText || variable.dataBinding.cancelButtonText || "CANCEL",
                    alerttype: options.alerttype || variable.dataBinding.alerttype || "information",
                    onOk: function() {
                        initiateCallback("onOk", variable, options.data);
                        exports.dialogService.close(dialogId, variable._context);
                    },
                    onCancel: function() {
                        initiateCallback("onCancel", variable, options.data);
                        exports.dialogService.close(dialogId, variable._context);
                    },
                    onClose: function() {
                        initiateCallback("onClose", variable, options.data);
                    }
                }
            });
        };
        NotificationActionManager.prototype.notify = function(variable, options, success, error) {
            var operation = variable.operation;
            options = options || {};
            if (operation === "toast") {
                this.notifyViaToaster(variable, options);
            } else {
                this.notifyViaDialog(variable, options);
            }
        };
        NotificationActionManager.prototype.getMessage = function(variable) {
            return variable.dataBinding.text;
        };
        NotificationActionManager.prototype.setMessage = function(variable, text) {
            if (_.isString(text)) {
                variable.dataBinding.text = text;
            }
            return variable.dataBinding.text;
        };
        NotificationActionManager.prototype.getOkButtonText = function(variable) {
            return variable.dataBinding.okButtonText;
        };
        NotificationActionManager.prototype.setOkButtonText = function(variable, text) {
            if (_.isString(text)) {
                variable.dataBinding.okButtonText = text;
            }
            return variable.dataBinding.okButtonText;
        };
        NotificationActionManager.prototype.getToasterDuration = function(variable) {
            return variable.dataBinding.duration;
        };
        NotificationActionManager.prototype.setToasterDuration = function(variable, duration) {
            variable.dataBinding.duration = duration;
            return variable.dataBinding.duration;
        };
        NotificationActionManager.prototype.getToasterClass = function(variable) {
            return variable.dataBinding.class;
        };
        NotificationActionManager.prototype.setToasterClass = function(variable, type) {
            if (_.isString(type)) {
                variable.dataBinding.class = type;
            }
            return variable.dataBinding.class;
        };
        NotificationActionManager.prototype.getToasterPosition = function(variable) {
            return variable.dataBinding.class;
        };
        NotificationActionManager.prototype.setToasterPosition = function(variable, position) {
            if (_.isString(position)) {
                variable.dataBinding.position = position;
            }
            return variable.dataBinding.position;
        };
        NotificationActionManager.prototype.getAlertType = function(variable) {
            return variable.dataBinding.alerttype;
        };
        NotificationActionManager.prototype.setAlertType = function(variable, alerttype) {
            if (_.isString(alerttype)) {
                variable.dataBinding.alerttype = alerttype;
            }
            return variable.dataBinding.alerttype;
        };
        NotificationActionManager.prototype.getCancelButtonText = function(variable) {
            return variable.dataBinding.cancelButtonText;
        };
        NotificationActionManager.prototype.setCancelButtonText = function(variable, text) {
            if (_.isString(text)) {
                variable.dataBinding.cancelButtonText = text;
            }
            return variable.dataBinding.cancelButtonText;
        };
        return NotificationActionManager;
    }(BaseActionManager);
    var LoginActionManager = function(_super) {
        __extends(LoginActionManager, _super);
        function LoginActionManager() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        LoginActionManager.prototype.validate = function(params) {
            var err, paramKey, remembermeKey;
            var LOGIN_PARAM_REMEMBER_ME = "j_rememberme";
            var LOGIN_PARAM_REMEMBER_ME_OLD = [ "rememberme", "remembermecheck" ];
            LOGIN_PARAM_REMEMBER_ME_OLD.forEach(function(old_key) {
                if (_.isBoolean(params[old_key])) {
                    remembermeKey = old_key;
                }
            });
            remembermeKey = remembermeKey || LOGIN_PARAM_REMEMBER_ME;
            params[remembermeKey] = _.isBoolean(params[remembermeKey]) ? params[remembermeKey] : false;
            for (paramKey in params) {
                if (params.hasOwnProperty(paramKey) && (params[paramKey] === "" || params[paramKey] === undefined)) {
                    err = "Please provide required credentials";
                    break;
                }
            }
            return err;
        };
        LoginActionManager.prototype.migrateOldParams = function(params) {
            var loginParams = {}, paramMigrationMap = {
                usernametext: "j_username",
                username: "j_username",
                passwordtext: "j_password",
                password: "j_password",
                remembermecheck: "j_rememberme",
                rememberme: "j_rememberme"
            };
            _.each(params, function(value, key) {
                if (paramMigrationMap[key]) {
                    loginParams[paramMigrationMap[key]] = value;
                } else {
                    loginParams[key] = value;
                }
            });
            return loginParams;
        };
        LoginActionManager.prototype.login = function(variable, options, success, error) {
            var _this = this;
            var newDataSet;
            options = options || {};
            var loginInfo = options.loginInfo || options.input || variable.dataBinding;
            var errMsg = this.validate(loginInfo);
            if (errMsg) {
                core.triggerFn(error, errMsg);
                initiateCallback("onError", variable, errMsg);
                return;
            }
            var params = core.getClonedObject(loginInfo);
            var output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, params);
            if (_.isObject(output)) {
                params = output;
            } else if (output === false) {
                core.triggerFn(error);
                return;
            }
            params = this.migrateOldParams(params);
            var lastLoggedInUsername = _.get(exports.securityService.get(), "userInfo.userName");
            this.notifyInflight(variable, true);
            variable.promise = exports.securityService.appLogin(params, function(response) {
                exports.dialogService.close("CommonLoginDialog");
                exports.appManager.reloadAppData().then(function(config) {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, _.get(config, "userInfo"));
                    newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, _.get(config, "userInfo"));
                    if (newDataSet) {
                        _.set(config, "userInfo", newDataSet);
                    }
                    _this.notifyInflight(variable, false, response);
                    core.triggerFn(success);
                    setTimeout(function() {
                        initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, _.get(config, "userInfo"));
                        if (variable.useDefaultSuccessHandler) {
                            var isSameUserReloggedIn = lastLoggedInUsername === params["j_username"];
                            if (!lastLoggedInUsername || isSameUserReloggedIn) {
                                exports.appManager.executeSessionFailureRequests();
                            }
                            var redirectPage = exports.securityService.getCurrentRouteQueryParam("redirectTo"), noRedirect = exports.appManager.noRedirect();
                            var queryParamsObj = exports.securityService.getRedirectedRouteQueryParams();
                            if (queryParamsObj.redirectTo) {
                                delete queryParamsObj.redirectTo;
                            }
                            exports.appManager.noRedirect(false);
                            if (!lastLoggedInUsername) {
                                if (!_.isEmpty(redirectPage)) {
                                    exports.routerService.navigate([ "/" + redirectPage ], {
                                        queryParams: queryParamsObj
                                    });
                                } else if (!noRedirect) {
                                    exports.routerService.navigate([ "/" ]);
                                }
                            } else {
                                if (!_.isEmpty(redirectPage)) {
                                    if (lastLoggedInUsername === params["j_username"]) {
                                        exports.routerService.navigate([ "/" + redirectPage ], {
                                            queryParams: queryParamsObj
                                        });
                                    } else {
                                        exports.routerService.navigate([ "/" ]);
                                        window.location.reload();
                                    }
                                } else {
                                    var securityConfig = exports.securityService.get(), sessionTimeoutLoginMode = _.get(securityConfig, "loginConfig.sessionTimeout.type") || "PAGE";
                                    if (!isSameUserReloggedIn || sessionTimeoutLoginMode !== "DIALOG") {
                                        exports.routerService.navigate([ "/" ]);
                                        window.location.reload();
                                    }
                                }
                            }
                        }
                        initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, _.get(config, "userInfo"));
                    });
                });
            }, function(e) {
                initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, e);
                _this.notifyInflight(variable, false, e);
                var errorMsg = e.error || "Invalid credentials.";
                var xhrObj = e.details;
                if (CONSTANTS.isRunMode) {
                    initiateCallback("onError", variable, errorMsg, xhrObj, true);
                }
                core.triggerFn(error, errorMsg, xhrObj);
                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, e);
            });
        };
        return LoginActionManager;
    }(BaseActionManager);
    var LogoutActionManager = function(_super) {
        __extends(LogoutActionManager, _super);
        function LogoutActionManager() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        LogoutActionManager.prototype.logout = function(variable, options, success, error) {
            var _this = this;
            var handleError, redirectPage, output, newDataSet;
            handleError = function(msg, details, xhrObj) {
                if (!CONSTANTS.isStudioMode) {
                    initiateCallback("onError", variable, msg, xhrObj);
                }
                core.triggerFn(error, msg, xhrObj);
            };
            output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, null);
            if (output === false) {
                core.triggerFn(error);
                return;
            }
            exports.securityService.isAuthenticated(function(isAuthenticated) {
                if (isAuthenticated) {
                    _this.notifyInflight(variable, true);
                    variable.promise = exports.securityService.appLogout(function(response) {
                        var redirectUrl = response.body;
                        redirectUrl = core.getValidJSON(redirectUrl);
                        exports.appManager.reloadAppData().then(function() {
                            _this.notifyInflight(variable, false, redirectUrl);
                            initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, redirectUrl);
                            newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, redirectUrl);
                            if (newDataSet) {
                                redirectUrl = newDataSet;
                            }
                            setTimeout(function() {
                                initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, redirectUrl);
                                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, redirectUrl);
                            });
                        });
                        if (redirectUrl && redirectUrl.result) {
                            window.location.href = redirectUrl.result;
                        } else if (variable.useDefaultSuccessHandler) {
                            redirectPage = variable.redirectTo;
                            if (!redirectPage || redirectPage === "login.html" || redirectPage === "index.html") {
                                redirectPage = "";
                            }
                            exports.routerService.navigate([ "/" + redirectPage ]);
                            if (!window["cordova"]) {
                                setTimeout(function() {
                                    window.location.reload();
                                });
                            }
                        }
                        core.triggerFn(success);
                    }, handleError);
                } else {
                    handleError("No authenticated user to logout.");
                }
            }, function(err) {
                _this.notifyInflight(variable, false, err);
                handleError(err);
            });
        };
        return LogoutActionManager;
    }(BaseActionManager);
    var TimerActionManager = function(_super) {
        __extends(TimerActionManager, _super);
        function TimerActionManager() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        TimerActionManager.prototype.trigger = function(variable, options, success, error) {
            if (core.isDefined(variable._promise) || CONSTANTS.isStudioMode) {
                return;
            }
            var repeatTimer = variable.repeating, delay = variable.delay || CONSTANTS.DEFAULT_TIMER_DELAY, event = "onTimerFire", exec = function() {
                initiateCallback(event, variable, {});
            };
            variable._promise = repeatTimer ? setInterval(exec, delay) : setTimeout(function() {
                exec();
                variable._promise = undefined;
            }, delay);
            return variable._promise;
        };
        TimerActionManager.prototype.cancel = function(variable) {
            if (core.isDefined(variable._promise)) {
                if (variable.repeating) {
                    clearInterval(variable._promise);
                } else {
                    clearTimeout(variable._promise);
                }
                variable._promise = undefined;
            }
        };
        return TimerActionManager;
    }(BaseActionManager);
    var DeviceVariableManager = function(_super) {
        __extends(DeviceVariableManager, _super);
        function DeviceVariableManager() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.serviceRegistry = new Map();
            return _this;
        }
        DeviceVariableManager.prototype.invoke = function(variable, options) {
            var _this = this;
            var service = this.serviceRegistry.get(variable.service);
            if (service == null) {
                initiateCallback("onError", variable, null);
                return Promise.reject("Could not find service '" + service + "'");
            } else {
                this.notifyInflight(variable, true);
                return service.invoke(variable, options).then(function(response) {
                    _this.notifyInflight(variable, false, response);
                    return response;
                }, function(err) {
                    _this.notifyInflight(variable, false, err);
                    return Promise.reject(err);
                });
            }
        };
        DeviceVariableManager.prototype.registerService = function(service) {
            this.serviceRegistry.set(service.name, service);
        };
        return DeviceVariableManager;
    }(BaseVariableManager);
    var WebSocketVariableManager = function(_super) {
        __extends(WebSocketVariableManager, _super);
        function WebSocketVariableManager() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.scope_var_socket_map = new Map();
            _this.PROPERTY = {
                SERVICE: "service",
                DATA_UPDATE_STRATEGY: "dataUpdateStrategy",
                DATA_LIMIT: "dataLimit"
            };
            _this.DATA_UPDATE_STRATEGY = {
                REFRESH: "refresh",
                PREPEND: "prepend",
                APPEND: "append"
            };
            return _this;
        }
        WebSocketVariableManager.prototype.shouldAppendData = function(variable) {
            variable = variable || this;
            return variable[this.PROPERTY.DATA_UPDATE_STRATEGY] !== this.DATA_UPDATE_STRATEGY.REFRESH;
        };
        WebSocketVariableManager.prototype.shouldAppendLast = function(variable) {
            return variable[this.PROPERTY.DATA_UPDATE_STRATEGY] === this.DATA_UPDATE_STRATEGY.APPEND;
        };
        WebSocketVariableManager.prototype.getDataLimit = function(variable) {
            return variable.dataLimit;
        };
        WebSocketVariableManager.prototype.getURL = function(variable) {
            var prefabName = variable.getPrefabName();
            var opInfo = prefabName ? _.get(exports.metadataService.getByOperationId(variable.operationId, prefabName), "wmServiceOperationInfo") : _.get(exports.metadataService.getByOperationId(variable.operationId), "wmServiceOperationInfo");
            var inputFields = variable.dataBinding;
            var config;
            _.forEach(opInfo.parameters, function(param) {
                param.sampleValue = inputFields[param.name];
            });
            $.extend(opInfo, {
                skipCloakHeaders: true
            });
            config = ServiceVariableUtils.constructRequestParams(variable, opInfo, inputFields);
            if (config.error && config.error.message) {
                this._onSocketError(variable, {
                    data: config.error.message
                });
                return;
            }
            return config.url;
        };
        WebSocketVariableManager.prototype._onSocketMessage = function(variable, evt) {
            var data = _.get(evt, "data"), value, dataLength, dataLimit, shouldAddToLast, insertIdx;
            data = core.getValidJSON(data) || core.xmlToJson(data) || data;
            value = initiateCallback(VARIABLE_CONSTANTS.EVENT.MESSAGE_RECEIVE, variable, data, evt);
            data = core.isDefined(value) ? value : data;
            if (this.shouldAppendData(variable)) {
                variable.dataSet = variable.dataSet || [];
                dataLength = variable.dataSet.length;
                dataLimit = this.getDataLimit(variable);
                shouldAddToLast = this.shouldAppendLast(variable);
                if (dataLimit && dataLength >= dataLimit) {
                    if (shouldAddToLast) {
                        variable.dataSet.shift();
                    } else {
                        variable.dataSet.pop();
                    }
                }
                insertIdx = shouldAddToLast ? dataLength : 0;
                variable.dataSet.splice(insertIdx, 0, data);
            } else {
                variable.dataSet = core.isDefined(value) ? value : data;
            }
        };
        WebSocketVariableManager.prototype._onBeforeSend = function(variable, message) {
            return initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_SEND, variable, message);
        };
        WebSocketVariableManager.prototype._onBeforeSocketClose = function(variable, evt) {
            return initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_CLOSE, variable, _.get(evt, "data"), evt);
        };
        WebSocketVariableManager.prototype._onBeforeSocketOpen = function(variable, evt) {
            return initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_OPEN, variable, _.get(evt, "data"), evt);
        };
        WebSocketVariableManager.prototype._onSocketOpen = function(variable, evt) {
            variable._socketConnected = true;
            initiateCallback(VARIABLE_CONSTANTS.EVENT.OPEN, variable, _.get(evt, "data"), evt);
        };
        WebSocketVariableManager.prototype.freeSocket = function(variable) {
            this.scope_var_socket_map.set(variable, undefined);
        };
        WebSocketVariableManager.prototype._onSocketClose = function(variable, evt) {
            variable._socketConnected = false;
            this.freeSocket(variable);
            initiateCallback(VARIABLE_CONSTANTS.EVENT.CLOSE, variable, _.get(evt, "data"), evt);
        };
        WebSocketVariableManager.prototype._onSocketError = function(variable, evt) {
            variable._socketConnected = false;
            this.freeSocket(variable);
            initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, _.get(evt, "data") || "Error while connecting with " + variable.service, evt);
        };
        WebSocketVariableManager.prototype.getSocket = function(variable) {
            var url = this.getURL(variable);
            var _socket = this.scope_var_socket_map.get(variable);
            if (_socket) {
                return _socket;
            }
            if (!CONSTANTS.hasCordova && core.isInsecureContentRequest(url)) {
                core.triggerFn(this._onSocketError.bind(this, variable));
                return;
            }
            _socket = new angular2Websocket.$WebSocket(url);
            _socket.onOpen(this._onSocketOpen.bind(this, variable));
            _socket.onError(this._onSocketError.bind(this, variable));
            _socket.onMessage(this._onSocketMessage.bind(this, variable));
            _socket.onClose(this._onSocketClose.bind(this, variable));
            this.scope_var_socket_map.set(variable, _socket);
            variable._socket = _socket;
            return _socket;
        };
        WebSocketVariableManager.prototype.open = function(variable, success, error) {
            var shouldOpen = this._onBeforeSocketOpen(variable);
            var socket;
            if (shouldOpen === false) {
                core.triggerFn(error);
                return;
            }
            socket = this.getSocket(variable);
            core.triggerFn(success);
            return socket;
        };
        WebSocketVariableManager.prototype.close = function(variable) {
            var shouldClose = this._onBeforeSocketClose(variable), socket = this.getSocket(variable);
            if (shouldClose === false) {
                return;
            }
            socket.close();
        };
        WebSocketVariableManager.prototype.send = function(variable, message) {
            var socket = this.getSocket(variable);
            var response;
            message = message || _.get(variable, "dataBinding.RequestBody");
            response = this._onBeforeSend(variable, message);
            if (response === false) {
                return;
            }
            message = core.isDefined(response) ? response : message;
            message = core.isObject(message) ? JSON.stringify(message) : message;
            socket.send(message, 0);
        };
        return WebSocketVariableManager;
    }(BaseVariableManager);
    var managerMap = new Map(), typeToManagerMap = {
        Variable: BaseVariableManager,
        Action: BaseActionManager,
        "wm.Variable": ModelVariableManager,
        "wm.ServiceVariable": ServiceVariableManager,
        "wm.LiveVariable": LiveVariableManager,
        "wm.NavigationVariable": NavigationActionManager,
        "wm.NotificationVariable": NotificationActionManager,
        "wm.LoginVariable": LoginActionManager,
        "wm.LogoutVariable": LogoutActionManager,
        "wm.TimerVariable": TimerActionManager,
        "wm.DeviceVariable": DeviceVariableManager,
        "wm.WebSocketVariable": WebSocketVariableManager
    };
    var VariableManagerFactory = function() {
        function VariableManagerFactory() {}
        VariableManagerFactory.get = function(type) {
            return managerMap.has(type) ? managerMap.get(type) : managerMap.set(type, new typeToManagerMap[type]()).get(type);
        };
        return VariableManagerFactory;
    }();
    var DeviceVariableService = function() {
        function DeviceVariableService() {}
        DeviceVariableService.prototype.invoke = function(variable, options) {
            var operation = this.operations.find(function(o) {
                return o.name === variable.operation;
            });
            if (operation == null) {
                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, null);
                return Promise.reject("Could not find operation '" + variable.operation + "' in service '" + this.name + "'");
            } else if (core.hasCordova()) {
                var dataBindings_1 = new Map();
                if (variable.dataBinding !== undefined) {
                    Object.entries(variable).forEach(function(o) {
                        dataBindings_1.set(o[0], o[1]);
                    });
                    Object.entries(variable.dataBinding).forEach(function(o) {
                        dataBindings_1.set(o[0], o[1]);
                    });
                }
                return operation.invoke(variable, options, dataBindings_1).then(function(data) {
                    variable.dataSet = data;
                    core.$invokeWatchers(true);
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, data);
                    return data;
                }, function(reason) {
                    variable.dataSet = {};
                    core.$invokeWatchers(true);
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, null);
                    return reason;
                });
            } else {
                return Promise.resolve().then(function() {
                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, operation.model);
                    return operation.model;
                });
            }
        };
        return DeviceVariableService;
    }();
    var DatasetUtil = function() {
        function DatasetUtil() {}
        DatasetUtil.isValidDataset = function(dataSet, isList) {
            if (!dataSet) {
                return false;
            }
            if (isList && !_.isArray(dataSet)) {
                return false;
            }
            return dataSet;
        };
        DatasetUtil.getValue = function(dataSet, key, index, isList) {
            index = index || 0;
            return isList ? dataSet[index][key] : dataSet[key];
        };
        DatasetUtil.setValue = function(dataSet, key, value, isList) {
            if (key && !isList) {
                dataSet[key] = value;
            }
            return dataSet;
        };
        DatasetUtil.getItem = function(dataSet, index, isList) {
            return isList ? dataSet[index] : dataSet;
        };
        DatasetUtil.getTargetNode = function(dataSet, options) {
            dataSet = options.parentIndex !== undefined ? dataSet[options.parentIndex] : dataSet;
            return _.get(dataSet, options.path);
        };
        DatasetUtil.setItem = function(dataSet, i, value, options) {
            var index;
            if (_.isUndefined(i) || !options.isList) {
                return dataSet;
            }
            if (_.isObject(i)) {
                index = _.findIndex(dataSet, i);
            } else {
                index = i;
            }
            if (options.path) {
                var innerArray = DatasetUtil.getTargetNode(dataSet, options);
                var innerElemindex = _.findIndex(innerArray, i);
                if (innerElemindex > -1) {
                    innerArray[innerElemindex] = value;
                }
            } else {
                if (index > -1) {
                    dataSet[index] = value;
                }
            }
            return dataSet;
        };
        DatasetUtil.addItem = function(dataSet, value, index, options) {
            if (_.isUndefined(value) || !options.isList) {
                return dataSet;
            }
            if (options.path) {
                var innerArray = DatasetUtil.getTargetNode(dataSet, options);
                if (innerArray) {
                    index = index !== undefined ? index : innerArray.length;
                    innerArray.splice(index, 0, value);
                } else {
                    options.parentIndex !== undefined ? _.set(dataSet[options.parentIndex], options.path, [ value ]) : _.set(dataSet, options.path, [ value ]);
                }
            } else {
                index = index !== undefined ? index : dataSet.length;
                dataSet.splice(index, 0, value);
            }
            return dataSet;
        };
        DatasetUtil.removeItem = function(dataSet, i, options) {
            var index, exactMatch;
            i = i !== undefined ? i : dataSet.length - 1;
            if (_.isBoolean(options)) {
                exactMatch = options;
            }
            if (_.isObject(options)) {
                exactMatch = options.exactMatch;
            }
            if (_.isObject(i)) {
                if (options.path) {
                    var innerArray = DatasetUtil.getTargetNode(dataSet, options);
                    var innerElemindex = _.findIndex(innerArray, i);
                    if (innerElemindex > -1 && (!exactMatch || exactMatch && _.isEqual(innerArray[innerElemindex], i))) {
                        innerArray.splice(innerElemindex, 1);
                    }
                } else {
                    index = _.findIndex(dataSet, i);
                    if (index > -1 && (!exactMatch || exactMatch && _.isEqual(dataSet[index], i))) {
                        dataSet.splice(index, 1);
                    }
                }
            } else {
                dataSet.splice(i, 1);
            }
            return dataSet;
        };
        DatasetUtil.getValidDataset = function(isList) {
            return isList ? [] : {};
        };
        DatasetUtil.getCount = function(dataSet, isList) {
            return isList ? dataSet.length : Object.keys(dataSet).length;
        };
        return DatasetUtil;
    }();
    var BaseVariable = function() {
        function BaseVariable() {}
        BaseVariable.prototype.execute = function(operation, options) {
            var returnVal;
            switch (operation) {
              case core.DataSource.Operation.GET_NAME:
                returnVal = this.name;
                break;

              case core.DataSource.Operation.GET_UNIQUE_IDENTIFIER:
                returnVal = this._id;
                break;

              case core.DataSource.Operation.GET_CONTEXT_IDENTIFIER:
                returnVal = this._context;
                break;

              case core.DataSource.Operation.ADD_ITEM:
                returnVal = this.addItem(options.item, _.omit(options, "item"));
                break;

              case core.DataSource.Operation.SET_ITEM:
                returnVal = this.setItem(options.prevItem, options.item, _.omit(options, "prevItem", "item"));
                break;

              case core.DataSource.Operation.REMOVE_ITEM:
                returnVal = this.removeItem(options.item, _.omit(options, "item"));
                break;
            }
            return returnVal;
        };
        BaseVariable.prototype.getData = function() {
            return this.dataSet;
        };
        BaseVariable.prototype.setData = function(dataSet) {
            if (DatasetUtil.isValidDataset(dataSet, this.isList)) {
                this.dataSet = dataSet;
            }
            return this.dataSet;
        };
        BaseVariable.prototype.getValue = function(key, index) {
            return DatasetUtil.getValue(this.dataSet, key, index, this.isList);
        };
        BaseVariable.prototype.setValue = function(key, value) {
            return DatasetUtil.setValue(this.dataSet, key, value, this.isList);
        };
        BaseVariable.prototype.getItem = function(index) {
            return DatasetUtil.getItem(this.dataSet, index, this.isList);
        };
        BaseVariable.prototype.setItem = function(index, value, options) {
            options = this.getChildDetails(options);
            return DatasetUtil.setItem(this.dataSet, index, value, options);
        };
        BaseVariable.prototype.getChildDetails = function(options) {
            var parentIndex, isList = this.isList, path;
            if (options && options.path) {
                path = options.path;
                var targetNode = void 0;
                if (isList) {
                    parentIndex = options.parentIndex || 0;
                    targetNode = _.get(this.dataSet[parentIndex], options.path);
                } else {
                    targetNode = _.get(this.dataSet, options.path);
                }
                isList = targetNode ? _.isArray(targetNode) ? true : false : true;
            }
            return {
                path: path,
                isList: isList,
                parentIndex: parentIndex
            };
        };
        BaseVariable.prototype.addItem = function(value, options) {
            var index;
            if (_.isNumber(options)) {
                index = options;
            }
            if (_.isObject(options)) {
                index = options.index;
            }
            options = this.getChildDetails(options);
            return DatasetUtil.addItem(this.dataSet, value, index, options);
        };
        BaseVariable.prototype.removeItem = function(index, options) {
            var exactMatch, parentIndex;
            if (options) {
                if (_.isBoolean(options)) {
                    exactMatch = options;
                }
                if (_.isObject(options)) {
                    exactMatch = options.exactMatch;
                    if (this.isList) {
                        parentIndex = options.parentIndex || 0;
                    }
                }
            }
            return DatasetUtil.removeItem(this.dataSet, index, {
                exactMatch: exactMatch,
                path: _.get(options, "path"),
                parentIndex: parentIndex
            });
        };
        BaseVariable.prototype.clearData = function() {
            this.dataSet = DatasetUtil.getValidDataset(this.isList);
            return this.dataSet;
        };
        BaseVariable.prototype.getCount = function() {
            return DatasetUtil.getCount(this.dataSet, this.isList);
        };
        BaseVariable.prototype.getPrefabName = function() {
            return this._context && (this._context.prefabName !== "__self__" && this._context.prefabName);
        };
        return BaseVariable;
    }();
    var ApiAwareVariable = function(_super) {
        __extends(ApiAwareVariable, _super);
        function ApiAwareVariable() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ApiAwareVariable;
    }(BaseVariable);
    var getManager = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.DEVICE);
    };
    var DeviceVariable = function(_super) {
        __extends(DeviceVariable, _super);
        function DeviceVariable(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        DeviceVariable.prototype.init = function() {
            getManager().initBinding(this);
        };
        DeviceVariable.prototype.invoke = function(options, onSuccess, onError) {
            getManager().invoke(this, options).then(onSuccess, onError);
        };
        return DeviceVariable;
    }(ApiAwareVariable);
    var getManager$1 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.LIVE);
    };
    var LiveVariable = function(_super) {
        __extends(LiveVariable, _super);
        function LiveVariable(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        LiveVariable.prototype.execute = function(operation, options) {
            var returnVal = _super.prototype.execute.call(this, operation, options);
            if (core.isDefined(returnVal)) {
                return returnVal;
            }
            switch (operation) {
              case core.DataSource.Operation.IS_API_AWARE:
                returnVal = true;
                break;

              case core.DataSource.Operation.SUPPORTS_CRUD:
                returnVal = true;
                break;

              case core.DataSource.Operation.SUPPORTS_DISTINCT_API:
                returnVal = true;
                break;

              case core.DataSource.Operation.IS_PAGEABLE:
                returnVal = true;
                break;

              case core.DataSource.Operation.SUPPORTS_SERVER_FILTER:
                returnVal = true;
                break;

              case core.DataSource.Operation.GET_OPERATION_TYPE:
                returnVal = this.operation;
                break;

              case core.DataSource.Operation.GET_RELATED_PRIMARY_KEYS:
                returnVal = this.getRelatedTablePrimaryKeys(options);
                break;

              case core.DataSource.Operation.GET_ENTITY_NAME:
                returnVal = this.propertiesMap.entityName;
                break;

              case core.DataSource.Operation.LIST_RECORDS:
                returnVal = this.listRecords(options);
                break;

              case core.DataSource.Operation.UPDATE_RECORD:
                returnVal = this.updateRecord(options);
                break;

              case core.DataSource.Operation.INSERT_RECORD:
                returnVal = this.insertRecord(options);
                break;

              case core.DataSource.Operation.DELETE_RECORD:
                returnVal = this.deleteRecord(options);
                break;

              case core.DataSource.Operation.INVOKE:
                returnVal = this.invoke(options);
                break;

              case core.DataSource.Operation.UPDATE:
                returnVal = this.update(options);
                break;

              case core.DataSource.Operation.GET_RELATED_TABLE_DATA:
                returnVal = this.getRelatedTableData(options.relatedField, options);
                break;

              case core.DataSource.Operation.GET_DISTINCT_DATA_BY_FIELDS:
                returnVal = this.getDistinctDataByFields(options);
                break;

              case core.DataSource.Operation.GET_AGGREGATED_DATA:
                returnVal = this.getAggregatedData(options);
                break;

              case core.DataSource.Operation.GET_MATCH_MODE:
                returnVal = this.matchMode;
                break;

              case core.DataSource.Operation.DOWNLOAD:
                returnVal = this.download(options);
                break;

              case core.DataSource.Operation.GET_PROPERTIES_MAP:
                returnVal = this.propertiesMap;
                break;

              case core.DataSource.Operation.GET_PRIMARY_KEY:
                returnVal = this.getPrimaryKey();
                break;

              case core.DataSource.Operation.GET_BLOB_URL:
                returnVal = "services/" + this.liveSource + "/" + this.type + "/" + options.primaryValue + "/content/" + options.columnName;
                break;

              case core.DataSource.Operation.GET_OPTIONS:
                returnVal = this._options || {};
                break;

              case core.DataSource.Operation.SEARCH_RECORDS:
                returnVal = this.searchRecords(options);
                break;

              case core.DataSource.Operation.GET_REQUEST_PARAMS:
                returnVal = this.getRequestParams(options);
                break;

              case core.DataSource.Operation.GET_PAGING_OPTIONS:
                returnVal = this.pagination;
                break;

              case core.DataSource.Operation.IS_UPDATE_REQUIRED:
                returnVal = true;
                break;

              case core.DataSource.Operation.IS_BOUND_TO_LOCALE:
                returnVal = false;
                break;

              case core.DataSource.Operation.CANCEL:
                returnVal = false;
                break;

              default:
                returnVal = {};
                break;
            }
            return returnVal;
        };
        LiveVariable.prototype.listRecords = function(options, success, error) {
            return getManager$1().listRecords(this, options, success, error);
        };
        LiveVariable.prototype.updateRecord = function(options, success, error) {
            return getManager$1().updateRecord(this, options, success, error);
        };
        LiveVariable.prototype.insertRecord = function(options, success, error) {
            return getManager$1().insertRecord(this, options, success, error);
        };
        LiveVariable.prototype.deleteRecord = function(options, success, error) {
            return getManager$1().deleteRecord(this, options, success, error);
        };
        LiveVariable.prototype.setInput = function(key, val, options) {
            return getManager$1().setInput(this, key, val, options);
        };
        LiveVariable.prototype.setFilter = function(key, val) {
            return getManager$1().setFilter(this, key, val);
        };
        LiveVariable.prototype.download = function(options, success, error) {
            return getManager$1().download(this, options, success, error);
        };
        LiveVariable.prototype.invoke = function(options, success, error) {
            switch (this.operation) {
              case "insert":
                return this.insertRecord(options, success, error);

              case "update":
                return this.updateRecord(options, success, error);

              case "delete":
                return this.deleteRecord(options, success, error);

              default:
                return this.listRecords(options, success, error);
            }
        };
        LiveVariable.prototype.getRelatedTablePrimaryKeys = function(columnName) {
            return getManager$1().getRelatedTablePrimaryKeys(this, columnName);
        };
        LiveVariable.prototype.getRelatedTableData = function(columnName, options, success, error) {
            return getManager$1().getRelatedTableData(this, columnName, options, success, error);
        };
        LiveVariable.prototype.getDistinctDataByFields = function(options, success, error) {
            return getManager$1().getDistinctDataByFields(this, options, success, error);
        };
        LiveVariable.prototype.getAggregatedData = function(options, success, error) {
            return getManager$1().getAggregatedData(this, options, success, error);
        };
        LiveVariable.prototype.getPrimaryKey = function() {
            return getManager$1().getPrimaryKey(this);
        };
        LiveVariable.prototype.searchRecords = function(options, success, error) {
            return getManager$1().searchRecords(this, options, success, error);
        };
        LiveVariable.prototype.getRequestParams = function(options) {
            return getManager$1().prepareRequestParams(options);
        };
        LiveVariable.prototype._downgradeInputData = function(data) {
            return getManager$1().downgradeFilterExpressionsToInputData(this, data);
        };
        LiveVariable.prototype._upgradeInputData = function(response, data) {
            return getManager$1().upgradeInputDataToFilterExpressions(this, response, data);
        };
        LiveVariable.prototype.setOrderBy = function(expression) {
            this.orderBy = expression;
            if (this.autoUpdate) {
                this.update();
            }
            return this.orderBy;
        };
        LiveVariable.prototype.update = function(options, success, error) {
            return this.invoke(options, success, error);
        };
        LiveVariable.prototype.createRecord = function(options, success, error) {
            return this.insertRecord(options, success, error);
        };
        LiveVariable.prototype.init = function() {
            getManager$1().initBinding(this, "dataBinding", this.operation === "read" ? "filterFields" : "inputFields");
            if (this.operation === "read") {
                getManager$1().initFilterExpressionBinding(this);
            }
            getManager$1().defineFirstLastRecord(this);
        };
        LiveVariable.prototype.cancel = function(options) {
            return getManager$1().cancel(this, options);
        };
        return LiveVariable;
    }(ApiAwareVariable);
    var BaseAction = function() {
        function BaseAction() {}
        BaseAction.prototype.execute = function(operation, options) {
            var returnVal;
            switch (operation) {
              case core.DataSource.Operation.GET_NAME:
                returnVal = this.name;
                break;

              case core.DataSource.Operation.GET_UNIQUE_IDENTIFIER:
                returnVal = this._id;
                break;

              case core.DataSource.Operation.GET_CONTEXT_IDENTIFIER:
                returnVal = this._context;
                break;
            }
            return returnVal;
        };
        BaseAction.prototype.getData = function() {
            return this.dataSet;
        };
        BaseAction.prototype.setData = function(dataSet) {
            if (DatasetUtil.isValidDataset(dataSet)) {
                this.dataSet = dataSet;
            }
            return this.dataSet;
        };
        BaseAction.prototype.getValue = function(key, index) {
            return DatasetUtil.getValue(this.dataSet, key, index);
        };
        BaseAction.prototype.setValue = function(key, value) {
            return DatasetUtil.setValue(this.dataSet, key, value);
        };
        BaseAction.prototype.getItem = function(index) {
            return DatasetUtil.getItem(this.dataSet, index);
        };
        BaseAction.prototype.setItem = function(index, value) {
            return DatasetUtil.setItem(this.dataSet, index, value);
        };
        BaseAction.prototype.addItem = function(value, index) {
            return DatasetUtil.addItem(this.dataSet, value, index);
        };
        BaseAction.prototype.removeItem = function(index, exactMatch) {
            return DatasetUtil.removeItem(this.dataSet, index, exactMatch);
        };
        BaseAction.prototype.clearData = function() {
            this.dataSet = DatasetUtil.getValidDataset();
            return this.dataSet;
        };
        BaseAction.prototype.getCount = function() {
            return DatasetUtil.getCount(this.dataSet);
        };
        BaseAction.prototype.init = function() {};
        return BaseAction;
    }();
    var getManager$2 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.NAVIGATION);
    };
    var NavigationAction = function(_super) {
        __extends(NavigationAction, _super);
        function NavigationAction(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        NavigationAction.prototype.invoke = function(options) {
            getManager$2().invoke(this, options);
        };
        NavigationAction.prototype.navigate = function(options) {
            this.invoke(options);
        };
        NavigationAction.prototype.init = function() {
            getManager$2().initBinding(this, "dataBinding", "dataBinding");
            getManager$2().initBinding(this, "dataSet", "dataSet");
        };
        return NavigationAction;
    }(BaseAction);
    var getManager$3 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.MODEL);
    };
    var ModelVariable = function(_super) {
        __extends(ModelVariable, _super);
        function ModelVariable(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        ModelVariable.prototype.init = function() {
            if (this.isList) {
                getManager$3().removeFirstEmptyObject(this);
            }
            getManager$3().initBinding(this, "dataBinding", "dataSet");
        };
        ModelVariable.prototype.execute = function(operation, options) {
            var returnVal = _super.prototype.execute.call(this, operation, options);
            if (core.isDefined(returnVal)) {
                return returnVal;
            }
            switch (operation) {
              case core.DataSource.Operation.IS_API_AWARE:
                returnVal = false;
                break;

              case core.DataSource.Operation.SUPPORTS_CRUD:
                returnVal = false;
                break;

              case core.DataSource.Operation.SUPPORTS_DISTINCT_API:
                returnVal = false;
                break;

              case core.DataSource.Operation.IS_PAGEABLE:
                returnVal = false;
                break;

              case core.DataSource.Operation.SUPPORTS_SERVER_FILTER:
                returnVal = false;
                break;

              case core.DataSource.Operation.IS_BOUND_TO_LOCALE:
                returnVal = this.isBoundToLocale();
                break;

              case core.DataSource.Operation.GET_DEFAULT_LOCALE:
                returnVal = this.getDefaultLocale();
                break;

              default:
                returnVal = {};
                break;
            }
            return returnVal;
        };
        ModelVariable.prototype.isBoundToLocale = function() {
            return this.name === "supportedLocale";
        };
        ModelVariable.prototype.getDefaultLocale = function() {
            return exports.appManager.getSelectedLocale();
        };
        return ModelVariable;
    }(BaseVariable);
    var getManager$4 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.SERVICE);
    };
    var ServiceVariable = function(_super) {
        __extends(ServiceVariable, _super);
        function ServiceVariable(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        ServiceVariable.prototype.execute = function(operation, options) {
            var returnVal = _super.prototype.execute.call(this, operation, options);
            if (core.isDefined(returnVal)) {
                return returnVal;
            }
            switch (operation) {
              case core.DataSource.Operation.IS_API_AWARE:
                returnVal = true;
                break;

              case core.DataSource.Operation.SUPPORTS_CRUD:
                returnVal = false;
                break;

              case core.DataSource.Operation.SUPPORTS_DISTINCT_API:
                returnVal = false;
                break;

              case core.DataSource.Operation.IS_PAGEABLE:
                returnVal = this.controller === VARIABLE_CONSTANTS.CONTROLLER_TYPE.QUERY || !_.isEmpty(this.pagination);
                break;

              case core.DataSource.Operation.SUPPORTS_SERVER_FILTER:
                returnVal = false;
                break;

              case core.DataSource.Operation.SET_INPUT:
                returnVal = this.setInput(options);
                break;

              case core.DataSource.Operation.LIST_RECORDS:
                returnVal = this.invoke(options);
                break;

              case core.DataSource.Operation.INVOKE:
                returnVal = this.invoke(options);
                break;

              case core.DataSource.Operation.UPDATE:
                returnVal = this.update(options);
                break;

              case core.DataSource.Operation.SEARCH_RECORDS:
                returnVal = this.searchRecords(options);
                break;

              case core.DataSource.Operation.DOWNLOAD:
                returnVal = this.download(options);
                break;

              case core.DataSource.Operation.GET_PAGING_OPTIONS:
                returnVal = this.pagination;
                break;

              case core.DataSource.Operation.IS_UPDATE_REQUIRED:
                returnVal = this.isUpdateRequired(options);
                break;

              case core.DataSource.Operation.IS_BOUND_TO_LOCALE:
                returnVal = false;
                break;

              case core.DataSource.Operation.CANCEL:
                returnVal = this.cancel(options);
                break;

              default:
                returnVal = {};
                break;
            }
            return returnVal;
        };
        ServiceVariable.prototype.invoke = function(options, success, error) {
            return getManager$4().invoke(this, options, success, error);
        };
        ServiceVariable.prototype.update = function(options, success, error) {
            return getManager$4().invoke(this, options, success, error);
        };
        ServiceVariable.prototype.download = function(options, success, error) {
            return getManager$4().download(this, options, success, error);
        };
        ServiceVariable.prototype.setInput = function(key, val, options) {
            return getManager$4().setInput(this, key, val, options);
        };
        ServiceVariable.prototype.searchRecords = function(options, success, error) {
            var _this = this;
            return new Promise(function(resolve, reject) {
                getManager$4().searchRecords(_this, options, function(response, pagination) {
                    resolve({
                        data: response.content || response,
                        pagination: pagination
                    });
                }, reject);
            });
        };
        ServiceVariable.prototype.isUpdateRequired = function(hasData) {
            var inputFields = getManager$4().getInputParms(this);
            var queryParams = ServiceVariableUtils.excludePaginationParams(inputFields);
            if (!queryParams.length) {
                if (hasData) {
                    return false;
                }
            }
            return true;
        };
        ServiceVariable.prototype.cancel = function(options) {
            return getManager$4().cancel(this, options);
        };
        ServiceVariable.prototype.init = function() {
            getManager$4().initBinding(this);
            getManager$4().defineFirstLastRecord(this);
        };
        return ServiceVariable;
    }(ApiAwareVariable);
    var getManager$5 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.NOTIFICATION);
    };
    var NotificationAction = function(_super) {
        __extends(NotificationAction, _super);
        function NotificationAction(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        NotificationAction.prototype.execute = function(operation, options) {
            var _this = this;
            var returnVal = _super.prototype.execute.call(this, operation, options);
            if (core.isDefined(returnVal)) {
                return returnVal;
            }
            return new Promise(function(resolve, reject) {
                switch (operation) {
                  case core.DataSource.Operation.INVOKE:
                    _this.invoke(options, resolve, reject);
                    break;

                  case core.DataSource.Operation.NOTIFY:
                    _this.notify(options, resolve, reject);
                    break;

                  default:
                    reject(operation + " operation is not supported on this data source");
                    break;
                }
            });
        };
        NotificationAction.prototype.notify = function(options, success, error) {
            getManager$5().notify(this, options, success, error);
        };
        NotificationAction.prototype.invoke = function(options, success, error) {
            this.notify(options, success, error);
        };
        NotificationAction.prototype.getMessage = function() {
            return getManager$5().getMessage(this);
        };
        NotificationAction.prototype.setMessage = function(text) {
            return getManager$5().setMessage(this, text);
        };
        NotificationAction.prototype.clearMessage = function() {
            return getManager$5().setMessage(this, "");
        };
        NotificationAction.prototype.getOkButtonText = function() {
            return getManager$5().getOkButtonText(this);
        };
        NotificationAction.prototype.setOkButtonText = function(text) {
            return getManager$5().setOkButtonText(this, text);
        };
        NotificationAction.prototype.getToasterDuration = function() {
            return getManager$5().getToasterDuration(this);
        };
        NotificationAction.prototype.setToasterDuration = function(duration) {
            return getManager$5().setToasterDuration(this, duration);
        };
        NotificationAction.prototype.getToasterClass = function() {
            return getManager$5().getToasterClass(this);
        };
        NotificationAction.prototype.setToasterClass = function(classText) {
            return getManager$5().setToasterClass(this, classText);
        };
        NotificationAction.prototype.getToasterPosition = function() {
            return getManager$5().getToasterPosition(this);
        };
        NotificationAction.prototype.setToasterPosition = function(position) {
            return getManager$5().setToasterPosition(this, position);
        };
        NotificationAction.prototype.getAlertType = function() {
            return getManager$5().getAlertType(this);
        };
        NotificationAction.prototype.setAlertType = function(type) {
            return getManager$5().setAlertType(this, type);
        };
        NotificationAction.prototype.getCancelButtonText = function() {
            return getManager$5().getCancelButtonText(this);
        };
        NotificationAction.prototype.setCancelButtonText = function(text) {
            return getManager$5().setCancelButtonText(this, text);
        };
        NotificationAction.prototype.init = function() {
            getManager$5().initBinding(this, "dataBinding", "dataBinding");
            getManager$5().initBinding(this, "dataSet", "dataSet");
        };
        return NotificationAction;
    }(BaseAction);
    var getManager$6 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.LOGIN);
    };
    var LoginAction = function(_super) {
        __extends(LoginAction, _super);
        function LoginAction(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        LoginAction.prototype.login = function(options, success, error) {
            return getManager$6().login(this, options, success, error);
        };
        LoginAction.prototype.invoke = function(options, success, error) {
            return this.login(options, success, error);
        };
        LoginAction.prototype.cancel = function() {};
        LoginAction.prototype.init = function() {
            getManager$6().initBinding(this, "dataBinding", "dataBinding");
        };
        return LoginAction;
    }(BaseAction);
    var getManager$7 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.LOGOUT);
    };
    var LogoutAction = function(_super) {
        __extends(LogoutAction, _super);
        function LogoutAction(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        LogoutAction.prototype.logout = function(options, success, error) {
            getManager$7().logout(this, options, success, error);
        };
        LogoutAction.prototype.invoke = function(options, success, error) {
            this.logout(options, success, error);
        };
        LogoutAction.prototype.cancel = function() {};
        return LogoutAction;
    }(BaseAction);
    var getManager$8 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.TIMER);
    };
    var TimerAction = function(_super) {
        __extends(TimerAction, _super);
        function TimerAction(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        TimerAction.prototype.fire = function(options, success, error) {
            return getManager$8().trigger(this, options, success, error);
        };
        TimerAction.prototype.invoke = function(options, success, error) {
            return this.fire(options, success, error);
        };
        TimerAction.prototype.cancel = function() {
            return getManager$8().cancel(this);
        };
        return TimerAction;
    }(BaseAction);
    var getManager$9 = function() {
        return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.WEBSOCKET);
    };
    var WebSocketVariable = function(_super) {
        __extends(WebSocketVariable, _super);
        function WebSocketVariable(variable) {
            var _this = _super.call(this) || this;
            Object.assign(_this, variable);
            return _this;
        }
        WebSocketVariable.prototype.open = function(success, error) {
            return getManager$9().open(this, success, error);
        };
        WebSocketVariable.prototype.close = function() {
            return getManager$9().close(this);
        };
        WebSocketVariable.prototype.update = function() {
            return getManager$9().update(this);
        };
        WebSocketVariable.prototype.send = function(message) {
            return getManager$9().send(this, message);
        };
        WebSocketVariable.prototype.cancel = function() {
            return this.close();
        };
        WebSocketVariable.prototype.invoke = function(options, success, error) {
            this.open(success, error);
        };
        WebSocketVariable.prototype.init = function() {
            getManager$9().initBinding(this);
        };
        return WebSocketVariable;
    }(ApiAwareVariable);
    var VariableFactory = function() {
        function VariableFactory() {}
        VariableFactory.create = function(variable, context) {
            var variableInstance;
            switch (variable.category) {
              case VARIABLE_CONSTANTS.CATEGORY.MODEL:
                variableInstance = new ModelVariable(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.SERVICE:
                variableInstance = new ServiceVariable(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.LIVE:
                variableInstance = new LiveVariable(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.DEVICE:
                variableInstance = new DeviceVariable(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.NAVIGATION:
                variableInstance = new NavigationAction(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.NOTIFICATION:
                variableInstance = new NotificationAction(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.LOGIN:
                variableInstance = new LoginAction(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.LOGOUT:
                variableInstance = new LogoutAction(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.TIMER:
                variableInstance = new TimerAction(variable);
                break;

              case VARIABLE_CONSTANTS.CATEGORY.WEBSOCKET:
                variableInstance = new WebSocketVariable(variable);
            }
            variableInstance._context = context;
            variableInstance.__cloneable__ = false;
            return variableInstance;
        };
        return VariableFactory;
    }();
    var MetadataService = function() {
        function MetadataService($http) {
            this.$http = $http;
            this.CONTEXT_APP = "app";
        }
        MetadataService.prototype.isLoaded = function() {
            return this.metadataMap ? this.metadataMap.has(this.CONTEXT_APP) : false;
        };
        MetadataService.prototype.load = function(prefabName) {
            var _this = this;
            var url;
            if (core.hasCordova() && !core.isSpotcues) {
                url = "metadata/" + (prefabName ? "prefabs/" + prefabName + "/" : "app/") + "service-definitions.json";
            } else {
                url = "./services/" + (prefabName ? "prefabs/" + prefabName + "/" : "") + "servicedefs";
            }
            return new Promise(function(resolve, reject) {
                _this.$http.send({
                    url: url,
                    method: "GET"
                }).then(function(response) {
                    _this.metadataMap = _this.metadataMap || new Map();
                    _this.metadataMap.set(prefabName || _this.CONTEXT_APP, response.body);
                    resolve(response.body);
                }, reject);
            });
        };
        MetadataService.prototype.getByOperationId = function(operationId, context) {
            context = context || this.CONTEXT_APP;
            var map = this.metadataMap.get(context);
            return map && map[operationId];
        };
        MetadataService.decorators = [ {
            type: core$1.Injectable
        } ];
        MetadataService.ctorParameters = function() {
            return [ {
                type: core.AbstractHttpService
            } ];
        };
        return MetadataService;
    }();
    var VariablesService = function() {
        function VariablesService(httpService, metadataService, navigationService, routerService, toasterService, oAuthService, securityService, dialogService) {
            this.httpService = httpService;
            this.metadataService = metadataService;
            this.navigationService = navigationService;
            this.routerService = routerService;
            this.toasterService = toasterService;
            this.oAuthService = oAuthService;
            this.securityService = securityService;
            this.dialogService = dialogService;
            setDependency("http", this.httpService);
            setDependency("metadata", this.metadataService);
            setDependency("navigationService", this.navigationService);
            setDependency("router", this.routerService);
            setDependency("toaster", this.toasterService);
            setDependency("oAuth", this.oAuthService);
            setDependency("security", this.securityService);
            setDependency("dialog", this.dialogService);
        }
        VariablesService.prototype.bulkCancel = function(collection) {
            Object.keys(collection).forEach(function(name) {
                var variable = collection[name];
                if (_.isFunction(variable.cancel)) {
                    variable.cancel();
                }
            });
        };
        VariablesService.prototype.triggerStartUpdate = function(collection) {
            return Promise.all(Object.keys(collection).map(function(name) {
                return collection[name];
            }).filter(function(variable) {
                return variable.startUpdate && variable.invoke;
            }).map(function(variable) {
                return variable.invoke();
            }));
        };
        VariablesService.prototype.register = function(page, variablesJson, scope) {
            var _this = this;
            var variableInstances = {
                Variables: {},
                Actions: {},
                callback: this.triggerStartUpdate
            };
            var varInstance;
            for (var variableName in variablesJson) {
                varInstance = VariableFactory.create(variablesJson[variableName], scope);
                varInstance.init();
                if (varInstance instanceof BaseAction) {
                    variableInstances.Actions[variableName] = varInstance;
                } else {
                    variableInstances.Variables[variableName] = varInstance;
                }
            }
            if (scope.registerDestroyListener) {
                scope.registerDestroyListener(function() {
                    _this.bulkCancel(variableInstances.Variables);
                    _this.bulkCancel(variableInstances.Actions);
                });
            }
            return variableInstances;
        };
        VariablesService.prototype.destroy = function() {};
        VariablesService.prototype.registerDependency = function(name, ref) {
            setDependency(name, ref);
        };
        VariablesService.decorators = [ {
            type: core$1.Injectable
        } ];
        VariablesService.ctorParameters = function() {
            return [ {
                type: core.AbstractHttpService
            }, {
                type: MetadataService
            }, {
                type: core.AbstractNavigationService
            }, {
                type: router.Router
            }, {
                type: core.AbstractToasterService
            }, {
                type: oAuth.OAuthService
            }, {
                type: security.SecurityService
            }, {
                type: core.AbstractDialogService
            } ];
        };
        return VariablesService;
    }();
    var toastrModule = ngxToastr.ToastrModule.forRoot({
        maxOpened: 1,
        autoDismiss: true
    });
    var VariablesModule = function() {
        function VariablesModule() {}
        VariablesModule.forRoot = function() {
            return {
                ngModule: VariablesModule,
                providers: [ VariablesService, MetadataService, common.Location, {
                    provide: common.LocationStrategy,
                    useClass: common.HashLocationStrategy
                } ]
            };
        };
        VariablesModule.decorators = [ {
            type: core$1.NgModule,
            args: [ {
                imports: [ common.CommonModule, toastrModule, http.HttpClientModule, http$1.HttpServiceModule, oAuth.OAuthModule, security.SecurityModule ],
                declarations: []
            } ]
        } ];
        return VariablesModule;
    }();
    exports.\u0275b = BaseActionManager;
    exports.\u0275h = LoginActionManager;
    exports.\u0275i = LogoutActionManager;
    exports.\u0275f = NavigationActionManager;
    exports.\u0275g = NotificationActionManager;
    exports.\u0275j = TimerActionManager;
    exports.\u0275a = BaseVariableManager;
    exports.\u0275e = LiveVariableManager;
    exports.\u0275c = ModelVariableManager;
    exports.\u0275d = ServiceVariableManager;
    exports.\u0275k = WebSocketVariableManager;
    exports.CONSTANTS = CONSTANTS;
    exports.VARIABLE_CONSTANTS = VARIABLE_CONSTANTS;
    exports.WS_CONSTANTS = WS_CONSTANTS;
    exports.DB_CONSTANTS = DB_CONSTANTS;
    exports.SWAGGER_CONSTANTS = SWAGGER_CONSTANTS;
    exports.VARIABLE_URLS = VARIABLE_URLS;
    exports.$rootScope = $rootScope;
    exports.VariableManagerFactory = VariableManagerFactory;
    exports.DeviceVariableManager = DeviceVariableManager;
    exports.DeviceVariableService = DeviceVariableService;
    exports.VariablesService = VariablesService;
    exports.MetadataService = MetadataService;
    exports.parseConfig = parseConfig;
    exports.generateConnectionParams = generateConnectionParams;
    exports.LVService = LVService;
    exports.\u02750 = \u02750$3;
    exports.LiveVariableUtils = LiveVariableUtils;
    exports.setDependency = setDependency;
    exports.initiateCallback = initiateCallback;
    exports.processBinding = processBinding;
    exports.simulateFileDownload = simulateFileDownload;
    exports.setInput = setInput;
    exports.isFileUploadSupported = isFileUploadSupported;
    exports.getEvaluatedOrderBy = getEvaluatedOrderBy;
    exports.formatExportExpression = formatExportExpression;
    exports.debounceVariableCall = debounceVariableCall;
    exports.formatDate = formatDate;
    exports.\u02751 = \u02751;
    exports.\u02752 = \u02752;
    exports.\u02753 = \u02753;
    exports.\u02754 = \u02754;
    exports.\u02755 = \u02755;
    exports.\u02756 = \u02756;
    exports.\u02757 = \u02757;
    exports.\u02758 = \u02758;
    exports.\u02759 = \u02759;
    exports.\u027510 = \u027510;
    exports.\u027511 = \u027511;
    exports.\u027512 = \u027512;
    exports.\u027513 = \u027513;
    exports.\u027514 = \u027514;
    exports.\u027515 = \u027515;
    exports.\u027516 = \u027516;
    exports.\u027517 = \u027517;
    exports.toastrModule = toastrModule;
    exports.VariablesModule = VariablesModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/core")) : typeof define === "function" && define.amd ? define("@wm/mobile/runtime", [ "exports", "@angular/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.mobile = global.wm.mobile || {}, global.wm.mobile.runtime = {}), global.ng.core);
})(this, function(exports, core) {
    "use strict";
    var MobileRuntimeModule = function() {
        function MobileRuntimeModule() {}
        MobileRuntimeModule.forRoot = function() {
            return {
                ngModule: MobileRuntimeModule,
                providers: []
            };
        };
        MobileRuntimeModule.decorators = [ {
            type: core.NgModule,
            args: [ {} ]
        } ];
        return MobileRuntimeModule;
    }();
    exports.MobileRuntimeModule = MobileRuntimeModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/core")) : typeof define === "function" && define.amd ? define("@wm/mobile/runtime/dynamic", [ "exports", "@angular/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.mobile = global.wm.mobile || {}, global.wm.mobile.runtime = global.wm.mobile.runtime || {}, 
    global.wm.mobile.runtime.dynamic = {}), global.ng.core);
})(this, function(exports, core) {
    "use strict";
    var MOBILE_COMPONENT_MODULES_FOR_ROOT = [];
    var MobileRuntimeDynamicModule = function() {
        function MobileRuntimeDynamicModule() {}
        MobileRuntimeDynamicModule.decorators = [ {
            type: core.NgModule,
            args: [ {} ]
        } ];
        return MobileRuntimeDynamicModule;
    }();
    exports.MOBILE_COMPONENT_MODULES_FOR_ROOT = MOBILE_COMPONENT_MODULES_FOR_ROOT;
    exports.MobileRuntimeDynamicModule = MobileRuntimeDynamicModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@wm/components/page"), require("@wm/components/dialogs"), require("@wm/components/dialogs/confirm-dialog"), require("@wm/components/dialogs/design-dialog"), require("@wm/mobile/runtime"), require("ngx-toastr"), require("@angular/common/http"), require("ngx-bootstrap/chronos"), require("ngx-bootstrap/datepicker"), require("@wm/security"), require("@angular/router"), require("ngx-bootstrap/utils"), require("@wm/oAuth"), require("@angular/common"), require("@wm/components/base"), require("rxjs"), require("rxjs/operators"), require("@wm/variables"), require("@wm/http"), require("@wm/components/prefab"), require("@wm/transpiler"), require("@wm/build-task"), require("@angular/core"), require("@wm/core")) : typeof define === "function" && define.amd ? define("@wm/runtime/base", [ "exports", "@wm/components/page", "@wm/components/dialogs", "@wm/components/dialogs/confirm-dialog", "@wm/components/dialogs/design-dialog", "@wm/mobile/runtime", "ngx-toastr", "@angular/common/http", "ngx-bootstrap/chronos", "ngx-bootstrap/datepicker", "@wm/security", "@angular/router", "ngx-bootstrap/utils", "@wm/oAuth", "@angular/common", "@wm/components/base", "rxjs", "rxjs/operators", "@wm/variables", "@wm/http", "@wm/components/prefab", "@wm/transpiler", "@wm/build-task", "@angular/core", "@wm/core" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.runtime = global.wm.runtime || {}, global.wm.runtime.base = {}), global.wm.components.page, global.wm.components.dialogs, global.wm.components.dialogs.confirmdialog, global.wm.components.dialogs.designdialog, global.wm.mobile.runtime, global.ngxToastr, global.ng.common.http, global.ngxBootstrap, global.ngxBootstrap, global.wm.security, global.ng.router, global.ngxBootstrap, global.wm.oAuth, global.ng.common, global.wm.components.base, global.rxjs, global.rxjs.operators, global.wm.variables, global.wm.http, global.wm.components.prefab, global.wm.transpiler, global.wm.buildTask, global.ng.core, global.wm.core);
})(this, function(exports, page, dialogs, confirmDialog, designDialog, runtime, ngxToastr, http, chronos, datepicker, security, router, utils, oAuth, common, base, rxjs, operators, variables, http$1, prefab, transpiler, buildTask, i0, core) {
    "use strict";
    (function(ComponentType) {
        ComponentType[ComponentType["PAGE"] = 0] = "PAGE";
        ComponentType[ComponentType["PREFAB"] = 1] = "PREFAB";
        ComponentType[ComponentType["PARTIAL"] = 2] = "PARTIAL";
    })(exports.ComponentType || (exports.ComponentType = {}));
    var ComponentRefProvider = function() {
        function ComponentRefProvider() {}
        ComponentRefProvider.prototype.clearComponentFactoryRefCache = function() {};
        return ComponentRefProvider;
    }();
    var PrefabConfigProvider = function() {
        function PrefabConfigProvider() {}
        return PrefabConfigProvider;
    }();
    var AppJSProvider = function() {
        function AppJSProvider() {}
        return AppJSProvider;
    }();
    var AppVariablesProvider = function() {
        function AppVariablesProvider() {}
        return AppVariablesProvider;
    }();
    var PartialRefProvider = function() {
        function PartialRefProvider() {}
        return PartialRefProvider;
    }();
    var POST_MESSAGES;
    (function(POST_MESSAGES) {
        POST_MESSAGES["HIDE_TEMPLATES_SHOW_CASE"] = "hide-templates-show-case";
        POST_MESSAGES["SHOW_TEMPLATES_SHOW_CASE"] = "show-templates-show-case";
        POST_MESSAGES["UPDATE_LOCATION"] = "update-location-path";
        POST_MESSAGES["SELECT_TEMPLATE"] = "select-template";
        POST_MESSAGES["TEMPLATEBUNDLE_CONFIG"] = "template-bundle-config";
        POST_MESSAGES["ON_LOAD"] = "on-load";
    })(POST_MESSAGES || (POST_MESSAGES = {}));
    var AppManagerService = function() {
        function AppManagerService($http, $security, $dialog, $router, $app, $variables, $metadata, $spinner, $i18n, $datePipe) {
            var _this = this;
            this.$http = $http;
            this.$security = $security;
            this.$dialog = $dialog;
            this.$router = $router;
            this.$app = $app;
            this.$variables = $variables;
            this.$metadata = $metadata;
            this.$spinner = $spinner;
            this.$i18n = $i18n;
            this.$datePipe = $datePipe;
            this.appVariablesLoaded = false;
            this.appVariablesFired = false;
            this._noRedirect = false;
            this.$http.registerOnSessionTimeout(this.handle401.bind(this));
            this.$variables.registerDependency("appManager", this);
            this.$app.subscribe("toggle-variable-state", function(data) {
                var variable = data.variable, active = data.active;
                if (!_.isEmpty(_.trim(variable.spinnerContext))) {
                    if (active) {
                        variable._spinnerId = variable._spinnerId || [];
                        var spinnerId = _this.$spinner.show(variable.spinnerMessage, variable._id + "_" + Date.now(), variable.spinnerclass, variable.spinnerContext);
                        variable._spinnerId.push(spinnerId);
                    } else {
                        _this.$spinner.hide(variable._spinnerId.shift());
                    }
                }
            });
            this.$app.subscribe("userLoggedIn", function() {
                return _this.setLandingPage();
            });
            this.$app.subscribe("userLoggedOut", function() {
                return _this.setLandingPage().then(function() {
                    if (window["cordova"]) {
                        _this.$router.navigate([ "/" ]);
                    }
                });
            });
            this.$app.subscribe("http401", function(d) {
                if (d === void 0) {
                    d = {};
                }
                return _this.handle401(d.page, d.options);
            });
        }
        AppManagerService.prototype.showLoginDialog = function() {
            this.$spinner.hide("globalSpinner");
            this.$dialog.open("CommonLoginDialog");
            core.$appDigest();
        };
        AppManagerService.prototype.loadAppJS = function() {};
        AppManagerService.prototype.loadCommonPage = function() {};
        AppManagerService.prototype.loadSecurityConfig = function() {
            var _this = this;
            return this.$security.load().then(function(r) {
                if (!_this.$app.landingPageName) {
                    _this.setLandingPage();
                }
                return r;
            });
        };
        AppManagerService.prototype.loadMetadata = function() {
            return this.$metadata.load();
        };
        AppManagerService.prototype.loadAppVariables = function(variables$$1) {
            var _this = this;
            if (this.appVariablesLoaded) {
                return Promise.resolve();
            }
            var init = function(response) {
                var data = _this.$variables.register("app", response, _this.$app);
                _.extend(_this.$app.Variables, data.Variables);
                _.extend(_this.$app.Actions, data.Actions);
                _this.updateLoggedInUserVariable();
                _this.updateSupportedLocaleVariable();
                _this.appVariablesLoaded = true;
                _this.appVariablesFired = false;
            };
            if (core.isDefined(variables$$1)) {
                init(variables$$1);
                return Promise.resolve();
            }
            return this.$http.get("./app.variables.json").then(function(response) {
                return init(response);
            });
        };
        AppManagerService.prototype.isAppVariablesFired = function(isFired) {
            if (core.isDefined(isFired)) {
                this.appVariablesFired = isFired;
            }
            return this.appVariablesFired;
        };
        AppManagerService.prototype.clearLoggedInUserVariable = function(variable) {
            variable.isAuthenticated = false;
            variable.roles = [];
            variable.name = undefined;
            variable.id = undefined;
            variable.tenantId = undefined;
        };
        AppManagerService.prototype.updateLoggedInUserVariable = function() {
            var _this = this;
            var loggedInUser = _.get(this.$app, "Variables.loggedInUser.dataSet");
            if (!loggedInUser) {
                return;
            }
            return this.$security.load().then(function() {
                var securityConfig = _this.$security.get();
                if (securityConfig && securityConfig.securityEnabled && securityConfig.authenticated) {
                    loggedInUser.isAuthenticated = securityConfig.authenticated;
                    loggedInUser.roles = securityConfig.userInfo.userRoles;
                    loggedInUser.name = securityConfig.userInfo.userName;
                    loggedInUser.id = securityConfig.userInfo.userId;
                    loggedInUser.tenantId = securityConfig.userInfo.tenantId;
                } else {
                    _this.clearLoggedInUserVariable(loggedInUser);
                    loggedInUser.isSecurityEnabled = securityConfig && securityConfig.securityEnabled;
                    throw null;
                }
                return securityConfig;
            }).catch(function(err) {
                loggedInUser.isAuthenticated = false;
                loggedInUser.roles = [];
                loggedInUser.name = undefined;
                loggedInUser.id = undefined;
                loggedInUser.tenantId = undefined;
            });
        };
        AppManagerService.prototype.updateSupportedLocaleVariable = function() {
            var supportedLocaleVar = _.get(this.$app, "Variables.supportedLocale");
        };
        AppManagerService.prototype.handleSSOLogin = function(config) {
            var _this = this;
            var SSO_URL = "services/security/ssologin", PREVIEW_WINDOW_NAME = "WM_PREVIEW_WINDOW";
            var page$$1, pageParams;
            page$$1 = this.$security.getRedirectPage(config);
            if (variables.CONSTANTS.hasCordova) {
                var lastLoggedInUsername_1 = _.get(this.$security.get(), "userInfo.userName");
                this.$security.authInBrowser().then(function() {
                    return _this.reloadAppData();
                }).then(function() {
                    var presentLoggedInUsername = _.get(_this.$security.get(), "userInfo.userName");
                    if (presentLoggedInUsername && presentLoggedInUsername === lastLoggedInUsername_1) {
                        variables.routerService.navigate([ page$$1 ]);
                    } else {
                        variables.routerService.navigate([ "/" ]);
                    }
                });
            } else {
                page$$1 = page$$1 ? "?redirectPage=" + encodeURIComponent(page$$1) : "";
                pageParams = this.$security.getQueryString(this.$security.getRedirectedRouteQueryParams());
                pageParams = pageParams ? "?" + pageParams : "";
                document.body.textContent = _.get(this.getAppLocale(), [ "MESSAGE_LOGIN_REDIRECTION" ]) || "Redirecting to sso login...";
                var ssoUrl = this.getDeployedURL() + SSO_URL + page$$1 + pageParams;
                if (window.self !== window.top && window.parent.name === PREVIEW_WINDOW_NAME) {
                    window.parent.location.href = window.self.location.href;
                    window.parent.name = "";
                } else {
                    window.location.href = ssoUrl;
                }
            }
        };
        AppManagerService.prototype.handle401 = function(page$$1, options) {
            var sessionTimeoutConfig, sessionTimeoutMethod, loginConfig, loginMethod;
            var LOGIN_METHOD = {
                DIALOG: "DIALOG",
                PAGE: "PAGE",
                SSO: "SSO"
            };
            var config = this.$security.get();
            var queryParamsObj = {};
            loginConfig = config.loginConfig;
            if (config.userInfo && config.userInfo.userName) {
                config.authenticated = false;
                sessionTimeoutConfig = loginConfig.sessionTimeout || {
                    type: LOGIN_METHOD.DIALOG
                };
                sessionTimeoutMethod = sessionTimeoutConfig.type.toUpperCase();
                switch (sessionTimeoutMethod) {
                  case LOGIN_METHOD.DIALOG:
                    this.showLoginDialog();
                    break;

                  case LOGIN_METHOD.PAGE:
                    if (!page$$1) {
                        page$$1 = this.$security.getCurrentRoutePage();
                    }
                    queryParamsObj["redirectTo"] = page$$1;
                    queryParamsObj = _.merge(queryParamsObj, this.$security.getRedirectedRouteQueryParams());
                    if (page$$1 !== sessionTimeoutConfig.pageName) {
                        this.$router.navigate([ sessionTimeoutConfig.pageName ], {
                            queryParams: queryParamsObj
                        });
                    }
                    break;

                  case LOGIN_METHOD.SSO:
                    this.handleSSOLogin(config);
                    break;
                }
                this.setLandingPage();
            } else {
                loginMethod = loginConfig.type.toUpperCase();
                switch (loginMethod) {
                  case LOGIN_METHOD.DIALOG:
                    this.noRedirect(true);
                    this.showLoginDialog();
                    break;

                  case LOGIN_METHOD.PAGE:
                    page$$1 = this.$security.getRedirectPage(config);
                    queryParamsObj["redirectTo"] = page$$1;
                    queryParamsObj = _.merge(queryParamsObj, this.$security.getRedirectedRouteQueryParams());
                    this.$router.navigate([ loginConfig.pageName ], {
                        queryParams: queryParamsObj
                    });
                    this.$app.landingPageName = loginConfig.pageName;
                    break;

                  case LOGIN_METHOD.SSO:
                    this.handleSSOLogin(config);
                    break;
                }
            }
        };
        AppManagerService.prototype.reloadAppData = function() {
            var _this = this;
            return this.loadSecurityConfig().then(function() {
                return _this.loadMetadata().then(function() {
                    return _this.updateLoggedInUserVariable();
                });
            });
        };
        AppManagerService.prototype.noRedirect = function(value) {
            if (_.isUndefined(value)) {
                return this._noRedirect;
            }
            this._noRedirect = value;
            return this._noRedirect;
        };
        AppManagerService.prototype.executeSessionFailureRequests = function() {
            this.$http.executeSessionFailureRequests();
        };
        AppManagerService.prototype.pushToSessionFailureRequests = function(callback) {
            this.$http.pushToSessionFailureQueue(callback);
        };
        AppManagerService.prototype.getDeployedURL = function() {
            return this.$app.deployedUrl ? this.$app.deployedUrl : variables.$rootScope.project.deployedUrl;
        };
        AppManagerService.prototype.notify = function(eventName, data) {
            this.$app.notify(eventName, data);
        };
        AppManagerService.prototype.subscribe = function(eventName, data) {
            return this.$app.subscribe(eventName, data);
        };
        AppManagerService.prototype.getActivePage = function() {
            return this.$app.activePage;
        };
        AppManagerService.prototype.getAppLocale = function() {
            return this.$app.appLocale;
        };
        AppManagerService.prototype.getSelectedLocale = function() {
            return this.$i18n.getSelectedLocale();
        };
        AppManagerService.prototype.notifyApp = function(template, type, title) {
            this.$app.notifyApp(template, type, title);
        };
        AppManagerService.prototype.appOnBeforeServiceCall = function(requestParams) {
            return core.triggerFn(this.$app.onBeforeServiceCall, requestParams);
        };
        AppManagerService.prototype.appOnServiceSuccess = function(data, xhrObj) {
            return core.triggerFn(this.$app.onServiceSuccess, data, xhrObj);
        };
        AppManagerService.prototype.appOnServiceError = function(data, xhrOb) {
            return core.triggerFn(this.$app.onServiceError, data, xhrOb);
        };
        AppManagerService.prototype.appVariablesReady = function() {
            core.triggerFn(this.$app.onAppVariablesReady);
        };
        AppManagerService.prototype.getPipe = function(pipe) {
            if (pipe === "date") {
                return this.$datePipe;
            }
        };
        AppManagerService.prototype.setLandingPage = function() {
            var _this = this;
            return this.$security.getPageByLoggedInUser().then(function(p) {
                return _this.$app.landingPageName = p;
            });
        };
        AppManagerService.prototype.isPrefabType = function() {
            return this.$app.isPrefabType;
        };
        AppManagerService.prototype.isTemplateBundleType = function() {
            return this.$app.isTemplateBundleType;
        };
        AppManagerService.prototype.postMessage = function(content) {
            window.top.postMessage(content, "*");
        };
        AppManagerService.prototype.showTemplate = function(idx) {
            var template = this.templates[idx];
            this.$router.navigate([ template.id ]);
        };
        AppManagerService.prototype.postTemplateBundleInfo = function() {
            var _this = this;
            window.onmessage = function(evt) {
                var msgData = evt.data;
                if (!_.isObject(msgData)) {
                    return;
                }
                var key = msgData.key;
                switch (key) {
                  case POST_MESSAGES.HIDE_TEMPLATES_SHOW_CASE:
                    break;

                  case POST_MESSAGES.SELECT_TEMPLATE:
                    _this.showTemplate(msgData.templateIndex);
                    break;
                }
            };
            setTimeout(function() {
                _this.postMessage({
                    key: POST_MESSAGES.ON_LOAD
                });
            });
            return core.fetchContent("json", "./config.json", true, function(response) {
                _this.templates = [];
                if (!response.error) {
                    _this.templates = response.templates;
                    _this.postMessage({
                        key: POST_MESSAGES.TEMPLATEBUNDLE_CONFIG,
                        config: response
                    });
                }
            });
        };
        AppManagerService.prototype.postAppTypeInfo = function() {
            if (this.isTemplateBundleType()) {
                return this.postTemplateBundleInfo();
            }
        };
        AppManagerService.SERVICE_NAME = "AppManagerService";
        AppManagerService.decorators = [ {
            type: i0.Injectable
        } ];
        AppManagerService.ctorParameters = function() {
            return [ {
                type: core.AbstractHttpService
            }, {
                type: security.SecurityService
            }, {
                type: core.AbstractDialogService
            }, {
                type: router.Router
            }, {
                type: core.App
            }, {
                type: variables.VariablesService
            }, {
                type: variables.MetadataService
            }, {
                type: core.AbstractSpinnerService
            }, {
                type: core.AbstractI18nService
            }, {
                type: common.DatePipe
            } ];
        };
        return AppManagerService;
    }();
    var isPrefabInPreview = function(prefabName) {
        return prefabName === "__self__";
    };
    var getPrefabBaseUrl = function(prefabName) {
        return isPrefabInPreview(prefabName) ? "." : "app/prefabs/" + prefabName;
    };
    var getPrefabConfigUrl = function(prefabName) {
        return getPrefabBaseUrl(prefabName) + "/config.json";
    };
    var getPrefabMinJsonUrl = function(prefabName) {
        return getPrefabBaseUrl(prefabName) + "/pages/Main/page.min.json";
    };
    var prefabsWithError = new Set();
    var inProgress = new Map();
    var resolvedPrefabs = new Set();
    var getPrefabResourceUrl = function(resourcePath, resourceBasePath) {
        var _url = resourcePath;
        if (!core.stringStartsWith(resourcePath, "http://|https://|//")) {
            _url = (resourceBasePath + _url).replace("//", "/");
        }
        return _url;
    };
    var \u02750 = getPrefabResourceUrl;
    var PrefabManagerService = function() {
        function PrefabManagerService($metadata, prefabConfigProvider) {
            this.$metadata = $metadata;
            this.prefabConfigProvider = prefabConfigProvider;
        }
        PrefabManagerService.prototype.getConfig = function(prefabName) {
            return this.prefabConfigProvider.getConfig(prefabName);
        };
        PrefabManagerService.prototype.loadServiceDefs = function(prefabName) {
            return isPrefabInPreview(prefabName) ? Promise.resolve() : this.$metadata.load(prefabName);
        };
        PrefabManagerService.prototype.loadStyles = function(prefabName, _a) {
            var styles = (_a === void 0 ? {
                resources: {
                    styles: []
                }
            } : _a).resources.styles;
            var baseUrl = getPrefabBaseUrl(prefabName);
            var _styles = styles.map(function(url) {
                if (!_.endsWith(url, "/pages/Main/Main.css")) {
                    return getPrefabResourceUrl(url, baseUrl);
                }
                return undefined;
            }).filter(function(url) {
                return !!url;
            });
            core.loadStyleSheets(_styles);
            return Promise.resolve();
        };
        PrefabManagerService.prototype.loadScripts = function(prefabName, _a) {
            var scripts = (_a === void 0 ? {
                resources: {
                    scripts: []
                }
            } : _a).resources.scripts;
            var baseUrl = getPrefabBaseUrl(prefabName);
            var _scripts = scripts.map(function(url) {
                return getPrefabResourceUrl(url, baseUrl);
            });
            return core.loadScripts(_scripts);
        };
        PrefabManagerService.prototype.setInProgress = function(prefabName) {
            var _res;
            var _rej;
            var _promise = new Promise(function(res, rej) {
                _res = res;
                _rej = rej;
            });
            _promise.resolve = _res;
            _promise.reject = _rej;
            inProgress.set(prefabName, _promise);
        };
        PrefabManagerService.prototype.resolveInProgress = function(prefabName) {
            if (inProgress.get(prefabName)) {
                inProgress.get(prefabName).resolve();
                inProgress.delete(prefabName);
            }
        };
        PrefabManagerService.prototype.loadDependencies = function(prefabName) {
            var _this = this;
            if (resolvedPrefabs.has(prefabName)) {
                return Promise.resolve();
            }
            if (prefabsWithError.has(prefabName)) {
                return Promise.reject("");
            }
            if (inProgress.get(prefabName)) {
                return inProgress.get(prefabName);
            }
            this.setInProgress(prefabName);
            return this.getConfig(prefabName).then(function(config) {
                return Promise.all([ _this.loadStyles(prefabName, config), _this.loadScripts(prefabName, config), _this.loadServiceDefs(prefabName) ]).then(function() {
                    _this.resolveInProgress(prefabName);
                    resolvedPrefabs.add(prefabName);
                });
            });
        };
        PrefabManagerService.decorators = [ {
            type: i0.Injectable
        } ];
        PrefabManagerService.ctorParameters = function() {
            return [ {
                type: variables.MetadataService
            }, {
                type: PrefabConfigProvider
            } ];
        };
        return PrefabManagerService;
    }();
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function(resolve, reject) {
            function fulfilled(value) {
                try {
                    step(generator.next(value));
                } catch (e) {
                    reject(e);
                }
            }
            function rejected(value) {
                try {
                    step(generator["throw"](value));
                } catch (e) {
                    reject(e);
                }
            }
            function step(result) {
                result.done ? resolve(result.value) : new P(function(resolve) {
                    resolve(result.value);
                }).then(fulfilled, rejected);
            }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = {
            label: 0,
            sent: function() {
                if (t[0] & 1) throw t[1];
                return t[1];
            },
            trys: [],
            ops: []
        }, f, y, t, g;
        return g = {
            next: verb(0),
            throw: verb(1),
            return: verb(2)
        }, typeof Symbol === "function" && (g[Symbol.iterator] = function() {
            return this;
        }), g;
        function verb(n) {
            return function(v) {
                return step([ n, v ]);
            };
        }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 
                0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [ op[0] & 2, t.value ];
                switch (op[0]) {
                  case 0:
                  case 1:
                    t = op;
                    break;

                  case 4:
                    _.label++;
                    return {
                        value: op[1],
                        done: false
                    };

                  case 5:
                    _.label++;
                    y = op[1];
                    op = [ 0 ];
                    continue;

                  case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;

                  default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue;
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break;
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break;
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break;
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue;
                }
                op = body.call(thisArg, _);
            } catch (e) {
                op = [ 6, e ];
                y = 0;
            } finally {
                f = t = 0;
            }
            if (op[0] & 5) throw op[1];
            return {
                value: op[0] ? op[1] : void 0,
                done: true
            };
        }
    }
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m) return m.call(o);
        return {
            next: function() {
                if (o && i >= o.length) o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var FragmentMonitor = function() {
        function FragmentMonitor() {
            this.fragments = 0;
            this.fragmentsLoaded$ = new rxjs.Subject();
        }
        FragmentMonitor.prototype.init = function() {
            var _this = this;
            this.viewInit$.subscribe(core.noop, core.noop, function() {
                _this.isViewInitialized = true;
                _this.isReady();
            });
        };
        FragmentMonitor.prototype.registerFragment = function() {
            this.fragments++;
        };
        FragmentMonitor.prototype.resolveFragment = function() {
            this.fragments--;
            this.isReady();
        };
        FragmentMonitor.prototype.isReady = function() {
            if (this.isViewInitialized && !this.fragments) {
                this.registerFragment = core.noop;
                this.resolveFragment = core.noop;
                this.fragmentsLoaded$.complete();
            }
        };
        return FragmentMonitor;
    }();
    var commonPartialWidgets = {};
    var BasePartialComponent = function(_super) {
        __extends(BasePartialComponent, _super);
        function BasePartialComponent() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.compileContent = false;
            _this.destroy$ = new rxjs.Subject();
            _this.viewInit$ = new rxjs.Subject();
            return _this;
        }
        BasePartialComponent.prototype.getContainerWidgetInjector = function() {
            return this.containerWidget.inj || this.containerWidget.injector;
        };
        BasePartialComponent.prototype.init = function() {
            var _this = this;
            this.App = this.injector.get(core.App);
            this.containerWidget = this.injector.get(base.WidgetRef);
            this.i18nService = this.injector.get(core.AbstractI18nService);
            this.scriptLoaderService = this.injector.get(core.ScriptLoaderService);
            if (this.getContainerWidgetInjector().view.component.registerFragment) {
                this.getContainerWidgetInjector().view.component.registerFragment();
            }
            this.initUserScript();
            this.registerWidgets();
            this.initVariables();
            this.activePageName = this.App.activePageName;
            this.registerPageParams();
            this.defineI18nProps();
            this.viewInit$.subscribe(core.noop, core.noop, function() {
                _this.pageParams = _this.containerWidget.partialParams;
            });
            _super.prototype.init.call(this);
        };
        BasePartialComponent.prototype.registerWidgets = function() {
            if (this.partialName === "Common") {
                this.Widgets = commonPartialWidgets;
            } else {
                this.Widgets = Object.create(commonPartialWidgets);
            }
            this.containerWidget.Widgets = this.Widgets;
        };
        BasePartialComponent.prototype.registerDestroyListener = function(fn) {
            this.destroy$.subscribe(core.noop, core.noop, function() {
                return fn();
            });
        };
        BasePartialComponent.prototype.initUserScript = function() {
            try {
                this.evalUserScript(this, this.App, this.injector.get(core.UtilsService));
            } catch (e) {
                console.error("Error in evaluating partial (" + this.partialName + ") script\n", e);
            }
        };
        BasePartialComponent.prototype.initVariables = function() {
            var _this = this;
            var variablesService = this.injector.get(variables.VariablesService);
            var variableCollection = variablesService.register(this.partialName, this.getVariables(), this);
            this.Variables = Object.create(this.App.Variables);
            this.Actions = Object.create(this.App.Actions);
            this.containerWidget.Variables = this.Variables;
            this.containerWidget.Actions = this.Actions;
            Object.entries(variableCollection.Variables).forEach(function(_a) {
                var _b = __read(_a, 2), name = _b[0], variable = _b[1];
                return _this.Variables[name] = variable;
            });
            Object.entries(variableCollection.Actions).forEach(function(_a) {
                var _b = __read(_a, 2), name = _b[0], action = _b[1];
                return _this.Actions[name] = action;
            });
            this.viewInit$.subscribe(core.noop, core.noop, function() {
                core.$invokeWatchers(true, true);
                variableCollection.callback(variableCollection.Variables).catch(core.noop);
                variableCollection.callback(variableCollection.Actions);
            });
        };
        BasePartialComponent.prototype.registerPageParams = function() {
            this.pageParams = this.containerWidget.partialParams;
        };
        BasePartialComponent.prototype.defineI18nProps = function() {
            this.appLocale = this.i18nService.getAppLocale();
        };
        BasePartialComponent.prototype.invokeOnReady = function() {
            this.onReady();
            if (this.getContainerWidgetInjector().view.component.resolveFragment) {
                this.getContainerWidgetInjector().view.component.resolveFragment();
            }
        };
        BasePartialComponent.prototype.loadScripts = function() {
            var _this = this;
            return new Promise(function(resolve) {
                var _a;
                var scriptsRequired = _this.partialDirective.$element.attr("scripts-to-load");
                if (scriptsRequired) {
                    (_a = _this.scriptLoaderService).load.apply(_a, __spread(scriptsRequired.split(","))).then(resolve);
                } else {
                    resolve();
                }
            });
        };
        BasePartialComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            this.loadScripts().then(function() {
                _this.compileContent = true;
                setTimeout(function() {
                    _this.viewInit$.complete();
                    _this.fragmentsLoaded$.subscribe(core.noop, core.noop, function() {
                        return _this.invokeOnReady();
                    });
                }, 100);
            });
        };
        BasePartialComponent.prototype.ngOnDestroy = function() {
            this.destroy$.complete();
        };
        BasePartialComponent.prototype.onReady = function() {};
        BasePartialComponent.propDecorators = {
            partialDirective: [ {
                type: i0.ViewChild,
                args: [ base.PartialDirective ]
            } ]
        };
        return BasePartialComponent;
    }(FragmentMonitor);
    var BasePageComponent = function(_super) {
        __extends(BasePageComponent, _super);
        function BasePageComponent() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.startupVariablesLoaded = false;
            _this.pageTransitionCompleted = false;
            _this.destroy$ = new rxjs.Subject();
            _this.viewInit$ = new rxjs.Subject();
            return _this;
        }
        BasePageComponent.prototype.init = function() {
            core.muteWatchers();
            this.App = this.injector.get(core.App);
            this.route = this.injector.get(router.ActivatedRoute);
            this.appManager = this.injector.get(AppManagerService);
            this.navigationService = this.injector.get(core.AbstractNavigationService);
            this.scriptLoaderService = this.injector.get(core.ScriptLoaderService);
            this.i18nService = this.injector.get(core.AbstractI18nService);
            this.router = this.injector.get(router.Router);
            this.initUserScript();
            this.registerWidgets();
            this.initVariables();
            this.App.lastActivePageName = this.App.activePageName;
            this.App.activePageName = this.pageName;
            this.App.activePage = this;
            this.activePageName = this.pageName;
            this.registerPageParams();
            this.defineI18nProps();
            _super.prototype.init.call(this);
        };
        BasePageComponent.prototype.registerWidgets = function() {
            this.Widgets = Object.create(commonPartialWidgets);
            this.App.Widgets = Object.create(this.Widgets);
        };
        BasePageComponent.prototype.initUserScript = function() {
            try {
                this.evalUserScript(this, this.App, this.injector.get(core.UtilsService));
            } catch (e) {
                console.error("Error in evaluating page (" + this.pageName + ") script\n", e);
            }
        };
        BasePageComponent.prototype.registerPageParams = function() {
            var _this = this;
            var subscription = this.route.queryParams.subscribe(function(params) {
                return _this.pageParams = _this.App.pageParams = params;
            });
            this.registerDestroyListener(function() {
                return subscription.unsubscribe();
            });
        };
        BasePageComponent.prototype.registerDestroyListener = function(fn) {
            this.destroy$.subscribe(core.noop, core.noop, function() {
                return fn();
            });
        };
        BasePageComponent.prototype.defineI18nProps = function() {
            this.appLocale = this.i18nService.getAppLocale();
        };
        BasePageComponent.prototype.initVariables = function() {
            var _this = this;
            var variablesService = this.injector.get(variables.VariablesService);
            var variableCollection = variablesService.register(this.pageName, this.getVariables(), this);
            this.Variables = Object.create(this.App.Variables);
            this.Actions = Object.create(this.App.Actions);
            Object.entries(variableCollection.Variables).forEach(function(_a) {
                var _b = __read(_a, 2), name = _b[0], variable = _b[1];
                return _this.Variables[name] = variable;
            });
            Object.entries(variableCollection.Actions).forEach(function(_a) {
                var _b = __read(_a, 2), name = _b[0], action = _b[1];
                return _this.Actions[name] = action;
            });
            var subscription = this.viewInit$.subscribe(core.noop, core.noop, function() {
                if (!_this.appManager.isAppVariablesFired()) {
                    variableCollection.callback(_this.App.Variables).catch(core.noop).then(function() {
                        _this.appManager.notify("app-variables-data-loaded", {
                            pageName: _this.pageName
                        });
                    });
                    variableCollection.callback(_this.App.Actions);
                    _this.appManager.appVariablesReady();
                    _this.appManager.isAppVariablesFired(true);
                }
                variableCollection.callback(variableCollection.Variables).catch(core.noop).then(function() {
                    _this.appManager.notify("page-variables-data-loaded", {
                        pageName: _this.pageName
                    });
                    _this.startupVariablesLoaded = true;
                    setTimeout(function() {
                        _this.showPageContent = true;
                    }, 100);
                });
                variableCollection.callback(variableCollection.Actions);
                subscription.unsubscribe();
            });
        };
        BasePageComponent.prototype.runPageTransition = function(transition) {
            var _this = this;
            return new Promise(function(resolve) {
                var $target = _this.getPageTransitionTarget();
                if (transition) {
                    var onTransitionEnd_1 = function() {
                        if (resolve) {
                            $target.off("animationend", onTransitionEnd_1);
                            $target.removeClass(transition);
                            $target.children().first().remove();
                            resolve();
                            resolve = null;
                        }
                    };
                    transition = "page-transition page-transition-" + transition;
                    $target.addClass(transition);
                    $target.on("animationend", onTransitionEnd_1);
                    setTimeout(onTransitionEnd_1, 1e3);
                } else {
                    resolve();
                }
            });
        };
        BasePageComponent.prototype.invokeOnReady = function() {
            this.onReady();
            (this.App.onPageReady || core.noop)(this.pageName, this);
            this.appManager.notify("pageReady", {
                name: this.pageName,
                instance: this
            });
        };
        BasePageComponent.prototype.loadScripts = function() {
            var _this = this;
            return new Promise(function(resolve) {
                var _a;
                var scriptsRequired = _this.pageDirective && _this.pageDirective.$element.attr("scripts-to-load");
                if (scriptsRequired) {
                    (_a = _this.scriptLoaderService).load.apply(_a, __spread(scriptsRequired.split(","))).then(resolve);
                } else {
                    resolve();
                }
            });
        };
        BasePageComponent.prototype.getPageTransitionTarget = function() {
            return $("app-page-outlet:first").length ? $("app-page-outlet:first") : $('div[data-role="pageContainer"]:first').parent();
        };
        BasePageComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            this.loadScripts().then(function() {
                var transition = _this.navigationService.getPageTransition();
                if (transition) {
                    var pageOutlet = _this.getPageTransitionTarget();
                    pageOutlet.prepend(pageOutlet.children().first().clone());
                }
                _this.runPageTransition(transition).then(function() {
                    _this.pageTransitionCompleted = true;
                    _this.compilePageContent = true;
                }).then(function() {
                    setTimeout(function() {
                        core.unMuteWatchers();
                        _this.viewInit$.complete();
                        _this.onPageContentReady = function() {
                            _this.fragmentsLoaded$.subscribe(core.noop, core.noop, function() {
                                _this.invokeOnReady();
                            });
                            _this.onPageContentReady = core.noop;
                        };
                    }, 300);
                });
            });
        };
        BasePageComponent.prototype.ngOnDestroy = function() {
            this.destroy$.complete();
        };
        BasePageComponent.prototype.onReady = function() {};
        BasePageComponent.prototype.onBeforePageLeave = function() {};
        BasePageComponent.prototype.onPageContentReady = function() {};
        BasePageComponent.propDecorators = {
            pageDirective: [ {
                type: i0.ViewChild,
                args: [ page.PageDirective ]
            } ]
        };
        return BasePageComponent;
    }(FragmentMonitor);
    var BasePrefabComponent = function(_super) {
        __extends(BasePrefabComponent, _super);
        function BasePrefabComponent() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.compileContent = false;
            _this.destroy$ = new rxjs.Subject();
            _this.viewInit$ = new rxjs.Subject();
            return _this;
        }
        BasePrefabComponent.prototype.getContainerWidgetInjector = function() {
            return this.containerWidget.inj || this.containerWidget.injector;
        };
        BasePrefabComponent.prototype.init = function() {
            this.App = this.injector.get(core.App);
            this.containerWidget = this.injector.get(base.WidgetRef);
            this.prefabMngr = this.injector.get(PrefabManagerService);
            this.i18nService = this.injector.get(core.AbstractI18nService);
            this.scriptLoaderService = this.injector.get(core.ScriptLoaderService);
            if (this.getContainerWidgetInjector().view.component.registerFragment) {
                this.getContainerWidgetInjector().view.component.registerFragment();
            }
            this.initUserScript();
            this.registerWidgets();
            this.initVariables();
            this.registerProps();
            this.defineI18nProps();
            _super.prototype.init.call(this);
        };
        BasePrefabComponent.prototype.registerWidgets = function() {
            this.Widgets = {};
        };
        BasePrefabComponent.prototype.initUserScript = function() {
            try {
                this.evalUserScript(this, this.App, this.injector.get(core.UtilsService));
            } catch (e) {
                console.error("Error in evaluating prefab (" + this.prefabName + ") script\n", e);
            }
        };
        BasePrefabComponent.prototype.registerChangeListeners = function() {
            this.containerWidget.registerPropertyChangeListener(this.onPropertyChange);
            this.containerWidget.registerStyleChangeListener(this.onPropertyChange);
        };
        BasePrefabComponent.prototype.registerDestroyListener = function(fn) {
            this.destroy$.subscribe(core.noop, core.noop, function() {
                return fn();
            });
        };
        BasePrefabComponent.prototype.defineI18nProps = function() {
            this.appLocale = this.i18nService.getPrefabLocaleBundle(this.prefabName);
        };
        BasePrefabComponent.prototype.registerProps = function() {
            var _this = this;
            this.prefabMngr.getConfig(this.prefabName).then(function(config) {
                if (config) {
                    _this.displayName = config.displayName;
                    Object.entries(config.properties || {}).forEach(function(_a) {
                        var _b = __read(_a, 2), key = _b[0], prop = _b[1];
                        var expr;
                        var value = _.trim(prop.value);
                        if (_.startsWith(value, "bind:")) {
                            expr = value.replace("bind:", "");
                        }
                        Object.defineProperty(_this, key, {
                            get: function() {
                                return _this.containerWidget[key];
                            },
                            set: function(nv) {
                                return _this.containerWidget.widget[key] = nv;
                            }
                        });
                        if (expr) {
                            _this.registerDestroyListener(core.$watch(expr, _this, {}, function(nv) {
                                return _this.containerWidget.widget[key] = nv;
                            }));
                        }
                    });
                    Object.entries(config.events || {}).forEach(function(_a) {
                        var _b = __read(_a, 2), key = _b[0], prop = _b[1];
                        _this[key] = function() {
                            var args = [];
                            for (var _i = 0; _i < arguments.length; _i++) {
                                args[_i] = arguments[_i];
                            }
                            var eventName = key.substr(2).toLowerCase();
                            _this.containerWidget.invokeEventCallback(eventName, {
                                $event: args[0],
                                $data: args[1]
                            });
                        };
                    });
                    Object.entries(config.methods || {}).forEach(function(_a) {
                        var _b = __read(_a, 2), key = _b[0], prop = _b[1];
                        _this.containerWidget[key] = function() {
                            var args = [];
                            for (var _i = 0; _i < arguments.length; _i++) {
                                args[_i] = arguments[_i];
                            }
                            try {
                                if (_this[key]) {
                                    return _this[key].apply(_this, args);
                                }
                            } catch (e) {
                                console.warn("error in executing prefab-" + _this.prefabName + " method-" + key);
                            }
                        };
                    });
                }
                _this.containerWidget.setProps(config);
                if (core.isIE()) {
                    _this.containerWidget.widget = _this.containerWidget.createProxy();
                }
            });
        };
        BasePrefabComponent.prototype.initVariables = function() {
            var _this = this;
            var variablesService = this.injector.get(variables.VariablesService);
            var variableCollection = variablesService.register(this.prefabName, this.getVariables(), this);
            this.Variables = {};
            this.Actions = {};
            Object.entries(variableCollection.Variables).forEach(function(_a) {
                var _b = __read(_a, 2), name = _b[0], variable = _b[1];
                return _this.Variables[name] = variable;
            });
            Object.entries(variableCollection.Actions).forEach(function(_a) {
                var _b = __read(_a, 2), name = _b[0], action = _b[1];
                return _this.Actions[name] = action;
            });
            this.viewInit$.subscribe(core.noop, core.noop, function() {
                variableCollection.callback(variableCollection.Variables).catch(core.noop);
                variableCollection.callback(variableCollection.Actions);
            });
        };
        BasePrefabComponent.prototype.invokeOnReady = function() {
            core.$invokeWatchers(true, true);
            this.onReady();
            if (this.getContainerWidgetInjector().view.component.resolveFragment) {
                this.getContainerWidgetInjector().view.component.resolveFragment();
            }
            this.containerWidget.invokeEventCallback("load");
        };
        BasePrefabComponent.prototype.loadScripts = function() {
            var _this = this;
            return new Promise(function(resolve) {
                var _a;
                var scriptsRequired = _this.prefabContainerDirective.$element.attr("scripts-to-load");
                if (scriptsRequired) {
                    (_a = _this.scriptLoaderService).load.apply(_a, __spread(scriptsRequired.split(","))).then(resolve);
                } else {
                    resolve();
                }
            });
        };
        BasePrefabComponent.prototype.ngAfterViewInit = function() {
            var _this = this;
            this.loadScripts().then(function() {
                _this.compileContent = true;
                _this.viewInit$.complete();
                _this.registerChangeListeners();
                setTimeout(function() {
                    _this.fragmentsLoaded$.subscribe(core.noop, core.noop, function() {
                        return _this.invokeOnReady();
                    });
                }, 100);
            });
        };
        BasePrefabComponent.prototype.ngOnDestroy = function() {
            this.containerWidget.invokeEventCallback("destroy");
            this.destroy$.complete();
        };
        BasePrefabComponent.prototype.onPropertyChange = function() {};
        BasePrefabComponent.prototype.onReady = function() {};
        BasePrefabComponent.propDecorators = {
            prefabContainerDirective: [ {
                type: i0.ViewChild,
                args: [ prefab.PrefabContainerDirective ]
            } ]
        };
        return BasePrefabComponent;
    }(FragmentMonitor);
    var USER_ROLE;
    (function(USER_ROLE) {
        USER_ROLE["EVERYONE"] = "Everyone";
        USER_ROLE["ANONYMOUS"] = "Anonymous";
        USER_ROLE["AUTHENTICATED"] = "Authenticated";
    })(USER_ROLE || (USER_ROLE = {}));
    var AccessrolesDirective = function() {
        function AccessrolesDirective(templateRef, viewContainerRef, securityService) {
            this.templateRef = templateRef;
            this.viewContainerRef = viewContainerRef;
            this.securityService = securityService;
            this.processed = false;
            var securityConfig = this.securityService.get();
            this.securityEnabled = _.get(securityConfig, "securityEnabled");
            this.isUserAuthenticated = _.get(securityConfig, "authenticated");
            this.userRoles = _.get(securityConfig, "userInfo.userRoles");
        }
        AccessrolesDirective.prototype.getWidgetRolesArrayFromStr = function(val) {
            var UNICODE_COMMA_REGEX = /&#44;/g;
            val = val || "";
            if (val === "") {
                return [];
            }
            return _.split(val, ",").map(function(v) {
                return _.trim(v).replace(UNICODE_COMMA_REGEX, ",");
            });
        };
        AccessrolesDirective.prototype.matchRoles = function(widgetRoles, userRoles) {
            return widgetRoles.some(function(item) {
                return _.includes(userRoles, item);
            });
        };
        AccessrolesDirective.prototype.hasAccessToWidget = function(widgetRoles, userRoles) {
            if (_.includes(widgetRoles, USER_ROLE.EVERYONE)) {
                return true;
            }
            if (_.includes(widgetRoles, USER_ROLE.ANONYMOUS) && !this.isUserAuthenticated) {
                return true;
            }
            if (_.includes(widgetRoles, USER_ROLE.AUTHENTICATED) && this.isUserAuthenticated) {
                return true;
            }
            return this.isUserAuthenticated && this.matchRoles(widgetRoles, userRoles);
        };
        Object.defineProperty(AccessrolesDirective.prototype, "accessroles", {
            set: function(roles) {
                if (this.processed) {
                    return;
                }
                this.processed = true;
                var widgetRoles = this.getWidgetRolesArrayFromStr(roles);
                var isAccessible = !this.securityEnabled || this.hasAccessToWidget(widgetRoles, this.userRoles);
                if (isAccessible) {
                    this.viewContainerRef.createEmbeddedView(this.templateRef);
                } else {
                    this.viewContainerRef.clear();
                }
            },
            enumerable: true,
            configurable: true
        });
        AccessrolesDirective.decorators = [ {
            type: i0.Directive,
            args: [ {
                selector: "[accessroles]"
            } ]
        } ];
        AccessrolesDirective.ctorParameters = function() {
            return [ {
                type: i0.TemplateRef
            }, {
                type: i0.ViewContainerRef
            }, {
                type: security.SecurityService
            } ];
        };
        AccessrolesDirective.propDecorators = {
            accessroles: [ {
                type: i0.Input
            } ]
        };
        return AccessrolesDirective;
    }();
    var PartialContainerDirective = function() {
        function PartialContainerDirective(componentInstance, vcRef, elRef, inj, app, _content, resolver, componentRefProvider, partialRefProvider) {
            var _this = this;
            this.componentInstance = componentInstance;
            this.vcRef = vcRef;
            this.elRef = elRef;
            this.inj = inj;
            this.app = app;
            this.resolver = resolver;
            this.componentRefProvider = componentRefProvider;
            this.partialRefProvider = partialRefProvider;
            this.contentInitialized = false;
            this.renderPartial = _.debounce(this._renderPartial, 200);
            componentInstance.registerPropertyChangeListener(function(key, nv, ov) {
                if (key === "content") {
                    if (componentInstance.$lazyLoad) {
                        componentInstance.$lazyLoad = function() {
                            _this.renderPartial(nv);
                            componentInstance.$lazyLoad = core.noop;
                        };
                    } else {
                        _this.renderPartial(nv);
                    }
                }
            });
            var subscription = componentInstance.params$.pipe(operators.filter(function() {
                return _this.contentInitialized;
            }), operators.debounceTime(200)).subscribe(function() {
                return _this.renderPartial(componentInstance.content);
            });
            componentInstance.registerDestroyListener(function() {
                return subscription.unsubscribe();
            });
        }
        Object.defineProperty(PartialContainerDirective.prototype, "name", {
            get: function() {
                return this.componentInstance.name;
            },
            enumerable: true,
            configurable: true
        });
        PartialContainerDirective.prototype._renderPartial = function(nv) {
            return __awaiter(this, void 0, void 0, function() {
                var componentFactory, instanceRef;
                var _this = this;
                return __generator(this, function(_a) {
                    switch (_a.label) {
                      case 0:
                        this.vcRef.clear();
                        core.$invokeWatchers(true);
                        return [ 4, this.partialRefProvider.getComponentFactoryRef(nv, exports.ComponentType.PARTIAL) ];

                      case 1:
                        componentFactory = _a.sent();
                        if (componentFactory) {
                            instanceRef = this.vcRef.createComponent(componentFactory, 0, this.inj);
                            if (!this.$target) {
                                this.$target = this.elRef.nativeElement.querySelector("[partial-container-target]") || this.elRef.nativeElement;
                            }
                            this.$target.innerHTML = "";
                            this.$target.appendChild(instanceRef.location.nativeElement);
                            this.contentInitialized = true;
                            setTimeout(function() {
                                return _this.onLoadSuccess();
                            }, 200);
                        }
                        return [ 2 ];
                    }
                });
            });
        };
        PartialContainerDirective.prototype.onLoadSuccess = function() {
            this.componentInstance.invokeEventCallback("load");
            this.app.notify("partialLoaded");
        };
        PartialContainerDirective.decorators = [ {
            type: i0.Directive,
            args: [ {
                selector: "[partialContainer]"
            } ]
        } ];
        PartialContainerDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: i0.Self
                }, {
                    type: i0.Inject,
                    args: [ base.WidgetRef ]
                } ]
            }, {
                type: i0.ViewContainerRef
            }, {
                type: i0.ElementRef
            }, {
                type: i0.Injector
            }, {
                type: core.App
            }, {
                type: String,
                decorators: [ {
                    type: i0.Attribute,
                    args: [ "content" ]
                } ]
            }, {
                type: i0.ComponentFactoryResolver
            }, {
                type: ComponentRefProvider
            }, {
                type: PartialRefProvider
            } ];
        };
        return PartialContainerDirective;
    }();
    var AppSpinnerComponent = function() {
        function AppSpinnerComponent() {}
        AppSpinnerComponent.decorators = [ {
            type: i0.Component,
            args: [ {
                selector: "app-spinner",
                template: '\n        <div class="app-spinner" [ngClass]="classname" *ngIf="show">\n            <div class="spinner-message" aria-label="loading gif">\n                <i class="spinner-image animated infinite fa fa-circle-o-notch fa-spin"></i>\n                <div class="spinner-messages">\n                    <p *ngFor="let value of spinnermessages" [textContent]="value"></p>\n                </div>\n            </div>\n        </div>\n    '
            } ]
        } ];
        AppSpinnerComponent.ctorParameters = function() {
            return [];
        };
        AppSpinnerComponent.propDecorators = {
            show: [ {
                type: i0.Input
            } ],
            spinnermessages: [ {
                type: i0.Input
            } ],
            classname: [ {
                type: i0.Input
            } ]
        };
        return AppSpinnerComponent;
    }();
    var CustomToasterComponent = function(_super) {
        __extends(CustomToasterComponent, _super);
        function CustomToasterComponent(toastrService, toastPackage) {
            var _this = _super.call(this, toastrService, toastPackage) || this;
            _this.toastrService = toastrService;
            _this.toastPackage = toastPackage;
            _this.watchers = [];
            _this.params = {};
            _this.pagename = _this.message || "";
            _this.generateParams();
            return _this;
        }
        CustomToasterComponent.prototype.generateParams = function() {
            var _this = this;
            _.forEach(this.options.partialParams, function(param) {
                if (_.isString(param.value) && param.value.indexOf("bind:") === 0) {
                    _this.watchers.push(core.$watch(param.value.substr(5), _this.options.context, {}, function(nv) {
                        _this.params[param.name] = nv;
                        core.$appDigest();
                    }));
                } else {
                    _this.params[param.name] = param.value;
                }
            });
        };
        CustomToasterComponent.prototype.generateDynamicComponent = function() {
            return __awaiter(this, void 0, void 0, function() {
                var $targetLayout;
                return __generator(this, function(_a) {
                    $targetLayout = $(".parent-custom-toast");
                    this.customToastRef.clear();
                    $targetLayout[0].appendChild(this.customToastRef.createEmbeddedView(this.customToastTmpl).rootNodes[0]);
                    return [ 2 ];
                });
            });
        };
        CustomToasterComponent.prototype.ngAfterViewInit = function() {
            this.generateDynamicComponent();
        };
        CustomToasterComponent.prototype.ngOnDestroy = function() {
            _.forEach(this.watchers, function(watcher) {
                return watcher();
            });
        };
        CustomToasterComponent.decorators = [ {
            type: i0.Component,
            args: [ {
                selector: "[custom-toaster-component]",
                template: '\n        <div class="parent-custom-toast"></div>\n        <ng-container #customToast></ng-container>\n        <ng-template #customToastTmpl>\n            <div wmContainer partialContainer content.bind="pagename">\n                <div *ngFor="let param of params | keyvalue" wmParam hidden\n                    [name]="param.key" [value]="param.value"></div>\n            </div>\n        </ng-template>',
                preserveWhitespaces: false
            } ]
        } ];
        CustomToasterComponent.ctorParameters = function() {
            return [ {
                type: ngxToastr.ToastrService
            }, {
                type: ngxToastr.ToastPackage
            } ];
        };
        CustomToasterComponent.propDecorators = {
            customToastRef: [ {
                type: i0.ViewChild,
                args: [ "customToast", {
                    read: i0.ViewContainerRef
                } ]
            } ],
            customToastTmpl: [ {
                type: i0.ViewChild,
                args: [ "customToastTmpl" ]
            } ]
        };
        return CustomToasterComponent;
    }(ngxToastr.Toast);
    var EmptyPageComponent = function() {
        function EmptyPageComponent(route, securityService, router$$1, app, appManger) {
            this.route = route;
            this.securityService = securityService;
            this.router = router$$1;
            this.app = app;
            this.appManger = appManger;
        }
        EmptyPageComponent.prototype.ngOnInit = function() {
            var _this = this;
            if (this.app.isPrefabType) {
                this.router.navigate([ "prefab-preview" ]);
            } else if (this.app.isApplicationType) {
                this.securityService.getPageByLoggedInUser().then(function(page$$1) {
                    _this.router.navigate([ page$$1 ]);
                });
            } else {
                this.router.navigate([ core.getWmProjectProperties().homePage ]);
                this.appManger.postAppTypeInfo();
            }
        };
        EmptyPageComponent.decorators = [ {
            type: i0.Component,
            args: [ {
                selector: "app-empty-page",
                template: "<div></div>"
            } ]
        } ];
        EmptyPageComponent.ctorParameters = function() {
            return [ {
                type: router.ActivatedRoute
            }, {
                type: security.SecurityService
            }, {
                type: router.Router
            }, {
                type: core.App
            }, {
                type: AppManagerService
            } ];
        };
        return EmptyPageComponent;
    }();
    var PrefabDirective = function() {
        function PrefabDirective(componentInstance, vcRef, elRef, prefabMngr, resolver, injector, componentRefProvider) {
            var _this = this;
            this.componentInstance = componentInstance;
            this.vcRef = vcRef;
            this.elRef = elRef;
            this.prefabMngr = prefabMngr;
            this.resolver = resolver;
            this.injector = injector;
            this.componentRefProvider = componentRefProvider;
            var prefabName = this.componentInstance.prefabName;
            this.prefabMngr.loadDependencies(prefabName).then(function() {
                return __awaiter(_this, void 0, void 0, function() {
                    var componentFactory, instanceRef;
                    return __generator(this, function(_a) {
                        switch (_a.label) {
                          case 0:
                            return [ 4, this.componentRefProvider.getComponentFactoryRef(prefabName, exports.ComponentType.PREFAB) ];

                          case 1:
                            componentFactory = _a.sent();
                            if (componentFactory) {
                                instanceRef = this.vcRef.createComponent(componentFactory, 0, injector);
                                this.elRef.nativeElement.appendChild(instanceRef.location.nativeElement);
                            }
                            return [ 2 ];
                        }
                    });
                });
            });
        }
        PrefabDirective.decorators = [ {
            type: i0.Directive,
            args: [ {
                selector: "[wmPrefab][prefabname]"
            } ]
        } ];
        PrefabDirective.ctorParameters = function() {
            return [ {
                type: undefined,
                decorators: [ {
                    type: i0.Self
                }, {
                    type: i0.Inject,
                    args: [ base.WidgetRef ]
                } ]
            }, {
                type: i0.ViewContainerRef
            }, {
                type: i0.ElementRef
            }, {
                type: PrefabManagerService
            }, {
                type: i0.ComponentFactoryResolver
            }, {
                type: i0.Injector
            }, {
                type: ComponentRefProvider
            } ];
        };
        return PrefabDirective;
    }();
    var injectorMap = {
        DialogService: core.AbstractDialogService,
        i18nService: core.AbstractI18nService,
        SpinnerService: core.AbstractSpinnerService,
        ToasterService: core.AbstractToasterService,
        Utils: core.UtilsService,
        CONSTANTS: core.ConstantService,
        FIELD_TYPE: core.FieldTypeService,
        FIELD_WIDGET: core.FieldWidgetService,
        DynamicComponentService: core.DynamicComponentRefProvider
    };
    var noop = function() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
    };
    var getHttpDependency = function() {
        var httpService = this.httpService;
        var fn = function(key, options) {
            var args = Array.from(arguments).slice(1);
            return Promise.resolve(httpService[key].apply(httpService, args));
        };
        var $http = function() {
            return fn.apply(undefined, __spread([ "send" ], Array.from(arguments)));
        };
        [ "get", "post", "head", "put", "delete", "jsonp", "patch" ].forEach(function(key) {
            return $http[key] = fn.bind(undefined, key);
        });
        return $http;
    };
    var AppRef = function() {
        function AppRef(inj, i18nService, httpService, securityService) {
            this.inj = inj;
            this.i18nService = i18nService;
            this.httpService = httpService;
            this.securityService = securityService;
            this.Variables = {};
            this.Actions = {};
            this.onAppVariablesReady = noop;
            this.onSessionTimeout = noop;
            this.onPageReady = noop;
            this.onBeforePageLeave = noop;
            this.onBeforeServiceCall = noop;
            this.onServiceSuccess = noop;
            this.onServiceError = noop;
            this.dynamicComponentContainerRef = {};
            this.changeLocale = this.i18nService.setSelectedLocale.bind(this.i18nService);
            this.getSelectedLocale = this.i18nService.getSelectedLocale.bind(this.i18nService);
            this._eventNotifier = new core.EventNotifier();
            this.landingPageName = core.getWmProjectProperties().homePage;
            var wmProjectProperties = core.getWmProjectProperties();
            this.projectName = wmProjectProperties.name;
            this.isPrefabType = wmProjectProperties.type === "PREFAB";
            this.isApplicationType = wmProjectProperties.type === "APPLICATION";
            this.isTemplateBundleType = wmProjectProperties.type === "TEMPLATEBUNDLE";
            this.httpService.registerOnSessionTimeout(this.on401.bind(this));
            this.appLocale = this.i18nService.getAppLocale();
            this.httpService.setLocale(this.appLocale);
        }
        AppRef.prototype.reload = function() {
            window.location.reload();
        };
        AppRef.prototype.notify = function(eventName) {
            var data = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                data[_i - 1] = arguments[_i];
            }
            this._eventNotifier.notify.apply(this._eventNotifier, arguments);
        };
        AppRef.prototype.getDependency = function(injToken) {
            if (core.isString(injToken)) {
                if (injToken === "HttpService") {
                    return getHttpDependency.call(this);
                }
                var providerInstance_1 = injectorMap[injToken] && this.inj.get(injectorMap[injToken]);
                if (!providerInstance_1 && this.inj["_providers"]) {
                    _.forEach(this.inj["_providers"], function(val) {
                        if (_.isObject(val)) {
                            if (val.__proto__.constructor.SERVICE_NAME === injToken) {
                                providerInstance_1 = val;
                                return false;
                            }
                        }
                    });
                }
                return providerInstance_1;
            }
            return this.inj.get(injToken);
        };
        AppRef.prototype.on401 = function() {
            var userInfo = _.get(this.securityService.get(), "userInfo");
            if (!_.isEmpty(userInfo)) {
                this.onSessionTimeout();
            }
        };
        AppRef.prototype.subscribe = function(eventName, callback) {
            return this._eventNotifier.subscribe(eventName, callback);
        };
        AppRef.prototype.notifyApp = function(template, type, title) {
            var notificationAction = _.get(this, "Actions.appNotification");
            if (notificationAction) {
                type = type || "success";
                notificationAction.invoke({
                    message: template,
                    title: core.isDefined(title) ? title : type.toUpperCase(),
                    class: type,
                    duration: type.toUpperCase() === "ERROR" ? 0 : undefined
                });
            } else {
                console.warn('The default Action "appNotification" doesn\'t exist in the app.');
            }
        };
        AppRef.decorators = [ {
            type: i0.Injectable
        } ];
        AppRef.ctorParameters = function() {
            return [ {
                type: i0.Injector
            }, {
                type: core.AbstractI18nService
            }, {
                type: core.AbstractHttpService
            }, {
                type: security.SecurityService
            } ];
        };
        return AppRef;
    }();
    var ToasterServiceImpl = function(_super) {
        __extends(ToasterServiceImpl, _super);
        function ToasterServiceImpl(toaster) {
            var _this = _super.call(this) || this;
            _this.toaster = toaster;
            return _this;
        }
        ToasterServiceImpl.prototype._showToaster = function(type, title, desc, options) {
            if (_.isNumber(options)) {
                options = {
                    timeOut: options
                };
            }
            options = options || {};
            options.timeOut = core.isDefined(options.timeOut) ? options.timeOut : 0;
            options.enableHtml = core.isDefined(options.enableHtml);
            options.positionClass = options.positionClass || "toast-bottom-right";
            options.toastClass = "toast";
            if (title || desc) {
                if (!options.bodyOutputType && _.isObject(desc)) {
                    desc = JSON.stringify(desc);
                }
                var fn = this.toaster[type];
                if (fn) {
                    return fn.call(this.toaster, desc, title, options);
                }
            }
        };
        ToasterServiceImpl.prototype.success = function(title, desc) {
            return this._showToaster("success", title, desc, {
                timeOut: 5e3
            });
        };
        ToasterServiceImpl.prototype.error = function(title, desc) {
            return this._showToaster("error", title, desc, {
                timeOut: 0
            });
        };
        ToasterServiceImpl.prototype.info = function(title, desc) {
            return this._showToaster("info", title, desc, {
                timeOut: 0
            });
        };
        ToasterServiceImpl.prototype.warn = function(title, desc) {
            return this._showToaster("warning", title, desc, {
                timeOut: 0
            });
        };
        ToasterServiceImpl.prototype.show = function(type, title, desc, options) {
            return this._showToaster(type, title, desc, options);
        };
        ToasterServiceImpl.prototype.hide = function(toasterObj) {
            if (!toasterObj) {
                this.toaster.clear();
                return;
            }
            this.toaster.clear(toasterObj.toastId);
        };
        ToasterServiceImpl.prototype.showCustom = function(page$$1, options) {
            if (!page$$1) {
                return;
            }
            options = options || {};
            options.toastComponent = CustomToasterComponent;
            options.toastClass = "custom-toaster";
            options.timeOut = core.isDefined(options.timeOut) ? options.timeOut : 0;
            options.enableHtml = core.isDefined(options.enableHtml);
            options.positionClass = options.positionClass || "toast-bottom-right";
            options.toastClass = "toast";
            return this.toaster.show(page$$1, "", options);
        };
        ToasterServiceImpl.decorators = [ {
            type: i0.Injectable
        } ];
        ToasterServiceImpl.ctorParameters = function() {
            return [ {
                type: ngxToastr.ToastrService
            } ];
        };
        return ToasterServiceImpl;
    }(core.AbstractToasterService);
    var APP_LOCALE_ROOT_PATH = "resources/i18n";
    var RTL_LANGUAGE_CODES = [ "ar", "ar-001", "ar-ae", "ar-bh", "ar-dz", "ar-eg", "ar-iq", "ar-jo", "ar-kw", "ar-lb", "ar-ly", "ar-ma", "ar-om", "ar-qa", "ar-sa", "ar-sd", "ar-sy", "ar-tn", "ar-ye", "arc", "bcc", "bqi", "ckb", "dv", "fa", "glk", "he", "ku", "mzn", "pnb", "ps", "sd", "ug", "ur", "yi" ];
    var I18nServiceImpl = function(_super) {
        __extends(I18nServiceImpl, _super);
        function I18nServiceImpl($http, bsLocaleService, appDefaults) {
            var _this = _super.call(this) || this;
            _this.$http = $http;
            _this.bsLocaleService = bsLocaleService;
            _this.appDefaults = appDefaults;
            _this.defaultSupportedLocale = "en";
            _this._isAngularLocaleLoaded = false;
            _this.appLocale = {};
            _this.prefabLocale = new Map();
            return _this;
        }
        I18nServiceImpl.prototype.updateLocaleDirection = function() {
            var direction = "ltr";
            if (RTL_LANGUAGE_CODES.includes(this.selectedLocale)) {
                direction = "rtl";
            }
            core.setCSS(document.body, "direction", direction);
        };
        I18nServiceImpl.prototype.init = function() {
            this.messages = {};
            Object.setPrototypeOf(this.appLocale, this.messages);
        };
        I18nServiceImpl.prototype.getSelectedLocale = function() {
            return this.selectedLocale;
        };
        I18nServiceImpl.prototype.getDefaultSupportedLocale = function() {
            return this.defaultSupportedLocale;
        };
        I18nServiceImpl.prototype.getAppLocale = function() {
            return this.appLocale;
        };
        I18nServiceImpl.prototype.getPrefabLocaleBundle = function(prefabName) {
            if (!this.prefabLocale.has(prefabName)) {
                this.prefabLocale.set(prefabName, Object.create(this.appLocale));
            }
            return this.prefabLocale.get(prefabName);
        };
        I18nServiceImpl.prototype.extendPrefabMessages = function(messages) {
            var _this = this;
            if (!messages.prefabMessages) {
                return;
            }
            Object.keys(messages.prefabMessages).forEach(function(prefabName) {
                var bundle = _this.prefabLocale.get(prefabName);
                if (!bundle) {
                    bundle = Object.create(_this.appLocale);
                    _this.prefabLocale.set(prefabName, bundle);
                }
                Object.assign(bundle, messages.prefabMessages[prefabName]);
            });
        };
        I18nServiceImpl.prototype.extendMessages = function(messages) {
            Object.assign(this.messages, messages);
        };
        I18nServiceImpl.prototype.loadResource = function(path) {
            return this.$http.get(path).toPromise().catch(function() {
                console.warn("error loading locale resource from " + path);
            });
        };
        I18nServiceImpl.prototype.loadAppLocaleBundle = function() {
            var _this = this;
            this.loadResource(APP_LOCALE_ROOT_PATH + "/" + this.selectedLocale + ".json").then(function(bundle) {
                _this.extendMessages(bundle.messages);
                _this.extendPrefabMessages(bundle);
                _this.appDefaults.setFormats(bundle.formats);
            });
        };
        I18nServiceImpl.prototype.loadMomentLocaleBundle = function(momentLocale) {
            var _this = this;
            var _cdnUrl = core._WM_APP_PROJECT.cdnUrl || core._WM_APP_PROJECT.ngDest;
            if (this.selectedLocale === this.defaultSupportedLocale) {
                moment.locale(this.defaultSupportedLocale);
                return;
            }
            var path = _cdnUrl + ("locales/moment/" + momentLocale + ".js");
            this.$http.get(path, {
                responseType: "text"
            }).toPromise().then(function(response) {
                var fn = new Function(response);
                fn();
                moment.locale(_this.selectedLocale);
                var _config;
                fn.apply({
                    moment: {
                        defineLocale: function(code, config) {
                            return _config = config;
                        }
                    }
                });
                chronos.defineLocale(_this.selectedLocale, _config);
                _this.bsLocaleService.use(_this.getSelectedLocale() || _this.defaultSupportedLocale);
            });
        };
        I18nServiceImpl.prototype.loadAngularLocaleBundle = function(angLocale) {
            var _this = this;
            return new Promise(function(resolve) {
                var _cdnUrl = core._WM_APP_PROJECT.cdnUrl || core._WM_APP_PROJECT.ngDest;
                if (_this.selectedLocale === _this.defaultSupportedLocale) {
                    resolve();
                    return;
                }
                var path = _cdnUrl + ("locales/angular/" + angLocale + ".js");
                _this.$http.get(path, {
                    responseType: "text"
                }).toPromise().then(function(response) {
                    var module = {}, exports = {};
                    module.exports = exports;
                    var fn = new Function("module", "exports", response);
                    fn(module, exports);
                    common.registerLocaleData(exports.default);
                    _this._isAngularLocaleLoaded = true;
                    resolve();
                }, function() {
                    return resolve();
                });
            });
        };
        I18nServiceImpl.prototype.loadCalendarLocaleBundle = function(calendarLocale, force) {
            if (force === void 0) {
                force = false;
            }
            var _cdnUrl = core._WM_APP_PROJECT.cdnUrl || core._WM_APP_PROJECT.ngDest;
            var path;
            if (calendarLocale) {
                path = _cdnUrl + ("locales/fullcalendar/" + calendarLocale + ".js");
            } else {
                return Promise.resolve();
            }
            if (!force && (core.isMobile() || core.isMobileApp() || this.selectedLocale === this.defaultSupportedLocale)) {
                return;
            }
            this.$http.get(path, {
                responseType: "text"
            }).toPromise().then(function(response) {
                var fn = new Function(response);
                fn();
            });
        };
        I18nServiceImpl.prototype.loadLocaleBundles = function(libLocale) {
            if (libLocale.moment) {
                this.loadMomentLocaleBundle(libLocale.moment);
            }
            if (libLocale.fullCalendar && window["FullCalendar"]) {
                this.loadCalendarLocaleBundle(libLocale.fullCalendar);
            }
            if (libLocale.angular) {
                this.loadAppLocaleBundle();
            }
            return this.loadAngularLocaleBundle(libLocale.angular);
        };
        I18nServiceImpl.prototype.setSelectedLocale = function(locale) {
            var _this = this;
            if (_.isObject(locale)) {
                locale = locale.datavalue;
            }
            var libLocale = core.getWmProjectProperties().supportedLanguages[locale];
            var supportedLocale = Object.keys(core.getWmProjectProperties().supportedLanguages);
            if (!_.includes(supportedLocale, locale)) {
                return Promise.resolve();
            }
            if (!locale || locale === this.selectedLocale) {
                return Promise.resolve();
            }
            core.setSessionStorageItem("selectedLocale", locale);
            this.selectedLocale = locale;
            this.init();
            return this.loadLocaleBundles(libLocale).then(function() {
                return _this.updateLocaleDirection();
            });
        };
        I18nServiceImpl.prototype.loadDefaultLocale = function() {
            var _acceptLang = this.getAcceptedLanguages();
            _acceptLang.push(core.getWmProjectProperties().defaultLanguage);
            var _supportedLang = Object.keys(core.getWmProjectProperties().supportedLanguages) || [ this.defaultSupportedLocale ];
            var _defaultLang = core.getSessionStorageItem("selectedLocale") || _.intersection(_acceptLang, _supportedLang)[0] || this.defaultSupportedLocale;
            _supportedLang = _supportedLang || [ _defaultLang ];
            var defaultLanguage = _defaultLang || _supportedLang[0];
            return this.setSelectedLocale(defaultLanguage);
        };
        I18nServiceImpl.prototype.getLocalizedMessage = function(message) {
            var args = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                args[_i - 1] = arguments[_i];
            }
            return core.replace(this.appLocale[message], args);
        };
        I18nServiceImpl.prototype.getAcceptedLanguages = function() {
            var languages;
            if (variables.CONSTANTS.hasCordova) {
                languages = navigator.languages || [ navigator.language ];
            } else {
                languages = core.getWmProjectProperties().preferredLanguage || "";
                languages = languages.split(",").map(function(locale) {
                    return locale.split(";")[0];
                });
            }
            return _.map(languages, _.toLower);
        };
        I18nServiceImpl.prototype.initCalendarLocale = function() {
            if (this.selectedLocale !== "en") {
                return this.loadCalendarLocaleBundle(this.selectedLocale, true);
            }
            return Promise.resolve();
        };
        I18nServiceImpl.prototype.isAngularLocaleLoaded = function() {
            return this._isAngularLocaleLoaded;
        };
        I18nServiceImpl.decorators = [ {
            type: i0.Injectable
        } ];
        I18nServiceImpl.ctorParameters = function() {
            return [ {
                type: http.HttpClient
            }, {
                type: datepicker.BsLocaleService
            }, {
                type: core.AppDefaults
            } ];
        };
        return I18nServiceImpl;
    }(core.AbstractI18nService);
    var spinnerTemplate = '<div class="app-spinner">\n                            <div class="spinner-message" aria-label="loading gif">\n                                <i class="spinner-image animated infinite fa fa-circle-o-notch fa-spin"></i>\n                                <div class="spinner-messages">\n                                    <p class="spinner-messages-container"></p>\n                               </div>\n                            </div>\n                         </div>';
    var SpinnerServiceImpl = function(_super) {
        __extends(SpinnerServiceImpl, _super);
        function SpinnerServiceImpl() {
            var _this = _super.call(this) || this;
            _this.spinnerId = 0;
            _this.messageSource = new rxjs.Subject();
            _this.messagesByContext = {};
            return _this;
        }
        SpinnerServiceImpl.prototype.getMessageSource = function() {
            return this.messageSource;
        };
        SpinnerServiceImpl.prototype.showContextSpinner = function(ctx, message, id) {
            var ctxMarkup = $('[name="' + ctx + '"]');
            this.messagesByContext[ctx] = this.messagesByContext[ctx] || {};
            if (Object.keys(this.messagesByContext[ctx]).length !== 0) {
                this.messagesByContext[ctx][id] = message;
                this.messagesByContext[ctx]["finalMessage"] = this.messagesByContext[ctx]["finalMessage"] + " " + this.messagesByContext[ctx][id];
                ctxMarkup.find(".spinner-messages-container").html(this.messagesByContext[ctx]["finalMessage"]);
            } else {
                var ctxSpinnerTemp = $(spinnerTemplate);
                this.messagesByContext[ctx][id] = message;
                this.messagesByContext[ctx]["finalMessage"] = this.messagesByContext[ctx][id];
                ctxSpinnerTemp.find(".spinner-messages-container").html(this.messagesByContext[ctx]["finalMessage"]);
                ctxMarkup.prepend(ctxSpinnerTemp);
            }
            return id;
        };
        SpinnerServiceImpl.prototype.showAppSpinner = function(msg, id) {
            var ctx = "page";
            this.messagesByContext[ctx] = this.messagesByContext[ctx] || {};
            this.messagesByContext[ctx][id] = msg;
            this.messageSource.next({
                show: true,
                message: msg,
                messages: _.values(this.messagesByContext[ctx])
            });
        };
        SpinnerServiceImpl.prototype.hideContextSpinner = function(ctx, id) {
            delete this.messagesByContext[ctx][id];
            if (Object.keys(this.messagesByContext[ctx]).length === 1) {
                this.messagesByContext[ctx] = {};
            }
            var ctxMarkup = $('[name="' + ctx + '"]');
            ctxMarkup.find(".app-spinner").remove();
        };
        SpinnerServiceImpl.prototype.show = function(message, id, spinnerClass, spinnerContext, variableScopeId) {
            id = id || ++this.spinnerId;
            if (spinnerContext && spinnerContext !== "page") {
                return this.showContextSpinner(spinnerContext, message, id);
            }
            this.showAppSpinner(message, id);
            return id;
        };
        SpinnerServiceImpl.prototype.hide = function(id) {
            var ctx = _.findKey(this.messagesByContext, function(obj) {
                return _.includes(_.keys(obj), id);
            }) || "page";
            if (ctx !== "page") {
                this.hideContextSpinner(ctx, id);
                return;
            }
            if (id) {
                delete this.messagesByContext[ctx][id];
                var messages = _.values(this.messagesByContext[ctx]);
                this.messageSource.next({
                    show: messages.length ? true : false,
                    messages: _.values(this.messagesByContext[ctx])
                });
            } else {
                this.messagesByContext[ctx] = {};
            }
        };
        SpinnerServiceImpl.decorators = [ {
            type: i0.Injectable
        } ];
        SpinnerServiceImpl.ctorParameters = function() {
            return [];
        };
        return SpinnerServiceImpl;
    }(core.AbstractSpinnerService);
    var parentSelector = "body:first >app-root:last";
    var NavigationServiceImpl = function() {
        function NavigationServiceImpl(app, router$$1) {
            var _this = this;
            this.app = app;
            this.router = router$$1;
            this.history = new History();
            this.isPageAddedToHistory = false;
            this.router.events.subscribe(function(event) {
                if (event instanceof router.NavigationStart) {
                    var url = event.url;
                    var urlParams_1 = {};
                    var pageName = void 0;
                    if (!_this.isPageAddedToHistory) {
                        _this.isPageAddedToHistory = false;
                        if (url.indexOf("?") > 0) {
                            url.substr(url.indexOf("?") + 1).split("&").forEach(function(s) {
                                var splits = s.split("=");
                                urlParams_1[splits[0]] = splits[1];
                            });
                            pageName = url.substr(0, url.indexOf("?"));
                        } else {
                            pageName = url;
                        }
                        if (pageName[0] === "/") {
                            pageName = pageName.substr(1);
                        }
                        if (pageName) {
                            delete urlParams_1["name"];
                            _this.history.push(new PageInfo(pageName, urlParams_1, _this.transition));
                        }
                    }
                }
            });
        }
        NavigationServiceImpl.prototype.getPageTransition = function() {
            if (_.isEmpty(this.transition) || _.isEqual("none", this.transition)) {
                return null;
            }
            return this.transition;
        };
        NavigationServiceImpl.prototype.goToPage = function(pageName, options) {
            this.transition = options.transition || "";
            if (this.history.getCurrentPage()) {
                this.isPageAddedToHistory = true;
            }
            this.history.push(new PageInfo(pageName, options.urlParams, this.transition));
            if (variables.CONSTANTS.isWaveLens) {
                var location_1 = window["location"];
                var strQueryParams = _.map(options.urlParams || [], function(value, key) {
                    return key + "=" + value;
                });
                var strQuery = strQueryParams.length > 0 ? "?" + strQueryParams.join("&") : "";
                location_1.href = location_1.origin + location_1.pathname + "#/" + pageName + strQuery;
                return;
            }
            return this.router.navigate([ "/" + pageName ], {
                queryParams: options.urlParams
            });
        };
        NavigationServiceImpl.prototype.goToPrevious = function() {
            if (this.history.getPagesCount()) {
                this.transition = this.history.getCurrentPage().transition;
                if (!_.isEmpty(this.transition)) {
                    this.transition += "-exit";
                }
                this.history.pop();
                this.isPageAddedToHistory = true;
                window.history.back();
            }
        };
        NavigationServiceImpl.prototype.goToView = function(viewName, options, variable) {
            var _this = this;
            options = options || {};
            var pageName = options.pageName;
            var transition = options.transition || "";
            var $event = options.$event;
            var activePage = this.app.activePage;
            var prefabName = variable && variable._context && variable._context.prefabName;
            if (this.app.isPrefabType) {
                this.goToElementView($(parentSelector).find('[name="' + viewName + '"]'), viewName, pageName, variable);
            } else {
                if (pageName !== activePage.activePageName && !prefabName) {
                    if (this.isPartialWithNameExists(pageName)) {
                        this.goToElementView($('[partialcontainer][content="' + pageName + '"]').find('[name="' + viewName + '"]'), viewName, pageName, variable);
                    } else {
                        this.goToPage(pageName, {
                            viewName: viewName,
                            $event: $event,
                            transition: transition,
                            urlParams: options.urlParams
                        });
                        var pageReadySubscriber_1 = this.app.subscribe("pageReady", function(page$$1) {
                            _this.goToElementView($(parentSelector).find('[name="' + viewName + '"]'), viewName, pageName, variable);
                            pageReadySubscriber_1();
                        });
                    }
                } else if (prefabName && this.isPrefabWithNameExists(prefabName)) {
                    this.goToElementView($('[prefabName="' + prefabName + '"]').find('[name="' + viewName + '"]'), viewName, pageName, variable);
                } else if (!pageName || pageName === activePage.activePageName) {
                    this.goToElementView($(parentSelector).find('[name="' + viewName + '"]'), viewName, pageName, variable);
                } else {
                    this.app.notifyApp(variables.CONSTANTS.WIDGET_DOESNT_EXIST, "error");
                }
            }
        };
        NavigationServiceImpl.prototype.goToElementView = function(viewElement, viewName, pageName, variable) {
            var _this = this;
            var $el, parentDialog;
            var activePage = this.app.activePage;
            if (viewElement.length) {
                if (!this.app.isPrefabType && pageName === activePage.activePageName) {
                    viewElement = this.getViewElementInActivePage(viewElement);
                }
                $el = viewElement[0].widget;
                switch ($el.widgetType) {
                  case "wm-accordionpane":
                    this.showAncestors(viewElement, variable);
                    $el.expand();
                    break;

                  case "wm-tabpane":
                    this.showAncestors(viewElement, variable);
                    $el.select();
                    break;

                  case "wm-segment-content":
                    this.showAncestors(viewElement, variable);
                    $el.navigate();
                    break;

                  case "wm-panel":
                    $el.expanded = true;
                    break;
                }
            } else {
                parentDialog = this.showAncestorDialog(viewName);
                setTimeout(function() {
                    if (parentDialog) {
                        _this.goToElementView($('[name="' + viewName + '"]'), viewName, pageName, variable);
                    }
                });
            }
        };
        NavigationServiceImpl.prototype.getViewElementInActivePage = function($el) {
            var selector;
            if ($el.length > 1) {
                selector = _.filter($el, function(childSelector) {
                    if (_.isEmpty($(childSelector).closest('[data-role = "partial"]')) && _.isEmpty($(childSelector).closest("[wmprefabcontainer]"))) {
                        return childSelector;
                    }
                });
                if (selector) {
                    $el = $(selector);
                }
            }
            return $el;
        };
        NavigationServiceImpl.prototype.isPartialWithNameExists = function(name) {
            return $('[partialcontainer][content="' + name + '"]').length;
        };
        NavigationServiceImpl.prototype.isPrefabWithNameExists = function(prefabName) {
            return $('[prefabName="' + prefabName + '"]').length;
        };
        NavigationServiceImpl.prototype.showAncestors = function(element, variable) {
            var ancestorSearchQuery = '[wm-navigable-element="true"]';
            element.parents(ancestorSearchQuery).toArray().reverse().forEach(function(parent) {
                var $el = parent.widget;
                switch ($el.widgetType) {
                  case "wm-accordionpane":
                    $el.expand();
                    break;

                  case "wm-tabpane":
                    $el.select();
                    break;

                  case "wm-segment-content":
                    $el.navigate();
                    break;

                  case "wm-panel":
                    $el.expanded = true;
                    break;
                }
            });
        };
        NavigationServiceImpl.prototype.showAncestorDialog = function(viewName) {
            var dialogId;
            $("app-root [dialogtype]").each(function() {
                var dialog = $(this);
                if ($(dialog.html()).find('[name="' + viewName + '"]').length) {
                    dialogId = dialog.attr("name");
                    return false;
                }
            });
            return dialogId;
        };
        NavigationServiceImpl.decorators = [ {
            type: i0.Injectable
        } ];
        NavigationServiceImpl.ctorParameters = function() {
            return [ {
                type: core.App
            }, {
                type: router.Router
            } ];
        };
        return NavigationServiceImpl;
    }();
    var PageInfo = function() {
        function PageInfo(name, urlParams, transition) {
            this.name = name;
            this.urlParams = urlParams;
            this.transition = transition;
            this.transition = _.isEmpty(this.transition) ? null : this.transition;
        }
        PageInfo.prototype.isEqual = function(page1) {
            return page1 && page1.name === this.name && _.isEqual(page1.urlParams, this.urlParams);
        };
        return PageInfo;
    }();
    var History = function() {
        function History() {
            this.stack = [];
        }
        History.prototype.getCurrentPage = function() {
            return this.currentPage;
        };
        History.prototype.getPagesCount = function() {
            return this.stack.length;
        };
        History.prototype.isLastVisitedPage = function(page$$1) {
            return this.getLastPage().isEqual(page$$1);
        };
        History.prototype.push = function(pageInfo) {
            if (this.currentPage) {
                this.stack.push(this.currentPage);
            }
            this.currentPage = pageInfo;
        };
        History.prototype.pop = function() {
            this.currentPage = this.stack.pop();
            return this.currentPage;
        };
        History.prototype.getLastPage = function() {
            return this.stack.length > 0 ? this.stack[this.stack.length - 1] : undefined;
        };
        return History;
    }();
    var AppDefaultsService = function() {
        function AppDefaultsService() {}
        AppDefaultsService.prototype.setFormats = function(formats) {
            var dateFormat = formats.date;
            var timeFormat = formats.time;
            var dateTimeFormat = dateFormat && timeFormat ? dateFormat + " " + timeFormat : undefined;
            this.dateFormat = dateFormat;
            this.timeFormat = timeFormat;
            this.dateTimeFormat = dateTimeFormat;
        };
        AppDefaultsService.decorators = [ {
            type: i0.Injectable
        } ];
        AppDefaultsService.ctorParameters = function() {
            return [];
        };
        return AppDefaultsService;
    }();
    var securityConfigLoaded = false;
    var AuthGuard = function() {
        function AuthGuard(securityService, appManager) {
            this.securityService = securityService;
            this.appManager = appManager;
        }
        AuthGuard.prototype.loadSecurityConfig = function() {
            if (securityConfigLoaded) {
                return Promise.resolve(true);
            }
            return this.appManager.loadSecurityConfig().then(function() {
                return securityConfigLoaded = true;
            });
        };
        AuthGuard.prototype.isAuthenticated = function() {
            var _this = this;
            return this.loadSecurityConfig().then(function() {
                return new Promise(function(resolve, reject) {
                    _this.securityService.isAuthenticated(resolve, reject);
                });
            });
        };
        AuthGuard.prototype.canActivate = function(route) {
            var _this = this;
            return this.isAuthenticated().then(function(isLoggedIn) {
                if (isLoggedIn) {
                    return Promise.resolve(true);
                }
                _this.appManager.handle401(route.routeConfig.path);
                return Promise.resolve(false);
            });
        };
        AuthGuard.decorators = [ {
            type: i0.Injectable
        } ];
        AuthGuard.ctorParameters = function() {
            return [ {
                type: security.SecurityService
            }, {
                type: AppManagerService
            } ];
        };
        return AuthGuard;
    }();
    var RoleGuard = function() {
        function RoleGuard(securityService, authGuard, toasterService, app, appManager) {
            this.securityService = securityService;
            this.authGuard = authGuard;
            this.toasterService = toasterService;
            this.app = app;
            this.appManager = appManager;
        }
        RoleGuard.prototype.canActivate = function(route) {
            var _this = this;
            var allowedRoles = route.data.allowedRoles;
            return this.authGuard.isAuthenticated().then(function(isLoggedIn) {
                if (isLoggedIn) {
                    var userRoles = _this.securityService.get().userInfo.userRoles;
                    var hasAccess = _.intersection(allowedRoles, userRoles).length > 0;
                    if (hasAccess) {
                        return Promise.resolve(true);
                    }
                    _this.appManager.notifyApp(_this.app.appLocale.LABEL_ACCESS_DENIED || "Access Denied", "error");
                    return Promise.resolve(false);
                } else {
                    _this.appManager.handle401(route.routeConfig.path);
                    return Promise.resolve(false);
                }
            });
        };
        RoleGuard.decorators = [ {
            type: i0.Injectable
        } ];
        RoleGuard.ctorParameters = function() {
            return [ {
                type: security.SecurityService
            }, {
                type: AuthGuard
            }, {
                type: core.AbstractToasterService
            }, {
                type: core.App
            }, {
                type: AppManagerService
            } ];
        };
        return RoleGuard;
    }();
    var PageNotFoundGaurd = function() {
        function PageNotFoundGaurd(app, appManager) {
            this.app = app;
            this.appManager = appManager;
        }
        PageNotFoundGaurd.prototype.canActivate = function(route) {
            this.appManager.notifyApp(this.app.appLocale.MESSAGE_PAGE_NOT_FOUND || "The page you are trying to reach is not available", "error");
            return Promise.resolve(false);
        };
        PageNotFoundGaurd.decorators = [ {
            type: i0.Injectable
        } ];
        PageNotFoundGaurd.ctorParameters = function() {
            return [ {
                type: core.App
            }, {
                type: AppManagerService
            } ];
        };
        return PageNotFoundGaurd;
    }();
    var appJsLoaded = false;
    var AppJSResolve = function() {
        function AppJSResolve(inj, app, utilService, appJsProvider) {
            this.inj = inj;
            this.app = app;
            this.utilService = utilService;
            this.appJsProvider = appJsProvider;
        }
        AppJSResolve.prototype.resolve = function() {
            return __awaiter(this, void 0, void 0, function() {
                var appScriptFn, e_1;
                return __generator(this, function(_a) {
                    switch (_a.label) {
                      case 0:
                        if (appJsLoaded) {
                            return [ 2, true ];
                        }
                        _a.label = 1;

                      case 1:
                        _a.trys.push([ 1, 3, , 4 ]);
                        return [ 4, this.appJsProvider.getAppScriptFn() ];

                      case 2:
                        appScriptFn = _a.sent();
                        appScriptFn(this.app, this.utilService, this.inj);
                        return [ 3, 4 ];

                      case 3:
                        e_1 = _a.sent();
                        console.warn("Error in executing app.js", e_1);
                        return [ 3, 4 ];

                      case 4:
                        appJsLoaded = true;
                        return [ 2, true ];
                    }
                });
            });
        };
        AppJSResolve.decorators = [ {
            type: i0.Injectable
        } ];
        AppJSResolve.ctorParameters = function() {
            return [ {
                type: i0.Injector
            }, {
                type: core.App
            }, {
                type: core.UtilsService
            }, {
                type: AppJSProvider
            } ];
        };
        return AppJSResolve;
    }();
    var I18nResolve = function() {
        function I18nResolve(i18nService) {
            this.i18nService = i18nService;
        }
        I18nResolve.prototype.resolve = function() {
            return this.i18nService.loadDefaultLocale();
        };
        I18nResolve.decorators = [ {
            type: i0.Injectable
        } ];
        I18nResolve.ctorParameters = function() {
            return [ {
                type: core.AbstractI18nService
            } ];
        };
        return I18nResolve;
    }();
    var PipeProvider = function() {
        function PipeProvider(compiler, injector) {
            var _this = this;
            this.compiler = compiler;
            this.injector = injector;
            this._locale = core.getSessionStorageItem("selectedLocale") || "en";
            this.preparePipeMeta = function(reference, name, pure, diDeps) {
                if (diDeps === void 0) {
                    diDeps = [];
                }
                return {
                    type: {
                        reference: reference,
                        diDeps: diDeps
                    },
                    name: name,
                    pure: pure
                };
            };
            this._pipeData = [ this.preparePipeMeta(common.AsyncPipe, "async", false, [ i0.ChangeDetectorRef ]), this.preparePipeMeta(common.SlicePipe, "slice", false), this.preparePipeMeta(common.PercentPipe, "percent", true, [ this._locale ]), this.preparePipeMeta(common.I18nPluralPipe, "i18nPlural", true, [ common.NgLocalization ]), this.preparePipeMeta(common.I18nSelectPipe, "i18nSelect", true), this.preparePipeMeta(common.KeyValuePipe, "keyvalue", false, [ i0.KeyValueDiffers ]), this.preparePipeMeta(base.FileIconClassPipe, "fileIconClass", true), this.preparePipeMeta(base.FileExtensionFromMimePipe, "fileExtensionFromMime", true), this.preparePipeMeta(base.StateClassPipe, "stateClass", true), this.preparePipeMeta(base.FileSizePipe, "filesize", true), this.preparePipeMeta(base.FilterPipe, "filter", true), this.preparePipeMeta(common.UpperCasePipe, "uppercase", true), this.preparePipeMeta(common.LowerCasePipe, "lowercase", true), this.preparePipeMeta(common.JsonPipe, "json", false), this.preparePipeMeta(common.DecimalPipe, "number", true, [ this._locale ]), this.preparePipeMeta(common.TitleCasePipe, "titlecase", true), this.preparePipeMeta(common.CurrencyPipe, "currency", true, [ this._locale ]), this.preparePipeMeta(common.DatePipe, "date", true, [ this._locale ]), this.preparePipeMeta(base.ToDatePipe, "toDate", true, [ new common.DatePipe(this._locale) ]), this.preparePipeMeta(base.ToNumberPipe, "toNumber", true, [ new common.DecimalPipe(this._locale) ]), this.preparePipeMeta(base.ToCurrencyPipe, "toCurrency", true, [ new common.DecimalPipe(this._locale) ]), this.preparePipeMeta(base.PrefixPipe, "prefix", true), this.preparePipeMeta(base.SuffixPipe, "suffix", true), this.preparePipeMeta(base.TimeFromNowPipe, "timeFromNow", true), this.preparePipeMeta(base.NumberToStringPipe, "numberToString", true, [ new common.DecimalPipe(this._locale) ]), this.preparePipeMeta(base.StringToNumberPipe, "stringToNumber", true) ];
            this._pipeMeta = new Map();
            this._pipeData.forEach(function(v) {
                _this._pipeMeta.set(v.name, v);
            });
        }
        PipeProvider.prototype.unknownPipe = function(name) {
            throw Error("The pipe '" + name + "' could not be found");
        };
        PipeProvider.prototype.meta = function(name) {
            var meta = this._pipeMeta.get(name);
            if (!meta) {
                this.unknownPipe(name);
            }
            return meta;
        };
        PipeProvider.prototype.getPipeNameVsIsPureMap = function() {
            var _map = new Map();
            this._pipeMeta.forEach(function(v, k) {
                _map.set(k, v.pure);
            });
            return _map;
        };
        PipeProvider.prototype.resolveDep = function(dep) {
            return this.injector.get(dep.token.identifier.reference);
        };
        PipeProvider.prototype.getInstance = function(name) {
            var e_1, _a;
            var _b = this.meta(name).type, ref = _b.reference, deps = _b.diDeps;
            if (!ref) {
                this.unknownPipe(name);
            }
            if (!deps.length) {
                return new ref();
            } else {
                var args = [];
                try {
                    for (var deps_1 = __values(deps), deps_1_1 = deps_1.next(); !deps_1_1.done; deps_1_1 = deps_1.next()) {
                        var dep = deps_1_1.value;
                        args.push(dep);
                    }
                } catch (e_1_1) {
                    e_1 = {
                        error: e_1_1
                    };
                } finally {
                    try {
                        if (deps_1_1 && !deps_1_1.done && (_a = deps_1.return)) _a.call(deps_1);
                    } finally {
                        if (e_1) throw e_1.error;
                    }
                }
                return new (ref.bind.apply(ref, __spread([ void 0 ], args)))();
            }
        };
        PipeProvider.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        PipeProvider.ctorParameters = function() {
            return [ {
                type: i0.Compiler
            }, {
                type: i0.Injector
            } ];
        };
        PipeProvider.ngInjectableDef = i0.defineInjectable({
            factory: function PipeProvider_Factory() {
                return new PipeProvider(i0.inject(i0.Compiler), i0.inject(i0.INJECTOR));
            },
            token: PipeProvider,
            providedIn: "root"
        });
        return PipeProvider;
    }();
    var AppComponent = function() {
        function AppComponent(_pipeProvider, _appRef, elRef, oAuthService, dialogService, spinnerService, ngZone, router$$1, app) {
            var _this = this;
            this.elRef = elRef;
            this.oAuthService = oAuthService;
            this.dialogService = dialogService;
            this.spinnerService = spinnerService;
            this.router = router$$1;
            this.app = app;
            this.startApp = false;
            this.isApplicationType = false;
            this.spinner = {
                show: false,
                messages: []
            };
            this.isOAuthDialogOpen = false;
            core.setPipeProvider(_pipeProvider);
            core.setNgZone(ngZone);
            core.setAppRef(_appRef);
            this.isApplicationType = core.getWmProjectProperties().type === "APPLICATION";
            oAuthService.getOAuthProvidersAsObservable().subscribe(function(providers) {
                _this.providersConfig = providers;
                if (providers.length) {
                    _this.showOAuthDialog();
                } else {
                    _this.closeOAuthDialog();
                }
            });
            this.spinnerService.getMessageSource().asObservable().subscribe(function(data) {
                setTimeout(function() {
                    _this.spinner.show = data.show;
                    _this.spinner.messages = data.messages;
                });
            });
            utils.setTheme("bs3");
            if (core.hasCordova() && !window["wmDeviceReady"]) {
                document.addEventListener("wmDeviceReady", function() {
                    return _this.startApp = true;
                });
            } else {
                this.startApp = true;
            }
            var spinnerId;
            this.router.events.subscribe(function(e) {
                if (e instanceof router.NavigationStart) {
                    spinnerId = _this.spinnerService.show("", "globalSpinner");
                    var node = document.querySelector("app-page-outlet");
                    if (node) {
                        core.addClass(node, "page-load-in-progress");
                    }
                } else if (e instanceof router.NavigationEnd || e instanceof router.NavigationCancel || e instanceof router.NavigationError) {
                    setTimeout(function() {
                        _this.spinnerService.hide(spinnerId);
                        var node = document.querySelector("app-page-outlet");
                        if (node) {
                            core.removeClass(node, "page-load-in-progress");
                        }
                    }, 1e3);
                }
            });
        }
        AppComponent.prototype.showOAuthDialog = function() {
            if (!this.isOAuthDialogOpen) {
                this.isOAuthDialogOpen = true;
                this.dialogService.open("oAuthLoginDialog", this);
            }
        };
        AppComponent.prototype.closeOAuthDialog = function() {
            if (this.isOAuthDialogOpen) {
                this.isOAuthDialogOpen = false;
                this.dialogService.close("oAuthLoginDialog", this);
            }
        };
        AppComponent.prototype.ngAfterViewInit = function() {
            this.app.dynamicComponentContainerRef = this.dynamicComponentContainerRef;
        };
        AppComponent.prototype.ngDoCheck = function() {
            core.$invokeWatchers();
        };
        AppComponent.decorators = [ {
            type: i0.Component,
            args: [ {
                selector: "app-root",
                template: '<ng-container *ngIf="startApp">\n    <router-outlet></router-outlet>\n    <div wmContainer partialContainer content="Common" hidden class="ng-hide" *ngIf="isApplicationType"></div>\n    <app-spinner name="globalspinner" classname="global-spinner" [show]="spinner.show" [spinnermessages]="spinner.messages"></app-spinner>\n    <div wmDialog name="oAuthLoginDialog" title.bind="\'Application is requesting you to sign in with\'"\n         close.event="closeOAuthDialog()">\n        <ng-template #dialogBody>\n            <ul class="list-items">\n                <li class="list-item" *ngFor="let provider of providersConfig">\n                    <button class="btn" (click)="provider.invoke()">{{provider.name}}</button>\n                </li>\n            </ul>\n        </ng-template>\n    </div>\n    <div wmConfirmDialog name="_app-confirm-dialog" title.bind="title" message.bind="message" oktext.bind="oktext"\n         canceltext.bind="canceltext" closable="false"\n         iconclass.bind="iconclass" ok.event="onOk()" cancel.event="onCancel()" close.event="onClose()" opened.event="onOpen()"></div>\n    <div wmAppExt></div>\n    <i id="wm-mobile-display"></i>\n</ng-container>\n\x3c!--Dummy container to create the component dynamically--\x3e\n<ng-container #dynamicComponent></ng-container>\n',
                encapsulation: i0.ViewEncapsulation.None
            } ]
        } ];
        AppComponent.ctorParameters = function() {
            return [ {
                type: PipeProvider
            }, {
                type: i0.ApplicationRef
            }, {
                type: i0.ElementRef
            }, {
                type: oAuth.OAuthService
            }, {
                type: core.AbstractDialogService
            }, {
                type: core.AbstractSpinnerService
            }, {
                type: i0.NgZone
            }, {
                type: router.Router
            }, {
                type: core.App
            } ];
        };
        AppComponent.propDecorators = {
            dynamicComponentContainerRef: [ {
                type: i0.ViewChild,
                args: [ "dynamicComponent", {
                    read: i0.ViewContainerRef
                } ]
            } ]
        };
        return AppComponent;
    }();
    var HttpCallInterceptor = function() {
        function HttpCallInterceptor() {
            this.wmHttpRequest = new http$1.WmHttpRequest();
            this.wmHttpResponse = new http$1.WmHttpResponse();
        }
        HttpCallInterceptor.prototype.createSubject = function() {
            return new rxjs.Subject();
        };
        HttpCallInterceptor.prototype.intercept = function(request, next) {
            var _this = this;
            var modifiedReq;
            var modifiedResp;
            if (variables.appManager && variables.appManager.appOnBeforeServiceCall) {
                var req = this.wmHttpRequest.angularToWmRequest(request);
                modifiedReq = variables.appManager.appOnBeforeServiceCall(req);
                if (modifiedReq) {
                    modifiedReq = this.wmHttpRequest.wmToAngularRequest(modifiedReq);
                    request = modifiedReq;
                }
            }
            return next.handle(request).pipe(operators.tap(function(response) {
                if (response && response.type === 4 && variables.appManager && variables.appManager.appOnServiceSuccess) {
                    var resp = _this.wmHttpResponse.angularToWmResponse(response);
                    modifiedResp = variables.appManager.appOnServiceSuccess(resp.body, resp);
                    if (modifiedResp) {
                        modifiedResp = _this.wmHttpResponse.wmToAngularResponse(modifiedResp);
                        _.extend(response, modifiedResp);
                    }
                }
            }, function(error) {
                error._401Subscriber = _this.createSubject();
                if (variables.httpService.isPlatformSessionTimeout(error)) {
                    variables.httpService.handleSessionTimeout(request, error._401Subscriber);
                }
                if (variables.appManager && variables.appManager.appOnServiceError) {
                    var err = _this.wmHttpResponse.angularToWmResponse(error);
                    modifiedResp = variables.appManager.appOnServiceError(err.message, err);
                    if (modifiedResp) {
                        modifiedResp = _this.wmHttpResponse.wmToAngularResponse(modifiedResp);
                        _.extend(error, modifiedResp);
                    }
                }
            }));
        };
        HttpCallInterceptor.decorators = [ {
            type: i0.Injectable
        } ];
        HttpCallInterceptor.ctorParameters = function() {
            return [];
        };
        return HttpCallInterceptor;
    }();
    var PREFAB = "PREFAB";
    var PrefabPreviewComponent = function() {
        function PrefabPreviewComponent(prefabManager) {
            var _this = this;
            this.prefabManager = prefabManager;
            window.addEventListener("message", function(e) {
                var context = e.data && e.data.context;
                if (context !== PREFAB) {
                    return;
                }
                var action = e.data.action;
                var payload = e.data.payload;
                if (action === "init") {
                    _this.init();
                } else if (action === "set-property") {
                    _this.setProperty(payload);
                } else if (action === "get-outbound-properties") {
                    _this.getOutboundProps();
                } else if (action === "invoke-script") {
                    _this.invokeScript(payload);
                }
            });
        }
        PrefabPreviewComponent.prototype.postMessage = function(action, payload) {
            var data = {
                context: PREFAB,
                action: action,
                payload: payload
            };
            window.top.postMessage(data, "*");
        };
        PrefabPreviewComponent.prototype.setupEventListeners = function() {
            var _this = this;
            this.prefabInstance.invokeEventCallback = function(eventName, locals) {
                if (locals === void 0) {
                    locals = {};
                }
                _this.postMessage("event-log", {
                    name: eventName,
                    data: locals
                });
            };
        };
        PrefabPreviewComponent.prototype.init = function() {
            var _this = this;
            this.previewMode = true;
            this.prefabInstance.readyState.subscribe(function() {}, function() {}, function() {
                _this.prefabManager.getConfig("__self__").then(function(config) {
                    _this.config = config;
                    _this.postMessage("config", config);
                    _this.setupEventListeners();
                });
            });
        };
        PrefabPreviewComponent.prototype.setProperty = function(payload) {
            this.prefabInstance.widget[payload.name] = payload.value;
        };
        PrefabPreviewComponent.prototype.isOutBoundProp = function(info) {
            return info.bindable === "out-bound" || info.bindable === "in-out-bound";
        };
        PrefabPreviewComponent.prototype.getOutboundProps = function() {
            var e_1, _a;
            var payload = {};
            try {
                for (var _b = __values(Object.entries(this.config.properties || {})), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var _d = __read(_c.value, 2), name_1 = _d[0], info = _d[1];
                    if (this.isOutBoundProp(info)) {
                        payload[name_1] = this.prefabInstance.widget[name_1];
                    }
                }
            } catch (e_1_1) {
                e_1 = {
                    error: e_1_1
                };
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                } finally {
                    if (e_1) throw e_1.error;
                }
            }
            this.postMessage("outbound-properties", payload);
        };
        PrefabPreviewComponent.prototype.invokeScript = function(payload) {
            var script = "\n return " + payload.script + ";";
            var fn = new Function("Prefab", script);
            var retVal = fn(this.prefabInstance);
            this.postMessage("method-output", {
                methodName: payload.methodName,
                output: retVal
            });
        };
        PrefabPreviewComponent.prototype.ngAfterViewInit = function() {
            this.setupEventListeners();
            this.postMessage("init");
        };
        PrefabPreviewComponent.decorators = [ {
            type: i0.Component,
            args: [ {
                selector: "wm-prefab-preview",
                template: '\n        <div class="prefab-preview row">\n            <section wmPrefab name="prefab-preview" prefabname="__self__"></section>\n        </div>\n    '
            } ]
        } ];
        PrefabPreviewComponent.ctorParameters = function() {
            return [ {
                type: PrefabManagerService
            } ];
        };
        PrefabPreviewComponent.propDecorators = {
            prefabInstance: [ {
                type: i0.ViewChild,
                args: [ prefab.PrefabDirective ]
            } ]
        };
        return PrefabPreviewComponent;
    }();
    buildTask.initComponentsBuildTask();
    var componentFactoryRefCache = new Map();
    var getDynamicModule = function(componentRef) {
        var DynamicModule = function() {
            function DynamicModule() {}
            DynamicModule.decorators = [ {
                type: i0.NgModule,
                args: [ {
                    declarations: [ componentRef ],
                    imports: [ RuntimeBaseModule ],
                    schemas: [ i0.CUSTOM_ELEMENTS_SCHEMA, i0.NO_ERRORS_SCHEMA ]
                } ]
            } ];
            return DynamicModule;
        }();
        return DynamicModule;
    };
    var getDynamicComponent = function(selector, template, css) {
        if (css === void 0) {
            css = "";
        }
        var componentDef = {
            template: template,
            styles: [ css ],
            encapsulation: i0.ViewEncapsulation.None
        };
        var DynamicComponent = function() {
            function DynamicComponent() {}
            DynamicComponent.decorators = [ {
                type: i0.Component,
                args: [ __assign({}, componentDef, {
                    selector: selector
                }) ]
            } ];
            return DynamicComponent;
        }();
        return DynamicComponent;
    };
    var DynamicComponentRefProviderService = function() {
        function DynamicComponentRefProviderService(app, appManager, compiler) {
            this.app = app;
            this.appManager = appManager;
            this.compiler = compiler;
            this.counter = 1;
        }
        DynamicComponentRefProviderService.prototype.getComponentFactoryRef = function(selector, markup, options) {
            if (options === void 0) {
                options = {};
            }
            return __awaiter(this, void 0, void 0, function() {
                var componentFactoryRef, componentDef_1, moduleDef;
                return __generator(this, function(_a) {
                    componentFactoryRef = componentFactoryRefCache.get(selector);
                    markup = options.transpile ? transpiler.transpile(markup).markup : markup;
                    if (!componentFactoryRef || options.noCache) {
                        componentDef_1 = getDynamicComponent(selector, markup, options.styles);
                        moduleDef = getDynamicModule(componentDef_1);
                        componentFactoryRef = this.compiler.compileModuleAndAllComponentsSync(moduleDef).componentFactories.filter(function(factory) {
                            return factory.componentType === componentDef_1;
                        })[0];
                        componentFactoryRefCache.set(selector, componentFactoryRef);
                    }
                    return [ 2, componentFactoryRef ];
                });
            });
        };
        DynamicComponentRefProviderService.prototype.addComponent = function(target, markup, context, options) {
            if (context === void 0) {
                context = {};
            }
            if (options === void 0) {
                options = {};
            }
            return __awaiter(this, void 0, void 0, function() {
                var componentFactoryRef, component;
                return __generator(this, function(_a) {
                    switch (_a.label) {
                      case 0:
                        options.transpile = core.isDefined(options.transpile) ? options.transpile : true;
                        options.noCache = core.isDefined(options.noCache) ? options.noCache : true;
                        options.selector = core.isDefined(options.selector) ? options.selector : "wm-dynamic-component-" + this.counter++;
                        return [ 4, this.getComponentFactoryRef(options.selector, markup, options) ];

                      case 1:
                        componentFactoryRef = _a.sent();
                        component = this.app.dynamicComponentContainerRef.createComponent(componentFactoryRef, 0);
                        core.extendProto(component.instance, context);
                        target.appendChild(component.location.nativeElement);
                        return [ 2 ];
                    }
                });
            });
        };
        DynamicComponentRefProviderService.decorators = [ {
            type: i0.Injectable
        } ];
        DynamicComponentRefProviderService.ctorParameters = function() {
            return [ {
                type: core.App
            }, {
                type: AppManagerService
            }, {
                type: i0.Compiler
            } ];
        };
        return DynamicComponentRefProviderService;
    }();
    var CanDeactivatePageGuard = function() {
        function CanDeactivatePageGuard() {}
        CanDeactivatePageGuard.prototype.canDeactivate = function(component, route, state) {
            return component.canDeactivate ? component.canDeactivate() : true;
        };
        CanDeactivatePageGuard.decorators = [ {
            type: i0.Injectable
        } ];
        return CanDeactivatePageGuard;
    }();
    function InitializeApp(I18nService) {
        return function() {
            core._WM_APP_PROJECT.id = location.href.split("/")[3];
            core._WM_APP_PROJECT.cdnUrl = document.querySelector('[name="cdnUrl"]') && document.querySelector('[name="cdnUrl"]').getAttribute("content");
            core._WM_APP_PROJECT.ngDest = "ng-bundle/";
            return I18nService.loadDefaultLocale();
        };
    }
    function setAngularLocale(I18nService) {
        return I18nService.isAngularLocaleLoaded() ? I18nService.getSelectedLocale() : I18nService.getDefaultSupportedLocale();
    }
    var definitions = [ AccessrolesDirective, PartialContainerDirective, AppSpinnerComponent, CustomToasterComponent, PrefabDirective, AppComponent, PrefabPreviewComponent, EmptyPageComponent ];
    var REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS = [ confirmDialog.ConfirmDialogModule, designDialog.DesignDialogModule, dialogs.DialogModule ];
    $.fn.swipeAnimation.expressionEvaluator = core.$parseExpr;
    var RuntimeBaseModule = function() {
        function RuntimeBaseModule() {
            RuntimeBaseModule.addCustomEventPolyfill();
        }
        RuntimeBaseModule.addCustomEventPolyfill = function() {
            if (typeof window["CustomEvent"] === "function") {
                return false;
            }
            var CustomEvent = function(event, params) {
                params = params || {
                    bubbles: false,
                    cancelable: false,
                    detail: null
                };
                var evt = document.createEvent("CustomEvent");
                evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);
                return evt;
            };
            CustomEvent.prototype = window["Event"].prototype;
            window["CustomEvent"] = CustomEvent;
        };
        RuntimeBaseModule.forRoot = function() {
            return {
                ngModule: RuntimeBaseModule,
                providers: [ {
                    provide: core.App,
                    useClass: AppRef
                }, {
                    provide: core.AbstractToasterService,
                    useClass: ToasterServiceImpl
                }, {
                    provide: core.AbstractI18nService,
                    useClass: I18nServiceImpl
                }, {
                    provide: core.AbstractSpinnerService,
                    useClass: SpinnerServiceImpl
                }, {
                    provide: core.AbstractNavigationService,
                    useClass: NavigationServiceImpl
                }, {
                    provide: core.AppDefaults,
                    useClass: AppDefaultsService
                }, {
                    provide: core.DynamicComponentRefProvider,
                    useClass: DynamicComponentRefProviderService
                }, {
                    provide: i0.APP_INITIALIZER,
                    useFactory: InitializeApp,
                    deps: [ core.AbstractI18nService ],
                    multi: true
                }, {
                    provide: i0.LOCALE_ID,
                    useFactory: setAngularLocale,
                    deps: [ core.AbstractI18nService ]
                }, {
                    provide: http.HTTP_INTERCEPTORS,
                    useClass: HttpCallInterceptor,
                    multi: true
                }, common.DecimalPipe, common.DatePipe, AppManagerService, PrefabManagerService, AuthGuard, RoleGuard, PageNotFoundGaurd, CanDeactivatePageGuard, AppJSResolve, I18nResolve ]
            };
        };
        RuntimeBaseModule.decorators = [ {
            type: i0.NgModule,
            args: [ {
                declarations: definitions,
                imports: [ common.CommonModule, router.RouterModule, http.HttpClientModule, ngxToastr.ToastrModule, base.WmComponentsModule, prefab.PrefabModule, runtime.MobileRuntimeModule, core.CoreModule, security.SecurityModule, oAuth.OAuthModule, variables.VariablesModule, http$1.HttpServiceModule, REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS ],
                exports: [ definitions, common.CommonModule, base.WmComponentsModule, runtime.MobileRuntimeModule, core.CoreModule, security.SecurityModule, oAuth.OAuthModule, variables.VariablesModule, http$1.HttpServiceModule, REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS ],
                entryComponents: [ CustomToasterComponent ]
            } ]
        } ];
        RuntimeBaseModule.ctorParameters = function() {
            return [];
        };
        return RuntimeBaseModule;
    }();
    var WM_MODULES_FOR_ROOT = [ base.WmComponentsModule.forRoot(), runtime.MobileRuntimeModule.forRoot(), core.CoreModule.forRoot(), security.SecurityModule.forRoot(), oAuth.OAuthModule.forRoot(), variables.VariablesModule.forRoot(), http$1.HttpServiceModule.forRoot(), RuntimeBaseModule.forRoot() ];
    var appVariablesLoaded = false;
    var AppVariablesResolve = function() {
        function AppVariablesResolve(appManager, appVariablesProvider) {
            this.appManager = appManager;
            this.appVariablesProvider = appVariablesProvider;
        }
        AppVariablesResolve.prototype.resolve = function() {
            var _this = this;
            if (appVariablesLoaded) {
                return true;
            }
            return this.appVariablesProvider.getAppVariables().then(function(variables$$1) {
                return _this.appManager.loadAppVariables(variables$$1);
            }).then(function() {
                return appVariablesLoaded = true;
            });
        };
        AppVariablesResolve.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        AppVariablesResolve.ctorParameters = function() {
            return [ {
                type: AppManagerService
            }, {
                type: AppVariablesProvider
            } ];
        };
        AppVariablesResolve.ngInjectableDef = i0.defineInjectable({
            factory: function AppVariablesResolve_Factory() {
                return new AppVariablesResolve(i0.inject(AppManagerService), i0.inject(AppVariablesProvider));
            },
            token: AppVariablesResolve,
            providedIn: "root"
        });
        return AppVariablesResolve;
    }();
    var metadataResolved = false;
    var MetadataResolve = function() {
        function MetadataResolve(appManager) {
            this.appManager = appManager;
        }
        MetadataResolve.prototype.resolve = function() {
            return metadataResolved || this.appManager.loadMetadata().then(function() {
                return metadataResolved = true;
            });
        };
        MetadataResolve.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        MetadataResolve.ctorParameters = function() {
            return [ {
                type: AppManagerService
            } ];
        };
        MetadataResolve.ngInjectableDef = i0.defineInjectable({
            factory: function MetadataResolve_Factory() {
                return new MetadataResolve(i0.inject(AppManagerService));
            },
            token: MetadataResolve,
            providedIn: "root"
        });
        return MetadataResolve;
    }();
    var SecurityConfigResolve = function() {
        function SecurityConfigResolve(appManager) {
            this.appManager = appManager;
            this.loaded = this.appManager.isPrefabType() || this.appManager.isTemplateBundleType() || !core.getWmProjectProperties().securityEnabled;
        }
        SecurityConfigResolve.prototype.resolve = function() {
            var _this = this;
            return this.loaded || this.appManager.loadSecurityConfig().then(function() {
                _this.loaded = true;
            });
        };
        SecurityConfigResolve.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        SecurityConfigResolve.ctorParameters = function() {
            return [ {
                type: AppManagerService
            } ];
        };
        SecurityConfigResolve.ngInjectableDef = i0.defineInjectable({
            factory: function SecurityConfigResolve_Factory() {
                return new SecurityConfigResolve(i0.inject(AppManagerService));
            },
            token: SecurityConfigResolve,
            providedIn: "root"
        });
        return SecurityConfigResolve;
    }();
    exports.\u0275d = AppSpinnerComponent;
    exports.\u0275e = CustomToasterComponent;
    exports.\u0275b = AccessrolesDirective;
    exports.\u0275c = PartialContainerDirective;
    exports.\u0275f = PrefabDirective;
    exports.\u0275m = AppDefaultsService;
    exports.\u0275h = AppRef;
    exports.\u0275n = DynamicComponentRefProviderService;
    exports.\u0275o = HttpCallInterceptor;
    exports.\u0275j = I18nServiceImpl;
    exports.\u0275l = NavigationServiceImpl;
    exports.\u0275g = PipeProvider;
    exports.\u0275k = SpinnerServiceImpl;
    exports.\u0275i = ToasterServiceImpl;
    exports.\u0275a = FragmentMonitor;
    exports.ComponentRefProvider = ComponentRefProvider;
    exports.PrefabConfigProvider = PrefabConfigProvider;
    exports.AppJSProvider = AppJSProvider;
    exports.AppVariablesProvider = AppVariablesProvider;
    exports.PartialRefProvider = PartialRefProvider;
    exports.AppManagerService = AppManagerService;
    exports.PrefabManagerService = PrefabManagerService;
    exports.\u02750 = \u02750;
    exports.BasePageComponent = BasePageComponent;
    exports.commonPartialWidgets = commonPartialWidgets;
    exports.BasePartialComponent = BasePartialComponent;
    exports.BasePrefabComponent = BasePrefabComponent;
    exports.InitializeApp = InitializeApp;
    exports.setAngularLocale = setAngularLocale;
    exports.REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS = REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS;
    exports.RuntimeBaseModule = RuntimeBaseModule;
    exports.WM_MODULES_FOR_ROOT = WM_MODULES_FOR_ROOT;
    exports.isPrefabInPreview = isPrefabInPreview;
    exports.getPrefabBaseUrl = getPrefabBaseUrl;
    exports.getPrefabConfigUrl = getPrefabConfigUrl;
    exports.getPrefabMinJsonUrl = getPrefabMinJsonUrl;
    exports.AuthGuard = AuthGuard;
    exports.RoleGuard = RoleGuard;
    exports.PageNotFoundGaurd = PageNotFoundGaurd;
    exports.AppComponent = AppComponent;
    exports.EmptyPageComponent = EmptyPageComponent;
    exports.PrefabPreviewComponent = PrefabPreviewComponent;
    exports.AppJSResolve = AppJSResolve;
    exports.AppVariablesResolve = AppVariablesResolve;
    exports.I18nResolve = I18nResolve;
    exports.MetadataResolve = MetadataResolve;
    exports.SecurityConfigResolve = SecurityConfigResolve;
    exports.CanDeactivatePageGuard = CanDeactivatePageGuard;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});

(function(global, factory) {
    typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("@angular/platform-browser-dynamic"), require("@angular/platform-browser"), require("@angular/common"), require("@angular/forms"), require("ngx-bootstrap"), require("ng-circle-progress"), require("ngx-toastr"), require("@wm/components/basic"), require("@wm/components/basic/progress"), require("@wm/components/basic/rich-text-editor"), require("@wm/components/basic/search"), require("@wm/components/basic/tree"), require("@wm/components/input"), require("@wm/components/input/calendar"), require("@wm/components/input/chips"), require("@wm/components/input/color-picker"), require("@wm/components/input/currency"), require("@wm/components/input/epoch"), require("@wm/components/input/file-upload"), require("@wm/components/input/rating"), require("@wm/components/input/slider"), require("@wm/mobile/runtime/dynamic"), require("@wm/components/data/card"), require("@wm/components/data/form"), require("@wm/components/data/list"), require("@wm/components/data/live-table"), require("@wm/components/data/pagination"), require("@wm/components/data/table"), require("@wm/components/chart"), require("@wm/components/containers/accordion"), require("@wm/components/containers/layout-grid"), require("@wm/components/containers/panel"), require("@wm/components/containers/tabs"), require("@wm/components/containers/tile"), require("@wm/components/containers/wizard"), require("@wm/components/dialogs/alert-dialog"), require("@wm/components/dialogs/iframe-dialog"), require("@wm/components/dialogs/login-dialog"), require("@wm/components/dialogs/partial-dialog"), require("@wm/components/navigation/breadcrumb"), require("@wm/components/navigation/menu"), require("@wm/components/navigation/navbar"), require("@wm/components/navigation/popover"), require("@wm/components/advanced/carousel"), require("@wm/components/advanced/login"), require("@wm/components/advanced/marquee"), require("@wm/components/page"), require("@wm/components/page/footer"), require("@wm/components/page/header"), require("@wm/components/page/left-panel"), require("@wm/components/page/right-panel"), require("@wm/components/page/top-nav"), require("@wm/components/prefab"), require("@angular/router"), require("@wm/variables"), require("@wm/security"), require("@angular/common/http"), require("@wm/core"), require("@wm/transpiler"), require("@angular/core"), require("@wm/runtime/base")) : typeof define === "function" && define.amd ? define("@wm/runtime/dynamic", [ "exports", "@angular/platform-browser-dynamic", "@angular/platform-browser", "@angular/common", "@angular/forms", "ngx-bootstrap", "ng-circle-progress", "ngx-toastr", "@wm/components/basic", "@wm/components/basic/progress", "@wm/components/basic/rich-text-editor", "@wm/components/basic/search", "@wm/components/basic/tree", "@wm/components/input", "@wm/components/input/calendar", "@wm/components/input/chips", "@wm/components/input/color-picker", "@wm/components/input/currency", "@wm/components/input/epoch", "@wm/components/input/file-upload", "@wm/components/input/rating", "@wm/components/input/slider", "@wm/mobile/runtime/dynamic", "@wm/components/data/card", "@wm/components/data/form", "@wm/components/data/list", "@wm/components/data/live-table", "@wm/components/data/pagination", "@wm/components/data/table", "@wm/components/chart", "@wm/components/containers/accordion", "@wm/components/containers/layout-grid", "@wm/components/containers/panel", "@wm/components/containers/tabs", "@wm/components/containers/tile", "@wm/components/containers/wizard", "@wm/components/dialogs/alert-dialog", "@wm/components/dialogs/iframe-dialog", "@wm/components/dialogs/login-dialog", "@wm/components/dialogs/partial-dialog", "@wm/components/navigation/breadcrumb", "@wm/components/navigation/menu", "@wm/components/navigation/navbar", "@wm/components/navigation/popover", "@wm/components/advanced/carousel", "@wm/components/advanced/login", "@wm/components/advanced/marquee", "@wm/components/page", "@wm/components/page/footer", "@wm/components/page/header", "@wm/components/page/left-panel", "@wm/components/page/right-panel", "@wm/components/page/top-nav", "@wm/components/prefab", "@angular/router", "@wm/variables", "@wm/security", "@angular/common/http", "@wm/core", "@wm/transpiler", "@angular/core", "@wm/runtime/base" ], factory) : factory((global.wm = global.wm || {}, 
    global.wm.runtime = global.wm.runtime || {}, global.wm.runtime.dynamic = {}), global.ng.platformBrowserDynamic, global.ng.platformBrowser, global.ng.common, global.ng.forms, global.ngxBootstrap, global.ngCircleProgress, global.ngxToastr, global.wm.components.basic, global.wm.components.basic.progress, global.wm.components.basic.richtexteditor, global.wm.components.basic.search, global.wm.components.basic.tree, global.wm.components.input, global.wm.components.input.calendar, global.wm.components.input.chips, global.wm.components.input.colorpicker, global.wm.components.input.currency, global.wm.components.input.epoch, global.wm.components.input.fileupload, global.wm.components.input.rating, global.wm.components.input.slider, global.wm.mobile.runtime.dynamic, global.wm.components.data.card, global.wm.components.data.form, global.wm.components.data.list, global.wm.components.data.livetable, global.wm.components.data.pagination, global.wm.components.data.table, global.wm.components.chart, global.wm.components.containers.accordion, global.wm.components.containers.layoutgrid, global.wm.components.containers.panel, global.wm.components.containers.tabs, global.wm.components.containers.tile, global.wm.components.containers.wizard, global.wm.components.dialogs.alertdialog, global.wm.components.dialogs.iframedialog, global.wm.components.dialogs.logindialog, global.wm.components.dialogs.partialdialog, global.wm.components.navigation.breadcrumb, global.wm.components.navigation.menu, global.wm.components.navigation.navbar, global.wm.components.navigation.popover, global.wm.components.advanced.carousel, global.wm.components.advanced.login, global.wm.components.advanced.marquee, global.wm.components.page, global.wm.components.page.footer, global.wm.components.page.header, global.wm.components.page.leftpanel, global.wm.components.page.rightpanel, global.wm.components.page.topnav, global.wm.components.prefab, global.ng.router, global.wm.variables, global.wm.security, global.ng.common.http, global.wm.core, global.wm.transpiler, global.ng.core, global.wm.runtime.base);
})(this, function(exports, platformBrowserDynamic, platformBrowser, common, forms, ngxBootstrap, ngCircleProgress, ngxToastr, basic, progress, richTextEditor, search, tree, input, calendar, chips, colorPicker, currency, epoch, fileUpload, rating, slider, dynamic, card, form, list, liveTable, pagination, table, chart, accordion, layoutGrid, panel, tabs, tile, wizard, alertDialog, iframeDialog, loginDialog, partialDialog, breadcrumb, menu, navbar, popover, carousel, login, marquee, page, footer, header, leftPanel, rightPanel, topNav, prefab, router, variables, security, i1, core, transpiler, i0, base) {
    "use strict";
    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(d, b) {
            d.__proto__ = b;
        } || function(d, b) {
            for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() {
            this.constructor = d;
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function(resolve, reject) {
            function fulfilled(value) {
                try {
                    step(generator.next(value));
                } catch (e) {
                    reject(e);
                }
            }
            function rejected(value) {
                try {
                    step(generator["throw"](value));
                } catch (e) {
                    reject(e);
                }
            }
            function step(result) {
                result.done ? resolve(result.value) : new P(function(resolve) {
                    resolve(result.value);
                }).then(fulfilled, rejected);
            }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = {
            label: 0,
            sent: function() {
                if (t[0] & 1) throw t[1];
                return t[1];
            },
            trys: [],
            ops: []
        }, f, y, t, g;
        return g = {
            next: verb(0),
            throw: verb(1),
            return: verb(2)
        }, typeof Symbol === "function" && (g[Symbol.iterator] = function() {
            return this;
        }), g;
        function verb(n) {
            return function(v) {
                return step([ n, v ]);
            };
        }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 
                0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [ op[0] & 2, t.value ];
                switch (op[0]) {
                  case 0:
                  case 1:
                    t = op;
                    break;

                  case 4:
                    _.label++;
                    return {
                        value: op[1],
                        done: false
                    };

                  case 5:
                    _.label++;
                    y = op[1];
                    op = [ 0 ];
                    continue;

                  case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;

                  default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue;
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break;
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break;
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break;
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue;
                }
                op = body.call(thisArg, _);
            } catch (e) {
                op = [ 6, e ];
                y = 0;
            } finally {
                f = t = 0;
            }
            if (op[0] & 5) throw op[1];
            return {
                value: op[0] ? op[1] : void 0,
                done: true
            };
        }
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        } catch (error) {
            e = {
                error: error
            };
        } finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    var PageWrapperComponent = function() {
        function PageWrapperComponent(injector, route, vcRef, appRef, metadataService, securityService, appManager, app, ngZone, elRef, spinnerService, componentRefProvider, router$$1) {
            this.injector = injector;
            this.route = route;
            this.vcRef = vcRef;
            this.appRef = appRef;
            this.metadataService = metadataService;
            this.securityService = securityService;
            this.appManager = appManager;
            this.app = app;
            this.ngZone = ngZone;
            this.elRef = elRef;
            this.spinnerService = spinnerService;
            this.componentRefProvider = componentRefProvider;
            this.router = router$$1;
        }
        PageWrapperComponent.prototype.getTargetNode = function() {
            return this.elRef.nativeElement;
        };
        PageWrapperComponent.prototype.resetViewContainer = function() {
            this.vcRef.clear();
            var $target = this.getTargetNode();
            $target.innerHTML = "";
        };
        PageWrapperComponent.prototype.renderPage = function(pageName) {
            var _this = this;
            var $target = this.getTargetNode();
            this.appManager.loadAppVariables().then(function() {
                return __awaiter(_this, void 0, void 0, function() {
                    var pageComponentFactoryRef, instance;
                    return __generator(this, function(_a) {
                        switch (_a.label) {
                          case 0:
                            return [ 4, this.componentRefProvider.getComponentFactoryRef(pageName, base.ComponentType.PAGE) ];

                          case 1:
                            pageComponentFactoryRef = _a.sent();
                            if (pageComponentFactoryRef) {
                                instance = this.vcRef.createComponent(pageComponentFactoryRef, 0, this.injector);
                                $target.appendChild(instance.location.nativeElement);
                            }
                            if (this.vcRef.length > 1) {
                                this.vcRef.remove(1);
                            }
                            return [ 2 ];
                        }
                    });
                });
            });
        };
        PageWrapperComponent.prototype.renderPrefabPreviewPage = function() {
            this.router.navigate([ "prefab-preview" ]);
        };
        PageWrapperComponent.prototype.canDeactivate = function() {
            var retVal;
            retVal = this.app.activePage && this.app.activePage.onBeforePageLeave();
            if (retVal !== false) {
                retVal = (this.app.onBeforePageLeave || core.noop)(this.app.activePageName, this.app.activePage);
            }
            return retVal === undefined ? true : retVal;
        };
        PageWrapperComponent.prototype.loadPage = function(pageName) {
            var _this = this;
            this.ngZone.run(function() {
                if (pageName) {
                    _this.renderPage(pageName);
                }
            });
        };
        PageWrapperComponent.prototype.ngOnInit = function() {
            var _this = this;
            if (this.app.isPrefabType) {
                this.renderPrefabPreviewPage();
            } else {
                $(this.getTargetNode()).find(">div:first").remove();
                this.subscription = this.route.params.subscribe(function(_a) {
                    var pageName = _a.pageName;
                    _this.loadPage(pageName);
                });
                this.queryParamSubscription = this.route.queryParams.subscribe(function(p) {
                    if (_this.app.activePageName === _this.route.snapshot.paramMap.get("pageName")) {
                        _this.loadPage(_this.app.activePageName);
                    }
                });
            }
        };
        PageWrapperComponent.prototype.ngOnDestroy = function() {
            this.vcRef.clear();
            if (this.subscription) {
                this.subscription.unsubscribe();
            }
            if (this.queryParamSubscription) {
                this.queryParamSubscription.unsubscribe();
            }
        };
        PageWrapperComponent.decorators = [ {
            type: i0.Component,
            args: [ {
                selector: "app-page-outlet",
                template: "<div></div>"
            } ]
        } ];
        PageWrapperComponent.ctorParameters = function() {
            return [ {
                type: i0.Injector
            }, {
                type: router.ActivatedRoute
            }, {
                type: i0.ViewContainerRef
            }, {
                type: i0.ApplicationRef
            }, {
                type: variables.MetadataService
            }, {
                type: security.SecurityService
            }, {
                type: base.AppManagerService
            }, {
                type: core.App
            }, {
                type: i0.NgZone
            }, {
                type: i0.ElementRef
            }, {
                type: core.AbstractSpinnerService
            }, {
                type: base.ComponentRefProvider
            }, {
                type: router.Router
            } ];
        };
        PageWrapperComponent.propDecorators = {
            canDeactivate: [ {
                type: i0.HostListener,
                args: [ "window:beforeunload" ]
            } ]
        };
        return PageWrapperComponent;
    }();
    var appDependenciesResolve = {
        securityConfig: base.SecurityConfigResolve,
        metadata: base.MetadataResolve,
        appJS: base.AppJSResolve
    };
    var routes = [ {
        path: "",
        pathMatch: "full",
        resolve: appDependenciesResolve,
        component: base.EmptyPageComponent
    }, {
        path: "prefab-preview",
        pathMatch: "full",
        resolve: appDependenciesResolve,
        component: base.PrefabPreviewComponent
    }, {
        path: ":pageName",
        pathMatch: "full",
        resolve: appDependenciesResolve,
        component: PageWrapperComponent,
        canDeactivate: [ base.CanDeactivatePageGuard ]
    } ];
    var AppJSProviderService = function(_super) {
        __extends(AppJSProviderService, _super);
        function AppJSProviderService($http) {
            var _this = _super.call(this) || this;
            _this.$http = $http;
            return _this;
        }
        AppJSProviderService.prototype.getAppScriptFn = function() {
            return this.$http.get("./app.js", {
                responseType: "text"
            }).toPromise().then(function(script) {
                return new Function("App", "Utils", "Injector", script);
            });
        };
        AppJSProviderService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        AppJSProviderService.ctorParameters = function() {
            return [ {
                type: i1.HttpClient
            } ];
        };
        AppJSProviderService.ngInjectableDef = i0.defineInjectable({
            factory: function AppJSProviderService_Factory() {
                return new AppJSProviderService(i0.inject(i1.HttpClient));
            },
            token: AppJSProviderService,
            providedIn: "root"
        });
        return AppJSProviderService;
    }(base.AppJSProvider);
    var cache = new Map();
    var AppResourceManagerService = function() {
        function AppResourceManagerService($http) {
            this.$http = $http;
        }
        AppResourceManagerService.prototype.get = function(url, useCache) {
            var cachedResponse = cache.get(url);
            if (cachedResponse) {
                return Promise.resolve(cachedResponse);
            }
            return this.$http.get(url).then(function(response) {
                if (useCache) {
                    cache.set(url, response);
                }
                return response;
            });
        };
        AppResourceManagerService.prototype.clearCache = function() {
            cache.clear();
        };
        AppResourceManagerService.decorators = [ {
            type: i0.Injectable
        } ];
        AppResourceManagerService.ctorParameters = function() {
            return [ {
                type: core.AbstractHttpService
            } ];
        };
        return AppResourceManagerService;
    }();
    var AppVariablesProviderService = function(_super) {
        __extends(AppVariablesProviderService, _super);
        function AppVariablesProviderService(resourceManager) {
            var _this = _super.call(this) || this;
            _this.resourceManager = resourceManager;
            return _this;
        }
        AppVariablesProviderService.prototype.getAppVariables = function() {
            return __awaiter(this, void 0, void 0, function() {
                return __generator(this, function(_a) {
                    return [ 2, this.resourceManager.get("./app.variables.json") ];
                });
            });
        };
        AppVariablesProviderService.decorators = [ {
            type: i0.Injectable,
            args: [ {
                providedIn: "root"
            } ]
        } ];
        AppVariablesProviderService.ctorParameters = function() {
            return [ {
                type: AppResourceManagerService
            } ];
        };
        AppVariablesProviderService.ngInjectableDef = i0.defineInjectable({
            factory: function AppVariablesProviderService_Factory() {
                return new AppVariablesProviderService(i0.inject(AppResourceManagerService));
            },
            token: AppVariablesProviderService,
            providedIn: "root"
        });
        return AppVariablesProviderService;
    }(base.AppVariablesProvider);
    var fragmentCache = new Map();
    window.resourceCache = fragmentCache;
    var componentFactoryRefCache = new Map();
    componentFactoryRefCache.set(base.ComponentType.PAGE, new Map());
    componentFactoryRefCache.set(base.ComponentType.PARTIAL, new Map());
    componentFactoryRefCache.set(base.ComponentType.PREFAB, new Map());
    var _decodeURIComponent = function(str) {
        return decodeURIComponent(str.replace(/\+/g, " "));
    };
    var getFragmentUrl = function(fragmentName, type) {
        if (type === base.ComponentType.PAGE || type === base.ComponentType.PARTIAL) {
            return "./pages/" + fragmentName + "/page.min.json";
        } else if (type === base.ComponentType.PREFAB) {
            return base.getPrefabMinJsonUrl(fragmentName);
        }
    };
    var scriptCache = new Map();
    var execScript = function(script, identifier, ctx, instance, app, utils) {
        var fn = scriptCache.get(identifier);
        if (!fn) {
            fn = new Function(ctx, "App", "Utils", script);
            scriptCache.set(identifier, fn);
        }
        fn(instance, app, utils);
    };
    var BaseDynamicComponent = function() {
        function BaseDynamicComponent() {}
        BaseDynamicComponent.prototype.init = function() {};
        return BaseDynamicComponent;
    }();
    var getDynamicModule = function(componentRef) {
        var DynamicModule = function() {
            function DynamicModule() {}
            DynamicModule.decorators = [ {
                type: i0.NgModule,
                args: [ {
                    declarations: [ componentRef ],
                    imports: [ base.RuntimeBaseModule ],
                    schemas: [ i0.CUSTOM_ELEMENTS_SCHEMA, i0.NO_ERRORS_SCHEMA ]
                } ]
            } ];
            return DynamicModule;
        }();
        return DynamicModule;
    };
    var getDynamicComponent = function(componentName, type, template, css, script, variables$$1) {
        var componentDef = {
            template: template,
            styles: [ css ],
            encapsulation: i0.ViewEncapsulation.None
        };
        var BaseClass = BaseDynamicComponent;
        var selector = "";
        var context = "";
        switch (type) {
          case base.ComponentType.PAGE:
            BaseClass = base.BasePageComponent;
            selector = "app-page-" + componentName;
            context = "Page";
            break;

          case base.ComponentType.PARTIAL:
            BaseClass = base.BasePartialComponent;
            selector = "app-partial-" + componentName;
            context = "Partial";
            break;

          case base.ComponentType.PREFAB:
            BaseClass = base.BasePrefabComponent;
            selector = "app-prefab-" + componentName;
            context = "Prefab";
            break;
        }
        var DynamicComponent = function(_super) {
            __extends(DynamicComponent, _super);
            function DynamicComponent(injector) {
                var _this = _super.call(this) || this;
                _this.injector = injector;
                switch (type) {
                  case base.ComponentType.PAGE:
                    _this.pageName = componentName;
                    break;

                  case base.ComponentType.PARTIAL:
                    _this.partialName = componentName;
                    break;

                  case base.ComponentType.PREFAB:
                    _this.prefabName = componentName;
                    break;
                }
                _super.prototype.init.call(_this);
                return _this;
            }
            DynamicComponent.prototype.evalUserScript = function(instance, appContext, utils) {
                execScript(script, selector, context, instance, appContext, utils);
            };
            DynamicComponent.prototype.getVariables = function() {
                return JSON.parse(variables$$1);
            };
            DynamicComponent.decorators = [ {
                type: i0.Component,
                args: [ __assign({}, componentDef, {
                    selector: selector,
                    providers: [ {
                        provide: core.UserDefinedExecutionContext,
                        useExisting: DynamicComponent
                    } ]
                }) ]
            } ];
            DynamicComponent.ctorParameters = function() {
                return [ {
                    type: i0.Injector
                } ];
            };
            return DynamicComponent;
        }(BaseClass);
        return DynamicComponent;
    };
    var ComponentRefProviderService = function(_super) {
        __extends(ComponentRefProviderService, _super);
        function ComponentRefProviderService(resouceMngr, app, appManager, compiler) {
            var _this = _super.call(this) || this;
            _this.resouceMngr = resouceMngr;
            _this.app = app;
            _this.appManager = appManager;
            _this.compiler = compiler;
            return _this;
        }
        ComponentRefProviderService.prototype.loadResourcesOfFragment = function(componentName, componentType) {
            var _this = this;
            var url = getFragmentUrl(componentName, componentType);
            var resource = fragmentCache.get(url);
            if (resource) {
                return Promise.resolve(resource);
            }
            return this.resouceMngr.get(url, true).then(function(_a) {
                var markup = _a.markup, script = _a.script, styles = _a.styles, variables$$1 = _a.variables;
                var response = {
                    markup: transpiler.transpile(_decodeURIComponent(markup)).markup,
                    script: _decodeURIComponent(script),
                    styles: transpiler.scopeComponentStyles(componentName, componentType, _decodeURIComponent(styles)),
                    variables: core.getValidJSON(_decodeURIComponent(variables$$1))
                };
                fragmentCache.set(url, response);
                return response;
            }, function(e) {
                var status = e.details.status;
                var errorMsgMap = {
                    404: _this.app.appLocale.MESSAGE_PAGE_NOT_FOUND || "The page you are trying to reach is not available",
                    403: _this.app.appLocale.LABEL_ACCESS_DENIED || "Access Denied"
                };
                return Promise.reject(errorMsgMap[status]);
            });
        };
        ComponentRefProviderService.prototype.getComponentFactoryRef = function(componentName, componentType) {
            return __awaiter(this, void 0, void 0, function() {
                var componentFactoryMap, componentFactoryRef;
                var _this = this;
                return __generator(this, function(_a) {
                    componentFactoryMap = componentFactoryRefCache.get(componentType);
                    if (componentFactoryMap) {
                        componentFactoryRef = componentFactoryMap.get(componentName);
                        if (componentFactoryRef) {
                            return [ 2, componentFactoryRef ];
                        }
                    }
                    return [ 2, this.loadResourcesOfFragment(componentName, componentType).then(function(_a) {
                        var markup = _a.markup, script = _a.script, styles = _a.styles, variables$$1 = _a.variables;
                        var componentDef = getDynamicComponent(componentName, componentType, markup, styles, script, JSON.stringify(variables$$1));
                        var moduleDef = getDynamicModule(componentDef);
                        componentFactoryRef = _this.compiler.compileModuleAndAllComponentsSync(moduleDef).componentFactories.filter(function(factory) {
                            return factory.componentType === componentDef;
                        })[0];
                        componentFactoryRefCache.get(componentType).set(componentName, componentFactoryRef);
                        return componentFactoryRef;
                    }, function(err) {
                        if (err) {
                            _this.appManager.notifyApp(err, "error");
                        }
                    }) ];
                });
            });
        };
        ComponentRefProviderService.prototype.clearComponentFactoryRefCache = function() {
            this.resouceMngr.clearCache();
            fragmentCache.clear();
            componentFactoryRefCache.forEach(function(map) {
                map.clear();
            });
        };
        ComponentRefProviderService.decorators = [ {
            type: i0.Injectable
        } ];
        ComponentRefProviderService.ctorParameters = function() {
            return [ {
                type: AppResourceManagerService
            }, {
                type: core.App
            }, {
                type: base.AppManagerService
            }, {
                type: i0.Compiler
            } ];
        };
        return ComponentRefProviderService;
    }(base.ComponentRefProvider);
    var cache$1 = new Map();
    var PrefabConfigProviderService = function(_super) {
        __extends(PrefabConfigProviderService, _super);
        function PrefabConfigProviderService(resourceMngr) {
            var _this = _super.call(this) || this;
            _this.resourceMngr = resourceMngr;
            return _this;
        }
        PrefabConfigProviderService.prototype.getConfig = function(prefabName) {
            var config = cache$1.get(prefabName);
            if (config) {
                return Promise.resolve(config);
            }
            return this.resourceMngr.get(base.getPrefabConfigUrl(prefabName)).then(function(_config) {
                cache$1.set(prefabName, _config);
                return _config;
            });
        };
        PrefabConfigProviderService.decorators = [ {
            type: i0.Injectable
        } ];
        PrefabConfigProviderService.ctorParameters = function() {
            return [ {
                type: AppResourceManagerService
            } ];
        };
        return PrefabConfigProviderService;
    }(base.PrefabConfigProvider);
    var routerModule = router.RouterModule.forRoot(routes, {
        useHash: true,
        scrollPositionRestoration: "top"
    });
    var toastrModule = ngxToastr.ToastNoAnimationModule.forRoot({
        maxOpened: 1,
        autoDismiss: true
    });
    var httpClientXsrfModule = i1.HttpClientXsrfModule.withOptions({
        cookieName: "wm_xsrf_token",
        headerName: core.getWmProjectProperties().xsrf_header_name
    });
    var modalModule = ngxBootstrap.ModalModule.forRoot();
    var bsDatePickerModule = ngxBootstrap.BsDatepickerModule.forRoot();
    var datepickerModule = ngxBootstrap.DatepickerModule.forRoot();
    var timepickerModule = ngxBootstrap.TimepickerModule.forRoot();
    var bsDropdownModule = ngxBootstrap.BsDropdownModule.forRoot();
    var paginationModule = ngxBootstrap.PaginationModule.forRoot();
    var typeaheadModule = ngxBootstrap.TypeaheadModule.forRoot();
    var progressbarModule = ngxBootstrap.ProgressbarModule.forRoot();
    var carouselModule = ngxBootstrap.CarouselModule.forRoot();
    var popoverModule = ngxBootstrap.PopoverModule.forRoot();
    var ngCircleProgressModule = ngCircleProgress.NgCircleProgressModule.forRoot({});
    var tooltipModule = ngxBootstrap.TooltipModule.forRoot();
    var componentsModule = [ ngxBootstrap.BsDatepickerModule, ngxBootstrap.DatepickerModule, ngxBootstrap.TimepickerModule, ngxBootstrap.BsDropdownModule, ngxBootstrap.PaginationModule, ngxBootstrap.TypeaheadModule, ngxBootstrap.ProgressbarModule, ngxBootstrap.CarouselModule, ngxBootstrap.PopoverModule, ngCircleProgress.NgCircleProgressModule, ngxBootstrap.TooltipModule, basic.BasicModule, progress.ProgressModule, richTextEditor.RichTextEditorModule, search.SearchModule, tree.TreeModule, calendar.CalendarModule, chips.ChipsModule, colorPicker.ColorPickerModule, currency.CurrencyModule, epoch.EpochModule, fileUpload.FileUploadModule, input.InputModule, rating.RatingModule, slider.SliderModule, card.CardModule, form.FormModule, list.ListModule, liveTable.LiveTableModule, pagination.PaginationModule, table.TableModule, chart.ChartModule, accordion.AccordionModule, layoutGrid.LayoutGridModule, panel.PanelModule, tabs.TabsModule, tile.TileModule, wizard.WizardModule, alertDialog.AlertDialogModule, iframeDialog.IframeDialogModule, loginDialog.LoginDialogModule, partialDialog.PartialDialogModule, breadcrumb.BreadcrumbModule, menu.MenuModule, navbar.NavbarModule, popover.PopoverModule, carousel.CarouselModule, login.LoginModule, marquee.MarqueeModule, page.PageModule, footer.FooterModule, header.HeaderModule, leftPanel.LeftPanelModule, rightPanel.RightPanelModule, topNav.TopNavModule, prefab.PrefabModule ];
    base.REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS.push.apply(base.REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS, __spread(componentsModule));
    base.REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS.push.apply(base.REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS, __spread(dynamic.MOBILE_COMPONENT_MODULES_FOR_ROOT));
    base.REQUIRED_MODULES_FOR_DYNAMIC_COMPONENTS.push(forms.FormsModule, forms.ReactiveFormsModule);
    var AppModule = function() {
        function AppModule(app, inj, componentRefProvider) {
            this.app = app;
            this.inj = inj;
            this.componentRefProvider = componentRefProvider;
            if (window["cordova"]) {
                this.app.subscribe("userLoggedOut", this.componentRefProvider.clearComponentFactoryRefCache.bind(this.componentRefProvider));
            }
        }
        AppModule.decorators = [ {
            type: i0.NgModule,
            args: [ {
                declarations: [ PageWrapperComponent ],
                imports: [ platformBrowser.BrowserModule, common.CommonModule, router.RouterModule, i1.HttpClientModule, modalModule, bsDatePickerModule, datepickerModule, timepickerModule, bsDropdownModule, paginationModule, typeaheadModule, tooltipModule, progressbarModule, carouselModule, popoverModule, ngCircleProgressModule, routerModule, toastrModule, httpClientXsrfModule, base.WM_MODULES_FOR_ROOT ],
                providers: [ AppResourceManagerService, {
                    provide: base.AppJSProvider,
                    useClass: AppJSProviderService
                }, {
                    provide: base.AppVariablesProvider,
                    useClass: AppVariablesProviderService
                }, {
                    provide: base.ComponentRefProvider,
                    useClass: ComponentRefProviderService
                }, {
                    provide: base.PartialRefProvider,
                    useClass: ComponentRefProviderService
                }, {
                    provide: base.PrefabConfigProvider,
                    useClass: PrefabConfigProviderService
                } ],
                bootstrap: [ base.AppComponent ]
            } ]
        } ];
        AppModule.ctorParameters = function() {
            return [ {
                type: core.App
            }, {
                type: i0.Injector
            }, {
                type: base.ComponentRefProvider
            } ];
        };
        return AppModule;
    }();
    var DEBUG_MODE = "debugMode";
    var isSpotcues = /Spotcues/i.test(window["navigator"].userAgent);
    if (sessionStorage.getItem(DEBUG_MODE) !== "true") {
        i0.enableProdMode();
    }
    console.time("bootstrap");
    var createDirectory = function(parent, name) {
        return new Promise(function(resolve, reject) {
            window["resolveLocalFileSystemURL"](parent, function(fileSystem) {
                fileSystem.getDirectory(name, {
                    create: true,
                    exclusive: false
                }, resolve, reject);
            }, reject);
        });
    };
    var \u02750$1 = createDirectory;
    var generateHash = function(message, algorithm) {
        if (algorithm === void 0) {
            algorithm = "SHA-256";
        }
        var msgUint8 = new window["TextEncoder"]().encode(message);
        return crypto.subtle.digest(algorithm, msgUint8).then(function(hashBuffer) {
            var hashArray = Array.from(new Uint8Array(hashBuffer));
            var hashHex = hashArray.map(function(b) {
                return b.toString(16).padStart(2, "0");
            }).join("");
            return hashHex;
        });
    };
    var \u02751$1 = generateHash;
    var setupFileSystem = function() {
        var cordova = window["cordova"];
        var url = location.href.substring(0, location.href.indexOf("?"));
        return generateHash(url).then(function(hash) {
            return createDirectory(cordova.file.dataDirectory, hash).then(function() {
                return cordova.file.dataDirectory += hash + "/";
            }).then(function() {
                return createDirectory(cordova.file.cacheDirectory, hash);
            }).then(function() {
                return cordova.file.cacheDirectory += hash + "/";
            });
        });
    };
    var \u02752$1 = setupFileSystem;
    document.addEventListener("DOMContentLoaded", function() {
        new Promise(function(resolve) {
            if (isSpotcues) {
                window["SPOTCUES_UTILS"].loadCordova(function() {
                    document.addEventListener("deviceready", function() {
                        setupFileSystem().then(resolve);
                    });
                });
            } else if (window["cordova"]) {
                document.addEventListener("deviceready", resolve);
            } else {
                resolve();
            }
        }).then(function() {
            return platformBrowserDynamic.platformBrowserDynamic().bootstrapModule(AppModule);
        }).then(function() {
            return console.timeEnd("bootstrap");
        }, function(err) {
            return console.log(err);
        });
    });
    window.debugMode = function(on) {
        if (_.isEmpty(on)) {
            on = true;
        }
        var value = on ? "true" : "false";
        if (sessionStorage.getItem(DEBUG_MODE) !== value) {
            sessionStorage.setItem(DEBUG_MODE, value);
            window.location.reload();
        }
    };
    exports.\u0275a = routes;
    exports.\u0275b = PageWrapperComponent;
    exports.\u0275d = AppJSProviderService;
    exports.\u0275c = AppResourceManagerService;
    exports.\u0275e = AppVariablesProviderService;
    exports.\u0275f = ComponentRefProviderService;
    exports.\u0275g = PrefabConfigProviderService;
    exports.\u02750 = \u02750$1;
    exports.\u02751 = \u02751$1;
    exports.\u02752 = \u02752$1;
    exports.routerModule = routerModule;
    exports.toastrModule = toastrModule;
    exports.httpClientXsrfModule = httpClientXsrfModule;
    exports.modalModule = modalModule;
    exports.bsDatePickerModule = bsDatePickerModule;
    exports.datepickerModule = datepickerModule;
    exports.timepickerModule = timepickerModule;
    exports.bsDropdownModule = bsDropdownModule;
    exports.paginationModule = paginationModule;
    exports.typeaheadModule = typeaheadModule;
    exports.progressbarModule = progressbarModule;
    exports.carouselModule = carouselModule;
    exports.popoverModule = popoverModule;
    exports.ngCircleProgressModule = ngCircleProgressModule;
    exports.tooltipModule = tooltipModule;
    exports.AppModule = AppModule;
    Object.defineProperty(exports, "__esModule", {
        value: true
    });
});